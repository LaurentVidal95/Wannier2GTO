module mod_D_X_V_and_E_vec4
  
  implicit none
  
  private
  public :: D_X_V_and_E_vec4
  public :: D_X_V_and_E_fast_vec4
  
  integer, parameter :: NVEC=4
   
contains
  
  

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
recursive function D_X_V_and_E_fast_vec4(a12,lmax,r3,w3,V,Ex,Ey,Ez)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12           !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: r3(NVEC,3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: w3(NVEC)      !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax          !< max order of hermit decomposition of the product of orbital 1 and 2
  real(kind=8), intent(out) :: V(*)          !< cumulated Potential
  real(kind=8), intent(out) :: Ex(*)         !< cumulated x dipole
  real(kind=8), intent(out) :: Ey(*)         !< cumulated y dipole
  real(kind=8), intent(out) :: Ez(*)         !< cumulated z dipole
  
  ! return value
  logical :: D_X_V_and_E_fast_vec4
  
  ! C function interface
  INTERFACE
    PURE RECURSIVE SUBROUTINE my_erf_v4(pd, exppd2, erfpd) BIND(C,NAME="my_erf_v4_")
     real(kind=8), intent(in)  :: pd(4)
     real(kind=8), intent(out) :: erfpd(4)
     real(kind=8), intent(out) :: exppd2(4)
    END SUBROUTINE my_erf_v4
  END INTERFACE
  
  ! local variables
  real(kind=8) :: wgt(NVEC)
  real(kind=8) :: d(NVEC)
  real(kind=8) :: p(NVEC)
  real(kind=8) :: pd(NVEC)
  real(kind=8) :: pd2(NVEC)
  real(kind=8) :: erfpd(NVEC)
  real(kind=8) :: exppd2(NVEC)
  real(kind=8) :: x(NVEC)
  real(kind=8) :: y(NVEC)
  real(kind=8) :: z(NVEC)
  real(kind=8) :: u404(NVEC)
  real(kind=8) :: u463(NVEC)
  real(kind=8) :: u465(NVEC)
  real(kind=8) :: u507(NVEC)
  real(kind=8) :: u708(NVEC)
  real(kind=8) :: u710(NVEC)
  real(kind=8) :: u775(NVEC)
  real(kind=8) :: u776(NVEC)
  real(kind=8) :: u777(NVEC)
  real(kind=8) :: u778(NVEC)
  real(kind=8) :: u779(NVEC)
  real(kind=8) :: u78(NVEC)
  real(kind=8) :: u780(NVEC)
  real(kind=8) :: u781(NVEC)
  real(kind=8) :: u782(NVEC)
  real(kind=8) :: u783(NVEC)
  real(kind=8) :: u784(NVEC)
  real(kind=8) :: u785(NVEC)
  real(kind=8) :: u786(NVEC)
  real(kind=8) :: u787(NVEC)
  real(kind=8) :: u788(NVEC)
  real(kind=8) :: u789(NVEC)
  real(kind=8) :: u79(NVEC)
  real(kind=8) :: u790(NVEC)
  real(kind=8) :: u8(NVEC)
  real(kind=8) :: u80(NVEC)
  real(kind=8) :: u803(NVEC)
  real(kind=8) :: u804(NVEC)
  real(kind=8) :: u805(NVEC)
  real(kind=8) :: u806(NVEC)
  real(kind=8) :: u807(NVEC)
  real(kind=8) :: u808(NVEC)
  real(kind=8) :: u809(NVEC)
  real(kind=8) :: u81(NVEC)
  real(kind=8) :: u810(NVEC)
  real(kind=8) :: u811(NVEC)
  real(kind=8) :: u812(NVEC)
  real(kind=8) :: u813(NVEC)
  real(kind=8) :: u814(NVEC)
  real(kind=8) :: u815(NVEC)
  real(kind=8) :: u816(NVEC)
  real(kind=8) :: u817(NVEC)
  real(kind=8) :: u818(NVEC)
  real(kind=8) :: u819(NVEC)
  real(kind=8) :: u82(NVEC)
  real(kind=8) :: u820(NVEC)
  real(kind=8) :: u821(NVEC)
  real(kind=8) :: u822(NVEC)
  real(kind=8) :: u823(NVEC)
  real(kind=8) :: u824(NVEC)
  real(kind=8) :: u825(NVEC)
  real(kind=8) :: u826(NVEC)
  real(kind=8) :: u827(NVEC)
  real(kind=8) :: u828(NVEC)
  real(kind=8) :: u829(NVEC)
  real(kind=8) :: u83(NVEC)
  real(kind=8) :: u830(NVEC)
  real(kind=8) :: u831(NVEC)
  real(kind=8) :: u832(NVEC)
  real(kind=8) :: u833(NVEC)
  real(kind=8) :: u834(NVEC)
  real(kind=8) :: u835(NVEC)
  real(kind=8) :: u836(NVEC)
  real(kind=8) :: u837(NVEC)
  real(kind=8) :: u838(NVEC)
  real(kind=8) :: u839(NVEC)
  real(kind=8) :: u84(NVEC)
  real(kind=8) :: u840(NVEC)
  real(kind=8) :: u841(NVEC)
  real(kind=8) :: u842(NVEC)
  real(kind=8) :: u843(NVEC)
  real(kind=8) :: u844(NVEC)
  real(kind=8) :: u845(NVEC)
  real(kind=8) :: u846(NVEC)
  real(kind=8) :: u847(NVEC)
  real(kind=8) :: u848(NVEC)
  real(kind=8) :: u849(NVEC)
  real(kind=8) :: u85(NVEC)
  real(kind=8) :: u850(NVEC)
  real(kind=8) :: u851(NVEC)
  real(kind=8) :: u852(NVEC)
  real(kind=8) :: u853(NVEC)
  real(kind=8) :: u854(NVEC)
  real(kind=8) :: u855(NVEC)
  real(kind=8) :: u856(NVEC)
  real(kind=8) :: u857(NVEC)
  real(kind=8) :: u858(NVEC)
  real(kind=8) :: u859(NVEC)
  real(kind=8) :: u86(NVEC)
  real(kind=8) :: u860(NVEC)
  real(kind=8) :: u861(NVEC)
  real(kind=8) :: u862(NVEC)
  real(kind=8) :: u863(NVEC)
  real(kind=8) :: u864(NVEC)
  real(kind=8) :: u865(NVEC)
  real(kind=8) :: u866(NVEC)
  real(kind=8) :: u867(NVEC)
  real(kind=8) :: u868(NVEC)
  real(kind=8) :: u869(NVEC)
  real(kind=8) :: u87(NVEC)
  real(kind=8) :: u870(NVEC)
  real(kind=8) :: u871(NVEC)
  real(kind=8) :: u872(NVEC)
  real(kind=8) :: u873(NVEC)
  real(kind=8) :: u874(NVEC)
  real(kind=8) :: u875(NVEC)
  real(kind=8) :: u876(NVEC)
  real(kind=8) :: u877(NVEC)
  real(kind=8) :: u878(NVEC)
  real(kind=8) :: u879(NVEC)
  real(kind=8) :: u88(NVEC)
  real(kind=8) :: u880(NVEC)
  real(kind=8) :: u881(NVEC)
  real(kind=8) :: u882(NVEC)
  real(kind=8) :: u883(NVEC)
  real(kind=8) :: u884(NVEC)
  real(kind=8) :: u885(NVEC)
  real(kind=8) :: u886(NVEC)
  real(kind=8) :: u887(NVEC)
  real(kind=8) :: u888(NVEC)
  real(kind=8) :: u889(NVEC)
  real(kind=8) :: u89(NVEC)
  real(kind=8) :: u890(NVEC)
  real(kind=8) :: u891(NVEC)
  real(kind=8) :: u892(NVEC)
  real(kind=8) :: u893(NVEC)
  real(kind=8) :: u894(NVEC)
  real(kind=8) :: u895(NVEC)
  real(kind=8) :: u896(NVEC)
  real(kind=8) :: u897(NVEC)
  real(kind=8) :: u898(NVEC)
  real(kind=8) :: u899(NVEC)
  real(kind=8) :: u9(NVEC)
  real(kind=8) :: u90(NVEC)
  real(kind=8) :: u900(NVEC)
  real(kind=8) :: u901(NVEC)
  real(kind=8) :: u902(NVEC)
  real(kind=8) :: u903(NVEC)
  real(kind=8) :: u904(NVEC)
  real(kind=8) :: u905(NVEC)
  real(kind=8) :: u906(NVEC)
  real(kind=8) :: u907(NVEC)
  real(kind=8) :: u908(NVEC)
  real(kind=8) :: u909(NVEC)
  real(kind=8) :: u91(NVEC)
  real(kind=8) :: u910(NVEC)
  real(kind=8) :: u911(NVEC)
  real(kind=8) :: u912(NVEC)
  real(kind=8) :: u913(NVEC)
  real(kind=8) :: u914(NVEC)
  real(kind=8) :: u915(NVEC)
  real(kind=8) :: u916(NVEC)
  real(kind=8) :: u917(NVEC)
  real(kind=8) :: u918(NVEC)
  real(kind=8) :: u919(NVEC)
  real(kind=8) :: u92(NVEC)
  real(kind=8) :: u920(NVEC)
  real(kind=8) :: u921(NVEC)
  real(kind=8) :: u922(NVEC)
  real(kind=8) :: u93(NVEC)
  real(kind=8) :: u94(NVEC)
  real(kind=8) :: u95(NVEC)
  real(kind=8) :: u96(NVEC)
  real(kind=8) :: u97(NVEC)
  real(kind=8) :: u98(NVEC)
  real(kind=8) :: u99(NVEC)
  
  ! scalar variables
  real(kind=8) :: u404_s
  real(kind=8) :: u463_s
  real(kind=8) :: u465_s
  real(kind=8) :: u708_s
  real(kind=8) :: u710_s
  real(kind=8) :: u775_s
  real(kind=8) :: u776_s
  real(kind=8) :: u781_s
  real(kind=8) :: u782_s
  real(kind=8) :: u783_s
  real(kind=8) :: u784_s
  real(kind=8) :: u785_s
  real(kind=8) :: u788_s
  real(kind=8) :: u789_s
  real(kind=8) :: u78_s
  real(kind=8) :: u79_s
  real(kind=8) :: u803_s
  real(kind=8) :: u804_s
  real(kind=8) :: u805_s
  real(kind=8) :: u806_s
  real(kind=8) :: u80_s
  real(kind=8) :: u810_s
  real(kind=8) :: u811_s
  real(kind=8) :: u812_s
  real(kind=8) :: u813_s
  real(kind=8) :: u814_s
  real(kind=8) :: u815_s
  real(kind=8) :: u817_s
  real(kind=8) :: u819_s
  real(kind=8) :: u81_s
  real(kind=8) :: u820_s
  real(kind=8) :: u821_s
  real(kind=8) :: u822_s
  real(kind=8) :: u824_s
  real(kind=8) :: u825_s
  real(kind=8) :: u826_s
  real(kind=8) :: u827_s
  real(kind=8) :: u829_s
  real(kind=8) :: u82_s
  real(kind=8) :: u831_s
  real(kind=8) :: u833_s
  real(kind=8) :: u834_s
  real(kind=8) :: u836_s
  real(kind=8) :: u839_s
  real(kind=8) :: u83_s
  real(kind=8) :: u840_s
  real(kind=8) :: u846_s
  real(kind=8) :: u847_s
  real(kind=8) :: u848_s
  real(kind=8) :: u852_s
  real(kind=8) :: u853_s
  real(kind=8) :: u856_s
  real(kind=8) :: u857_s
  real(kind=8) :: u858_s
  real(kind=8) :: u859_s
  real(kind=8) :: u860_s
  real(kind=8) :: u861_s
  real(kind=8) :: u863_s
  real(kind=8) :: u864_s
  real(kind=8) :: u870_s
  real(kind=8) :: u871_s
  real(kind=8) :: u872_s
  real(kind=8) :: u873_s
  real(kind=8) :: u874_s
  real(kind=8) :: u875_s
  real(kind=8) :: u877_s
  real(kind=8) :: u87_s
  real(kind=8) :: u880_s
  real(kind=8) :: u882_s
  real(kind=8) :: u885_s
  real(kind=8) :: u888_s
  real(kind=8) :: u889_s
  real(kind=8) :: u892_s
  real(kind=8) :: u897_s
  real(kind=8) :: u898_s
  real(kind=8) :: u899_s
  real(kind=8) :: u89_s
  real(kind=8) :: u900_s
  real(kind=8) :: u903_s
  real(kind=8) :: u904_s
  real(kind=8) :: u905_s
  real(kind=8) :: u909_s
  real(kind=8) :: u90_s
  real(kind=8) :: u910_s
  real(kind=8) :: u911_s
  real(kind=8) :: u912_s
  real(kind=8) :: u915_s
  real(kind=8) :: u916_s
  real(kind=8) :: u918_s
  real(kind=8) :: u919_s
  real(kind=8) :: u920_s
  real(kind=8) :: u921_s
  real(kind=8) :: u92_s
  real(kind=8) :: u93_s
  real(kind=8) :: u94_s
  real(kind=8) :: u96_s
  real(kind=8) :: u98_s
  real(kind=8) :: u99_s
  
  ! init computation flag
  D_X_V_and_E_fast_vec4=.true.
  
  ! set weight 
  wgt=w3
  
  ! compute local quantities
  p=sqrt(a12)
  d=sqrt(sum(r3**2,dim=2))+1.0d-32
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  x=r3(:,1)/d
  y=r3(:,2)/d
  z=r3(:,3)/d
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
!  erfpd =erf(pd)
!  exppd2=exp(-pd2)
  call my_erf_v4(pd, exppd2, erfpd)
  
  ! computation section
  u826=1.0d0*p*A1_v(pd,exppd2,erfpd)
  V(1)=sum(wgt*(u826))
  u826=-p**2*A2_v(pd,exppd2,erfpd)
  u783=+u826
  Ex(1)=sum(wgt*(u783*x))
  Ey(1)=sum(wgt*(u783*y))
  Ez(1)=sum(wgt*(u783*z))
  if ( lmax .eq. 0 ) return
  u783=1.0d0*(-u826)
  V(2)=sum(wgt*(u783*x))
  u826=A3_v(pd,exppd2,erfpd)
  u865=5.31736155271654808d0*u826
  u869=p**3
  u9=4.0d0*exppd2
  u808=1.88063194515918762d-1*u869*(u865+u9)
  u859=-3.0d0*u869*u826
  u826=+u859
  u507=x**2
  Ex(2)=sum(wgt*(u826*u507+u808))
  u404=x*y
  u708_s=sum(wgt*(u826*u404))
  Ey(2)=u708_s
  u463=x*z
  u918_s=sum(wgt*(u826*u463))
  Ez(2)=u918_s
  V(3)=sum(wgt*(u783*y))
  Ex(3)=u708_s
  u708=y**2
  Ey(3)=sum(wgt*(u826*u708+u808))
  u465=y*z
  u710_s=sum(wgt*(u826*u465))
  Ez(3)=u710_s
  V(4)=sum(wgt*(u783*z))
  Ex(4)=u918_s
  Ey(4)=u710_s
  u710=z**2
  Ez(4)=sum(wgt*(u826*u710+u808))
  if ( lmax .eq. 1 ) return
  u808=-1.88063194515918762d-1*u869*(u9+u865)
  u826=-u859
  V(5)=sum(wgt*(u826*u507+u808))
  u865=A5_v(pd,exppd2,erfpd)
  u783=2.65868077635827404d1*u865
  u869=p**4*pd
  u918=8.0d0*exppd2
  u97=u869*(u783+u918)
  u828=3.38513750128653772d-1*u97
  u832=-1.5d1*u869*u865
  u865=+u832
  u862=u865*u507
  Ex(5)=sum(wgt*(x*(u862+u828)))
  u866=1.12837916709551257d-1*u97
  u97=(u862+u866)
  u863_s=sum(wgt*(u97*y))
  Ey(5)=u863_s
  u864_s=sum(wgt*(u97*z))
  Ez(5)=u864_s
  V(6)=sum(wgt*(u826*u404))
  Ex(6)=u863_s
  u863=u865*u708
  u97=(u863+u866)
  u825_s=sum(wgt*(x*u97))
  Ey(6)=u825_s
  u862=u404*z
  u92_s=sum(wgt*(u865*u862))
  Ez(6)=u92_s
  V(7)=sum(wgt*(u826*u463))
  Ex(7)=u864_s
  Ey(7)=u92_s
  u864=u865*u710
  u882=(u864+u866)
  u785_s=sum(wgt*(x*u882))
  Ez(7)=u785_s
  V(8)=sum(wgt*(u826*u708+u808))
  Ex(8)=u825_s
  Ey(8)=sum(wgt*(y*(u863+u828)))
  u825_s=sum(wgt*(u97*z))
  Ez(8)=u825_s
  V(9)=sum(wgt*(u826*u465))
  Ex(9)=u92_s
  Ey(9)=u825_s
  u825_s=sum(wgt*(y*u882))
  Ez(9)=u825_s
  V(10)=sum(wgt*(u826*u710+u808))
  Ex(10)=u785_s
  Ey(10)=u825_s
  Ez(10)=sum(wgt*(z*(u864+u828)))
  if ( lmax .eq. 2 ) return
  u866=u869*(u918+u783)
  u808=-3.38513750128653772d-1*u866
  u828=-u832
  u865=u828*u507
  V(11)=sum(wgt*(x*(u865+u808)))
  u859=A7_v(pd,exppd2,erfpd)
  u783=pd2*u859
  u869=1.86107654345079183d2*u783
  u826=p**5
  u864=2.0d0*pd2
  u785=u826*(u918*(u864+7.0d0)+u869)
  u825=-4.83591071612362532d-2*u785
  u92=1.86107654345079183d2*u859
  u97=1.6d1*exppd2
  u882=(u92+u97)
  u915=u826*pd2
  u905=u915*u882
  u821=4.83591071612362532d-1*u905
  u96=-1.05d2*u826*u783
  u783=+u96
  u830=u783*u507
  Ex(11)=sum(wgt*(u507*(u821+u830)+u825))
  u99=2.41795535806181266d-1*u905
  u897=x*(u830+u99)
  u83_s=sum(wgt*(u897*y))
  Ey(11)=u83_s
  u836_s=sum(wgt*(u897*z))
  Ez(11)=u836_s
  u897=-1.12837916709551257d-1*u866
  u866=(u865+u897)
  V(12)=sum(wgt*(u866*y))
  Ex(12)=u83_s
  u83=-1.61197023870787511d-2*u785
  u785=8.05985119353937553d-2*u905
  u905=(u785+u830)
  u91=u785*u507+u83
  u831_s=sum(wgt*(u905*u708+u91))
  Ey(12)=u831_s
  u834_s=sum(wgt*((u830+u785)*u465))
  Ez(12)=u834_s
  V(13)=sum(wgt*(u866*z))
  Ex(13)=u836_s
  Ey(13)=u834_s
  u836_s=sum(wgt*(u905*u710+u91))
  Ez(13)=u836_s
  u866=u828*u708
  u905=(u866+u897)
  V(14)=sum(wgt*(x*u905))
  Ex(14)=u831_s
  u831=u783*u708
  u91=(u831+u99)
  u810_s=sum(wgt*(u404*u91))
  Ey(14)=u810_s
  u817_s=sum(wgt*(x*(u831+u785)*z))
  Ez(14)=u817_s
  V(15)=sum(wgt*(u828*u862))
  Ex(15)=u834_s
  Ey(15)=u817_s
  u834=u783*u710
  u892_s=sum(wgt*(u404*(u834+u785)))
  Ez(15)=u892_s
  u867=u828*u710
  u868=(u867+u897)
  V(16)=sum(wgt*(x*u868))
  Ex(16)=u836_s
  Ey(16)=u892_s
  u836=(u834+u99)
  u822_s=sum(wgt*(u463*u836))
  Ez(16)=u822_s
  V(17)=sum(wgt*(y*(u866+u808)))
  Ex(17)=u810_s
  Ey(17)=sum(wgt*(u708*(u821+u831)+u825))
  u810_s=sum(wgt*(y*u91*z))
  Ez(17)=u810_s
  V(18)=sum(wgt*(u905*z))
  Ex(18)=u817_s
  Ey(18)=u810_s
  u817_s=sum(wgt*((u785+u831)*u710+u785*u708+u83))
  Ez(18)=u817_s
  V(19)=sum(wgt*(y*u868))
  Ex(19)=u892_s
  Ey(19)=u817_s
  u785_s=sum(wgt*(u465*u836))
  Ez(19)=u785_s
  V(20)=sum(wgt*(z*(u867+u808)))
  Ex(20)=u822_s
  Ey(20)=u785_s
  Ez(20)=sum(wgt*(u710*(u821+u834)+u825))
  if ( lmax .eq. 3 ) return
  u808=u826*(u869+u918*(7.0d0+u864))
  u785=4.83591071612362532d-2*u808
  u99=(u97+u92)
  u821=u915*u99
  u783=-4.83591071612362532d-1*u821
  u83=-u96
  u832=u83*u507
  V(21)=sum(wgt*(u507*(u783+u832)+u785))
  u825=p**6*pd
  u869=u825*u99
  u99=-1.20897767903090633d0*u869
  u92=u825*u859
  u915=1.05d3*u92
  u867=exppd2*pd2
  u834=-3.2d1*u867
  u828=u825*(1.67496888910571265d3*u859+u834)
  u859=-5.64189583547756287d-1*u828
  u826=u859*u507
  Ex(21)=sum(wgt*(x*(u507*(u915+u826)+u99)))
  u817=-2.41795535806181266d-1*u869
  u810=6.3d2*u92
  u892=(u507*(u810+u826)+u817)
  u822_s=sum(wgt*(u892*y))
  Ey(21)=u822_s
  u897_s=sum(wgt*(u892*z))
  Ez(21)=u897_s
  u892=-2.41795535806181266d-1*u821
  u905=x*(u832+u892)
  V(22)=sum(wgt*(u905*y))
  Ex(22)=u822_s
  u822=3.15d2*u92
  u91=1.05d2*u92
  u92=(u822+u826)
  u868=u91*u507
  u836=u868+u817
  u811_s=sum(wgt*(x*(u92*u708+u836)))
  Ey(22)=u811_s
  u833_s=sum(wgt*(x*(u826+u822)*u465))
  Ez(22)=u833_s
  V(23)=sum(wgt*(u905*z))
  Ex(23)=u897_s
  Ey(23)=u833_s
  u897_s=sum(wgt*(x*(u92*u710+u836)))
  Ez(23)=u897_s
  u905=1.61197023870787511d-2*u808
  u808=-8.05985119353937553d-2*u821
  u821=(u808+u832)
  u92=u808*u507+u905
  V(24)=sum(wgt*(u821*u708+u92))
  Ex(24)=u811_s
  u811=(u91+u826)
  u836=u811*u708
  u903=u822*u507+u817
  u827_s=sum(wgt*(y*(u836+u903)))
  Ey(24)=u827_s
  u820=-8.05985119353937553d-2*u869
  u869=u868+u820
  u875_s=sum(wgt*((u836+u869)*z))
  Ez(24)=u875_s
  V(25)=sum(wgt*((u832+u808)*u465))
  Ex(25)=u833_s
  Ey(25)=u875_s
  u833=u811*u710
  u836_s=sum(wgt*(y*(u833+u869)))
  Ez(25)=u836_s
  V(26)=sum(wgt*(u821*u710+u92))
  Ex(26)=u897_s
  Ey(26)=u836_s
  u897_s=sum(wgt*(z*(u833+u903)))
  Ez(26)=u897_s
  u833=u83*u708
  u821=(u833+u892)
  V(27)=sum(wgt*(u404*u821))
  Ex(27)=u827_s
  u827=u859*u708
  u811=(u708*(u810+u827)+u817)
  u92_s=sum(wgt*(x*u811))
  Ey(27)=u92_s
  u903_s=sum(wgt*(u404*(u827+u822)*z))
  Ez(27)=u903_s
  V(28)=sum(wgt*(x*(u833+u808)*z))
  Ex(28)=u875_s
  Ey(28)=u903_s
  u875=(u91+u827)*u710
  u869=u91*u708
  u831_s=sum(wgt*(x*(u875+u869+u820)))
  Ez(28)=u831_s
  u835=u83*u710
  V(29)=sum(wgt*(u404*(u835+u808)))
  Ex(29)=u836_s
  Ey(29)=u831_s
  u836=u859*u710
  u819_s=sum(wgt*(u862*(u836+u822)))
  Ez(29)=u819_s
  u78=(u835+u892)
  V(30)=sum(wgt*(u463*u78))
  Ex(30)=u897_s
  Ey(30)=u819_s
  u897=(u710*(u810+u836)+u817)
  u872_s=sum(wgt*(x*u897))
  Ez(30)=u872_s
  V(31)=sum(wgt*(u708*(u783+u833)+u785))
  Ex(31)=u92_s
  Ey(31)=sum(wgt*(y*(u708*(u915+u827)+u99)))
  u92_s=sum(wgt*(u811*z))
  Ez(31)=u92_s
  V(32)=sum(wgt*(y*u821*z))
  Ex(32)=u903_s
  Ey(32)=u92_s
  u92_s=sum(wgt*(y*((u822+u827)*u710+u869+u817)))
  Ez(32)=u92_s
  V(33)=sum(wgt*((u808+u833)*u710+u808*u708+u905))
  Ex(33)=u831_s
  Ey(33)=u92_s
  u905_s=sum(wgt*(z*(u875+u822*u708+u817)))
  Ez(33)=u905_s
  V(34)=sum(wgt*(u465*u78))
  Ex(34)=u819_s
  Ey(34)=u905_s
  u892_s=sum(wgt*(y*u897))
  Ez(34)=u892_s
  V(35)=sum(wgt*(u710*(u783+u835)+u785))
  Ex(35)=u872_s
  Ey(35)=u892_s
  Ez(35)=sum(wgt*(z*(u710*(u915+u836)+u99)))
  if ( lmax .eq. 4 ) return
  u817=u825*u882
  u892=1.20897767903090633d0*u817
  u783=-u915
  u99=5.64189583547756287d-1*u828
  u828=u99*u507
  V(36)=sum(wgt*(x*(u507*(u783+u828)+u892)))
  u96=A9_v(pd,exppd2,erfpd)
  u915=pd2*u96
  u882=1.67496888910571265d3*u915
  u825=p**7
  u83=u825*(u882+u97*(9.0d0+u864))
  u785=1.34330853225656259d-1*u83
  u905=1.67496888910571265d3*u96
  u833=u825*pd2
  u836=3.2d1*exppd2
  u92=u833*(u836+u905)
  u808=-2.82094791773878144d0*u92
  u872=u825*u915
  u915=1.4175d4*u872
  u835=-6.4d1*u867
  u820=u833*(1.84246577801628391d4*u96+u835)
  u903=-5.64189583547756287d-1*u820
  u819=u903*u507
  Ex(36)=sum(wgt*(u507*(u808+u507*(u819+u915))+u785))
  u811=-9.40315972579593812d-1*u92
  u897=9.45d3*u872
  u859=x*(u507*(u897+u819)+u811)
  u875_s=sum(wgt*(u859*y))
  Ey(36)=u875_s
  u821_s=sum(wgt*(u859*z))
  Ez(36)=u821_s
  u859=2.41795535806181266d-1*u817
  u78=-u810
  u810=(u507*(u78+u828)+u859)
  V(37)=sum(wgt*(u810*y))
  Ex(37)=u875_s
  u875=2.68661706451312518d-2*u83
  u83=-1.88063194515918762d-1*u92
  u831=-3.76126389031837525d-1*u92
  u86=5.67d3*u872
  u846=9.45d2*u872
  u870=(u83+u507*(u819+u86))
  u837=u846*u507
  u898=u507*(u831+u837)+u875
  u93_s=sum(wgt*(u870*u708+u898))
  Ey(37)=u93_s
  u87_s=sum(wgt*((u507*(u86+u819)+u83)*u465))
  Ez(37)=u87_s
  V(38)=sum(wgt*(u810*z))
  Ex(38)=u821_s
  Ey(38)=u87_s
  u821_s=sum(wgt*(u870*u710+u898))
  Ez(38)=u821_s
  u810=-u822
  u822=-u91
  u91=(u810+u828)
  u870=u822*u507
  u898=u870+u859
  V(39)=sum(wgt*(x*(u91*u708+u898)))
  Ex(39)=u93_s
  u93=-5.64189583547756287d-1*u92
  u92=2.835d3*u872
  u872=(u92+u819)
  u840=u872*u708
  u871=u92*u507
  u852=u871+u93
  u815_s=sum(wgt*(u404*(u840+u852)))
  Ey(39)=u815_s
  u84=u837+u83
  u919_s=sum(wgt*(x*(u840+u84)*z))
  Ez(39)=u919_s
  V(40)=sum(wgt*(x*(u828+u810)*u465))
  Ex(40)=u87_s
  Ey(40)=u919_s
  u87=u872*u710
  u840_s=sum(wgt*(u404*(u87+u84)))
  Ez(40)=u840_s
  V(41)=sum(wgt*(x*(u91*u710+u898)))
  Ex(41)=u821_s
  Ey(41)=u840_s
  u821_s=sum(wgt*(u463*(u87+u852)))
  Ez(41)=u821_s
  u87=(u822+u828)
  u91=u87*u708
  u872=u810*u507+u859
  V(42)=sum(wgt*(y*(u91+u872)))
  Ex(42)=u815_s
  u815=(u819+u846)
  u898=u815*u708
  u852=u831+u86*u507
  u84=u83*u507+u875
  u824_s=sum(wgt*(u708*(u852+u898)+u84))
  Ey(42)=u824_s
  u80=(u846+u819)
  u873=u871+u83
  u79_s=sum(wgt*(y*(u80*u708+u873)*z))
  Ez(42)=u79_s
  u874=8.05985119353937553d-2*u817
  u817=u870+u874
  V(43)=sum(wgt*((u91+u817)*z))
  Ex(43)=u919_s
  Ey(43)=u79_s
  u919=u918*(4.0d0*pd2-3.0d0)
  u918=-5.37323412902625035d-2*u825*(u919+u882)
  u91=-u846
  u860=-2.25675833419102515d0*u833*(5.02490666731713794d3*u96-1.6d1*u86&
 &7)
  u96=+u860
  u776=5.64189583547756287d-1*u820
  u820=u776*u507
  u879=(u820+u91)
  u855=u879*u708
  u838=u91*u507
  u839_s=sum(wgt*(u708*(u846+u507*(u820+u96)+u855)+u507*(u846+u838)+u918)&
 &)
  Ez(43)=u839_s
  u829=u87*u710
  V(44)=sum(wgt*(y*(u829+u817)))
  Ex(44)=u840_s
  Ey(44)=u839_s
  u840_s=sum(wgt*(u465*(u80*u710+u873)))
  Ez(44)=u840_s
  V(45)=sum(wgt*(z*(u829+u872)))
  Ex(45)=u821_s
  Ey(45)=u840_s
  u821_s=sum(wgt*(u710*(u852+u815*u710)+u84))
  Ez(45)=u821_s
  u829=u99*u708
  u87=(u708*(u78+u829)+u859)
  V(46)=sum(wgt*(x*u87))
  Ex(46)=u824_s
  u824=u903*u708
  u815=(u708*(u897+u824)+u811)
  u870_s=sum(wgt*(u404*u815))
  Ey(46)=u870_s
  u80_s=sum(wgt*(x*(u708*(u86+u824)+u83)*z))
  Ez(46)=u80_s
  V(47)=sum(wgt*(u404*(u829+u810)*z))
  Ex(47)=u79_s
  Ey(47)=u80_s
  u79=(u92+u824)*u710
  u872=u846*u708
  u852_s=sum(wgt*(u404*(u79+u872+u83)))
  Ez(47)=u852_s
  u84=(u822+u829)*u710
  u873=u822*u708
  V(48)=sum(wgt*(x*(u84+u873+u874)))
  Ex(48)=u839_s
  Ey(48)=u852_s
  u874=u92*u708
  u918_s=sum(wgt*(u463*((u846+u824)*u710+u874+u83)))
  Ez(48)=u918_s
  u839=u99*u710
  V(49)=sum(wgt*(u862*(u839+u810)))
  Ex(49)=u840_s
  Ey(49)=u918_s
  u840=u903*u710
  u817_s=sum(wgt*(u404*(u710*(u86+u840)+u83)))
  Ez(49)=u817_s
  u848=(u710*(u78+u839)+u859)
  V(50)=sum(wgt*(x*u848))
  Ex(50)=u821_s
  Ey(50)=u817_s
  u821=(u710*(u897+u840)+u811)
  u812_s=sum(wgt*(u463*u821))
  Ez(50)=u812_s
  V(51)=sum(wgt*(y*(u708*(u783+u829)+u892)))
  Ex(51)=u870_s
  Ey(51)=sum(wgt*(u708*(u808+u708*(u824+u915))+u785))
  u870_s=sum(wgt*(y*u815*z))
  Ez(51)=u870_s
  V(52)=sum(wgt*(u87*z))
  Ex(52)=u80_s
  Ey(52)=u870_s
  u80_s=sum(wgt*((u83+u708*(u824+u86))*u710+u708*(u831+u872)+u875))
  Ez(52)=u80_s
  V(53)=sum(wgt*(y*((u810+u829)*u710+u873+u859)))
  Ex(53)=u852_s
  Ey(53)=u80_s
  u852_s=sum(wgt*(u465*(u79+u874+u93)))
  Ez(53)=u852_s
  V(54)=sum(wgt*(z*(u84+u810*u708+u859)))
  Ex(54)=u918_s
  Ey(54)=u852_s
  u822_s=sum(wgt*(u710*(u831+u86*u708+(u824+u846)*u710)+u83*u708+u875))
  Ez(54)=u822_s
  V(55)=sum(wgt*(y*u848))
  Ex(55)=u817_s
  Ey(55)=u822_s
  u831_s=sum(wgt*(u465*u821))
  Ez(55)=u831_s
  V(56)=sum(wgt*(z*(u710*(u783+u839)+u892)))
  Ex(56)=u812_s
  Ey(56)=u831_s
  Ez(56)=sum(wgt*(u710*(u808+u710*(u840+u915))+u785))
  if ( lmax .eq. 5 ) return
  u99=u825*(u97*(u864+9.0d0)+u882)
  u811=-1.34330853225656259d-1*u99
  u831=u833*(u905+u836)
  u808=2.82094791773878144d0*u831
  u859=-u915
  V(57)=sum(wgt*(u507*(u808+u507*(u820+u859))+u811))
  u892=A11_v(pd,exppd2,erfpd)
  u822=pd2*u892
  u810=1.84246577801628391d4*u822
  u824=(u810+u836*(1.1d1+u864))
  u783=p**8*pd
  u78=u783*u824
  u915=5.98382891641559699d-1*u78
  u870=1.84246577801628391d4*u892
  u840=6.4d1*exppd2
  u839=pd2*(u840+u870)
  u833=u783*u839
  u97=-5.38544602477403729d0*u833
  u875=u783*u822
  u93=2.18295d5*u875
  u785=2.39520551142116908d5*u892
  u852=-1.28d2*u867
  u918=pd2*(u785+u852)
  u80=u783*u918
  u871=-5.64189583547756287d-1*u80
  u817=u871*u507
  Ex(57)=sum(wgt*(x*(u507*(u97+u507*(u817+u93))+u915)))
  u812=8.54832702345085283d-2*u78
  u83=-2.30804829633173027d0*u833
  u87=1.55925d5*u875
  u815=(u507*(u83+u507*(u817+u87))+u812)
  u848_s=sum(wgt*(u815*y))
  Ey(57)=u848_s
  u821_s=sum(wgt*(u815*z))
  Ez(57)=u821_s
  u815=9.40315972579593812d-1*u831
  u79=-u897
  u897=x*(u507*(u79+u820)+u815)
  V(58)=sum(wgt*(u897*y))
  Ex(58)=u848_s
  u848=-7.69349432110576755d-1*u833
  u84=-5.1289962140705117d-1*u833
  u905=1.0395d5*u875
  u858=1.0395d4*u875
  u8=(u848+u507*(u817+u905))
  u841=u858*u507
  u857=u507*(u84+u841)+u812
  u94_s=sum(wgt*(x*(u8*u708+u857)))
  Ey(58)=u94_s
  u89_s=sum(wgt*(x*(u507*(u905+u817)+u848)*u465))
  Ez(58)=u89_s
  V(59)=sum(wgt*(u897*z))
  Ex(59)=u821_s
  Ey(59)=u89_s
  u821_s=sum(wgt*(x*(u8*u710+u857)))
  Ez(59)=u821_s
  u897=-2.68661706451312518d-2*u99
  u8=1.88063194515918762d-1*u831
  u857=3.76126389031837525d-1*u831
  u99=-u86
  u86=(u8+u507*(u820+u99))
  u900=u507*(u857+u838)+u897
  V(60)=sum(wgt*(u86*u708+u900))
  Ex(60)=u94_s
  u94=5.1289962140705117d-2*u78
  u901=-1.53869886422115351d-1*u833
  u85=-9.23219318532692106d-1*u833
  u775=6.237d4*u875
  u906=3.1185d4*u875
  u875=(u901+u507*(u817+u775))
  u81=u875*u708
  u842=u906*u507
  u784=u507*(u85+u842)+u94
  u96_s=sum(wgt*(y*(u81+u784)))
  Ey(60)=u96_s
  u787=1.70966540469017057d-2*u78
  u78=-3.07739772844230702d-1*u833
  u876=u507*(u78+u841)+u787
  u904_s=sum(wgt*((u81+u876)*z))
  Ez(60)=u904_s
  V(61)=sum(wgt*((u507*(u99+u820)+u8)*u465))
  Ex(61)=u89_s
  Ey(61)=u904_s
  u89=u875*u710
  u81_s=sum(wgt*(y*(u89+u876)))
  Ez(61)=u81_s
  V(62)=sum(wgt*(u86*u710+u900))
  Ex(62)=u821_s
  Ey(62)=u81_s
  u821_s=sum(wgt*(z*(u89+u784)))
  Ez(62)=u821_s
  u89=5.64189583547756287d-1*u831
  u831=-u92
  u92=(u831+u820)
  u86=u92*u708
  u875=u831*u507
  u900=u875+u89
  V(63)=sum(wgt*(u404*(u86+u900)))
  Ex(63)=u96_s
  u96=(u817+u906)
  u784=u96*u708
  u876=u775*u507
  u827=u85+u876
  u877=u901*u507
  u863=u877+u94
  u82_s=sum(wgt*(x*(u708*(u827+u784)+u863)))
  Ey(63)=u82_s
  u88=-4.61609659266346053d-1*u833
  u833=(u906+u817)
  u847=u842+u88
  u90_s=sum(wgt*(u404*(u833*u708+u847)*z))
  Ez(63)=u90_s
  u881=u838+u8
  V(64)=sum(wgt*(x*(u86+u881)*z))
  Ex(64)=u904_s
  Ey(64)=u90_s
  u904=u9*(1.6d1*pd2-1.1d1)
  u874=(u904+u810)
  u9=-1.36773232375213645d-1*u783*u874
  u86=-u906
  u786=u783*pd2
  u838=1.28d2*exppd2
  u823=5.1289962140705117d-2*u786*(u785+u838)
  u95=-9.02703333676410059d0*u786*(u870-8.0d0*u867)
  u883=+u95
  u912=5.64189583547756287d-1*u80
  u80=-u858
  u818=u912*u507
  u844=u507*(u818+u883)
  u814=(u818+u86)
  u788=u814*u708
  u843=u80*u507
  u873_s=sum(wgt*(x*(u708*(u906+u844+u788)+u507*(u823+u843)+u9)))
  Ez(64)=u873_s
  u845=u92*u710
  V(65)=sum(wgt*(u404*(u845+u881)))
  Ex(65)=u81_s
  Ey(65)=u873_s
  u81_s=sum(wgt*(u862*(u833*u710+u847)))
  Ez(65)=u81_s
  V(66)=sum(wgt*(u463*(u845+u900)))
  Ex(66)=u821_s
  Ey(66)=u81_s
  u821_s=sum(wgt*(x*(u710*(u827+u96*u710)+u863)))
  Ez(66)=u821_s
  u845=u857+u99*u507
  u92=u8*u507+u897
  V(67)=sum(wgt*(u708*(u845+u855)+u92))
  Ex(67)=u82_s
  u82=(u817+u858)
  u855=u82*u708
  u96=u84+u905*u507
  u833=u848*u507+u812
  u900_s=sum(wgt*(y*(u708*(u96+u855)+u833)))
  Ey(67)=u900_s
  u827=u78+u876
  u863=u877+u787
  u847_s=sum(wgt*((u708*(u827+u855)+u863)*z))
  Ez(67)=u847_s
  u881=(u91+u820)
  u907=u875+u8
  V(68)=sum(wgt*(y*(u881*u708+u907)*z))
  Ex(68)=u90_s
  Ey(68)=u847_s
  u90=u823+u844
  u844=u86*u507
  u878=u507*(u906+u844)+u9
  u820=(u818+u80)
  u890=u820*u708
  u880_s=sum(wgt*(y*(u708*(u90+u890)+u878)))
  Ez(68)=u880_s
  u869=5.37323412902625035d-2*u825*(u882+u919)
  u882=-u860
  V(69)=sum(wgt*(u708*(u91+u507*(u819+u882)+u898)+u507*(u91+u837)+u869)&
 &)
  Ex(69)=u873_s
  Ey(69)=u880_s
  u869=u820*u710
  u882_s=sum(wgt*(z*(u710*(u90+u869)+u878)))
  Ez(69)=u882_s
  V(70)=sum(wgt*(u465*(u881*u710+u907)))
  Ex(70)=u81_s
  Ey(70)=u882_s
  u860=u82*u710
  u846_s=sum(wgt*(y*(u710*(u827+u860)+u863)))
  Ez(70)=u846_s
  V(71)=sum(wgt*(u710*(u845+u879*u710)+u92))
  Ex(71)=u821_s
  Ey(71)=u846_s
  u919_s=sum(wgt*(z*(u710*(u96+u860)+u833)))
  Ez(71)=u919_s
  u825=u776*u708
  u873=(u708*(u79+u825)+u815)
  V(72)=sum(wgt*(u404*u873))
  Ex(72)=u900_s
  u821=u871*u708
  u900=(u708*(u83+u708*(u821+u87))+u812)
  u81_s=sum(wgt*(x*u900))
  Ey(72)=u81_s
  u90_s=sum(wgt*(u404*(u708*(u905+u821)+u848)*z))
  Ez(72)=u90_s
  V(73)=sum(wgt*(x*(u708*(u99+u825)+u8)*z))
  Ex(73)=u847_s
  Ey(73)=u90_s
  u847=(u901+u708*(u821+u775))*u710
  u878=u858*u708
  u903_s=sum(wgt*(x*(u847+u708*(u78+u878)+u787)))
  Ez(73)=u903_s
  u898=(u831+u825)*u710
  u879=u91*u708
  V(74)=sum(wgt*(u404*(u898+u879+u8)))
  Ex(74)=u880_s
  Ey(74)=u903_s
  u880=u906*u708
  u82_s=sum(wgt*(u862*((u906+u821)*u710+u880+u88)))
  Ez(74)=u82_s
  u881=u831*u708
  V(75)=sum(wgt*(u463*((u91+u825)*u710+u881+u8)))
  Ex(75)=u882_s
  Ey(75)=u82_s
  u823=(u821+u858)*u710
  u882=u775*u708
  u883=u901*u708
  u820_s=sum(wgt*(x*(u710*(u78+u882+u823)+u883+u787)))
  Ez(75)=u820_s
  u845=u776*u710
  V(76)=sum(wgt*(u404*(u710*(u99+u845)+u8)))
  Ex(76)=u846_s
  Ey(76)=u820_s
  u846=u871*u710
  u92_s=sum(wgt*(u862*(u710*(u905+u846)+u848)))
  Ez(76)=u92_s
  u96=(u710*(u79+u845)+u815)
  V(77)=sum(wgt*(u463*u96))
  Ex(77)=u919_s
  Ey(77)=u92_s
  u919=(u710*(u83+u710*(u846+u87))+u812)
  u875_s=sum(wgt*(x*u919))
  Ez(77)=u875_s
  V(78)=sum(wgt*(u708*(u808+u708*(u825+u859))+u811))
  Ex(78)=u81_s
  Ey(78)=sum(wgt*(y*(u708*(u97+u708*(u821+u93))+u915)))
  u81_s=sum(wgt*(u900*z))
  Ez(78)=u81_s
  V(79)=sum(wgt*(y*u873*z))
  Ex(79)=u90_s
  Ey(79)=u81_s
  u81_s=sum(wgt*(y*((u848+u708*(u821+u905))*u710+u708*(u84+u878)+u812)))
  Ez(79)=u81_s
  V(80)=sum(wgt*((u8+u708*(u825+u99))*u710+u708*(u857+u879)+u897))
  Ex(80)=u903_s
  Ey(80)=u81_s
  u81_s=sum(wgt*(z*(u847+u708*(u85+u880)+u94)))
  Ez(80)=u81_s
  V(81)=sum(wgt*(u465*(u898+u881+u89)))
  Ex(81)=u82_s
  Ey(81)=u81_s
  u873_s=sum(wgt*(y*(u710*(u85+u882+(u821+u906)*u710)+u883+u94)))
  Ez(81)=u873_s
  V(82)=sum(wgt*(u710*(u857+u99*u708+(u825+u91)*u710)+u8*u708+u897))
  Ex(82)=u820_s
  Ey(82)=u873_s
  u857_s=sum(wgt*(z*(u710*(u84+u905*u708+u823)+u848*u708+u812)))
  Ez(82)=u857_s
  V(83)=sum(wgt*(u465*u96))
  Ex(83)=u92_s
  Ey(83)=u857_s
  u79_s=sum(wgt*(y*u919))
  Ez(83)=u79_s
  V(84)=sum(wgt*(u710*(u808+u710*(u845+u859))+u811))
  Ex(84)=u875_s
  Ey(84)=u79_s
  Ez(84)=sum(wgt*(z*(u710*(u97+u710*(u846+u93))+u915)))
  if ( lmax .eq. 6 ) return
  u79=(u836*(u864+1.1d1)+u810)
  u857=u783*u79
  u808=-5.98382891641559699d-1*u857
  u859=pd2*(u870+u840)
  u787=u783*u859
  u94=5.38544602477403729d0*u787
  u91=-u93
  V(85)=sum(wgt*(x*(u507*(u94+u507*(u818+u91))+u808)))
  u873=p**9
  u820=u873*u79
  u79=-5.98382891641559699d-1*u820
  u93=u873*u859
  u859=2.15417840990961492d1*u93
  u776=u873*u822
  u83=-2.18295d6*u776
  u897=+u83
  u812=u873*u918
  u918=1.5797308339337176d1*u812
  u822=u873*pd2
  u870=u822*(3.59280826713175363d6*u892+u852*(1.5d1+u864))
  u84=-5.64189583547756287d-1*u870
  u811=u84*u507
  Ex(85)=sum(wgt*(u507*(u859+u507*(u507*(u918+u811)+u897))+u79))
  u915=5.38544602477403729d0*u93
  u846=-1.091475d6*u776
  u831=+u846
  u81=1.1847981254502882d1*u812
  u8=x*(u507*(u831+u507*(u811+u81))+u915)
  u96_s=sum(wgt*(u8*y))
  Ey(85)=u96_s
  u89_s=sum(wgt*(u8*z))
  Ez(85)=u89_s
  u8=-8.54832702345085283d-2*u857
  u875=2.30804829633173027d0*u787
  u815=-u87
  u87=(u507*(u875+u507*(u818+u815))+u8)
  V(86)=sum(wgt*(u87*y))
  Ex(86)=u96_s
  u96=-8.54832702345085283d-2*u820
  u82=7.69349432110576755d-1*u93
  u90=2.30804829633173027d0*u93
  u97=-4.67775d5*u776
  u903=+u97
  u881=-1.55925d5*u776
  u92=+u881
  u900=8.46284375321634431d0*u812
  u845=5.64189583547756287d-1*u812
  u919=(u82+u507*(u507*(u900+u811)+u903))
  u847=u845*u507
  u833=u507*(u90+u507*(u847+u92))+u96
  u78_s=sum(wgt*(u919*u708+u833))
  Ey(86)=u78_s
  u898_s=sum(wgt*((u507*(u903+u507*(u811+u900))+u82)*u465))
  Ez(86)=u898_s
  V(87)=sum(wgt*(u87*z))
  Ex(87)=u89_s
  Ey(87)=u898_s
  u89_s=sum(wgt*(u919*u710+u833))
  Ez(87)=u89_s
  u87=7.69349432110576755d-1*u787
  u919=5.1289962140705117d-1*u787
  u833=-u905
  u905=(u87+u507*(u818+u833))
  u823=u507*(u919+u843)+u8
  V(88)=sum(wgt*(x*(u905*u708+u823)))
  Ex(88)=u78_s
  u78=-3.1185d5*u776
  u827=+u78
  u901=5.64189583547756287d0*u812
  u85=1.69256875064326886d0*u812
  u99=(u92+u507*(u811+u901))
  u863=u99*u708
  u848=u85*u507
  u9=u507*(u827+u848)+u90
  u872_s=sum(wgt*(u404*(u863+u9)))
  Ey(88)=u872_s
  u825=-1.0395d5*u776
  u907=+u825
  u861=u507*(u907+u847)+u82
  u98_s=sum(wgt*(x*(u863+u861)*z))
  Ez(88)=u98_s
  V(89)=sum(wgt*(x*(u507*(u833+u818)+u87)*u465))
  Ex(89)=u898_s
  Ey(89)=u98_s
  u898=u99*u710
  u863_s=sum(wgt*(u404*(u898+u861)))
  Ez(89)=u863_s
  V(90)=sum(wgt*(x*(u905*u710+u823)))
  Ex(90)=u89_s
  Ey(90)=u863_s
  u89_s=sum(wgt*(u463*(u898+u9)))
  Ez(90)=u89_s
  u898=-5.1289962140705117d-2*u857
  u905=1.53869886422115351d-1*u787
  u99=9.23219318532692106d-1*u787
  u823=-u775
  u775=(u905+u507*(u818+u823))
  u9=u775*u708
  u861=u507*(u99+u844)+u898
  V(91)=sum(wgt*(y*(u9+u861)))
  Ex(91)=u872_s
  u872=-5.1289962140705117d-2*u820
  u820=9.23219318532692106d-1*u93
  u882=-3.1185d4*u776
  u821=+u882
  u830=-3.7422d5*u776
  u902=+u830
  u865=3.38513750128653772d0*u812
  u885=(u507*(u865+u811)+u821)
  u88=u885*u708
  u849=u865*u507
  u886=u820+u507*(u849+u902)
  u850=u821*u507
  u777=u507*(u820+u850)+u872
  u889_s=sum(wgt*(u708*(u886+u88)+u777))
  Ey(91)=u889_s
  u908=4.61609659266346053d-1*u93
  u866=-1.8711d5*u776
  u93=+u866
  u776=(u821+u507*(u811+u865))
  u887=u507*(u93+u848)+u908
  u920_s=sum(wgt*(y*(u776*u708+u887)*z))
  Ez(91)=u920_s
  u896=-1.70966540469017057d-2*u857
  u857=3.07739772844230702d-1*u787
  u778=u507*(u857+u843)+u896
  V(92)=sum(wgt*((u9+u778)*z))
  Ex(92)=u98_s
  Ey(92)=u920_s
  u98=(u810+u904)
  u810=1.36773232375213645d-1*u873*u98
  u9=-u882
  u883=u822*(3.86917813383419621d5*u892-u840)
  u904=-1.53869886422115351d-1*u883
  u876=1.69256875064326886d0*u822
  u880=-2.56d2*u867
  u843=u876*(4.97465760064396656d5*u892+u880)
  u828=-u865
  u877=1.12837916709551257d0*u822*(1.65821920021465552d5*u892+u835)
  u921=u822*(5.02993157398445508d6*u892+u852*(2.1d1+u864))
  u895=-5.64189583547756287d-1*u921
  u879=5.64189583547756287d-1*u870
  u870=-5.64189583547756287d-1*u812
  u812=u879*u507
  u878=(u507*(u828+u812)+u9)
  u922=u878*u708
  u854=u507*(u895+u812)
  u851=u870*u507
  u888_s=sum(wgt*(u708*(u821+u507*(u854+u843)+u922)+u507*(u904+u507*(u851&
 &+u877))+u810))
  Ez(92)=u888_s
  u884=u775*u710
  V(93)=sum(wgt*(y*(u884+u778)))
  Ex(93)=u863_s
  Ey(93)=u888_s
  u863_s=sum(wgt*(u465*(u776*u710+u887)))
  Ez(93)=u863_s
  V(94)=sum(wgt*(z*(u884+u861)))
  Ex(94)=u89_s
  Ey(94)=u863_s
  u89_s=sum(wgt*(u710*(u886+u885*u710)+u777))
  Ez(94)=u89_s
  u884=u823*u507
  u775=u99+u884
  u885=u905*u507
  u776=u885+u898
  V(95)=sum(wgt*(x*(u708*(u775+u788)+u776)))
  Ex(95)=u889_s
  u889=(u811+u85)
  u861=u889*u708
  u886=u901*u507
  u777=u827+u886
  u887=u92*u507
  u778=u887+u90
  u788_s=sum(wgt*(u404*(u708*(u777+u861)+u778)))
  Ey(95)=u788_s
  u779=u93+u849
  u780=u850+u908
  u853_s=sum(wgt*(x*(u708*(u779+u861)+u780)*z))
  Ez(95)=u853_s
  u891=4.61609659266346053d-1*u787
  u787=(u86+u818)
  u781=u844+u891
  V(96)=sum(wgt*(u404*(u787*u708+u781)*z))
  Ex(96)=u920_s
  Ey(96)=u853_s
  u844=u822*(9.21232889008141955d4*u892-u836)
  u920=-9.23219318532692106d-1*u844
  u913=u876*(2.76369866702442587d5*u892+u852)
  u876=-u85
  u818=u867*(1.0d1+pd2)
  u832=-2.25675833419102515d0*u822*(1.19760275571058454d6*u892-6.4d1*u8&
 &18)
  u892=+u832
  u822=u913+u507*(u812+u892)
  u852=u876*u507
  u782=u507*(u913+u852)+u920
  u910=(u812+u876)
  u804=u910*u708
  u813_s=sum(wgt*(u404*(u708*(u822+u804)+u782)))
  Ez(96)=u813_s
  u899=1.36773232375213645d-1*u783*u98
  u98=-5.1289962140705117d-2*u786*(u838+u785)
  u819=-u95
  u837=u507*(u817+u819)
  V(97)=sum(wgt*(x*(u708*(u86+u837+u784)+u507*(u98+u841)+u899)))
  Ex(97)=u888_s
  Ey(97)=u813_s
  u841=u910*u710
  u888_s=sum(wgt*(u463*(u710*(u822+u841)+u782)))
  Ez(97)=u888_s
  V(98)=sum(wgt*(u862*(u787*u710+u781)))
  Ex(98)=u863_s
  Ey(98)=u888_s
  u910=u889*u710
  u822_s=sum(wgt*(u404*(u710*(u779+u910)+u780)))
  Ez(98)=u822_s
  V(99)=sum(wgt*(x*(u710*(u775+u814*u710)+u776)))
  Ex(99)=u89_s
  Ey(99)=u822_s
  u89_s=sum(wgt*(u463*(u710*(u777+u910)+u778)))
  Ez(99)=u89_s
  u782=u919+u833*u507
  u783=u87*u507+u8
  V(100)=sum(wgt*(y*(u708*(u782+u890)+u783)))
  Ex(100)=u788_s
  u817=(u845+u811)
  u863=u817*u708
  u784=u90+u903*u507
  u785=u900*u507+u92
  u786=u82*u507+u96
  u814_s=sum(wgt*(u708*(u784+u708*(u863+u785))+u786))
  Ey(100)=u814_s
  u776=(u811+u845)
  u787=u907+u886
  u788=u887+u82
  u889_s=sum(wgt*(y*(u708*(u787+u776*u708)+u788)*z))
  Ez(100)=u889_s
  u789=u857+u884
  u790=u885+u896
  V(101)=sum(wgt*((u708*(u789+u890)+u790)*z))
  Ex(101)=u853_s
  Ey(101)=u889_s
  u853=u828*u507
  u826=u904+u507*(u853+u843)
  u890=u854+u877
  u854=u9*u507
  u893=u507*(u821+u854)+u810
  u777=(u870+u812)
  u805=u777*u708
  u856_s=sum(wgt*(u708*(u826+u708*(u805+u890))+u893))
  Ez(101)=u856_s
  u894=u98+u837
  u885=u507*(u86+u842)+u899
  V(102)=sum(wgt*(y*(u708*(u894+u855)+u885)))
  Ex(102)=u813_s
  Ey(102)=u856_s
  u813=u879*u708
  u780=(u813+u876)*u710
  u855=u876*u708
  u829_s=sum(wgt*(u465*(u710*(u913+u708*(u813+u892)+u780)+u708*(u913+u855&
 &)+u920)))
  Ez(102)=u829_s
  V(103)=sum(wgt*(z*(u710*(u894+u860)+u885)))
  Ex(103)=u888_s
  Ey(103)=u829_s
  u819=u777*u710
  u858_s=sum(wgt*(u710*(u826+u710*(u819+u890))+u893))
  Ez(103)=u858_s
  V(104)=sum(wgt*(y*(u710*(u789+u869)+u790)))
  Ex(104)=u822_s
  Ey(104)=u858_s
  u899_s=sum(wgt*(u465*(u710*(u787+u776*u710)+u788)))
  Ez(104)=u899_s
  V(105)=sum(wgt*(z*(u710*(u782+u869)+u783)))
  Ex(105)=u89_s
  Ey(105)=u899_s
  u837=u817*u710
  u782_s=sum(wgt*(u710*(u784+u710*(u837+u785))+u786))
  Ez(105)=u782_s
  u822=u912*u708
  u786=(u708*(u875+u708*(u822+u815))+u8)
  V(106)=sum(wgt*(x*u786))
  Ex(106)=u814_s
  u814=u84*u708
  u776=(u708*(u831+u708*(u814+u81))+u915)
  u789_s=sum(wgt*(u404*u776))
  Ey(106)=u789_s
  u885_s=sum(wgt*(x*(u708*(u903+u708*(u814+u900))+u82)*z))
  Ez(106)=u885_s
  V(107)=sum(wgt*(u404*(u708*(u833+u822)+u87)*z))
  Ex(107)=u889_s
  Ey(107)=u885_s
  u826=(u92+u708*(u814+u901))*u710
  u888=u845*u708
  u89_s=sum(wgt*(u404*(u826+u708*(u907+u888)+u82)))
  Ez(107)=u89_s
  u871=(u905+u708*(u822+u823))*u710
  u889=u80*u708
  V(108)=sum(wgt*(x*(u871+u708*(u857+u889)+u896)))
  Ex(108)=u856_s
  Ey(108)=u89_s
  u856=u85*u708
  u817_s=sum(wgt*(u463*((u821+u708*(u814+u865))*u710+u708*(u93+u856)+u908&
 &)))
  Ez(108)=u817_s
  u890=u86*u708
  V(109)=sum(wgt*(u862*((u86+u822)*u710+u890+u891)))
  Ex(109)=u829_s
  Ey(109)=u817_s
  u829=(u814+u85)*u710
  u891=u865*u708
  u892=u821*u708
  u783_s=sum(wgt*(u404*(u710*(u93+u891+u829)+u892+u908)))
  Ez(109)=u783_s
  u777=(u822+u80)*u710
  u893=u823*u708
  u894=u905*u708
  V(110)=sum(wgt*(x*(u710*(u857+u893+u777)+u894+u896)))
  Ex(110)=u858_s
  Ey(110)=u783_s
  u895=u901*u708
  u896=u92*u708
  u785_s=sum(wgt*(u463*(u710*(u907+u895+(u814+u845)*u710)+u896+u82)))
  Ez(110)=u785_s
  u857=u912*u710
  V(111)=sum(wgt*(u862*(u710*(u833+u857)+u87)))
  Ex(111)=u899_s
  Ey(111)=u785_s
  u858=u84*u710
  u784_s=sum(wgt*(u404*(u710*(u903+u710*(u858+u900))+u82)))
  Ez(111)=u784_s
  u887=(u710*(u875+u710*(u857+u815))+u8)
  V(112)=sum(wgt*(x*u887))
  Ex(112)=u782_s
  Ey(112)=u784_s
  u782=(u710*(u831+u710*(u858+u81))+u915)
  u775_s=sum(wgt*(u463*u782))
  Ez(112)=u775_s
  V(113)=sum(wgt*(y*(u708*(u94+u708*(u822+u91))+u808)))
  Ex(113)=u789_s
  Ey(113)=sum(wgt*(u708*(u859+u708*(u708*(u918+u814)+u897))+u79))
  u789_s=sum(wgt*(y*u776*z))
  Ez(113)=u789_s
  V(114)=sum(wgt*(u786*z))
  Ex(114)=u885_s
  Ey(114)=u789_s
  u885_s=sum(wgt*((u82+u708*(u708*(u900+u814)+u903))*u710+u708*(u90+u708*&
 &(u888+u92))+u96))
  Ez(114)=u885_s
  V(115)=sum(wgt*(y*((u87+u708*(u822+u833))*u710+u708*(u919+u889)+u8)))
  Ex(115)=u89_s
  Ey(115)=u885_s
  u89_s=sum(wgt*(u465*(u826+u708*(u827+u856)+u90)))
  Ez(115)=u89_s
  V(116)=sum(wgt*(z*(u871+u708*(u99+u890)+u898)))
  Ex(116)=u817_s
  Ey(116)=u89_s
  u89_s=sum(wgt*(u710*(u820+u708*(u891+u902)+(u708*(u865+u814)+u821)*u710&
 &)+u708*(u820+u892)+u872))
  Ez(116)=u89_s
  V(117)=sum(wgt*(y*(u710*(u99+u893+(u822+u86)*u710)+u894+u898)))
  Ex(117)=u783_s
  Ey(117)=u89_s
  u99_s=sum(wgt*(u465*(u710*(u827+u895+u829)+u896+u90)))
  Ez(117)=u99_s
  V(118)=sum(wgt*(z*(u710*(u919+u833*u708+u777)+u87*u708+u8)))
  Ex(118)=u785_s
  Ey(118)=u99_s
  u871_s=sum(wgt*(u710*(u90+u903*u708+u710*((u845+u814)*u710+u900*u708+u9&
 &2))+u82*u708+u96))
  Ez(118)=u871_s
  V(119)=sum(wgt*(y*u887))
  Ex(119)=u784_s
  Ey(119)=u871_s
  u871_s=sum(wgt*(u465*u782))
  Ez(119)=u871_s
  V(120)=sum(wgt*(z*(u710*(u94+u710*(u857+u91))+u808)))
  Ex(120)=u775_s
  Ey(120)=u871_s
  Ez(120)=sum(wgt*(u710*(u859+u710*(u710*(u918+u858)+u897))+u79))
  if ( lmax .eq. 7 ) return
  u808=u873*u824
  u871=5.98382891641559699d-1*u808
  u919=u873*u839
  u892=-2.15417840990961492d1*u919
  u896=-u83
  u99=-u918
  V(121)=sum(wgt*(u507*(u892+u507*(u507*(u99+u812)+u896))+u871))
  u918=A13_v(pd,exppd2,erfpd)
  u82=pd2*u918
  u90=p**10*pd
  u887=u90*(u840*(u864+1.3d1)+2.39520551142116908d5*u82)
  u8=-3.72838570945894889d0*u887
  u915=u90*pd2
  u885=u915*(2.39520551142116908d5*u918+u838)
  u858=5.46829904053979171d1*u885
  u859=u90*u82
  u893=-5.108103d7*u859
  u80=3.59280826713175363d6*u918
  u823=u915*(u80+u880)
  u839=2.03108250077192263d1*u823
  u826=u915*(6.10777405412398116d7*u918+u880*(1.7d1+u864))
  u889=-5.64189583547756287d-1*u826
  u815=u889*u507
  Ex(121)=sum(wgt*(x*(u507*(u858+u507*(u507*(u839+u815)+u893))+u8)))
  u775=-4.14265078828772099d-1*u887
  u824=1.82276634684659724d1*u885
  u777=-2.837835d7*u859
  u86=1.5797308339337176d1*u823
  u895=(u507*(u824+u507*(u507*(u86+u815)+u777))+u775)
  u817_s=sum(wgt*(u895*y))
  Ey(121)=u817_s
  u94_s=sum(wgt*(u895*z))
  Ez(121)=u94_s
  u784=-5.38544602477403729d0*u919
  u895=-u846
  u93=-u81
  u822=x*(u507*(u895+u507*(u812+u93))+u784)
  V(122)=sum(wgt*(u822*y))
  Ex(122)=u817_s
  u817=4.55691586711649309d0*u885
  u783=-1.4189175d7*u859
  u857=-2.837835d6*u859
  u831=1.1847981254502882d1*u823
  u827=5.64189583547756287d-1*u823
  u890=(u817+u507*(u507*(u831+u815)+u783))
  u897=u827*u507
  u789=u507*(u817+u507*(u897+u857))+u775
  u776_s=sum(wgt*(x*(u890*u708+u789)))
  Ey(122)=u776_s
  u87_s=sum(wgt*(x*(u507*(u783+u507*(u815+u831))+u817)*u465))
  Ez(122)=u87_s
  V(123)=sum(wgt*(u822*z))
  Ex(123)=u94_s
  Ey(123)=u87_s
  u94_s=sum(wgt*(x*(u890*u710+u789)))
  Ez(123)=u94_s
  u822=8.54832702345085283d-2*u808
  u789=-7.69349432110576755d-1*u919
  u890=-2.30804829633173027d0*u919
  u875=-u97
  u891=-u881
  u89=-u900
  u842=(u789+u507*(u507*(u89+u812)+u875))
  u786=u507*(u890+u507*(u851+u891))+u822
  V(124)=sum(wgt*(u842*u708+u786))
  Ex(124)=u776_s
  u776=-1.77542176640902328d-1*u887
  u833=6.5098798101664187d-1*u885
  u785=5.85889182914977683d0*u885
  u888=-6.081075d6*u859
  u869=8.46284375321634431d0*u823
  u779=1.69256875064326886d0*u823
  u91=(u833+u507*(u507*(u869+u815)+u888))
  u810=u91*u708
  u898=u779*u507
  u787=u507*(u785+u507*(u898+u888))+u776
  u781_s=sum(wgt*(y*(u810+u787)))
  Ey(124)=u781_s
  u820=-5.91807255469674427d-2*u887
  u894=1.95296394304992561d0*u885
  u782=-2.027025d6*u859
  u96=+u782
  u790=u507*(u894+u507*(u897+u96))+u820
  u81_s=sum(wgt*((u810+u790)*z))
  Ez(124)=u81_s
  V(125)=sum(wgt*((u507*(u875+u507*(u812+u89))+u789)*u465))
  Ex(125)=u87_s
  Ey(125)=u81_s
  u87=u91*u710
  u810_s=sum(wgt*(y*(u87+u790)))
  Ez(125)=u810_s
  V(126)=sum(wgt*(u842*u710+u786))
  Ex(126)=u94_s
  Ey(126)=u810_s
  u94_s=sum(wgt*(z*(u87+u787)))
  Ez(126)=u94_s
  u842=-u78
  u87=-u901
  u901=(u891+u507*(u812+u87))
  u91=u901*u708
  u95=u507*(u842+u852)+u890
  V(127)=sum(wgt*(u404*(u91+u95)))
  Ex(127)=u781_s
  u897=3.90592788609985122d0*u885
  u786=1.30197596203328374d0*u885
  u787=-8.1081d6*u859
  u781=5.64189583547756287d0*u823
  u790=-4.05405d5*u859
  u778=+u790
  u872=3.38513750128653772d0*u823
  u907=(u507*(u781+u815)+u96)
  u899=u872*u507
  u902=u897+u507*(u899+u787)
  u900=u778*u507
  u860=u507*(u786+u900)+u776
  u905_s=sum(wgt*(x*(u708*(u902+u907*u708)+u860)))
  Ey(127)=u905_s
  u788=-4.05405d6*u859
  u98=(u96+u507*(u815+u781))
  u908=u507*(u788+u898)+u894
  u79_s=sum(wgt*(u404*(u98*u708+u908)*z))
  Ez(127)=u79_s
  u898=-u825
  u884=u507*(u898+u851)+u789
  V(128)=sum(wgt*(x*(u91+u884)*z))
  Ex(128)=u81_s
  Ey(128)=u79_s
  u81=u90*(1.19760275571058454d6*u82+u836*(2.0d1*pd2-1.3d1))
  u836=1.18361451093934885d-1*u81
  u868=-u782
  u90=-2.16995993672213957d-1*u915*(u838+6.46705488083715652d6*u918)
  u82=-5.12d2*u867
  u91=2.82094791773878144d0*u915*(7.90417818768985798d6*u918+u82)
  u851=-u781
  u92=4.5135166683820503d0*u915*(7.18561653426350725d5*u918+u834)
  u809=-5.64189583547756287d-1*u915
  u834=+u809*(9.70058232125573479d7*u918+u880*(2.7d1+u864))
  u867=5.64189583547756287d-1*u826
  u826=-5.64189583547756287d-1*u823
  u823=u867*u507
  u911=u507*(u834+u823)
  u912_s=sum(wgt*(x*(u708*(u96+u507*(u911+u91)+(u507*(u851+u823)+u868)*u7&
 &08)+u507*(u90+u507*(u826*u507+u92))+u836)))
  Ez(128)=u912_s
  u886=u901*u710
  V(129)=sum(wgt*(u404*(u886+u884)))
  Ex(129)=u810_s
  Ey(129)=u912_s
  u810_s=sum(wgt*(u862*(u98*u710+u908)))
  Ez(129)=u810_s
  V(130)=sum(wgt*(u463*(u886+u95)))
  Ex(130)=u94_s
  Ey(130)=u810_s
  u94_s=sum(wgt*(x*(u710*(u902+u907*u710)+u860)))
  Ez(130)=u94_s
  u95=5.1289962140705117d-2*u808
  u886=-9.23219318532692106d-1*u919
  u98=-u830
  u808=u886+u507*(u853+u98)
  u907=u507*(u886+u854)+u95
  V(131)=sum(wgt*(u708*(u808+u922)+u907))
  Ex(131)=u905_s
  u905=(u507*(u872+u815)+u778)
  u922=u905*u708
  u901=u781*u507
  u860=u786+u507*(u901+u787)
  u902=u96*u507
  u908=u507*(u897+u902)+u776
  u806_s=sum(wgt*(y*(u708*(u860+u922)+u908)))
  Ey(131)=u806_s
  u884=-3.55084353281804656d-2*u887
  u887=7.81185577219970244d-1*u885
  u885=-4.86486d6*u859
  u859=u887+u507*(u899+u885)
  u909=u507*(u887+u900)+u884
  u803_s=sum(wgt*((u708*(u859+u922)+u909)*z))
  Ez(131)=u803_s
  u922=-4.61609659266346053d-1*u919
  u900=-u866
  u919=(u9+u507*(u812+u828))
  u807=u507*(u900+u852)+u922
  V(132)=sum(wgt*(y*(u919*u708+u807)*z))
  Ex(132)=u79_s
  Ey(132)=u803_s
  u852=7.10168706563609313d-2*u81
  u79=-1.30197596203328374d-1*u915*(2.56d2*exppd2+u80)
  u899=-u790
  u80=-3.90592788609985122d-1*u915*(5.98801377855292271d6*u918-u838)
  u81=1.69256875064326886d0*u915*(8.38321928997409179d6*u918+u82)
  u838=-u872
  u82=6.77027500257307545d0*u915*(1.19760275571058454d6*u918+u835)
  u835=+u809*(8.98202066782938406d7*u918+u880*(2.5d1+u864))
  u864=-u779
  u809=u507*(u835+u823)
  u920=u79+u507*(u809+u81)
  u903=u864*u507
  u904=u507*(u80+u507*(u903+u82))+u852
  u906=(u507*(u838+u823)+u899)
  u916_s=sum(wgt*(y*(u708*(u920+u906*u708)+u904)))
  Ez(132)=u916_s
  u816=-1.36773232375213645d-1*u873*u874
  u914=1.53869886422115351d-1*u883
  u883=-u843
  u843=-u877
  u917=5.64189583547756287d-1*u921
  u921=u507*(u917+u811)
  V(133)=sum(wgt*(u708*(u9+u507*(u921+u883)+u88)+u507*(u914+u507*(u847+&
 &u843))+u816))
  Ex(133)=u912_s
  Ey(133)=u916_s
  u912_s=sum(wgt*(z*(u710*(u920+u906*u710)+u904)))
  Ez(133)=u912_s
  V(134)=sum(wgt*(u465*(u919*u710+u807)))
  Ex(134)=u810_s
  Ey(134)=u912_s
  u904=u905*u710
  u920_s=sum(wgt*(y*(u710*(u859+u904)+u909)))
  Ez(134)=u920_s
  V(135)=sum(wgt*(u710*(u808+u878*u710)+u907))
  Ex(135)=u94_s
  Ey(135)=u920_s
  u874_s=sum(wgt*(z*(u710*(u860+u904)+u908)))
  Ez(135)=u874_s
  u904=u87*u507
  u810=u842+u904
  u905=u891*u507
  u878=u905+u890
  V(136)=sum(wgt*(u404*(u708*(u810+u804)+u878)))
  Ex(136)=u806_s
  u806=(u779+u815)
  u906=u888*u507
  u847=u785+u906
  u907=u869*u507
  u88=u907+u888
  u908=u833*u507
  u877=u908+u776
  u909_s=sum(wgt*(x*(u708*(u847+u708*(u806*u708+u88))+u877)))
  Ey(136)=u909_s
  u807=(u815+u779)
  u873=u788+u901
  u901=u902+u894
  u860_s=sum(wgt*(u404*(u708*(u873+u807*u708)+u901)*z))
  Ez(136)=u860_s
  u902=u900+u853
  u853=u854+u922
  V(137)=sum(wgt*(x*(u708*(u902+u804)+u853)*z))
  Ex(137)=u803_s
  Ey(137)=u860_s
  u854=u80+u507*(u838*u507+u81)
  u880=u809+u82
  u809=u507*(u79+u899*u507)+u852
  u808=(u864+u823)
  u859_s=sum(wgt*(x*(u708*(u854+u708*(u808*u708+u880))+u809)))
  Ez(137)=u859_s
  u919=9.23219318532692106d-1*u844
  u94=-u913
  u913=-u832
  u803=u94+u507*(u811+u913)
  u804=u507*(u94+u848)+u919
  V(138)=sum(wgt*(u404*(u708*(u803+u861)+u804)))
  Ex(138)=u916_s
  Ey(138)=u859_s
  u916=-2.34355673165991073d0*u915*(3.99200918570194847d5*u918-u840)
  u861=-2.25675833419102515d0*u915*(1.79640413356587681d7*u918-1.28d2*u&
 &818)
  u918_s=sum(wgt*(u404*(u708*(u779+u507*(u823+u861)+(u823+u864)*u708)+u50&
 &7*(u779+u903)+u916)*z))
  Ez(138)=u918_s
  V(139)=sum(wgt*(u463*(u710*(u803+u910)+u804)))
  Ex(139)=u912_s
  Ey(139)=u918_s
  u915_s=sum(wgt*(x*(u710*(u854+u710*(u808*u710+u880))+u809)))
  Ez(139)=u915_s
  V(140)=sum(wgt*(u404*(u710*(u902+u841)+u853)))
  Ex(140)=u920_s
  Ey(140)=u915_s
  u912_s=sum(wgt*(u862*(u710*(u873+u807*u710)+u901)))
  Ez(140)=u912_s
  V(141)=sum(wgt*(u463*(u710*(u810+u841)+u878)))
  Ex(141)=u874_s
  Ey(141)=u912_s
  u920_s=sum(wgt*(x*(u710*(u847+u710*(u806*u710+u88))+u877)))
  Ez(141)=u920_s
  u877=u890+u875*u507
  u88=u89*u507+u891
  u874=u789*u507+u822
  V(142)=sum(wgt*(u708*(u877+u708*(u805+u88))+u874))
  Ex(142)=u909_s
  u847=(u827+u815)
  u809=u847*u708
  u803=u817+u783*u507
  u804=u831*u507+u857
  u805=u817*u507+u775
  u910_s=sum(wgt*(y*(u708*(u803+u708*(u809+u804))+u805)))
  Ey(142)=u910_s
  u806=u894+u906
  u807=u907+u96
  u808=u908+u820
  u909_s=sum(wgt*((u708*(u806+u708*(u809+u807))+u808)*z))
  Ez(142)=u909_s
  u908=(u812+u870)
  u809=u898+u904
  u810=u905+u789
  V(143)=sum(wgt*(y*(u708*(u809+u908*u708)+u810)*z))
  Ex(143)=u860_s
  Ey(143)=u909_s
  u860=u90+u507*(u851*u507+u91)
  u905=u911+u92
  u904=u507*(u96+u868*u507)+u836
  u907=(u826+u823)
  u911_s=sum(wgt*(y*(u708*(u860+u708*(u907*u708+u905))+u904)))
  Ez(143)=u911_s
  u823=u914+u507*(u849+u883)
  u849=u921+u843
  u812=u507*(u9+u850)+u816
  V(144)=sum(wgt*(u708*(u823+u708*(u863+u849))+u812))
  Ex(144)=u859_s
  Ey(144)=u911_s
  u859=u867*u708
  u863=u708*(u835+u859)
  u921_s=sum(wgt*(z*(u710*(u79+u708*(u863+u81)+(u708*(u838+u859)+u899)*u7&
 &10)+u708*(u80+u708*(u864*u708+u82))+u852)))
  Ez(144)=u921_s
  V(145)=sum(wgt*(u465*(u710*(u94+u708*(u814+u913)+u829)+u708*(u94+u856&
 &)+u919)))
  Ex(145)=u918_s
  Ey(145)=u921_s
  u916_s=sum(wgt*(y*(u710*(u80+u708*(u838*u708+u81)+u710*((u864+u859)*u71&
 &0+u863+u82))+u708*(u79+u899*u708)+u852)))
  Ez(145)=u916_s
  V(146)=sum(wgt*(u710*(u823+u710*(u837+u849))+u812))
  Ex(146)=u915_s
  Ey(146)=u916_s
  u812_s=sum(wgt*(z*(u710*(u860+u710*(u907*u710+u905))+u904)))
  Ez(146)=u812_s
  V(147)=sum(wgt*(u465*(u710*(u809+u908*u710)+u810)))
  Ex(147)=u912_s
  Ey(147)=u812_s
  u816=u847*u710
  u861_s=sum(wgt*(y*(u710*(u806+u710*(u816+u807))+u808)))
  Ez(147)=u861_s
  V(148)=sum(wgt*(u710*(u877+u710*(u819+u88))+u874))
  Ex(148)=u920_s
  Ey(148)=u861_s
  u819_s=sum(wgt*(z*(u710*(u803+u710*(u816+u804))+u805)))
  Ez(148)=u819_s
  u806=(u708*(u895+u708*(u813+u93))+u784)
  V(149)=sum(wgt*(u404*u806))
  Ex(149)=u910_s
  u816=u889*u708
  u88=(u708*(u824+u708*(u708*(u86+u816)+u777))+u775)
  u805_s=sum(wgt*(x*u88))
  Ey(149)=u805_s
  u877_s=sum(wgt*(u404*(u708*(u783+u708*(u816+u831))+u817)*z))
  Ez(149)=u877_s
  V(150)=sum(wgt*(x*(u708*(u875+u708*(u813+u89))+u789)*z))
  Ex(150)=u909_s
  Ey(150)=u877_s
  u874=(u833+u708*(u708*(u869+u816)+u888))*u710
  u909=u827*u708
  u803_s=sum(wgt*(x*(u874+u708*(u894+u708*(u909+u96))+u820)))
  Ez(150)=u803_s
  u807=(u891+u708*(u813+u87))*u710
  u910=u870*u708
  V(151)=sum(wgt*(u404*(u807+u708*(u898+u910)+u789)))
  Ex(151)=u911_s
  Ey(151)=u803_s
  u911=u779*u708
  u804_s=sum(wgt*(u862*((u96+u708*(u816+u781))*u710+u708*(u788+u911)+u894&
 &)))
  Ez(151)=u804_s
  V(152)=sum(wgt*(u463*((u9+u708*(u813+u828))*u710+u708*(u900+u855)+u92&
 &2)))
  Ex(152)=u921_s
  Ey(152)=u804_s
  u808=(u708*(u872+u816)+u778)*u710
  u912=u872*u708
  u913=u778*u708
  u847_s=sum(wgt*(x*(u710*(u887+u708*(u912+u885)+u808)+u708*(u887+u913)+u&
 &884)))
  Ez(152)=u847_s
  u914=u828*u708
  u915=u9*u708
  V(153)=sum(wgt*(u404*(u710*(u900+u914+u780)+u915+u922)))
  Ex(153)=u916_s
  Ey(153)=u847_s
  u916=u781*u708
  u917=u96*u708
  u79_s=sum(wgt*(u862*(u710*(u788+u916+(u816+u779)*u710)+u917+u894)))
  Ez(153)=u79_s
  u918=u87*u708
  u919=u891*u708
  V(154)=sum(wgt*(u463*(u710*(u898+u918+(u813+u870)*u710)+u919+u789)))
  Ex(154)=u812_s
  Ey(154)=u79_s
  u836=(u827+u816)*u710
  u920=u888*u708
  u921=u869*u708
  u922=u833*u708
  u834_s=sum(wgt*(x*(u710*(u894+u920+u710*(u836+u921+u96))+u922+u820)))
  Ez(154)=u834_s
  u860=u879*u710
  V(155)=sum(wgt*(u404*(u710*(u875+u710*(u860+u89))+u789)))
  Ex(155)=u861_s
  Ey(155)=u834_s
  u861=u889*u710
  u826_s=sum(wgt*(u862*(u710*(u783+u710*(u861+u831))+u817)))
  Ez(155)=u826_s
  u812=(u710*(u895+u710*(u860+u93))+u784)
  V(156)=sum(wgt*(u463*u812))
  Ex(156)=u819_s
  Ey(156)=u826_s
  u507=(u710*(u824+u710*(u710*(u86+u861)+u777))+u775)
  u463_s=sum(wgt*(x*u507))
  Ez(156)=u463_s
  V(157)=sum(wgt*(u708*(u892+u708*(u708*(u99+u813)+u896))+u871))
  Ex(157)=u805_s
  Ey(157)=sum(wgt*(y*(u708*(u858+u708*(u708*(u839+u816)+u893))+u8)))
  u805_s=sum(wgt*(u88*z))
  Ez(157)=u805_s
  V(158)=sum(wgt*(y*u806*z))
  Ex(158)=u877_s
  Ey(158)=u805_s
  u404_s=sum(wgt*(y*((u817+u708*(u708*(u831+u816)+u783))*u710+u708*(u817+&
 &u708*(u909+u857))+u775)))
  Ez(158)=u404_s
  V(159)=sum(wgt*((u789+u708*(u708*(u89+u813)+u875))*u710+u708*(u890+u7&
 &08*(u910+u891))+u822))
  Ex(159)=u803_s
  Ey(159)=u404_s
  u404_s=sum(wgt*(z*(u874+u708*(u785+u708*(u911+u888))+u776)))
  Ez(159)=u404_s
  V(160)=sum(wgt*(u465*(u807+u708*(u842+u855)+u890)))
  Ex(160)=u804_s
  Ey(160)=u404_s
  u404_s=sum(wgt*(y*(u710*(u897+u708*(u912+u787)+(u708*(u781+u816)+u96)*u&
 &710)+u708*(u786+u913)+u776)))
  Ez(160)=u404_s
  V(161)=sum(wgt*(u710*(u886+u708*(u914+u98)+(u708*(u828+u813)+u9)*u710&
 &)+u708*(u886+u915)+u95))
  Ex(161)=u847_s
  Ey(161)=u404_s
  u404_s=sum(wgt*(z*(u710*(u786+u708*(u916+u787)+u808)+u708*(u897+u917)+u&
 &776)))
  Ez(161)=u404_s
  V(162)=sum(wgt*(u465*(u710*(u842+u918+u780)+u919+u890)))
  Ex(162)=u79_s
  Ey(162)=u404_s
  u404_s=sum(wgt*(y*(u710*(u785+u920+u710*((u779+u816)*u710+u921+u888))+u&
 &922+u776)))
  Ez(162)=u404_s
  V(163)=sum(wgt*(u710*(u890+u875*u708+u710*((u870+u813)*u710+u89*u708+&
 &u891))+u789*u708+u822))
  Ex(163)=u834_s
  Ey(163)=u404_s
  u404_s=sum(wgt*(z*(u710*(u817+u783*u708+u710*(u836+u831*u708+u857))+u81&
 &7*u708+u775)))
  Ez(163)=u404_s
  V(164)=sum(wgt*(u465*u812))
  Ex(164)=u826_s
  Ey(164)=u404_s
  u465_s=sum(wgt*(y*u507))
  Ez(164)=u465_s
  V(165)=sum(wgt*(u710*(u892+u710*(u710*(u99+u860)+u896))+u871))
  Ex(165)=u463_s
  Ey(165)=u465_s
  Ez(165)=sum(wgt*(z*(u710*(u858+u710*(u710*(u839+u861)+u893))+u8)))
  if ( lmax .eq. 8 ) return
  ! if we get here, something went wrong...
  D_X_V_and_E_fast_vec4=.false.
  
  contains
  
  include "Av_functions.h"
  
end function

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
!! differentiate weights for charge and dipoles at a given point
!!
recursive function D_X_V_and_E_vec4(a12,lmax,r3,w3_v,w3_Ex,w3_Ey,w3_Ez,V,Ex,Ey,Ez)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12           !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: r3(NVEC,3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: w3_v(NVEC)    !< charge coeff at points r3
  real(kind=8), intent(in)  :: w3_Ex(NVEC)   !< x dipole coeff at points r3
  real(kind=8), intent(in)  :: w3_Ey(NVEC)   !< y dipole coeff at points r3
  real(kind=8), intent(in)  :: w3_Ez(NVEC)   !< z dipole coeff at points r3
  integer     , intent(in)  :: lmax          !< max order of hermit decomposition of the product of orbital 1 and 2
  real(kind=8), intent(out) :: V(*)          !< cumulated Potential
  real(kind=8), intent(out) :: Ex(*)         !< cumulated x dipole
  real(kind=8), intent(out) :: Ey(*)         !< cumulated y dipole
  real(kind=8), intent(out) :: Ez(*)         !< cumulated z dipole
  
  ! return value
  logical :: D_X_V_and_E_vec4
  
  ! C function interface
  INTERFACE
    PURE RECURSIVE SUBROUTINE my_erf_v4(pd, exppd2, erfpd) BIND(C,NAME="my_erf_v4_")
     real(kind=8), intent(in)  :: pd(4)
     real(kind=8), intent(out) :: erfpd(4)
     real(kind=8), intent(out) :: exppd2(4)
    END SUBROUTINE my_erf_v4
  END INTERFACE
  
  ! local variables
  real(kind=8) :: wgt_v(NVEC)
  real(kind=8) :: wgt_x(NVEC)
  real(kind=8) :: wgt_y(NVEC)
  real(kind=8) :: wgt_z(NVEC)
  real(kind=8) :: d(NVEC)
  real(kind=8) :: p(NVEC)
  real(kind=8) :: pd(NVEC)
  real(kind=8) :: pd2(NVEC)
  real(kind=8) :: erfpd(NVEC)
  real(kind=8) :: exppd2(NVEC)
  real(kind=8) :: x(NVEC)
  real(kind=8) :: y(NVEC)
  real(kind=8) :: z(NVEC)
  real(kind=8) :: u404(NVEC)
  real(kind=8) :: u463(NVEC)
  real(kind=8) :: u465(NVEC)
  real(kind=8) :: u474(NVEC)
  real(kind=8) :: u774(NVEC)
  real(kind=8) :: u775(NVEC)
  real(kind=8) :: u776(NVEC)
  real(kind=8) :: u777(NVEC)
  real(kind=8) :: u778(NVEC)
  real(kind=8) :: u779(NVEC)
  real(kind=8) :: u78(NVEC)
  real(kind=8) :: u780(NVEC)
  real(kind=8) :: u781(NVEC)
  real(kind=8) :: u782(NVEC)
  real(kind=8) :: u783(NVEC)
  real(kind=8) :: u784(NVEC)
  real(kind=8) :: u785(NVEC)
  real(kind=8) :: u786(NVEC)
  real(kind=8) :: u79(NVEC)
  real(kind=8) :: u798(NVEC)
  real(kind=8) :: u8(NVEC)
  real(kind=8) :: u80(NVEC)
  real(kind=8) :: u800(NVEC)
  real(kind=8) :: u801(NVEC)
  real(kind=8) :: u802(NVEC)
  real(kind=8) :: u803(NVEC)
  real(kind=8) :: u804(NVEC)
  real(kind=8) :: u805(NVEC)
  real(kind=8) :: u806(NVEC)
  real(kind=8) :: u807(NVEC)
  real(kind=8) :: u808(NVEC)
  real(kind=8) :: u809(NVEC)
  real(kind=8) :: u81(NVEC)
  real(kind=8) :: u810(NVEC)
  real(kind=8) :: u811(NVEC)
  real(kind=8) :: u812(NVEC)
  real(kind=8) :: u813(NVEC)
  real(kind=8) :: u814(NVEC)
  real(kind=8) :: u815(NVEC)
  real(kind=8) :: u816(NVEC)
  real(kind=8) :: u817(NVEC)
  real(kind=8) :: u818(NVEC)
  real(kind=8) :: u819(NVEC)
  real(kind=8) :: u82(NVEC)
  real(kind=8) :: u820(NVEC)
  real(kind=8) :: u821(NVEC)
  real(kind=8) :: u822(NVEC)
  real(kind=8) :: u823(NVEC)
  real(kind=8) :: u824(NVEC)
  real(kind=8) :: u825(NVEC)
  real(kind=8) :: u826(NVEC)
  real(kind=8) :: u827(NVEC)
  real(kind=8) :: u828(NVEC)
  real(kind=8) :: u829(NVEC)
  real(kind=8) :: u83(NVEC)
  real(kind=8) :: u830(NVEC)
  real(kind=8) :: u831(NVEC)
  real(kind=8) :: u832(NVEC)
  real(kind=8) :: u833(NVEC)
  real(kind=8) :: u834(NVEC)
  real(kind=8) :: u835(NVEC)
  real(kind=8) :: u836(NVEC)
  real(kind=8) :: u837(NVEC)
  real(kind=8) :: u838(NVEC)
  real(kind=8) :: u839(NVEC)
  real(kind=8) :: u84(NVEC)
  real(kind=8) :: u840(NVEC)
  real(kind=8) :: u841(NVEC)
  real(kind=8) :: u842(NVEC)
  real(kind=8) :: u843(NVEC)
  real(kind=8) :: u844(NVEC)
  real(kind=8) :: u845(NVEC)
  real(kind=8) :: u846(NVEC)
  real(kind=8) :: u847(NVEC)
  real(kind=8) :: u848(NVEC)
  real(kind=8) :: u849(NVEC)
  real(kind=8) :: u85(NVEC)
  real(kind=8) :: u850(NVEC)
  real(kind=8) :: u851(NVEC)
  real(kind=8) :: u852(NVEC)
  real(kind=8) :: u853(NVEC)
  real(kind=8) :: u854(NVEC)
  real(kind=8) :: u855(NVEC)
  real(kind=8) :: u856(NVEC)
  real(kind=8) :: u857(NVEC)
  real(kind=8) :: u858(NVEC)
  real(kind=8) :: u859(NVEC)
  real(kind=8) :: u86(NVEC)
  real(kind=8) :: u860(NVEC)
  real(kind=8) :: u861(NVEC)
  real(kind=8) :: u862(NVEC)
  real(kind=8) :: u863(NVEC)
  real(kind=8) :: u864(NVEC)
  real(kind=8) :: u865(NVEC)
  real(kind=8) :: u866(NVEC)
  real(kind=8) :: u867(NVEC)
  real(kind=8) :: u868(NVEC)
  real(kind=8) :: u869(NVEC)
  real(kind=8) :: u87(NVEC)
  real(kind=8) :: u870(NVEC)
  real(kind=8) :: u871(NVEC)
  real(kind=8) :: u872(NVEC)
  real(kind=8) :: u873(NVEC)
  real(kind=8) :: u874(NVEC)
  real(kind=8) :: u875(NVEC)
  real(kind=8) :: u876(NVEC)
  real(kind=8) :: u877(NVEC)
  real(kind=8) :: u878(NVEC)
  real(kind=8) :: u879(NVEC)
  real(kind=8) :: u88(NVEC)
  real(kind=8) :: u880(NVEC)
  real(kind=8) :: u881(NVEC)
  real(kind=8) :: u882(NVEC)
  real(kind=8) :: u883(NVEC)
  real(kind=8) :: u884(NVEC)
  real(kind=8) :: u885(NVEC)
  real(kind=8) :: u886(NVEC)
  real(kind=8) :: u887(NVEC)
  real(kind=8) :: u888(NVEC)
  real(kind=8) :: u889(NVEC)
  real(kind=8) :: u89(NVEC)
  real(kind=8) :: u890(NVEC)
  real(kind=8) :: u891(NVEC)
  real(kind=8) :: u892(NVEC)
  real(kind=8) :: u893(NVEC)
  real(kind=8) :: u894(NVEC)
  real(kind=8) :: u895(NVEC)
  real(kind=8) :: u896(NVEC)
  real(kind=8) :: u897(NVEC)
  real(kind=8) :: u898(NVEC)
  real(kind=8) :: u899(NVEC)
  real(kind=8) :: u9(NVEC)
  real(kind=8) :: u90(NVEC)
  real(kind=8) :: u900(NVEC)
  real(kind=8) :: u901(NVEC)
  real(kind=8) :: u902(NVEC)
  real(kind=8) :: u903(NVEC)
  real(kind=8) :: u904(NVEC)
  real(kind=8) :: u905(NVEC)
  real(kind=8) :: u906(NVEC)
  real(kind=8) :: u907(NVEC)
  real(kind=8) :: u908(NVEC)
  real(kind=8) :: u909(NVEC)
  real(kind=8) :: u91(NVEC)
  real(kind=8) :: u910(NVEC)
  real(kind=8) :: u911(NVEC)
  real(kind=8) :: u912(NVEC)
  real(kind=8) :: u913(NVEC)
  real(kind=8) :: u914(NVEC)
  real(kind=8) :: u915(NVEC)
  real(kind=8) :: u916(NVEC)
  real(kind=8) :: u917(NVEC)
  real(kind=8) :: u918(NVEC)
  real(kind=8) :: u919(NVEC)
  real(kind=8) :: u92(NVEC)
  real(kind=8) :: u920(NVEC)
  real(kind=8) :: u921(NVEC)
  real(kind=8) :: u922(NVEC)
  real(kind=8) :: u93(NVEC)
  real(kind=8) :: u94(NVEC)
  real(kind=8) :: u95(NVEC)
  real(kind=8) :: u96(NVEC)
  real(kind=8) :: u97(NVEC)
  real(kind=8) :: u98(NVEC)
  real(kind=8) :: u99(NVEC)

  
  ! init computation flag
  D_X_V_and_E_vec4=.true.
  
  ! set weight 
  wgt_v=w3_v
  wgt_x=w3_Ex
  wgt_y=w3_Ey
  wgt_z=w3_Ez
  
  ! compute local quantities
  p=sqrt(a12)
  d=sqrt(sum(r3**2,dim=2))+1.0d-32
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  x=r3(:,1)/d
  y=r3(:,2)/d
  z=r3(:,3)/d
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
!  erfpd =erf(pd)
!  exppd2=exp(-pd2)
  call my_erf_v4(pd, exppd2, erfpd)
  
  ! computation section
  u826=1.0d0*p*A1_v(pd,exppd2,erfpd)
  V(1)=sum(wgt_v*(u826))
  u826=-p**2*A2_v(pd,exppd2,erfpd)
  u779=+u826
  Ex(1)=sum(wgt_x*(u779*x))
  Ey(1)=sum(wgt_y*(u779*y))
  Ez(1)=sum(wgt_z*(u779*z))
  if ( lmax .eq. 0 ) return
  u779=1.0d0*(-u826)
  V(2)=sum(wgt_v*(u779*x))
  u826=A3_v(pd,exppd2,erfpd)
  u865=5.31736155271654808d0*u826
  u869=p**3
  u9=4.0d0*exppd2
  u803=1.88063194515918762d-1*u869*(u865+u9)
  u859=-3.0d0*u869*u826
  u826=+u859
  u474=x**2
  Ex(2)=sum(wgt_x*(u826*u474+u803))
  u404=x*y
  u808=(u826*u404)
  Ey(2)=sum(wgt_y*u808)
  u463=x*z
  u809=(u826*u463)
  Ez(2)=sum(wgt_z*u809)
  V(3)=sum(wgt_v*(u779*y))
  Ex(3)=sum(wgt_x*u808)
  u808=y**2
  Ey(3)=sum(wgt_y*(u826*u808+u803))
  u465=y*z
  u810=(u826*u465)
  Ez(3)=sum(wgt_z*u810)
  V(4)=sum(wgt_v*(u779*z))
  Ex(4)=sum(wgt_x*u809)
  Ey(4)=sum(wgt_y*u810)
  u810=z**2
  Ez(4)=sum(wgt_z*(u826*u810+u803))
  if ( lmax .eq. 1 ) return
  u803=-1.88063194515918762d-1*u869*(u9+u865)
  u826=-u859
  V(5)=sum(wgt_v*(u826*u474+u803))
  u865=A5_v(pd,exppd2,erfpd)
  u779=2.65868077635827404d1*u865
  u869=p**4*pd
  u918=8.0d0*exppd2
  u806=u869*(u779+u918)
  u828=3.38513750128653772d-1*u806
  u832=-1.5d1*u869*u865
  u865=+u832
  u862=u865*u474
  Ex(5)=sum(wgt_x*(x*(u862+u828)))
  u866=1.12837916709551257d-1*u806
  u806=(u862+u866)
  u863=(u806*y)
  Ey(5)=sum(wgt_y*u863)
  u864=(u806*z)
  Ez(5)=sum(wgt_z*u864)
  V(6)=sum(wgt_v*(u826*u404))
  Ex(6)=sum(wgt_x*u863)
  u863=u865*u808
  u806=(u863+u866)
  u825=(x*u806)
  Ey(6)=sum(wgt_y*u825)
  u862=u404*z
  u807=(u865*u862)
  Ez(6)=sum(wgt_z*u807)
  V(7)=sum(wgt_v*(u826*u463))
  Ex(7)=sum(wgt_x*u864)
  Ey(7)=sum(wgt_y*u807)
  u864=u865*u810
  u97=(u864+u866)
  u781=(x*u97)
  Ez(7)=sum(wgt_z*u781)
  V(8)=sum(wgt_v*(u826*u808+u803))
  Ex(8)=sum(wgt_x*u825)
  Ey(8)=sum(wgt_y*(y*(u863+u828)))
  u825=(u806*z)
  Ez(8)=sum(wgt_z*u825)
  V(9)=sum(wgt_v*(u826*u465))
  Ex(9)=sum(wgt_x*u807)
  Ey(9)=sum(wgt_y*u825)
  u825=(y*u97)
  Ez(9)=sum(wgt_z*u825)
  V(10)=sum(wgt_v*(u826*u810+u803))
  Ex(10)=sum(wgt_x*u781)
  Ey(10)=sum(wgt_y*u825)
  Ez(10)=sum(wgt_z*(z*(u864+u828)))
  if ( lmax .eq. 2 ) return
  u866=u869*(u918+u779)
  u803=-3.38513750128653772d-1*u866
  u828=-u832
  u865=u828*u474
  V(11)=sum(wgt_v*(x*(u865+u803)))
  u859=A7_v(pd,exppd2,erfpd)
  u779=pd2*u859
  u869=1.86107654345079183d2*u779
  u826=p**5
  u864=2.0d0*pd2
  u781=u826*(u918*(u864+7.0d0)+u869)
  u825=-4.83591071612362532d-2*u781
  u806=1.86107654345079183d2*u859
  u97=1.6d1*exppd2
  u882=(u806+u97)
  u915=u826*pd2
  u92=u915*u882
  u821=4.83591071612362532d-1*u92
  u96=-1.05d2*u826*u779
  u779=+u96
  u830=u779*u474
  Ex(11)=sum(wgt_x*(u474*(u821+u830)+u825))
  u99=2.41795535806181266d-1*u92
  u811=x*(u830+u99)
  u83=(u811*y)
  Ey(11)=sum(wgt_y*u83)
  u836=(u811*z)
  Ez(11)=sum(wgt_z*u836)
  u811=-1.12837916709551257d-1*u866
  u866=(u865+u811)
  V(12)=sum(wgt_v*(u866*y))
  Ex(12)=sum(wgt_x*u83)
  u83=-1.61197023870787511d-2*u781
  u781=8.05985119353937553d-2*u92
  u865=(u781+u830)
  u92=u781*u474+u83
  u831=(u865*u808+u92)
  Ey(12)=sum(wgt_y*u831)
  u834=((u830+u781)*u465)
  Ez(12)=sum(wgt_z*u834)
  V(13)=sum(wgt_v*(u866*z))
  Ex(13)=sum(wgt_x*u836)
  Ey(13)=sum(wgt_y*u834)
  u836=(u865*u810+u92)
  Ez(13)=sum(wgt_z*u836)
  u866=u828*u808
  u865=(u866+u811)
  V(14)=sum(wgt_v*(x*u865))
  Ex(14)=sum(wgt_x*u831)
  u831=u779*u808
  u92=(u831+u99)
  u863=(u404*u92)
  Ey(14)=sum(wgt_y*u863)
  u873=(x*(u831+u781)*z)
  Ez(14)=sum(wgt_z*u873)
  V(15)=sum(wgt_v*(u828*u862))
  Ex(15)=sum(wgt_x*u834)
  Ey(15)=sum(wgt_y*u873)
  u834=u779*u810
  u892=(u404*(u834+u781))
  Ez(15)=sum(wgt_z*u892)
  u867=u828*u810
  u868=(u867+u811)
  V(16)=sum(wgt_v*(x*u868))
  Ex(16)=sum(wgt_x*u836)
  Ey(16)=sum(wgt_y*u892)
  u836=(u834+u99)
  u822=(u463*u836)
  Ez(16)=sum(wgt_z*u822)
  V(17)=sum(wgt_v*(y*(u866+u803)))
  Ex(17)=sum(wgt_x*u863)
  Ey(17)=sum(wgt_y*(u808*(u821+u831)+u825))
  u863=(y*u92*z)
  Ez(17)=sum(wgt_z*u863)
  V(18)=sum(wgt_v*(u865*z))
  Ex(18)=sum(wgt_x*u873)
  Ey(18)=sum(wgt_y*u863)
  u873=((u781+u831)*u810+u781*u808+u83)
  Ez(18)=sum(wgt_z*u873)
  V(19)=sum(wgt_v*(y*u868))
  Ex(19)=sum(wgt_x*u892)
  Ey(19)=sum(wgt_y*u873)
  u781=(u465*u836)
  Ez(19)=sum(wgt_z*u781)
  V(20)=sum(wgt_v*(z*(u867+u803)))
  Ex(20)=sum(wgt_x*u822)
  Ey(20)=sum(wgt_y*u781)
  Ez(20)=sum(wgt_z*(u810*(u821+u834)+u825))
  if ( lmax .eq. 3 ) return
  u803=u826*(u869+u918*(7.0d0+u864))
  u781=4.83591071612362532d-2*u803
  u99=(u97+u806)
  u821=u915*u99
  u779=-4.83591071612362532d-1*u821
  u83=-u96
  u832=u83*u474
  V(21)=sum(wgt_v*(u474*(u779+u832)+u781))
  u825=p**6*pd
  u869=u825*u99
  u99=-1.20897767903090633d0*u869
  u806=u825*u859
  u915=1.05d3*u806
  u867=exppd2*pd2
  u834=-3.2d1*u867
  u828=u825*(1.67496888910571265d3*u859+u834)
  u859=-5.64189583547756287d-1*u828
  u826=u859*u474
  Ex(21)=sum(wgt_x*(x*(u474*(u915+u826)+u99)))
  u873=-2.41795535806181266d-1*u869
  u863=6.3d2*u806
  u892=(u474*(u863+u826)+u873)
  u822=(u892*y)
  Ey(21)=sum(wgt_y*u822)
  u811=(u892*z)
  Ez(21)=sum(wgt_z*u811)
  u892=-2.41795535806181266d-1*u821
  u865=x*(u832+u892)
  V(22)=sum(wgt_v*(u865*y))
  Ex(22)=sum(wgt_x*u822)
  u822=3.15d2*u806
  u92=1.05d2*u806
  u806=(u822+u826)
  u868=u92*u474
  u836=u868+u873
  u819=(x*(u806*u808+u836))
  Ey(22)=sum(wgt_y*u819)
  u833=(x*(u826+u822)*u465)
  Ez(22)=sum(wgt_z*u833)
  V(23)=sum(wgt_v*(u865*z))
  Ex(23)=sum(wgt_x*u811)
  Ey(23)=sum(wgt_y*u833)
  u811=(x*(u806*u810+u836))
  Ez(23)=sum(wgt_z*u811)
  u865=1.61197023870787511d-2*u803
  u803=-8.05985119353937553d-2*u821
  u821=(u803+u832)
  u806=u803*u474+u865
  V(24)=sum(wgt_v*(u821*u808+u806))
  Ex(24)=sum(wgt_x*u819)
  u819=(u92+u826)
  u836=u819*u808
  u90=u822*u474+u873
  u827=(y*(u836+u90))
  Ey(24)=sum(wgt_y*u827)
  u820=-8.05985119353937553d-2*u869
  u869=u868+u820
  u875=((u836+u869)*z)
  Ez(24)=sum(wgt_z*u875)
  V(25)=sum(wgt_v*((u832+u803)*u465))
  Ex(25)=sum(wgt_x*u833)
  Ey(25)=sum(wgt_y*u875)
  u833=u819*u810
  u836=(y*(u833+u869))
  Ez(25)=sum(wgt_z*u836)
  V(26)=sum(wgt_v*(u821*u810+u806))
  Ex(26)=sum(wgt_x*u811)
  Ey(26)=sum(wgt_y*u836)
  u811=(z*(u833+u90))
  Ez(26)=sum(wgt_z*u811)
  u833=u83*u808
  u821=(u833+u892)
  V(27)=sum(wgt_v*(u404*u821))
  Ex(27)=sum(wgt_x*u827)
  u827=u859*u808
  u819=(u808*(u863+u827)+u873)
  u806=(x*u819)
  Ey(27)=sum(wgt_y*u806)
  u90=(u404*(u827+u822)*z)
  Ez(27)=sum(wgt_z*u90)
  V(28)=sum(wgt_v*(x*(u833+u803)*z))
  Ex(28)=sum(wgt_x*u875)
  Ey(28)=sum(wgt_y*u90)
  u875=(u92+u827)*u810
  u869=u92*u808
  u868=(x*(u875+u869+u820))
  Ez(28)=sum(wgt_z*u868)
  u835=u83*u810
  V(29)=sum(wgt_v*(u404*(u835+u803)))
  Ex(29)=sum(wgt_x*u836)
  Ey(29)=sum(wgt_y*u868)
  u836=u859*u810
  u897=(u862*(u836+u822))
  Ez(29)=sum(wgt_z*u897)
  u78=(u835+u892)
  V(30)=sum(wgt_v*(u463*u78))
  Ex(30)=sum(wgt_x*u811)
  Ey(30)=sum(wgt_y*u897)
  u811=(u810*(u863+u836)+u873)
  u80=(x*u811)
  Ez(30)=sum(wgt_z*u80)
  V(31)=sum(wgt_v*(u808*(u779+u833)+u781))
  Ex(31)=sum(wgt_x*u806)
  Ey(31)=sum(wgt_y*(y*(u808*(u915+u827)+u99)))
  u806=(u819*z)
  Ez(31)=sum(wgt_z*u806)
  V(32)=sum(wgt_v*(y*u821*z))
  Ex(32)=sum(wgt_x*u90)
  Ey(32)=sum(wgt_y*u806)
  u806=(y*((u822+u827)*u810+u869+u873))
  Ez(32)=sum(wgt_z*u806)
  V(33)=sum(wgt_v*((u803+u833)*u810+u803*u808+u865))
  Ex(33)=sum(wgt_x*u868)
  Ey(33)=sum(wgt_y*u806)
  u827=(z*(u875+u822*u808+u873))
  Ez(33)=sum(wgt_z*u827)
  V(34)=sum(wgt_v*(u465*u78))
  Ex(34)=sum(wgt_x*u897)
  Ey(34)=sum(wgt_y*u827)
  u892=(y*u811)
  Ez(34)=sum(wgt_z*u892)
  V(35)=sum(wgt_v*(u810*(u779+u835)+u781))
  Ex(35)=sum(wgt_x*u80)
  Ey(35)=sum(wgt_y*u892)
  Ez(35)=sum(wgt_z*(z*(u810*(u915+u836)+u99)))
  if ( lmax .eq. 4 ) return
  u873=u825*u882
  u892=1.20897767903090633d0*u873
  u779=-u915
  u99=5.64189583547756287d-1*u828
  u828=u99*u474
  V(36)=sum(wgt_v*(x*(u474*(u779+u828)+u892)))
  u96=A9_v(pd,exppd2,erfpd)
  u915=pd2*u96
  u882=1.67496888910571265d3*u915
  u825=p**7
  u83=u825*(u882+u97*(9.0d0+u864))
  u781=1.34330853225656259d-1*u83
  u827=1.67496888910571265d3*u96
  u868=u825*pd2
  u836=3.2d1*exppd2
  u806=u868*(u836+u827)
  u803=-2.82094791773878144d0*u806
  u80=u825*u915
  u915=1.4175d4*u80
  u835=-6.4d1*u867
  u820=u868*(1.84246577801628391d4*u96+u835)
  u90=-5.64189583547756287d-1*u820
  u819=u90*u474
  Ex(36)=sum(wgt_x*(u474*(u803+u474*(u819+u915))+u781))
  u811=-9.40315972579593812d-1*u806
  u897=9.45d3*u80
  u859=x*(u474*(u897+u819)+u811)
  u875=(u859*y)
  Ey(36)=sum(wgt_y*u875)
  u821=(u859*z)
  Ez(36)=sum(wgt_z*u821)
  u859=2.41795535806181266d-1*u873
  u78=-u863
  u863=(u474*(u78+u828)+u859)
  V(37)=sum(wgt_v*(u863*y))
  Ex(37)=sum(wgt_x*u875)
  u875=2.68661706451312518d-2*u83
  u83=-1.88063194515918762d-1*u806
  u865=-3.76126389031837525d-1*u806
  u86=5.67d3*u80
  u846=9.45d2*u80
  u870=(u83+u474*(u819+u86))
  u837=u846*u474
  u898=u474*(u865+u837)+u875
  u93=(u870*u808+u898)
  Ey(37)=sum(wgt_y*u93)
  u91=((u474*(u86+u819)+u83)*u465)
  Ez(37)=sum(wgt_z*u91)
  V(38)=sum(wgt_v*(u863*z))
  Ex(38)=sum(wgt_x*u821)
  Ey(38)=sum(wgt_y*u91)
  u821=(u870*u810+u898)
  Ez(38)=sum(wgt_z*u821)
  u863=-u822
  u822=-u92
  u92=(u863+u828)
  u870=u822*u474
  u898=u870+u859
  V(39)=sum(wgt_v*(x*(u92*u808+u898)))
  Ex(39)=sum(wgt_x*u93)
  u93=-5.64189583547756287d-1*u806
  u806=2.835d3*u80
  u80=(u806+u819)
  u840=u80*u808
  u871=u806*u474
  u872=u871+u93
  u815=(u404*(u840+u872))
  Ey(39)=sum(wgt_y*u815)
  u852=u837+u83
  u900=(x*(u840+u852)*z)
  Ez(39)=sum(wgt_z*u900)
  V(40)=sum(wgt_v*(x*(u828+u863)*u465))
  Ex(40)=sum(wgt_x*u91)
  Ey(40)=sum(wgt_y*u900)
  u91=u80*u810
  u840=(u404*(u91+u852))
  Ez(40)=sum(wgt_z*u840)
  V(41)=sum(wgt_v*(x*(u92*u810+u898)))
  Ex(41)=sum(wgt_x*u821)
  Ey(41)=sum(wgt_y*u840)
  u821=(u463*(u91+u872))
  Ez(41)=sum(wgt_z*u821)
  u91=(u822+u828)
  u92=u91*u808
  u80=u863*u474+u859
  V(42)=sum(wgt_v*(y*(u92+u80)))
  Ex(42)=sum(wgt_x*u815)
  u815=(u819+u846)
  u898=u815*u808
  u872=u865+u86*u474
  u852=u83*u474+u875
  u824=(u808*(u872+u898)+u852)
  Ey(42)=sum(wgt_y*u824)
  u833=(u846+u819)
  u84=u871+u83
  u79=(y*(u833*u808+u84)*z)
  Ez(42)=sum(wgt_z*u79)
  u874=8.05985119353937553d-2*u873
  u873=u870+u874
  V(43)=sum(wgt_v*((u92+u873)*z))
  Ex(43)=sum(wgt_x*u900)
  Ey(43)=sum(wgt_y*u79)
  u900=u918*(4.0d0*pd2-3.0d0)
  u918=-5.37323412902625035d-2*u825*(u900+u882)
  u92=-u846
  u845=-2.25675833419102515d0*u868*(5.02490666731713794d3*u96-1.6d1*u86&
 &7)
  u96=+u845
  u807=5.64189583547756287d-1*u820
  u820=u807*u474
  u879=(u820+u92)
  u855=u879*u808
  u838=u92*u474
  u839=(u808*(u846+u474*(u820+u96)+u855)+u474*(u846+u838)+u918)
  Ez(43)=sum(wgt_z*u839)
  u829=u91*u810
  V(44)=sum(wgt_v*(y*(u829+u873)))
  Ex(44)=sum(wgt_x*u840)
  Ey(44)=sum(wgt_y*u839)
  u840=(u465*(u833*u810+u84))
  Ez(44)=sum(wgt_z*u840)
  V(45)=sum(wgt_v*(z*(u829+u80)))
  Ex(45)=sum(wgt_x*u821)
  Ey(45)=sum(wgt_y*u840)
  u821=(u810*(u872+u815*u810)+u852)
  Ez(45)=sum(wgt_z*u821)
  u829=u99*u808
  u91=(u808*(u78+u829)+u859)
  V(46)=sum(wgt_v*(x*u91))
  Ex(46)=sum(wgt_x*u824)
  u824=u90*u808
  u815=(u808*(u897+u824)+u811)
  u833=(u404*u815)
  Ey(46)=sum(wgt_y*u833)
  u80=(x*(u808*(u86+u824)+u83)*z)
  Ez(46)=sum(wgt_z*u80)
  V(47)=sum(wgt_v*(u404*(u829+u863)*z))
  Ex(47)=sum(wgt_x*u79)
  Ey(47)=sum(wgt_y*u80)
  u79=(u806+u824)*u810
  u872=u846*u808
  u852=(u404*(u79+u872+u83))
  Ez(47)=sum(wgt_z*u852)
  u84=(u822+u829)*u810
  u873=u822*u808
  V(48)=sum(wgt_v*(x*(u84+u873+u874)))
  Ex(48)=sum(wgt_x*u839)
  Ey(48)=sum(wgt_y*u852)
  u874=u806*u808
  u918=(u463*((u846+u824)*u810+u874+u83))
  Ez(48)=sum(wgt_z*u918)
  u839=u99*u810
  V(49)=sum(wgt_v*(u862*(u839+u863)))
  Ex(49)=sum(wgt_x*u840)
  Ey(49)=sum(wgt_y*u918)
  u840=u90*u810
  u817=(u404*(u810*(u86+u840)+u83))
  Ez(49)=sum(wgt_z*u817)
  u848=(u810*(u78+u839)+u859)
  V(50)=sum(wgt_v*(x*u848))
  Ex(50)=sum(wgt_x*u821)
  Ey(50)=sum(wgt_y*u817)
  u821=(u810*(u897+u840)+u811)
  u812=(u463*u821)
  Ez(50)=sum(wgt_z*u812)
  V(51)=sum(wgt_v*(y*(u808*(u779+u829)+u892)))
  Ex(51)=sum(wgt_x*u833)
  Ey(51)=sum(wgt_y*(u808*(u803+u808*(u824+u915))+u781))
  u833=(y*u815*z)
  Ez(51)=sum(wgt_z*u833)
  V(52)=sum(wgt_v*(u91*z))
  Ex(52)=sum(wgt_x*u80)
  Ey(52)=sum(wgt_y*u833)
  u80=((u83+u808*(u824+u86))*u810+u808*(u865+u872)+u875)
  Ez(52)=sum(wgt_z*u80)
  V(53)=sum(wgt_v*(y*((u863+u829)*u810+u873+u859)))
  Ex(53)=sum(wgt_x*u852)
  Ey(53)=sum(wgt_y*u80)
  u852=(u465*(u79+u874+u93))
  Ez(53)=sum(wgt_z*u852)
  V(54)=sum(wgt_v*(z*(u84+u863*u808+u859)))
  Ex(54)=sum(wgt_x*u918)
  Ey(54)=sum(wgt_y*u852)
  u822=(u810*(u865+u86*u808+(u824+u846)*u810)+u83*u808+u875)
  Ez(54)=sum(wgt_z*u822)
  V(55)=sum(wgt_v*(y*u848))
  Ex(55)=sum(wgt_x*u817)
  Ey(55)=sum(wgt_y*u822)
  u865=(u465*u821)
  Ez(55)=sum(wgt_z*u865)
  V(56)=sum(wgt_v*(z*(u810*(u779+u839)+u892)))
  Ex(56)=sum(wgt_x*u812)
  Ey(56)=sum(wgt_y*u865)
  Ez(56)=sum(wgt_z*(u810*(u803+u810*(u840+u915))+u781))
  if ( lmax .eq. 5 ) return
  u99=u825*(u97*(u864+9.0d0)+u882)
  u811=-1.34330853225656259d-1*u99
  u865=u868*(u827+u836)
  u803=2.82094791773878144d0*u865
  u859=-u915
  V(57)=sum(wgt_v*(u474*(u803+u474*(u820+u859))+u811))
  u892=A11_v(pd,exppd2,erfpd)
  u822=pd2*u892
  u863=1.84246577801628391d4*u822
  u824=(u863+u836*(1.1d1+u864))
  u779=p**8*pd
  u78=u779*u824
  u915=5.98382891641559699d-1*u78
  u827=1.84246577801628391d4*u892
  u840=6.4d1*exppd2
  u839=pd2*(u840+u827)
  u868=u779*u839
  u97=-5.38544602477403729d0*u868
  u875=u779*u822
  u93=2.18295d5*u875
  u781=2.39520551142116908d5*u892
  u852=-1.28d2*u867
  u918=pd2*(u781+u852)
  u80=u779*u918
  u833=-5.64189583547756287d-1*u80
  u817=u833*u474
  Ex(57)=sum(wgt_x*(x*(u474*(u97+u474*(u817+u93))+u915)))
  u812=8.54832702345085283d-2*u78
  u83=-2.30804829633173027d0*u868
  u91=1.55925d5*u875
  u815=(u474*(u83+u474*(u817+u91))+u812)
  u848=(u815*y)
  Ey(57)=sum(wgt_y*u848)
  u821=(u815*z)
  Ez(57)=sum(wgt_z*u821)
  u815=9.40315972579593812d-1*u865
  u79=-u897
  u897=x*(u474*(u79+u820)+u815)
  V(58)=sum(wgt_v*(u897*y))
  Ex(58)=sum(wgt_x*u848)
  u848=-7.69349432110576755d-1*u868
  u84=-5.1289962140705117d-1*u868
  u905=1.0395d5*u875
  u858=1.0395d4*u875
  u8=(u848+u474*(u817+u905))
  u841=u858*u474
  u857=u474*(u84+u841)+u812
  u94=(x*(u8*u808+u857))
  Ey(58)=sum(wgt_y*u94)
  u89=(x*(u474*(u905+u817)+u848)*u465)
  Ez(58)=sum(wgt_z*u89)
  V(59)=sum(wgt_v*(u897*z))
  Ex(59)=sum(wgt_x*u821)
  Ey(59)=sum(wgt_y*u89)
  u821=(x*(u8*u810+u857))
  Ez(59)=sum(wgt_z*u821)
  u897=-2.68661706451312518d-2*u99
  u8=1.88063194515918762d-1*u865
  u857=3.76126389031837525d-1*u865
  u99=-u86
  u86=(u8+u474*(u820+u99))
  u81=u474*(u857+u838)+u897
  V(60)=sum(wgt_v*(u86*u808+u81))
  Ex(60)=sum(wgt_x*u94)
  u94=5.1289962140705117d-2*u78
  u901=-1.53869886422115351d-1*u868
  u85=-9.23219318532692106d-1*u868
  u889=6.237d4*u875
  u904=3.1185d4*u875
  u875=(u901+u474*(u817+u889))
  u903=u875*u808
  u842=u904*u474
  u780=u474*(u85+u842)+u94
  u870=(y*(u903+u780))
  Ey(60)=sum(wgt_y*u870)
  u783=1.70966540469017057d-2*u78
  u78=-3.07739772844230702d-1*u868
  u876=u474*(u78+u841)+u783
  u87=((u903+u876)*z)
  Ez(60)=sum(wgt_z*u87)
  V(61)=sum(wgt_v*((u474*(u99+u820)+u8)*u465))
  Ex(61)=sum(wgt_x*u89)
  Ey(61)=sum(wgt_y*u87)
  u89=u875*u810
  u903=(y*(u89+u876))
  Ez(61)=sum(wgt_z*u903)
  V(62)=sum(wgt_v*(u86*u810+u81))
  Ex(62)=sum(wgt_x*u821)
  Ey(62)=sum(wgt_y*u903)
  u821=(z*(u89+u780))
  Ez(62)=sum(wgt_z*u821)
  u89=5.64189583547756287d-1*u865
  u865=-u806
  u873=(u865+u820)
  u86=u873*u808
  u875=u865*u474
  u81=u875+u89
  V(63)=sum(wgt_v*(u404*(u86+u81)))
  Ex(63)=sum(wgt_x*u870)
  u870=(u817+u904)
  u780=u870*u808
  u876=u889*u474
  u806=u85+u876
  u877=u901*u474
  u832=u877+u94
  u82=(x*(u808*(u806+u780)+u832))
  Ey(63)=sum(wgt_y*u82)
  u88=-4.61609659266346053d-1*u868
  u868=(u904+u817)
  u847=u842+u88
  u920=(u404*(u868*u808+u847)*z)
  Ez(63)=sum(wgt_z*u920)
  u881=u838+u8
  V(64)=sum(wgt_v*(x*(u86+u881)*z))
  Ex(64)=sum(wgt_x*u87)
  Ey(64)=sum(wgt_y*u920)
  u87=u9*(1.6d1*pd2-1.1d1)
  u829=(u87+u863)
  u9=-1.36773232375213645d-1*u779*u829
  u86=-u904
  u782=u779*pd2
  u838=1.28d2*exppd2
  u823=5.1289962140705117d-2*u782*(u781+u838)
  u95=-9.02703333676410059d0*u782*(u827-8.0d0*u867)
  u883=+u95
  u874=5.64189583547756287d-1*u80
  u80=-u858
  u818=u874*u474
  u844=u474*(u818+u883)
  u814=(u818+u86)
  u784=u814*u808
  u843=u80*u474
  u914=(x*(u808*(u904+u844+u784)+u474*(u823+u843)+u9))
  Ez(64)=sum(wgt_z*u914)
  u919=u873*u810
  V(65)=sum(wgt_v*(u404*(u919+u881)))
  Ex(65)=sum(wgt_x*u903)
  Ey(65)=sum(wgt_y*u914)
  u903=(u862*(u868*u810+u847))
  Ez(65)=sum(wgt_z*u903)
  V(66)=sum(wgt_v*(u463*(u919+u81)))
  Ex(66)=sum(wgt_x*u821)
  Ey(66)=sum(wgt_y*u903)
  u821=(x*(u810*(u806+u870*u810)+u832))
  Ez(66)=sum(wgt_z*u821)
  u919=u857+u99*u474
  u873=u8*u474+u897
  V(67)=sum(wgt_v*(u808*(u919+u855)+u873))
  Ex(67)=sum(wgt_x*u82)
  u82=(u817+u858)
  u855=u82*u808
  u870=u84+u905*u474
  u868=u848*u474+u812
  u81=(y*(u808*(u870+u855)+u868))
  Ey(67)=sum(wgt_y*u81)
  u806=u78+u876
  u876=u877+u783
  u847=((u808*(u806+u855)+u876)*z)
  Ez(67)=sum(wgt_z*u847)
  u881=(u92+u820)
  u832=u875+u8
  V(68)=sum(wgt_v*(y*(u881*u808+u832)*z))
  Ex(68)=sum(wgt_x*u920)
  Ey(68)=sum(wgt_y*u847)
  u920=u823+u844
  u844=u86*u474
  u878=u474*(u904+u844)+u9
  u875=(u818+u80)
  u890=u875*u808
  u880=(y*(u808*(u920+u890)+u878))
  Ez(68)=sum(wgt_z*u880)
  u908=5.37323412902625035d-2*u825*(u882+u900)
  u882=-u845
  V(69)=sum(wgt_v*(u808*(u92+u474*(u819+u882)+u898)+u474*(u92+u837)+u908)&
 &)
  Ex(69)=sum(wgt_x*u914)
  Ey(69)=sum(wgt_y*u880)
  u908=u875*u810
  u882=(z*(u810*(u920+u908)+u878))
  Ez(69)=sum(wgt_z*u882)
  V(70)=sum(wgt_v*(u465*(u881*u810+u832)))
  Ex(70)=sum(wgt_x*u903)
  Ey(70)=sum(wgt_y*u882)
  u832=u82*u810
  u846=(y*(u810*(u806+u832)+u876))
  Ez(70)=sum(wgt_z*u846)
  V(71)=sum(wgt_v*(u810*(u919+u879*u810)+u873))
  Ex(71)=sum(wgt_x*u821)
  Ey(71)=sum(wgt_y*u846)
  u900=(z*(u810*(u870+u832)+u868))
  Ez(71)=sum(wgt_z*u900)
  u825=u807*u808
  u914=(u808*(u79+u825)+u815)
  V(72)=sum(wgt_v*(u404*u914))
  Ex(72)=sum(wgt_x*u81)
  u821=u833*u808
  u81=(u808*(u83+u808*(u821+u91))+u812)
  u903=(x*u81)
  Ey(72)=sum(wgt_y*u903)
  u920=(u404*(u808*(u905+u821)+u848)*z)
  Ez(72)=sum(wgt_z*u920)
  V(73)=sum(wgt_v*(x*(u808*(u99+u825)+u8)*z))
  Ex(73)=sum(wgt_x*u847)
  Ey(73)=sum(wgt_y*u920)
  u847=(u901+u808*(u821+u889))*u810
  u878=u858*u808
  u90=(x*(u847+u808*(u78+u878)+u783))
  Ez(73)=sum(wgt_z*u90)
  u898=(u865+u825)*u810
  u879=u92*u808
  V(74)=sum(wgt_v*(u404*(u898+u879+u8)))
  Ex(74)=sum(wgt_x*u880)
  Ey(74)=sum(wgt_y*u90)
  u880=u904*u808
  u82=(u862*((u904+u821)*u810+u880+u88))
  Ez(74)=sum(wgt_z*u82)
  u881=u865*u808
  V(75)=sum(wgt_v*(u463*((u92+u825)*u810+u881+u8)))
  Ex(75)=sum(wgt_x*u882)
  Ey(75)=sum(wgt_y*u82)
  u823=(u821+u858)*u810
  u882=u889*u808
  u883=u901*u808
  u875=(x*(u810*(u78+u882+u823)+u883+u783))
  Ez(75)=sum(wgt_z*u875)
  u845=u807*u810
  V(76)=sum(wgt_v*(u404*(u810*(u99+u845)+u8)))
  Ex(76)=sum(wgt_x*u846)
  Ey(76)=sum(wgt_y*u875)
  u846=u833*u810
  u919=(u862*(u810*(u905+u846)+u848))
  Ez(76)=sum(wgt_z*u919)
  u873=(u810*(u79+u845)+u815)
  V(77)=sum(wgt_v*(u463*u873))
  Ex(77)=sum(wgt_x*u900)
  Ey(77)=sum(wgt_y*u919)
  u900=(u810*(u83+u810*(u846+u91))+u812)
  u837=(x*u900)
  Ez(77)=sum(wgt_z*u837)
  V(78)=sum(wgt_v*(u808*(u803+u808*(u825+u859))+u811))
  Ex(78)=sum(wgt_x*u903)
  Ey(78)=sum(wgt_y*(y*(u808*(u97+u808*(u821+u93))+u915)))
  u903=(u81*z)
  Ez(78)=sum(wgt_z*u903)
  V(79)=sum(wgt_v*(y*u914*z))
  Ex(79)=sum(wgt_x*u920)
  Ey(79)=sum(wgt_y*u903)
  u903=(y*((u848+u808*(u821+u905))*u810+u808*(u84+u878)+u812))
  Ez(79)=sum(wgt_z*u903)
  V(80)=sum(wgt_v*((u8+u808*(u825+u99))*u810+u808*(u857+u879)+u897))
  Ex(80)=sum(wgt_x*u90)
  Ey(80)=sum(wgt_y*u903)
  u903=(z*(u847+u808*(u85+u880)+u94))
  Ez(80)=sum(wgt_z*u903)
  V(81)=sum(wgt_v*(u465*(u898+u881+u89)))
  Ex(81)=sum(wgt_x*u82)
  Ey(81)=sum(wgt_y*u903)
  u914=(y*(u810*(u85+u882+(u821+u904)*u810)+u883+u94))
  Ez(81)=sum(wgt_z*u914)
  V(82)=sum(wgt_v*(u810*(u857+u99*u808+(u825+u92)*u810)+u8*u808+u897))
  Ex(82)=sum(wgt_x*u875)
  Ey(82)=sum(wgt_y*u914)
  u857=(z*(u810*(u84+u905*u808+u823)+u848*u808+u812))
  Ez(82)=sum(wgt_z*u857)
  V(83)=sum(wgt_v*(u465*u873))
  Ex(83)=sum(wgt_x*u919)
  Ey(83)=sum(wgt_y*u857)
  u79=(y*u900)
  Ez(83)=sum(wgt_z*u79)
  V(84)=sum(wgt_v*(u810*(u803+u810*(u845+u859))+u811))
  Ex(84)=sum(wgt_x*u837)
  Ey(84)=sum(wgt_y*u79)
  Ez(84)=sum(wgt_z*(z*(u810*(u97+u810*(u846+u93))+u915)))
  if ( lmax .eq. 6 ) return
  u79=(u836*(u864+1.1d1)+u863)
  u857=u779*u79
  u803=-5.98382891641559699d-1*u857
  u859=pd2*(u827+u840)
  u783=u779*u859
  u94=5.38544602477403729d0*u783
  u92=-u93
  V(85)=sum(wgt_v*(x*(u474*(u94+u474*(u818+u92))+u803)))
  u914=p**9
  u875=u914*u79
  u79=-5.98382891641559699d-1*u875
  u93=u914*u859
  u859=2.15417840990961492d1*u93
  u807=u914*u822
  u83=-2.18295d6*u807
  u897=+u83
  u812=u914*u918
  u918=1.5797308339337176d1*u812
  u822=u914*pd2
  u827=u822*(3.59280826713175363d6*u892+u852*(1.5d1+u864))
  u84=-5.64189583547756287d-1*u827
  u811=u84*u474
  Ex(85)=sum(wgt_x*(u474*(u859+u474*(u474*(u918+u811)+u897))+u79))
  u915=5.38544602477403729d0*u93
  u846=-1.091475d6*u807
  u865=+u846
  u903=1.1847981254502882d1*u812
  u8=x*(u474*(u865+u474*(u811+u903))+u915)
  u873=(u8*y)
  Ey(85)=sum(wgt_y*u873)
  u89=(u8*z)
  Ez(85)=sum(wgt_z*u89)
  u8=-8.54832702345085283d-2*u857
  u837=2.30804829633173027d0*u783
  u815=-u91
  u91=(u474*(u837+u474*(u818+u815))+u8)
  V(86)=sum(wgt_v*(u91*y))
  Ex(86)=sum(wgt_x*u873)
  u873=-8.54832702345085283d-2*u875
  u82=7.69349432110576755d-1*u93
  u90=2.30804829633173027d0*u93
  u97=-4.67775d5*u807
  u920=+u97
  u881=-1.55925d5*u807
  u81=+u881
  u900=8.46284375321634431d0*u812
  u845=5.64189583547756287d-1*u812
  u919=(u82+u474*(u474*(u900+u811)+u920))
  u847=u845*u474
  u870=u474*(u90+u474*(u847+u81))+u873
  u85=(u919*u808+u870)
  Ey(86)=sum(wgt_y*u85)
  u898=((u474*(u920+u474*(u811+u900))+u82)*u465)
  Ez(86)=sum(wgt_z*u898)
  V(87)=sum(wgt_v*(u91*z))
  Ex(87)=sum(wgt_x*u89)
  Ey(87)=sum(wgt_y*u898)
  u89=(u919*u810+u870)
  Ez(87)=sum(wgt_z*u89)
  u91=7.69349432110576755d-1*u783
  u919=5.1289962140705117d-1*u783
  u870=-u905
  u905=(u91+u474*(u818+u870))
  u823=u474*(u919+u843)+u8
  V(88)=sum(wgt_v*(x*(u905*u808+u823)))
  Ex(88)=sum(wgt_x*u85)
  u85=-3.1185d5*u807
  u876=+u85
  u901=5.64189583547756287d0*u812
  u820=1.69256875064326886d0*u812
  u99=(u81+u474*(u811+u901))
  u868=u99*u808
  u848=u820*u474
  u9=u474*(u876+u848)+u90
  u806=(u404*(u868+u9))
  Ey(88)=sum(wgt_y*u806)
  u78=-1.0395d5*u807
  u907=+u78
  u861=u474*(u907+u847)+u82
  u98=(x*(u868+u861)*z)
  Ez(88)=sum(wgt_z*u98)
  V(89)=sum(wgt_v*(x*(u474*(u870+u818)+u91)*u465))
  Ex(89)=sum(wgt_x*u898)
  Ey(89)=sum(wgt_y*u98)
  u898=u99*u810
  u868=(u404*(u898+u861))
  Ez(89)=sum(wgt_z*u868)
  V(90)=sum(wgt_v*(x*(u905*u810+u823)))
  Ex(90)=sum(wgt_x*u89)
  Ey(90)=sum(wgt_y*u868)
  u89=(u463*(u898+u9))
  Ez(90)=sum(wgt_z*u89)
  u898=-5.1289962140705117d-2*u857
  u905=1.53869886422115351d-1*u783
  u99=9.23219318532692106d-1*u783
  u823=-u889
  u889=(u905+u474*(u818+u823))
  u9=u889*u808
  u861=u474*(u99+u844)+u898
  V(91)=sum(wgt_v*(y*(u9+u861)))
  Ex(91)=sum(wgt_x*u806)
  u806=-5.1289962140705117d-2*u875
  u875=9.23219318532692106d-1*u93
  u882=-3.1185d4*u807
  u821=+u882
  u866=-3.7422d5*u807
  u902=+u866
  u830=3.38513750128653772d0*u812
  u885=(u474*(u830+u811)+u821)
  u88=u885*u808
  u849=u830*u474
  u886=u875+u474*(u849+u902)
  u850=u821*u474
  u785=u474*(u875+u850)+u806
  u96=(u808*(u886+u88)+u785)
  Ey(91)=sum(wgt_y*u96)
  u912=4.61609659266346053d-1*u93
  u831=-1.8711d5*u807
  u93=+u831
  u807=(u821+u474*(u811+u830))
  u887=u474*(u93+u848)+u912
  u871=(y*(u807*u808+u887)*z)
  Ez(91)=sum(wgt_z*u871)
  u896=-1.70966540469017057d-2*u857
  u857=3.07739772844230702d-1*u783
  u774=u474*(u857+u843)+u896
  V(92)=sum(wgt_v*((u9+u774)*z))
  Ex(92)=sum(wgt_x*u98)
  Ey(92)=sum(wgt_y*u871)
  u98=(u863+u87)
  u863=1.36773232375213645d-1*u914*u98
  u9=-u882
  u883=u822*(3.86917813383419621d5*u892-u840)
  u87=-1.53869886422115351d-1*u883
  u877=1.69256875064326886d0*u822
  u880=-2.56d2*u867
  u843=u877*(4.97465760064396656d5*u892+u880)
  u828=-u830
  u917=1.12837916709551257d0*u822*(1.65821920021465552d5*u892+u835)
  u825=u822*(5.02993157398445508d6*u892+u852*(2.1d1+u864))
  u895=-5.64189583547756287d-1*u825
  u879=5.64189583547756287d-1*u827
  u827=-5.64189583547756287d-1*u812
  u812=u879*u474
  u878=(u474*(u828+u812)+u9)
  u922=u878*u808
  u854=u474*(u895+u812)
  u851=u827*u474
  u888=(u808*(u821+u474*(u854+u843)+u922)+u474*(u87+u474*(u851+u917))+u&
 &863)
  Ez(92)=sum(wgt_z*u888)
  u884=u889*u810
  V(93)=sum(wgt_v*(y*(u884+u774)))
  Ex(93)=sum(wgt_x*u868)
  Ey(93)=sum(wgt_y*u888)
  u868=(u465*(u807*u810+u887))
  Ez(93)=sum(wgt_z*u868)
  V(94)=sum(wgt_v*(z*(u884+u861)))
  Ex(94)=sum(wgt_x*u89)
  Ey(94)=sum(wgt_y*u868)
  u89=(u810*(u886+u885*u810)+u785)
  Ez(94)=sum(wgt_z*u89)
  u884=u823*u474
  u889=u99+u884
  u885=u905*u474
  u807=u885+u898
  V(95)=sum(wgt_v*(x*(u808*(u889+u784)+u807)))
  Ex(95)=sum(wgt_x*u96)
  u96=(u811+u820)
  u861=u96*u808
  u886=u901*u474
  u785=u876+u886
  u887=u81*u474
  u774=u887+u90
  u784=(u404*(u808*(u785+u861)+u774))
  Ey(95)=sum(wgt_y*u784)
  u775=u93+u849
  u776=u850+u912
  u853=(x*(u808*(u775+u861)+u776)*z)
  Ez(95)=sum(wgt_z*u853)
  u891=4.61609659266346053d-1*u783
  u783=(u86+u818)
  u777=u844+u891
  V(96)=sum(wgt_v*(u404*(u783*u808+u777)*z))
  Ex(96)=sum(wgt_x*u871)
  Ey(96)=sum(wgt_y*u853)
  u844=u822*(9.21232889008141955d4*u892-u836)
  u871=-9.23219318532692106d-1*u844
  u913=u877*(2.76369866702442587d5*u892+u852)
  u877=-u820
  u818=u867*(1.0d1+pd2)
  u869=-2.25675833419102515d0*u822*(1.19760275571058454d6*u892-6.4d1*u8&
 &18)
  u892=+u869
  u822=u913+u474*(u812+u892)
  u852=u877*u474
  u778=u474*(u913+u852)+u871
  u801=(u812+u877)
  u798=u801*u808
  u813=(u404*(u808*(u822+u798)+u778))
  Ez(96)=sum(wgt_z*u813)
  u899=1.36773232375213645d-1*u779*u98
  u98=-5.1289962140705117d-2*u782*(u838+u781)
  u826=-u95
  u819=u474*(u817+u826)
  V(97)=sum(wgt_v*(x*(u808*(u86+u819+u780)+u474*(u98+u841)+u899)))
  Ex(97)=sum(wgt_x*u888)
  Ey(97)=sum(wgt_y*u813)
  u841=u801*u810
  u888=(u463*(u810*(u822+u841)+u778))
  Ez(97)=sum(wgt_z*u888)
  V(98)=sum(wgt_v*(u862*(u783*u810+u777)))
  Ex(98)=sum(wgt_x*u868)
  Ey(98)=sum(wgt_y*u888)
  u801=u96*u810
  u822=(u404*(u810*(u775+u801)+u776))
  Ez(98)=sum(wgt_z*u822)
  V(99)=sum(wgt_v*(x*(u810*(u889+u814*u810)+u807)))
  Ex(99)=sum(wgt_x*u89)
  Ey(99)=sum(wgt_y*u822)
  u89=(u463*(u810*(u785+u801)+u774))
  Ez(99)=sum(wgt_z*u89)
  u778=u919+u870*u474
  u779=u91*u474+u8
  V(100)=sum(wgt_v*(y*(u808*(u778+u890)+u779)))
  Ex(100)=sum(wgt_x*u784)
  u807=(u845+u811)
  u868=u807*u808
  u780=u90+u920*u474
  u781=u900*u474+u81
  u782=u82*u474+u873
  u814=(u808*(u780+u808*(u868+u781))+u782)
  Ey(100)=sum(wgt_y*u814)
  u96=(u811+u845)
  u783=u907+u886
  u784=u887+u82
  u889=(y*(u808*(u783+u96*u808)+u784)*z)
  Ez(100)=sum(wgt_z*u889)
  u785=u857+u884
  u786=u885+u896
  V(101)=sum(wgt_v*((u808*(u785+u890)+u786)*z))
  Ex(101)=sum(wgt_x*u853)
  Ey(101)=sum(wgt_y*u889)
  u853=u828*u474
  u817=u87+u474*(u853+u843)
  u890=u854+u917
  u854=u9*u474
  u893=u474*(u821+u854)+u863
  u887=(u827+u812)
  u909=u887*u808
  u856=(u808*(u817+u808*(u909+u890))+u893)
  Ez(101)=sum(wgt_z*u856)
  u894=u98+u819
  u774=u474*(u86+u842)+u899
  V(102)=sum(wgt_v*(y*(u808*(u894+u855)+u774)))
  Ex(102)=sum(wgt_x*u813)
  Ey(102)=sum(wgt_y*u856)
  u813=u879*u808
  u775=(u813+u877)*u810
  u855=u877*u808
  u776=(u465*(u810*(u913+u808*(u813+u892)+u775)+u808*(u913+u855)+u871))
  Ez(102)=sum(wgt_z*u776)
  V(103)=sum(wgt_v*(z*(u810*(u894+u832)+u774)))
  Ex(103)=sum(wgt_x*u888)
  Ey(103)=sum(wgt_y*u776)
  u826=u887*u810
  u858=(u810*(u817+u810*(u826+u890))+u893)
  Ez(103)=sum(wgt_z*u858)
  V(104)=sum(wgt_v*(y*(u810*(u785+u908)+u786)))
  Ex(104)=sum(wgt_x*u822)
  Ey(104)=sum(wgt_y*u858)
  u899=(u465*(u810*(u783+u96*u810)+u784))
  Ez(104)=sum(wgt_z*u899)
  V(105)=sum(wgt_v*(z*(u810*(u778+u908)+u779)))
  Ex(105)=sum(wgt_x*u89)
  Ey(105)=sum(wgt_y*u899)
  u819=u807*u810
  u778=(u810*(u780+u810*(u819+u781))+u782)
  Ez(105)=sum(wgt_z*u778)
  u822=u874*u808
  u781=(u808*(u837+u808*(u822+u815))+u8)
  V(106)=sum(wgt_v*(x*u781))
  Ex(106)=sum(wgt_x*u814)
  u814=u84*u808
  u842=(u808*(u865+u808*(u814+u903))+u915)
  u785=(u404*u842)
  Ey(106)=sum(wgt_y*u785)
  u774=(x*(u808*(u920+u808*(u814+u900))+u82)*z)
  Ez(106)=sum(wgt_z*u774)
  V(107)=sum(wgt_v*(u404*(u808*(u870+u822)+u91)*z))
  Ex(107)=sum(wgt_x*u889)
  Ey(107)=sum(wgt_y*u774)
  u782=(u81+u808*(u814+u901))*u810
  u888=u845*u808
  u89=(u404*(u782+u808*(u907+u888)+u82))
  Ez(107)=sum(wgt_z*u89)
  u817=(u905+u808*(u822+u823))*u810
  u889=u80*u808
  V(108)=sum(wgt_v*(x*(u817+u808*(u857+u889)+u896)))
  Ex(108)=sum(wgt_x*u856)
  Ey(108)=sum(wgt_y*u89)
  u856=u820*u808
  u807=(u463*((u821+u808*(u814+u830))*u810+u808*(u93+u856)+u912))
  Ez(108)=sum(wgt_z*u807)
  u890=u86*u808
  V(109)=sum(wgt_v*(u862*((u86+u822)*u810+u890+u891)))
  Ex(109)=sum(wgt_x*u776)
  Ey(109)=sum(wgt_y*u807)
  u776=(u814+u820)*u810
  u891=u830*u808
  u892=u821*u808
  u779=(u404*(u810*(u93+u891+u776)+u892+u912))
  Ez(109)=sum(wgt_z*u779)
  u871=(u822+u80)*u810
  u893=u823*u808
  u894=u905*u808
  V(110)=sum(wgt_v*(x*(u810*(u857+u893+u871)+u894+u896)))
  Ex(110)=sum(wgt_x*u858)
  Ey(110)=sum(wgt_y*u779)
  u895=u901*u808
  u896=u81*u808
  u780=(u463*(u810*(u907+u895+(u814+u845)*u810)+u896+u82))
  Ez(110)=sum(wgt_z*u780)
  u857=u874*u810
  V(111)=sum(wgt_v*(u862*(u810*(u870+u857)+u91)))
  Ex(111)=sum(wgt_x*u899)
  Ey(111)=sum(wgt_y*u780)
  u858=u84*u810
  u887=(u404*(u810*(u920+u810*(u858+u900))+u82))
  Ez(111)=sum(wgt_z*u887)
  u885=(u810*(u837+u810*(u857+u815))+u8)
  V(112)=sum(wgt_v*(x*u885))
  Ex(112)=sum(wgt_x*u778)
  Ey(112)=sum(wgt_y*u887)
  u778=(u810*(u865+u810*(u858+u903))+u915)
  u87=(u463*u778)
  Ez(112)=sum(wgt_z*u87)
  V(113)=sum(wgt_v*(y*(u808*(u94+u808*(u822+u92))+u803)))
  Ex(113)=sum(wgt_x*u785)
  Ey(113)=sum(wgt_y*(u808*(u859+u808*(u808*(u918+u814)+u897))+u79))
  u785=(y*u842*z)
  Ez(113)=sum(wgt_z*u785)
  V(114)=sum(wgt_v*(u781*z))
  Ex(114)=sum(wgt_x*u774)
  Ey(114)=sum(wgt_y*u785)
  u774=((u82+u808*(u808*(u900+u814)+u920))*u810+u808*(u90+u808*(u888+u8&
 &1))+u873)
  Ez(114)=sum(wgt_z*u774)
  V(115)=sum(wgt_v*(y*((u91+u808*(u822+u870))*u810+u808*(u919+u889)+u8)))
  Ex(115)=sum(wgt_x*u89)
  Ey(115)=sum(wgt_y*u774)
  u89=(u465*(u782+u808*(u876+u856)+u90))
  Ez(115)=sum(wgt_z*u89)
  V(116)=sum(wgt_v*(z*(u817+u808*(u99+u890)+u898)))
  Ex(116)=sum(wgt_x*u807)
  Ey(116)=sum(wgt_y*u89)
  u89=(u810*(u875+u808*(u891+u902)+(u808*(u830+u814)+u821)*u810)+u808*(&
 &u875+u892)+u806)
  Ez(116)=sum(wgt_z*u89)
  V(117)=sum(wgt_v*(y*(u810*(u99+u893+(u822+u86)*u810)+u894+u898)))
  Ex(117)=sum(wgt_x*u779)
  Ey(117)=sum(wgt_y*u89)
  u99=(u465*(u810*(u876+u895+u776)+u896+u90))
  Ez(117)=sum(wgt_z*u99)
  V(118)=sum(wgt_v*(z*(u810*(u919+u870*u808+u871)+u91*u808+u8)))
  Ex(118)=sum(wgt_x*u780)
  Ey(118)=sum(wgt_y*u99)
  u817=(u810*(u90+u920*u808+u810*((u845+u814)*u810+u900*u808+u81))+u82*&
 &u808+u873)
  Ez(118)=sum(wgt_z*u817)
  V(119)=sum(wgt_v*(y*u885))
  Ex(119)=sum(wgt_x*u887)
  Ey(119)=sum(wgt_y*u817)
  u817=(u465*u778)
  Ez(119)=sum(wgt_z*u817)
  V(120)=sum(wgt_v*(z*(u810*(u94+u810*(u857+u92))+u803)))
  Ex(120)=sum(wgt_x*u87)
  Ey(120)=sum(wgt_y*u817)
  Ez(120)=sum(wgt_z*(u810*(u859+u810*(u810*(u918+u858)+u897))+u79))
  if ( lmax .eq. 7 ) return
  u803=u914*u824
  u817=5.98382891641559699d-1*u803
  u919=u914*u839
  u892=-2.15417840990961492d1*u919
  u896=-u83
  u99=-u918
  V(121)=sum(wgt_v*(u474*(u892+u474*(u474*(u99+u812)+u896))+u817))
  u918=A13_v(pd,exppd2,erfpd)
  u82=pd2*u918
  u90=p**10*pd
  u887=u90*(u840*(u864+1.3d1)+2.39520551142116908d5*u82)
  u8=-3.72838570945894889d0*u887
  u915=u90*pd2
  u885=u915*(2.39520551142116908d5*u918+u838)
  u858=5.46829904053979171d1*u885
  u859=u90*u82
  u893=-5.108103d7*u859
  u80=3.59280826713175363d6*u918
  u823=u915*(u80+u880)
  u839=2.03108250077192263d1*u823
  u774=u915*(6.10777405412398116d7*u918+u880*(1.7d1+u864))
  u888=-5.64189583547756287d-1*u774
  u815=u888*u474
  Ex(121)=sum(wgt_x*(x*(u474*(u858+u474*(u474*(u839+u815)+u893))+u8)))
  u780=-4.14265078828772099d-1*u887
  u824=1.82276634684659724d1*u885
  u874=-2.837835d7*u859
  u86=1.5797308339337176d1*u823
  u895=(u474*(u824+u474*(u474*(u86+u815)+u874))+u780)
  u871=(u895*y)
  Ey(121)=sum(wgt_y*u871)
  u94=(u895*z)
  Ez(121)=sum(wgt_z*u94)
  u889=-5.38544602477403729d0*u919
  u895=-u846
  u93=-u903
  u822=x*(u474*(u895+u474*(u812+u93))+u889)
  V(122)=sum(wgt_v*(u822*y))
  Ex(122)=sum(wgt_x*u871)
  u871=4.55691586711649309d0*u885
  u779=-1.4189175d7*u859
  u857=-2.837835d6*u859
  u865=1.1847981254502882d1*u823
  u876=5.64189583547756287d-1*u823
  u890=(u871+u474*(u474*(u865+u815)+u779))
  u897=u876*u474
  u785=u474*(u871+u474*(u897+u857))+u780
  u807=(x*(u890*u808+u785))
  Ey(122)=sum(wgt_y*u807)
  u87=(x*(u474*(u779+u474*(u815+u865))+u871)*u465)
  Ez(122)=sum(wgt_z*u87)
  V(123)=sum(wgt_v*(u822*z))
  Ex(123)=sum(wgt_x*u94)
  Ey(123)=sum(wgt_y*u87)
  u94=(x*(u890*u810+u785))
  Ez(123)=sum(wgt_z*u94)
  u822=8.54832702345085283d-2*u803
  u785=-7.69349432110576755d-1*u919
  u890=-2.30804829633173027d0*u919
  u837=-u97
  u891=-u881
  u89=-u900
  u842=(u785+u474*(u474*(u89+u812)+u837))
  u782=u474*(u890+u474*(u851+u891))+u822
  V(124)=sum(wgt_v*(u842*u808+u782))
  Ex(124)=sum(wgt_x*u807)
  u807=-1.77542176640902328d-1*u887
  u870=6.5098798101664187d-1*u885
  u781=5.85889182914977683d0*u885
  u96=-6.081075d6*u859
  u832=8.46284375321634431d0*u823
  u863=1.69256875064326886d0*u823
  u91=(u870+u474*(u474*(u832+u815)+u96))
  u806=u91*u808
  u898=u863*u474
  u783=u474*(u781+u474*(u898+u96))+u807
  u873=(y*(u806+u783))
  Ey(124)=sum(wgt_y*u873)
  u875=-5.91807255469674427d-2*u887
  u894=1.95296394304992561d0*u885
  u778=-2.027025d6*u859
  u833=+u778
  u786=u474*(u894+u474*(u897+u833))+u875
  u81=((u806+u786)*z)
  Ez(124)=sum(wgt_z*u81)
  V(125)=sum(wgt_v*((u474*(u837+u474*(u812+u89))+u785)*u465))
  Ex(125)=sum(wgt_x*u87)
  Ey(125)=sum(wgt_y*u81)
  u87=u91*u810
  u806=(y*(u87+u786))
  Ez(125)=sum(wgt_z*u806)
  V(126)=sum(wgt_v*(u842*u810+u782))
  Ex(126)=sum(wgt_x*u94)
  Ey(126)=sum(wgt_y*u806)
  u94=(z*(u87+u783))
  Ez(126)=sum(wgt_z*u94)
  u842=-u85
  u87=-u901
  u901=(u891+u474*(u812+u87))
  u91=u901*u808
  u95=u474*(u842+u852)+u890
  V(127)=sum(wgt_v*(u404*(u91+u95)))
  Ex(127)=sum(wgt_x*u873)
  u897=3.90592788609985122d0*u885
  u782=1.30197596203328374d0*u885
  u783=-8.1081d6*u859
  u873=5.64189583547756287d0*u823
  u786=-4.05405d5*u859
  u809=+u786
  u777=3.38513750128653772d0*u823
  u907=(u474*(u873+u815)+u833)
  u899=u777*u474
  u902=u897+u474*(u899+u783)
  u900=u809*u474
  u860=u474*(u782+u900)+u807
  u905=(x*(u808*(u902+u907*u808)+u860))
  Ey(127)=sum(wgt_y*u905)
  u784=-4.05405d6*u859
  u98=(u833+u474*(u815+u873))
  u908=u474*(u784+u898)+u894
  u79=(u404*(u98*u808+u908)*z)
  Ez(127)=sum(wgt_z*u79)
  u898=-u78
  u884=u474*(u898+u851)+u785
  V(128)=sum(wgt_v*(x*(u91+u884)*z))
  Ex(128)=sum(wgt_x*u81)
  Ey(128)=sum(wgt_y*u79)
  u81=u90*(1.19760275571058454d6*u82+u836*(2.0d1*pd2-1.3d1))
  u836=1.18361451093934885d-1*u81
  u872=-u778
  u90=-2.16995993672213957d-1*u915*(u838+6.46705488083715652d6*u918)
  u82=-5.12d2*u867
  u91=2.82094791773878144d0*u915*(7.90417818768985798d6*u918+u82)
  u851=-u873
  u92=4.5135166683820503d0*u915*(7.18561653426350725d5*u918+u834)
  u805=-5.64189583547756287d-1*u915
  u834=+u805*(9.70058232125573479d7*u918+u880*(2.7d1+u864))
  u867=5.64189583547756287d-1*u774
  u774=-5.64189583547756287d-1*u823
  u823=u867*u474
  u911=u474*(u834+u823)
  u912=(x*(u808*(u833+u474*(u911+u91)+(u474*(u851+u823)+u872)*u808)+u47&
 &4*(u90+u474*(u774*u474+u92))+u836))
  Ez(128)=sum(wgt_z*u912)
  u886=u901*u810
  V(129)=sum(wgt_v*(u404*(u886+u884)))
  Ex(129)=sum(wgt_x*u806)
  Ey(129)=sum(wgt_y*u912)
  u806=(u862*(u98*u810+u908))
  Ez(129)=sum(wgt_z*u806)
  V(130)=sum(wgt_v*(u463*(u886+u95)))
  Ex(130)=sum(wgt_x*u94)
  Ey(130)=sum(wgt_y*u806)
  u94=(x*(u810*(u902+u907*u810)+u860))
  Ez(130)=sum(wgt_z*u94)
  u95=5.1289962140705117d-2*u803
  u886=-9.23219318532692106d-1*u919
  u98=-u866
  u803=u886+u474*(u853+u98)
  u907=u474*(u886+u854)+u95
  V(131)=sum(wgt_v*(u808*(u803+u922)+u907))
  Ex(131)=sum(wgt_x*u905)
  u905=(u474*(u777+u815)+u809)
  u922=u905*u808
  u901=u873*u474
  u860=u782+u474*(u901+u783)
  u902=u833*u474
  u908=u474*(u897+u902)+u807
  u910=(y*(u808*(u860+u922)+u908))
  Ey(131)=sum(wgt_y*u910)
  u884=-3.55084353281804656d-2*u887
  u887=7.81185577219970244d-1*u885
  u885=-4.86486d6*u859
  u859=u887+u474*(u899+u885)
  u804=u474*(u887+u900)+u884
  u800=((u808*(u859+u922)+u804)*z)
  Ez(131)=sum(wgt_z*u800)
  u922=-4.61609659266346053d-1*u919
  u900=-u831
  u919=(u9+u474*(u812+u828))
  u802=u474*(u900+u852)+u922
  V(132)=sum(wgt_v*(y*(u919*u808+u802)*z))
  Ex(132)=sum(wgt_x*u79)
  Ey(132)=sum(wgt_y*u800)
  u852=7.10168706563609313d-2*u81
  u79=-1.30197596203328374d-1*u915*(2.56d2*exppd2+u80)
  u899=-u786
  u80=-3.90592788609985122d-1*u915*(5.98801377855292271d6*u918-u838)
  u81=1.69256875064326886d0*u915*(8.38321928997409179d6*u918+u82)
  u838=-u777
  u82=6.77027500257307545d0*u915*(1.19760275571058454d6*u918+u835)
  u835=+u805*(8.98202066782938406d7*u918+u880*(2.5d1+u864))
  u864=-u863
  u805=u474*(u835+u823)
  u920=u79+u474*(u805+u81)
  u903=u864*u474
  u904=u474*(u80+u474*(u903+u82))+u852
  u906=(u474*(u838+u823)+u899)
  u916=(y*(u808*(u920+u906*u808)+u904))
  Ez(132)=sum(wgt_z*u916)
  u816=-1.36773232375213645d-1*u914*u829
  u914=1.53869886422115351d-1*u883
  u883=-u843
  u843=-u917
  u917=5.64189583547756287d-1*u825
  u921=u474*(u917+u811)
  V(133)=sum(wgt_v*(u808*(u9+u474*(u921+u883)+u88)+u474*(u914+u474*(u847+&
 &u843))+u816))
  Ex(133)=sum(wgt_x*u912)
  Ey(133)=sum(wgt_y*u916)
  u912=(z*(u810*(u920+u906*u810)+u904))
  Ez(133)=sum(wgt_z*u912)
  V(134)=sum(wgt_v*(u465*(u919*u810+u802)))
  Ex(134)=sum(wgt_x*u806)
  Ey(134)=sum(wgt_y*u912)
  u904=u905*u810
  u920=(y*(u810*(u859+u904)+u804))
  Ez(134)=sum(wgt_z*u920)
  V(135)=sum(wgt_v*(u810*(u803+u878*u810)+u907))
  Ex(135)=sum(wgt_x*u94)
  Ey(135)=sum(wgt_y*u920)
  u880=(z*(u810*(u860+u904)+u908))
  Ez(135)=sum(wgt_z*u880)
  u904=u87*u474
  u806=u842+u904
  u905=u891*u474
  u878=u905+u890
  V(136)=sum(wgt_v*(u404*(u808*(u806+u798)+u878)))
  Ex(136)=sum(wgt_x*u910)
  u910=(u863+u815)
  u906=u96*u474
  u847=u781+u906
  u907=u832*u474
  u88=u907+u96
  u908=u870*u474
  u825=u908+u807
  u804=(x*(u808*(u847+u808*(u910*u808+u88))+u825))
  Ey(136)=sum(wgt_y*u804)
  u802=(u815+u863)
  u829=u784+u901
  u901=u902+u894
  u860=(u404*(u808*(u829+u802*u808)+u901)*z)
  Ez(136)=sum(wgt_z*u860)
  u902=u900+u853
  u853=u854+u922
  V(137)=sum(wgt_v*(x*(u808*(u902+u798)+u853)*z))
  Ex(137)=sum(wgt_x*u800)
  Ey(137)=sum(wgt_y*u860)
  u854=u80+u474*(u838*u474+u81)
  u798=u805+u82
  u805=u474*(u79+u899*u474)+u852
  u803=(u864+u823)
  u859=(x*(u808*(u854+u808*(u803*u808+u798))+u805))
  Ez(137)=sum(wgt_z*u859)
  u919=9.23219318532692106d-1*u844
  u94=-u913
  u913=-u869
  u844=u94+u474*(u811+u913)
  u800=u474*(u94+u848)+u919
  V(138)=sum(wgt_v*(u404*(u808*(u844+u861)+u800)))
  Ex(138)=sum(wgt_x*u916)
  Ey(138)=sum(wgt_y*u859)
  u916=-2.34355673165991073d0*u915*(3.99200918570194847d5*u918-u840)
  u861=-2.25675833419102515d0*u915*(1.79640413356587681d7*u918-1.28d2*u&
 &818)
  u918=(u404*(u808*(u863+u474*(u823+u861)+(u823+u864)*u808)+u474*(u863+&
 &u903)+u916)*z)
  Ez(138)=sum(wgt_z*u918)
  V(139)=sum(wgt_v*(u463*(u810*(u844+u801)+u800)))
  Ex(139)=sum(wgt_x*u912)
  Ey(139)=sum(wgt_y*u918)
  u915=(x*(u810*(u854+u810*(u803*u810+u798))+u805))
  Ez(139)=sum(wgt_z*u915)
  V(140)=sum(wgt_v*(u404*(u810*(u902+u841)+u853)))
  Ex(140)=sum(wgt_x*u920)
  Ey(140)=sum(wgt_y*u915)
  u912=(u862*(u810*(u829+u802*u810)+u901))
  Ez(140)=sum(wgt_z*u912)
  V(141)=sum(wgt_v*(u463*(u810*(u806+u841)+u878)))
  Ex(141)=sum(wgt_x*u880)
  Ey(141)=sum(wgt_y*u912)
  u920=(x*(u810*(u847+u810*(u910*u810+u88))+u825))
  Ez(141)=sum(wgt_z*u920)
  u847=u890+u837*u474
  u88=u89*u474+u891
  u798=u785*u474+u822
  V(142)=sum(wgt_v*(u808*(u847+u808*(u909+u88))+u798))
  Ex(142)=sum(wgt_x*u804)
  u825=(u876+u815)
  u805=u825*u808
  u815=u871+u779*u474
  u800=u865*u474+u857
  u801=u871*u474+u780
  u910=(y*(u808*(u815+u808*(u805+u800))+u801))
  Ey(142)=sum(wgt_y*u910)
  u802=u894+u906
  u803=u907+u833
  u804=u908+u875
  u909=((u808*(u802+u808*(u805+u803))+u804)*z)
  Ez(142)=sum(wgt_z*u909)
  u908=(u812+u827)
  u805=u898+u904
  u806=u905+u785
  V(143)=sum(wgt_v*(y*(u808*(u805+u908*u808)+u806)*z))
  Ex(143)=sum(wgt_x*u860)
  Ey(143)=sum(wgt_y*u909)
  u860=u90+u474*(u851*u474+u91)
  u905=u911+u92
  u904=u474*(u833+u872*u474)+u836
  u907=(u774+u823)
  u911=(y*(u808*(u860+u808*(u907*u808+u905))+u904))
  Ez(143)=sum(wgt_z*u911)
  u823=u914+u474*(u849+u883)
  u849=u921+u843
  u812=u474*(u9+u850)+u816
  V(144)=sum(wgt_v*(u808*(u823+u808*(u868+u849))+u812))
  Ex(144)=sum(wgt_x*u859)
  Ey(144)=sum(wgt_y*u911)
  u859=u867*u808
  u868=u808*(u835+u859)
  u921=(z*(u810*(u79+u808*(u868+u81)+(u808*(u838+u859)+u899)*u810)+u808&
 &*(u80+u808*(u864*u808+u82))+u852))
  Ez(144)=sum(wgt_z*u921)
  V(145)=sum(wgt_v*(u465*(u810*(u94+u808*(u814+u913)+u776)+u808*(u94+u856&
 &)+u919)))
  Ex(145)=sum(wgt_x*u918)
  Ey(145)=sum(wgt_y*u921)
  u916=(y*(u810*(u80+u808*(u838*u808+u81)+u810*((u864+u859)*u810+u868+u&
 &82))+u808*(u79+u899*u808)+u852))
  Ez(145)=sum(wgt_z*u916)
  V(146)=sum(wgt_v*(u810*(u823+u810*(u819+u849))+u812))
  Ex(146)=sum(wgt_x*u915)
  Ey(146)=sum(wgt_y*u916)
  u812=(z*(u810*(u860+u810*(u907*u810+u905))+u904))
  Ez(146)=sum(wgt_z*u812)
  V(147)=sum(wgt_v*(u465*(u810*(u805+u908*u810)+u806)))
  Ex(147)=sum(wgt_x*u912)
  Ey(147)=sum(wgt_y*u812)
  u816=u825*u810
  u861=(y*(u810*(u802+u810*(u816+u803))+u804))
  Ez(147)=sum(wgt_z*u861)
  V(148)=sum(wgt_v*(u810*(u847+u810*(u826+u88))+u798))
  Ex(148)=sum(wgt_x*u920)
  Ey(148)=sum(wgt_y*u861)
  u826=(z*(u810*(u815+u810*(u816+u800))+u801))
  Ez(148)=sum(wgt_z*u826)
  u802=(u808*(u895+u808*(u813+u93))+u889)
  V(149)=sum(wgt_v*(u404*u802))
  Ex(149)=sum(wgt_x*u910)
  u816=u888*u808
  u88=(u808*(u824+u808*(u808*(u86+u816)+u874))+u780)
  u801=(x*u88)
  Ey(149)=sum(wgt_y*u801)
  u847=(u404*(u808*(u779+u808*(u816+u865))+u871)*z)
  Ez(149)=sum(wgt_z*u847)
  V(150)=sum(wgt_v*(x*(u808*(u837+u808*(u813+u89))+u785)*z))
  Ex(150)=sum(wgt_x*u909)
  Ey(150)=sum(wgt_y*u847)
  u798=(u870+u808*(u808*(u832+u816)+u96))*u810
  u909=u876*u808
  u815=(x*(u798+u808*(u894+u808*(u909+u833))+u875))
  Ez(150)=sum(wgt_z*u815)
  u803=(u891+u808*(u813+u87))*u810
  u910=u827*u808
  V(151)=sum(wgt_v*(u404*(u803+u808*(u898+u910)+u785)))
  Ex(151)=sum(wgt_x*u911)
  Ey(151)=sum(wgt_y*u815)
  u911=u863*u808
  u800=(u862*((u833+u808*(u816+u873))*u810+u808*(u784+u911)+u894))
  Ez(151)=sum(wgt_z*u800)
  V(152)=sum(wgt_v*(u463*((u9+u808*(u813+u828))*u810+u808*(u900+u855)+u92&
 &2)))
  Ex(152)=sum(wgt_x*u921)
  Ey(152)=sum(wgt_y*u800)
  u804=(u808*(u777+u816)+u809)*u810
  u912=u777*u808
  u913=u809*u808
  u825=(x*(u810*(u887+u808*(u912+u885)+u804)+u808*(u887+u913)+u884))
  Ez(152)=sum(wgt_z*u825)
  u914=u828*u808
  u915=u9*u808
  V(153)=sum(wgt_v*(u404*(u810*(u900+u914+u775)+u915+u922)))
  Ex(153)=sum(wgt_x*u916)
  Ey(153)=sum(wgt_y*u825)
  u916=u873*u808
  u917=u833*u808
  u79=(u862*(u810*(u784+u916+(u816+u863)*u810)+u917+u894))
  Ez(153)=sum(wgt_z*u79)
  u918=u87*u808
  u919=u891*u808
  V(154)=sum(wgt_v*(u463*(u810*(u898+u918+(u813+u827)*u810)+u919+u785)))
  Ex(154)=sum(wgt_x*u812)
  Ey(154)=sum(wgt_y*u79)
  u836=(u876+u816)*u810
  u920=u96*u808
  u921=u832*u808
  u922=u870*u808
  u834=(x*(u810*(u894+u920+u810*(u836+u921+u833))+u922+u875))
  Ez(154)=sum(wgt_z*u834)
  u860=u879*u810
  V(155)=sum(wgt_v*(u404*(u810*(u837+u810*(u860+u89))+u785)))
  Ex(155)=sum(wgt_x*u861)
  Ey(155)=sum(wgt_y*u834)
  u861=u888*u810
  u812=(u862*(u810*(u779+u810*(u861+u865))+u871))
  Ez(155)=sum(wgt_z*u812)
  u774=(u810*(u895+u810*(u860+u93))+u889)
  V(156)=sum(wgt_v*(u463*u774))
  Ex(156)=sum(wgt_x*u826)
  Ey(156)=sum(wgt_y*u812)
  u474=(u810*(u824+u810*(u810*(u86+u861)+u874))+u780)
  u463=(x*u474)
  Ez(156)=sum(wgt_z*u463)
  V(157)=sum(wgt_v*(u808*(u892+u808*(u808*(u99+u813)+u896))+u817))
  Ex(157)=sum(wgt_x*u801)
  Ey(157)=sum(wgt_y*(y*(u808*(u858+u808*(u808*(u839+u816)+u893))+u8)))
  u801=(u88*z)
  Ez(157)=sum(wgt_z*u801)
  V(158)=sum(wgt_v*(y*u802*z))
  Ex(158)=sum(wgt_x*u847)
  Ey(158)=sum(wgt_y*u801)
  u404=(y*((u871+u808*(u808*(u865+u816)+u779))*u810+u808*(u871+u808*(u9&
 &09+u857))+u780))
  Ez(158)=sum(wgt_z*u404)
  V(159)=sum(wgt_v*((u785+u808*(u808*(u89+u813)+u837))*u810+u808*(u890+u8&
 &08*(u910+u891))+u822))
  Ex(159)=sum(wgt_x*u815)
  Ey(159)=sum(wgt_y*u404)
  u404=(z*(u798+u808*(u781+u808*(u911+u96))+u807))
  Ez(159)=sum(wgt_z*u404)
  V(160)=sum(wgt_v*(u465*(u803+u808*(u842+u855)+u890)))
  Ex(160)=sum(wgt_x*u800)
  Ey(160)=sum(wgt_y*u404)
  u404=(y*(u810*(u897+u808*(u912+u783)+(u808*(u873+u816)+u833)*u810)+u8&
 &08*(u782+u913)+u807))
  Ez(160)=sum(wgt_z*u404)
  V(161)=sum(wgt_v*(u810*(u886+u808*(u914+u98)+(u808*(u828+u813)+u9)*u810&
 &)+u808*(u886+u915)+u95))
  Ex(161)=sum(wgt_x*u825)
  Ey(161)=sum(wgt_y*u404)
  u404=(z*(u810*(u782+u808*(u916+u783)+u804)+u808*(u897+u917)+u807))
  Ez(161)=sum(wgt_z*u404)
  V(162)=sum(wgt_v*(u465*(u810*(u842+u918+u775)+u919+u890)))
  Ex(162)=sum(wgt_x*u79)
  Ey(162)=sum(wgt_y*u404)
  u404=(y*(u810*(u781+u920+u810*((u863+u816)*u810+u921+u96))+u922+u807)&
 &)
  Ez(162)=sum(wgt_z*u404)
  V(163)=sum(wgt_v*(u810*(u890+u837*u808+u810*((u827+u813)*u810+u89*u808+&
 &u891))+u785*u808+u822))
  Ex(163)=sum(wgt_x*u834)
  Ey(163)=sum(wgt_y*u404)
  u404=(z*(u810*(u871+u779*u808+u810*(u836+u865*u808+u857))+u871*u808+u&
 &780))
  Ez(163)=sum(wgt_z*u404)
  V(164)=sum(wgt_v*(u465*u774))
  Ex(164)=sum(wgt_x*u812)
  Ey(164)=sum(wgt_y*u404)
  u465=(y*u474)
  Ez(164)=sum(wgt_z*u465)
  V(165)=sum(wgt_v*(u810*(u892+u810*(u810*(u99+u860)+u896))+u817))
  Ex(165)=sum(wgt_x*u463)
  Ey(165)=sum(wgt_y*u465)
  Ez(165)=sum(wgt_z*(z*(u810*(u858+u810*(u810*(u839+u861)+u893))+u8)))
  if ( lmax .eq. 8 ) return
  
  ! if we get here, something went wrong...
  D_X_V_and_E_vec4=.false.
  
  contains
  
  include "Av_functions.h"
  
end function
  
end module
