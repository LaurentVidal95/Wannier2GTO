module mod_D_X_Y_opt_3
  
  use mod_A_functions
  
  implicit none
  
  private
  public :: D_X_Y_opt_3
  
contains
  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_m3(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_m3
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u198
  real(kind=8) :: u199
  real(kind=8) :: u200
  real(kind=8) :: u316
  real(kind=8) :: u317
  real(kind=8) :: u318
  real(kind=8) :: u319
  real(kind=8) :: u32
  real(kind=8) :: u320
  real(kind=8) :: u321
  real(kind=8) :: u322
  real(kind=8) :: u323
  real(kind=8) :: u324
  real(kind=8) :: u325
  real(kind=8) :: u326
  real(kind=8) :: u327
  real(kind=8) :: u328
  real(kind=8) :: u329
  real(kind=8) :: u33
  real(kind=8) :: u330
  real(kind=8) :: u331
  real(kind=8) :: u332
  real(kind=8) :: u333
  real(kind=8) :: u334
  real(kind=8) :: u335
  real(kind=8) :: u336
  real(kind=8) :: u337
  real(kind=8) :: u338
  real(kind=8) :: u339
  real(kind=8) :: u34
  real(kind=8) :: u340
  real(kind=8) :: u341
  real(kind=8) :: u35
  real(kind=8) :: u36
  real(kind=8) :: u37
  real(kind=8) :: u38
  real(kind=8) :: u39
  real(kind=8) :: u4
  real(kind=8) :: u40
  real(kind=8) :: u41
  real(kind=8) :: u42
  real(kind=8) :: u43
  real(kind=8) :: u44
  real(kind=8) :: u45
  real(kind=8) :: u46
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_m3=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u200=a3**(-3)
  u40=exppd2*pd
  u90=-1.41796308072441282d1*u40
  u198=u200*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u90)*p**4
  u334=2.3477088494128144d-2*u198
  u88=-7.04312654823844319d-2*u198
  u198=x**2
  u199=y**2
  value=value+(c(1)*(y*(u334*u199+u88*u198)))
  if ( lmax .eq. 0 ) return
  u334=A5_(p,pd,erfpd,exppd2)
  u88=p**5
  u99=u200*u334*u88
  u319=6.6379903866747395d0*u99
  u37=exppd2*pd2
  u73=-2.83592616144882564d1*u37
  u75=u200*(3.2986722862692829d2*u334+u73)*u88
  u334=2.3477088494128144d-2*u75
  u88=-7.04312654823844319d-2*u75
  u75=x*y
  u323=u334*u199
  u324=u88*u198
  u63=u323+u324
  value=value+(c(2)*(u75*(u63+u319)))
  u319=-3.31899519333736975d0*u99
  u77=+u319
  u55=-u319
  value=value+(c(3)*(u199*(u77+u324+u323)+u55*u198))
  value=value+(c(4)*(y*(u63)*z))
  if ( lmax .eq. 1 ) return
  u77=A6_(p,pd,erfpd,exppd2)
  u55=p**6
  u88=u200*u77*u55
  u334=-6.6379903866747395d0*u88
  u99=+u334
  u324=-2.83592616144882564d1*u40
  u319=u200*(3.2986722862692829d2*u77+u324)*u55
  u63=-2.3477088494128144d-2*u319
  u4=3.5215632741192216d-1*u319
  u323=2.0d0*pd2
  u322=(9.0d0+u323)
  u64=u200*(2.96880505764235461d3*u77+u324*u322)*u55
  u77=2.3477088494128144d-2*u64
  u55=-7.04312654823844319d-2*u64
  u64=u55*u198
  value=value+(c(5)*(y*((u63+u77*u198)*u199+u198*(u4+u64)+u99)))
  u4=7.04312654823844319d-2*u319
  u325=u77*u199
  u56=u64+u325
  u58=u4*u198
  value=value+(c(6)*(x*(u199*(u4+u56)+u58+u99)))
  u99=1.40862530964768864d-1*u319
  value=value+(c(7)*(u75*(u325+u64+u99)*z))
  u99=-u334
  u325=-1.64339619458897008d-1*u319
  u88=2.11293796447153296d-1*u319
  value=value+(c(8)*(y*(u199*(u325+u56)+u88*u198+u99)))
  u325=-7.04312654823844319d-2*u319
  value=value+(c(9)*((u199*(u325+u56)+u58)*z))
  u325=z**2
  value=value+(c(10)*(y*((u56)*u325+u63*u199+u58)))
  if ( lmax .eq. 2 ) return
  u88=A7_(p,pd,erfpd,exppd2)
  u99=p**7
  u63=u200*u88*u99
  u4=-2.78795596240339059d2*u63
  u319=-5.67185232289765129d1*u37
  u334=u200*(2.96880505764235461d3*u88+u319)*u99
  u56=-7.04312654823844319d-2*u334
  u64=6.33881389341459887d-1*u334
  u58=(1.1d1+u323)
  u327=u200*(3.26568556340659007d4*u88+u319*u58)*u99
  u76=2.3477088494128144d-2*u327
  u53=-7.04312654823844319d-2*u327
  u98=u53*u198
  u60=u76*u198
  value=value+(c(11)*(u75*((u56+u60)*u199+u198*(u64+u98)+u4)))
  u4=3.2986722862692829d2*u88
  u64=2.83592616144882564d1*exppd2
  u47=2.01232187092526948d-2*u200*(u4+u64)*u99
  u316=-2.32329663533615882d1*u63
  u43=+u316
  u68=-2.3477088494128144d-2*u334
  u45=-1.16164831766807941d2*u63
  u55=2.81725061929537728d-1*u334
  u94=7.04312654823844319d-2*u334
  u326=u94*u198
  value=value+(c(12)*(u199*(u43+u198*(u98+u55)+(u60+u68)*u199)+u198*(u4&
 &5+u326)+u47))
  u47=-4.64659327067231765d1*u63
  u45=+u47
  u55=3.5215632741192216d-1*u334
  value=value+(c(13)*(y*((u68+u60)*u199+u198*(u55+u98)+u45)*z))
  u55=-9.29318654134463529d1*u63
  u60=2.11293796447153296d-1*u334
  u89=u76*u199
  u49=u98+u89
  u328=u60*u198
  value=value+(c(14)*(u75*(u199*(u68+u49)+u328+u55)))
  u55=u326+u45
  value=value+(c(15)*(x*(u199*(u94+u49)+u55)*z))
  u61=1.40862530964768864d-1*u334
  value=value+(c(16)*(u75*((u61+u49)*u325+u68*u199+u55)))
  u61=-2.01232187092526948d-2*u200*(u64+u4)*u99
  u68=2.09096697180254294d2*u63
  u45=-2.81725061929537728d-1*u334
  u4=-6.96988990600847647d1*u63
  u64=4.22587592894306592d-1*u334
  value=value+(c(17)*(u199*(u68+u64*u198+u199*(u89+u98+u45))+u4*u198+u6&
 &1))
  u4=-u47
  u326=-1.64339619458897008d-1*u334
  value=value+(c(18)*(y*(u199*(u326+u49)+u328+u4)*z))
  u4=-u316
  u326=7.04312654823844319d-2*u200
  u64=u326*(3.62853951489621119d3*u88+u319)*u99
  u61=-1.40862530964768864d-1*u334
  u68=-9.39083539765125759d-2*u334
  u334=-2.81725061929537728d-1*u200
  u63=+u334*(8.90641517292706383d3*u88+u73*(6.0d0+pd2))*u99
  u88=7.04312654823844319d-2*u327
  u327=u88*u198
  value=value+(c(19)*((u4+u199*(u89+u61))*u325+u199*(u64+u198*(u327+u63&
 &)+(u327+u68)*u199)+u198*(u94+u56*u198)+u43))
  u55=y*z
  value=value+(c(20)*(u55*((u49)*u325+u56*u199+u328)))
  if ( lmax .eq. 3 ) return
  u64=A8_(p,pd,erfpd,exppd2)
  u61=p**8
  u68=u200*u64*u61
  u63=2.78795596240339059d2*u68
  u53=-5.67185232289765129d1*u40
  u94=u200*(2.96880505764235461d3*u64+u53)*u61
  u60=7.04312654823844319d-2*u94
  u43=-2.74681935381299285d0*u94
  u4=3.26568556340659007d4*u64
  u99=u200*(u4+u53*u58)*u61
  u58=-1.40862530964768864d-1*u99
  u56=9.86037716753382047d-1*u99
  u327=pd2**2
  u77=4.0d0*u327
  u319=(u323+1.1d1)
  u45=u200*(4.24539123242856709d5*u64+u53*(1.3d1*u319+u77))*u61
  u316=2.3477088494128144d-2*u45
  u47=-7.04312654823844319d-2*u45
  u49=u47*u198
  u86=u316*u198
  value=value+(c(21)*(y*((u60+u198*(u86+u58))*u199+u198*(u43+u198*(u49+&
 &u56))+u63)))
  u43=-6.33881389341459887d-1*u94
  u56=-7.04312654823844319d-2*u99
  u98=5.63450123859075456d-1*u99
  u89=7.04312654823844319d-2*u99
  u328=u89*u198
  value=value+(c(22)*(x*(u199*(u43+u198*(u49+u98)+(u86+u56)*u199)+u198*&
 &(u43+u328)+u63)))
  u98=-8.45175185788613183d-1*u94
  u43=6.33881389341459887d-1*u99
  value=value+(c(23)*(u75*((u56+u86)*u199+u198*(u43+u49)+u98)*z))
  u98=9.29318654134463529d1*u68
  u43=2.3477088494128144d-2*u94
  u63=-2.3477088494128144d-2*u99
  u32=-9.15606451270997615d-1*u94
  u7=1.87816707953025152d-1*u99
  u80=2.11293796447153296d-1*u99
  u36=(u86+u63)*u199
  u86=u80*u198
  value=value+(c(24)*(y*(u199*(u43+u198*(u49+u7)+u36)+u198*(u32+u86)+u9&
 &8)))
  u43=4.64659327067231765d1*u68
  u32=-7.04312654823844319d-2*u94
  u7=-3.5215632741192216d-1*u94
  u88=2.81725061929537728d-1*u99
  value=value+(c(25)*((u199*(u32+u198*(u49+u88)+u36)+u198*(u7+u328)+u43&
 &)*z))
  u32=u326*(3.62853951489621119d3*u64+u53)*u61
  u7=-2.11293796447153296d-1*u94
  u88=(1.3d1+u323)
  u328=u40*u88
  u36=u200*(3.85944657493506099d4*u64-5.67185232289765129d1*u328)*u61
  u97=-2.3477088494128144d-2*u36
  u6=2.3477088494128144d-2*u99
  u76=-7.04312654823844319d-2*u200
  u333=(1.7d1+u323)
  u89=u40*u333
  u79=+u76*(5.04696859799200284d4*u64-5.67185232289765129d1*u89)*u61
  u82=4.22587592894306592d-1*u99
  u51=u200*(u4+u90*(4.0d0*u319+u327))*u61
  u4=3.75633415906050304d-1*u51
  u319=-2.3477088494128144d-2*u45
  u90=1.40862530964768864d-1*u99
  u329=u319*u198
  value=value+(c(26)*(y*((u7+u198*(u49+u82))*u325+u199*(u97+u198*(u329+&
 &u4)+(u329+u6)*u199)+u198*(u79+u90*u198)+u32)))
  u32=u316*u199
  u97=u32+u49
  u6=u82*u198
  u79=u7*u198
  value=value+(c(27)*(x*(u199*(u7+u6+u199*(u97+u58))+u79+u98)))
  u4=-2.81725061929537728d-1*u94
  u98=u49+u32
  value=value+(c(28)*(u75*(u199*(u63+u98)+u86+u4)*z))
  u63=-2.11293796447153296d-1*u200
  u4=+u63*(2.74889357189106908d3*u64+u53)*u61
  u319=6.0d0*pd2
  u329=u40*(3.5d1+u319)
  u49=u326*(1.03908177017482411d5*u64-5.67185232289765129d1*u329)*u61
  u67=-2.3477088494128144d-1*u99
  u330=7.04312654823844319d-2*u36
  u36=-1.12690024771815091d0*u51
  u39=7.04312654823844319d-2*u45
  u33=u39*u198
  u44=u198*(u33+u36)
  u87=u199*(u32+u58)
  value=value+(c(29)*(x*((u60+u87)*u325+u199*(u49+u44+(u33+u67)*u199)+u&
 &198*(u330+u56*u198)+u4)))
  u49=-4.22587592894306592d-1*u94
  u45=u75*z
  u330=u56*u199
  value=value+(c(30)*(u45*((u90+u98)*u325+u330+u86+u49)))
  u90=-4.64659327067231765d2*u68
  u49=1.7607816370596108d0*u94
  u4=-4.22587592894306592d-1*u99
  u98=-1.05646898223576648d0*u94
  u86=7.0431265482384432d-1*u99
  value=value+(c(31)*(y*(u199*(u49+u86*u198+u199*(u97+u4))+u98*u198+u90&
 &)))
  u98=-u43
  u86=6.33881389341459887d-1*u94
  u90=-2.81725061929537728d-1*u99
  value=value+(c(32)*((u199*(u86+u6+u199*(u97+u90))+u79+u98)*z))
  u98=+u63*(3.18871654339364014d3*u64+u53)*u61
  u86=3.5215632741192216d-1*u94
  u90=2.3477088494128144d-2*u200
  u49=u90*(1.45471447824475376d5*u64+u53*(4.9d1+u319))*u61
  u4=-9.39083539765125759d-2*u99
  u68=-2.11293796447153296d-1*u99
  u43=u198*(u80+u68*u198)
  value=value+(c(33)*(y*((u86+u199*(u32+u67))*u325+u199*(u49+u44+(u33+u&
 &4)*u199)+u43+u98)))
  u67=1.40862530964768864d-1*u200
  u4=u67*(2.07816354034964823d4*u64+u53*(7.0d0+pd2))*u61
  u86=4.22587592894306592d-1*u94
  value=value+(c(34)*(z*(u325*(u4+u44+u87+(u33+u56)*u325)+u199*(u86+u33&
 &0)+u43+u7)))
  value=value+(c(35)*(y*(u325*(u6+u58*u199+(u97)*u325)+u60*u199+u79)))
  if ( lmax .eq. 4 ) return
  u4=A9_(p,pd,erfpd,exppd2)
  u86=p**9
  u49=u200*u4*u86
  u7=1.88187027462228865d4*u49
  u60=-1.13437046457953026d2*u37
  u47=u200*(3.26568556340659007d4*u4+u60)*u86
  u94=3.5215632741192216d-1*u47
  u64=-6.69097022082652103d0*u47
  u98=u200*(4.24539123242856709d5*u4+u60*u88)*u86
  u61=-2.3477088494128144d-1*u98
  u43=1.40862530964768864d0*u98
  u36=(u323+1.3d1)
  u82=(1.5d1*u36+u77)
  u44=u200*(6.36808684864285064d6*u4+u60*u82)*u86
  u87=2.3477088494128144d-2*u44
  u97=-7.04312654823844319d-2*u44
  u316=u97*u198
  u32=u87*u198
  value=value+(c(36)*(u75*((u94+u198*(u32+u61))*u199+u198*(u64+u198*(u3&
 &16+u43))+u7)))
  u7=2.96880505764235461d3*u4
  u64=5.67185232289765129d1*exppd2
  u43=u200*(u64+u7)*u86
  u33=-9.39083539765125759d-2*u43
  u6=1.88187027462228865d3*u49
  u79=7.04312654823844319d-2*u47
  u39=8.15477119002991747d3*u49
  u74=-2.32423176091868626d0*u47
  u54=-1.40862530964768864d-1*u98
  u339=-9.86037716753382047d-1*u47
  u59=9.15606451270997615d-1*u98
  u78=7.04312654823844319d-2*u98
  u331=u78*u198
  value=value+(c(37)*(u199*(u6+u198*(u198*(u59+u316)+u74)+(u198*(u54+u3&
 &2)+u79)*u199)+u198*(u39+u198*(u331+u339))+u33))
  u33=2.50916036616305153d3*u49
  u74=-2.74681935381299285d0*u47
  u339=9.86037716753382047d-1*u98
  value=value+(c(38)*(y*((u79+u198*(u32+u54))*u199+u198*(u74+u198*(u316&
 &+u339))+u33)*z))
  u74=6.27290091540762882d3*u49
  u339=-3.5215632741192216d-1*u47
  u59=-7.04312654823844319d-2*u98
  u6=-1.7607816370596108d0*u47
  u39=+u6
  u93=4.6954176988256288d-1*u98
  u85=2.11293796447153296d-1*u98
  u69=(u32+u59)*u199
  u72=u85*u198
  value=value+(c(39)*(u75*(u199*(u339+u198*(u316+u93)+u69)+u198*(u39+u7&
 &2)+u74)))
  u93=-6.33881389341459887d-1*u47
  u339=5.63450123859075456d-1*u98
  value=value+(c(40)*(x*(u199*(u93+u198*(u316+u339)+u69)+u198*(u93+u331&
 &)+u33)*z))
  u331=2.11293796447153296d-1*u200
  u93=u331*(4.45320758646353191d4*u4+u60)*u86
  u339=-1.05646898223576648d0*u47
  u74=+u339
  u33=(1.5d1+u323)
  u39=u200*(4.89852834510988511d5*u4+u60*u33)*u86
  u69=-7.04312654823844319d-2*u39
  u9=8.16421390851647518d5*u4
  u56=(2.5d1+u323)
  u34=+u76*(u9+u60*u56)*u86
  u83=7.0431265482384432d-1*u98
  u330=5.0d0*u36
  u58=(u330+u327)
  u52=u200*(2.12269561621428355d6*u4+u60*u58)*u86
  u46=9.39083539765125759d-2*u52
  u92=-2.3477088494128144d-2*u44
  u91=1.40862530964768864d-1*u98
  u338=u92*u198
  value=value+(c(41)*(u75*((u74+u198*(u316+u83))*u325+u199*(u69+u198*(u&
 &338+u46)+(u338+u78)*u199)+u198*(u34+u91*u198)+u93)))
  u93=-3.13027846588375253d-2*u43
  u34=6.27290091540762882d2*u49
  u43=1.40862530964768864d-1*u47
  u70=-2.3477088494128144d-2*u98
  u68=2.71825706334330582d3*u49
  u62=-1.47905657513007307d0*u47
  u50=-2.11293796447153296d-1*u47
  u84=4.22587592894306592d-1*u98
  u335=u84*u198
  u65=u50*u198
  value=value+(c(42)*(u199*(u34+u198*(u335+u62)+u199*((u70+u32)*u199+u1&
 &98*(u78+u316)+u43))+u198*(u68+u65)+u93))
  u93=8.36386788721017177d2*u49
  u43=2.3477088494128144d-2*u47
  u68=-9.15606451270997615d-1*u47
  u62=1.87816707953025152d-1*u98
  value=value+(c(43)*(y*(u199*(u43+u198*(u316+u62)+(u32+u70)*u199)+u198&
 &*(u68+u72)+u93)*z))
  u43=1.25211138635350101d-1*u200*(u7-7.08981540362206411d0*exppd2)*u86
  u68=+u334*(8.90641517292706383d3*u4+u73)*u86
  u62=2.93911700706593106d5*u4
  u80=-2.3477088494128144d-2*u200
  u334=+u80*(u62+u60*u322)*u86
  u322=2.3477088494128144d-2*u98
  u32=-1.40862530964768864d0*u200*(7.71889314987012199d3*u4+u73)*u86
  u70=4.0d0*pd2
  u73=u200*(8.81735102119779319d5*u4+u60*(2.7d1+u70))*u86
  u332=1.40862530964768864d-1*u73
  u336=u90*(1.27361736972857013d6*u4+u60*(3.0d0*u36+u77))*u86
  u71=u326*(5.55166545779120312d5*u4+u60*u333)*u86
  u333=+u76*(8.06624334161427748d6*u4+u60*(1.9d1*u36+u77))*u86
  u66=4.6954176988256288d-2*u44
  u42=7.04312654823844319d-2*u44
  u99=u42*u198
  value=value+(c(44)*(u199*(u68+u198*(u198*(u333+u99)+u332)+u199*((u322&
 &+u338)*u199+u198*(u336+u66*u198)+u334))+u198*(u32+u198*(u59*u198+u71)&
 &)+u43))
  u43=u200*(3.85944657493506099d4*u4+u60)*u86
  u32=2.11293796447153296d-1*u43
  u68=-1.40862530964768864d-1*u200
  u71=+u68*(u62+u60*(9.0d0+pd2))*u86
  u66=-1.26776277868291978d0*u47
  u332=u92*u199
  value=value+(c(45)*(u55*(u325*(u71+u198*(u316+u84)+u199*(u332+u46)+(u&
 &332+u78)*u325)+u199*(u69+u78*u199)+u198*(u66+u72)+u32)))
  u32=2.09096697180254294d3*u49
  u71=-2.81725061929537728d-1*u98
  u85=u87*u199
  u66=u85+u316
  u46=u83*u198
  u78=u74*u198
  value=value+(c(46)*(u75*(u199*(u94+u46+u199*(u66+u71))+u78+u32)))
  value=value+(c(47)*(x*(u199*(u50+u335+u199*(u66+u54))+u65+u93)*z))
  u32=-6.33881389341459887d-1*u200
  u336=+u32*(3.13373867195581876d4*u4+u60)*u86
  u93=u90*(4.7352440669395556d6*u4+u60*(1.45d2+1.8d1*pd2))*u86
  u92=2.11293796447153296d-1*u39
  u39=-2.81725061929537728d-1*u52
  u62=-2.11293796447153296d-1*u98
  u334=u198*(u99+u39)
  u72=u198*(u92+u62*u198)
  value=value+(c(48)*(u75*((u94+u199*(u85+u61))*u325+u199*(u93+u334+(u9&
 &9+u61)*u199)+u72+u336)))
  u336=+u32*(3.0677652262304331d4*u4+u60)*u86
  u93=7.51107679583515716d5*u4
  u338=3.0d0*pd2
  u322=u67*(u93+u60*(2.3d1+u338))*u86
  u333=4.22587592894306592d-1*u47
  value=value+(c(49)*(x*z*(u325*(u322+u334+u199*(u85+u54)+(u99+u62)*u32&
 &5)+u199*(u333+u59*u199)+u72+u336)))
  u336=1.25458018308152576d3*u49
  u322=-8.45175185788613183d-1*u47
  u333=u54*u199
  u334=u79*u199
  value=value+(c(50)*(u75*(u325*(u322+u335+u333+(u66+u91)*u325)+u334+u6&
 &5+u336)))
  u322=1.56513923294187627d-1*u200*(u7+u64)*u86
  u7=-1.9864186232124158d4*u49
  u64=3.87371960153114376d0*u47
  u72=-5.869272123532036d-1*u98
  u335=3.13645045770381441d3*u49
  u69=-3.16940694670729944d0*u47
  u65=1.05646898223576648d0*u98
  value=value+(c(51)*(u199*(u7+u69*u198+u199*(u199*(u72+u316+u85)+u65*u&
 &198+u64))+u335*u198+u322))
  u72=-4.18193394360508588d3*u49
  u335=-u6
  u64=-4.22587592894306592d-1*u98
  value=value+(c(52)*(y*(u199*(u335+u46+u199*(u66+u64))+u78+u72)*z))
  u72=7.82569616470938133d-3*u200*(8.60953466716282837d4*u4+1.134370464&
 &57953026d2*exppd2)*u86
  u335=-1.04548348590127147d3*u49
  u69=-4.22587592894306592d-1*u43
  u65=-u339
  u322=u326*(u93+u60*(2.3d1+u323))*u86
  u7=-3.5215632741192216d-1*u98
  u91=-9.39083539765125759d-2*u98
  u93=2.11293796447153296d-1*u73
  u73=+u76*(8.9153215880999909d6*u4+u60*(2.1d1*u36+u77))*u86
  u43=2.11293796447153296d-1*u47
  u6=u198*(u64*u198+u93)
  u339=u198*(u73+u99)
  u52=u198*(u50+u43*u198)
  value=value+(c(53)*((u335+u199*(u199*(u7+u85)+u65))*u325+u199*(u69+u6&
 &+u199*((u91+u99)*u199+u339+u322))+u52+u72))
  u72=+u32*(3.46360590058274705d4*u4+u60)*u86
  u98=(2.5d1+u338)
  u69=u67*(u9+u60*u98)*u86
  u91=(5.5d1+u319)
  u335=u326*(1.79612705987362454d6*u4+u60*u91)*u86
  u7=3.5d1*u36
  u65=-4.6954176988256288d-2*u200*(1.48588693134999848d7*u4+u60*(u7+6.0&
 &d0*u327))*u86
  u9=9.39083539765125759d-2*u44
  value=value+(c(54)*(u55*(u325*(u69+u199*(u9*u199+u65)+(u42*u199+u62)*&
 &u325)+u199*(u335+u71*u199)+u72)))
  u9=+u63*(6.8282516325774156d4*u4-2.26874092915906051d2*u37)*u86
  u44=u326*(6.20480257047252114d5*u4+u60*(1.9d1+u323))*u86
  u4=-u336
  u72=8.45175185788613183d-1*u47
  value=value+(c(55)*(u325*(u9+u6+u199*(u333+u72)+u325*((u59+u99)*u325+&
 &u199*(u54+u85)+u339+u44))+u199*(u4+u334)+u52+u34))
  value=value+(c(56)*(u55*(u325*(u46+u61*u199+(u66)*u325)+u94*u199+u78)&
 &))
  if ( lmax .eq. 5 ) return
  u85=A10_(p,pd,erfpd,exppd2)
  u44=p**10
  u78=u200*u85*u44
  u69=-1.88187027462228865d4*u78
  u52=-1.13437046457953026d2*u40
  u46=u200*(3.26568556340659007d4*u85+u52)*u44
  u55=-3.5215632741192216d-1*u46
  u74=2.6411724555894162d1*u46
  u97=u200*(4.24539123242856709d5*u85-1.13437046457953026d2*u328)*u44
  u333=1.05646898223576648d0*u97
  u79=-1.37340967690649642d1*u97
  u43=u200*(6.36808684864285064d6*u85+u52*u82)*u44
  u71=-3.5215632741192216d-1*u43
  u54=1.90164416802437966d0*u43
  u83=(u77+1.5d1*u88)
  u39=pd2**3
  u334=8.0d0*u39
  u9=u200*(1.08257476426928461d8*u85+u52*(1.7d1*u83+u334))*u44
  u4=2.3477088494128144d-2*u9
  u88=-7.04312654823844319d-2*u9
  u84=u88*u198
  u316=u4*u198
  value=value+(c(57)*(y*((u55+u198*(u198*(u71+u316)+u333))*u199+u198*(u&
 &74+u198*(u198*(u54+u84)+u79))+u69)))
  u74=5.2823449111788324d0*u46
  u79=3.5215632741192216d-1*u97
  u54=6.69097022082652103d0*u46
  u93=-5.98665756600267671d0*u97
  u328=-2.3477088494128144d-1*u43
  u59=-1.40862530964768864d0*u97
  u72=+u59
  u86=1.33819404416530421d0*u43
  u332=7.04312654823844319d-2*u43
  u335=u332*u198
  value=value+(c(58)*(x*(u199*(u74+u198*(u198*(u86+u84)+u93)+(u198*(u32&
 &8+u316)+u79)*u199)+u198*(u54+u198*(u335+u72))+u69)))
  u74=6.33881389341459888d0*u46
  u93=-6.69097022082652103d0*u97
  u86=1.40862530964768864d0*u43
  value=value+(c(59)*(u75*((u79+u198*(u316+u328))*u199+u198*(u93+u198*(&
 &u84+u86))+u74)*z))
  u74=-6.27290091540762882d3*u78
  u93=3.5215632741192216d-1*u46
  u86=7.04312654823844319d-2*u97
  u69=7.39528287565036535d0*u46
  u64=-1.7607816370596108d0*u97
  u65=+u64
  u61=-1.40862530964768864d-1*u43
  u60=-2.81725061929537728d0*u97
  u92=8.2169809729448504d-1*u43
  u37=2.11293796447153296d-1*u43
  u323=(u198*(u61+u316)+u86)*u199
  u336=u37*u198
  value=value+(c(60)*(y*(u199*(u93+u198*(u198*(u92+u84)+u65)+u323)+u198&
 &*(u69+u198*(u336+u60))+u74)))
  u93=-2.50916036616305153d3*u78
  u60=6.33881389341459887d-1*u46
  u92=2.74681935381299285d0*u46
  u94=-2.32423176091868626d0*u97
  u73=-9.86037716753382047d-1*u97
  u50=9.15606451270997615d-1*u43
  value=value+(c(61)*((u199*(u60+u198*(u198*(u50+u84)+u94)+u323)+u198*(&
 &u92+u198*(u335+u73))+u93)*z))
  u93=+u63*(4.45320758646353191d4*u85+u52)*u44
  u335=1.05646898223576648d0*u46
  u323=u200*(4.89852834510988511d5*u85+u52*u33)*u44
  u94=7.04312654823844319d-2*u323
  u73=-7.04312654823844319d-2*u97
  u50=1.63284278170329504d5*u85
  u92=1.69035037157722637d0*u200*(u50+u53*(1.0d1+pd2))*u44
  u60=-3.16940694670729944d0*u97
  u33=1.48588693134999848d7*u85
  u62=8.0d0*u327
  u47=u200*(u33+u52*(u7+u62))*u44
  u322=-7.04312654823844319d-2*u47
  u32=1.40862530964768864d-1*u43
  u319=+u76*(u33+u52*(u7+u77))*u44
  u33=1.05646898223576648d0*u43
  u7=u200*(1.59202171216071266d8*u85+u52*(2.5d1*u83+u334))*u44
  u6=2.3477088494128144d-2*u7
  u339=-2.3477088494128144d-2*u9
  u49=u339*u198
  value=value+(c(62)*(y*((u335+u198*(u198*(u33+u84)+u60))*u325+u199*(u9&
 &4+u198*(u198*(u6+u49)+u322)+(u198*(u32+u49)+u73)*u199)+u198*(u92+u198&
 &*(u32*u198+u319))+u93)))
  u93=3.16940694670729944d0*u46
  u92=-7.04312654823844319d-2*u43
  u319=1.7607816370596108d0*u46
  u87=3.5215632741192216d-1*u43
  u66=-2.11293796447153296d-1*u97
  u34=4.22587592894306592d-1*u43
  u42=(u316+u92)
  u99=u34*u198
  u51=u66*u198
  value=value+(c(63)*(x*(u199*(u93+u198*((u87+u84)*u199+u99+u60)+u42*y*&
 &*4)+u198*(u319+u51)+u74)))
  u93=2.11293796447153296d0*u46
  u319=-3.5215632741192216d-1*u97
  u87=4.6954176988256288d-1*u43
  value=value+(c(64)*(u75*(u199*(u319+u198*(u84+u87)+u42*u199)+u198*(u6&
 &5+u336)+u93)*z))
  u319=u200*(1.48440252882117731d4*u85+u53)*u44
  u87=1.69035037157722637d0*u319
  u53=u200*(u50+u324*(2.0d1+u338))*u44
  u74=-1.69035037157722637d0*u53
  u338=2.12269561621428355d6*u85
  u42=+u76*(u338+u52*(u330+u77))*u44
  u330=2.75950430107856861d7*u85
  u341=1.6d1*u327
  u324=6.5d1*u36
  u57=u67*(u330+u52*(u324+u341))*u44
  u320=3.18404342432142532d7*u85
  u95=+u80*(-u52*(u334-5.0d0*u82)+u320)*u44
  u48=u200*(9.76439983458570431d6*u85+u52*(2.3d1*u36+u77))*u44
  u35=7.04312654823844319d-2*u48
  u82=-7.04312654823844319d-2*u7
  u7=4.6954176988256288d-2*u9
  u5=7.04312654823844319d-2*u9
  u336=u5*u198
  u67=u198*(u82+u336)
  u337=u7*u198
  value=value+(c(65)*(x*(u199*(u74+u198*(u67+u57)+u199*((u332+u49)*u199&
 &+u198*(u95+u337)+u42))+u198*(u74+u198*(u92*u198+u35))+u87)))
  u74=8.16421390851647518d5*u85
  u42=u331*(u74+u52*u56)*u44
  u57=-u333
  u95=+u76*(1.91042605459285519d7*u85+u52*(4.5d1*u36+u77))*u44
  u35=7.0431265482384432d-1*u43
  u56=u200*(u320+u52*(5.0d0*u83+2.0d0*u39))*u44
  u87=9.39083539765125759d-2*u56
  u41=2.81725061929537728d-1*u43
  value=value+(c(66)*(u45*((u57+u198*(u84+u35))*u325+u199*(u92+u198*(u4&
 &9+u87)+(u49+u332)*u199)+u198*(u95+u41*u198)+u42)))
  u42=-2.09096697180254294d3*u78
  u95=2.81725061929537728d-1*u97
  u87=-2.3477088494128144d-2*u43
  u41=3.87371960153114376d0*u46
  u321=(u87+u316)*u199
  u316=u35*u198
  u317=u57*u198
  value=value+(c(67)*(y*(u199*(u55+u198*(u316+u65)+u199*(u321+u198*(u92&
 &+u84)+u95))+u198*(u41+u317)+u42)))
  u41=-8.36386788721017177d2*u78
  u340=2.11293796447153296d-1*u46
  u96=1.40862530964768864d-1*u97
  u38=9.15606451270997615d-1*u46
  u8=-1.47905657513007307d0*u97
  value=value+(c(68)*((u199*(u340+u198*(u99+u8)+u199*(u321+u198*(u332+u&
 &84)+u96))+u198*(u38+u51)+u41)*z))
  u41=5.63450123859075456d-1*u319
  u340=-5.32634315641177742d0*u200*u40*pd2*u44
  u38=2.3477088494128144d-2*u43
  u8=-2.25380049543630182d0*u200*(u50-7.08981540362206411d0*u40*(8.0d1+&
 &1.3d1*pd2))*u44
  u50=4.6954176988256288d-2*u200*(u320+u52*(7.5d1*u36+u341))*u44
  u320=u90*(5.73127816377856558d7*u85+u52*(9.0d0*u83+u334))*u44
  u341=1.2d1*u327
  u40=u326*(2.3349651778357119d7*u85+u52*(5.5d1*u36+u341))*u44
  u65=2.4d1*u39
  u321=+u80*(4.13925645161785292d8*u85+u52*(6.5d1*u83+u65))*u44
  u90=-2.11293796447153296d-1*u43
  u318=u90*u198
  value=value+(c(69)*(y*(u199*(u340+u198*(u198*(u321+u336)+u50)+u199*((&
 &u38+u49)*u199+u198*(u320+u337)+u87))+u198*(u8+u198*(u318+u40))+u41)))
  u41=8.45175185788613183d-1*u319
  u49=-1.40862530964768864d-1*u323
  u38=u200*(u74+u52*(2.5d1+u70))*u44
  u8=2.11293796447153296d-1*u38
  u50=u200*(u338+u52*u58)*u44
  u320=-2.81725061929537728d-1*u50
  u321=-6.33881389341459887d-1*u38
  u38=2.11293796447153296d-1*u47
  u47=-4.22587592894306592d-1*u43
  u338=8.45175185788613183d-1*u50
  u319=u339*u199
  u87=u199*(u6+u319)
  value=value+(c(70)*(z*(u325*(u49+u198*(u67+u38)+u199*(u87+u322)+(u199&
 &*(u32+u319)+u198*(u47+u336)+u96)*u325)+u199*(u8+u199*(u332*u199+u320)&
 &)+u198*(u321+u198*(u318+u338))+u41)))
  u338=+u63*(3.85944657493506099d4*u85+u52)*u44
  u321=u331*(1.01236252465604292d6*u85+u52*(3.1d1+u70))*u44
  u8=-7.04312654823844319d-2*u48
  u41=1.26776277868291978d0*u46
  u320=-2.53552555736583955d0*u97
  value=value+(c(71)*(y*(u325*(u321+u198*(u99+u320)+u199*(u32*u199+u322&
 &)+u325*((u332+u319)*u325+u87+u198*(u34+u84)+u8))+u199*(u94+u73*u199)+&
 &u198*(u41+u51)+u338)))
  u338=-u64
  u64=-4.46064681388434736d-1*u43
  u319=u4*u199
  u332=u84+u319
  u320=u60*u198
  u321=u33*u198
  u322=u335*u198
  value=value+(c(72)*(x*(u199*(u55+u320+u199*(u199*(u64+u332)+u321+u338&
 &))+u322+u42)))
  u338=7.0431265482384432d-1*u46
  u64=-2.81725061929537728d-1*u43
  u42=u319+u84
  value=value+(c(73)*(u75*(u199*(u79+u316+u199*(u42+u64))+u317+u338)*z)&
 &)
  u84=6.33881389341459887d-1*u200
  u338=u84*(3.13373867195581876d4*u85+u52)*u44
  u339=-3.38070074315445273d0*u53
  u41=u326*(u330+u52*(u324+u341))*u44
  u75=-2.11293796447153296d-1*u323
  u87=2.11293796447153296d-1*u97
  u8=u198*(u47*u198+u38)
  u49=u198*(u75+u87*u198)
  value=value+(c(74)*(x*((u55+u199*(u199*(u71+u319)+u333))*u325+u199*(u&
 &339+u8+u199*((u328+u336)*u199+u67+u41))+u49+u338)))
  u338=+u63*(1.14298994719230652d6*u85-1.13437046457953026d2*u329)*u44
  u339=-2.81725061929537728d-1*u56
  value=value+(c(75)*(u45*((u79+u199*(u319+u328))*u325+u199*(u40+u198*(&
 &u336+u339)+(u336+u64)*u199)+u198*(u37+u318)+u338)))
  u338=u84*(3.0677652262304331d4*u85+u52)*u44
  u318=1.2d1*pd2
  u339=+u63*(2.51457788382307436d6*u85+u52*(7.7d1+u318))*u44
  u340=u326*(2.58968865178142593d7*u85+u52*(6.1d1*u36+u341))*u44
  u341=-4.22587592894306592d-1*u46
  u40=8.45175185788613183d-1*u97
  u37=u199*(u61+u319)
  value=value+(c(76)*(x*(u325*(u339+u8+u199*(u61*u199+u40)+u325*((u90+u&
 &336)*u325+u37+u67+u340))+u199*(u341+u86*u199)+u49+u338)))
  u338=u328*u199
  u339=u79*u199
  value=value+(c(77)*(u45*(u325*(u72+u316+u338+(u42+u32)*u325)+u339+u31&
 &7+u93)))
  u340=4.39103064078534018d4*u78
  u341=-2.21858486269510961d1*u46
  u317=7.39528287565036535d0*u97
  u8=-7.74743920306228751d-1*u43
  u49=-u317
  u42=1.47905657513007307d0*u43
  value=value+(c(78)*(y*(u199*(u341+u49*u198+u199*(u199*(u8+u332)+u42*u&
 &198+u317))+u69*u198+u340)))
  u8=4.18193394360508588d3*u78
  u340=-u54
  u341=3.87371960153114376d0*u97
  u49=-5.869272123532036d-1*u43
  value=value+(c(79)*((u199*(u340+u320+u199*(u199*(u49+u332)+u321+u341)&
 &)+u322+u8)*z))
  u78=1.05646898223576648d0*u200*(3.66152623775890402d4*u85+u52)*u44
  u340=-2.46509429188345512d0*u46
  u341=-7.0431265482384432d-1*u200*(5.55166545779120312d5*u85-1.1343704&
 &6457953026d2*u89)*u44
  u89=2.46509429188345512d0*u97
  u49=u326*(1.3160712820528558d7*u85+u52*(3.1d1*u36+u77))*u44
  u54=-4.93018858376691024d-1*u43
  u8=-9.39083539765125759d-2*u43
  u42=3.5215632741192216d-1*u200*(1.40097910670142714d7*u85+u52*(3.3d1*&
 &u36+u62))*u44
  u317=+u76*(1.71938344913356967d8*u85+u52*(2.7d1*u83+u334))*u44
  u334=-7.0431265482384432d-1*u43
  u62=u198*(u334*u198+u42)
  u69=u198*(u317+u336)
  u316=u198*(u57+u333*u198)
  value=value+(c(80)*(y*((u340+u199*(u199*(u54+u319)+u89))*u325+u199*(u&
 &341+u62+u199*((u8+u336)*u199+u69+u49))+u316+u78)))
  u319=u84*(3.46360590058274705d4*u85+u52)*u44
  u84=+u68*(u74+u52*u98)*u44
  u74=-1.26776277868291978d0*u323
  u323=1.69035037157722637d0*u50
  u49=u200*(1.06134780810714177d7*u85+u52*(2.5d1*u36+u77))*u44
  u50=2.11293796447153296d-1*u49
  u77=+u68*(9.55213027296427596d7*u85+u52*(1.5d1*u83+4.0d0*u39))*u44
  u8=9.39083539765125759d-2*u9
  u340=u8*u199
  u341=u5*u199
  value=value+(c(81)*(z*(u325*(u84+u199*(u199*(u77+u340)+u323)+(u199*(u&
 &47+u341)+u87)*u325)+u199*(u74+u199*(u64*u199+u50))+u319)))
  u323=+u63*(2.77583272889560156d6*u85+u52*(8.5d1+u318))*u44
  u318=+u76*(1.79612705987362454d6*u85+u52*u91)*u44
  u76=u326*(5.30673904053570887d7*u85+u52*(1.25d2*u36+2.4d1*u327))*u44
  u326=+u80*(5.41287382134642304d8*u85+u52*(8.5d1*u83+u65))*u44
  u65=-5.63450123859075456d-1*u43
  value=value+(c(82)*(y*(u325*(u323+u199*(u65*u199+u76)+u325*((u90+u341&
 &)*u325+u199*(u326+u340)+u41))+u199*(u318+u95*u199)+u319)))
  u318=-3.5215632741192216d-1*u200*(9.47048813387911121d5*u85+u52*(2.9d&
 &1+u70))*u44
  u200=7.04312654823844319d-2*u49
  u49=-u93
  u46=-u59
  value=value+(c(83)*(z*(u325*(u318+u62+u199*(u338+u46)+u325*((u92+u336&
 &)*u325+u37+u69+u200))+u199*(u49+u339)+u316+u335)))
  value=value+(c(84)*(y*(u325*(u320+u333*u199+u325*((u332)*u325+u71*u19&
 &9+u321))+u55*u199+u322)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_m3=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_m2(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_m2
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u128
  real(kind=8) :: u129
  real(kind=8) :: u146
  real(kind=8) :: u153
  real(kind=8) :: u229
  real(kind=8) :: u243
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_m2=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u243=a3**(-3)
  u7=-1.15013774913559715d-1*u243
  u61=exppd2*pd
  u65=-1.41796308072441282d1*u61
  u229=+u7*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u65)*p**4
  u153=x*y
  u146=u153*z
  value=value+(c(1)*(u229*u146))
  if ( lmax .eq. 0 ) return
  u229=A5_(p,pd,erfpd,exppd2)
  u128=p**5
  u62=5.41989645495103886d0*u243
  u81=u62*u229*u128
  u57=exppd2*pd2
  u89=-2.83592616144882564d1*u57
  u71=+u7*(3.2986722862692829d2*u229+u89)*u128
  u229=x**2
  u84=y*z
  value=value+(c(2)*((u71*u229+u81)*u84))
  u128=y**2
  value=value+(c(3)*(x*(u71*u128+u81)*z))
  u129=z**2
  value=value+(c(4)*(u153*(u71*u129+u81)))
  if ( lmax .eq. 1 ) return
  u81=A6_(p,pd,erfpd,exppd2)
  u98=p**6
  u66=-2.83592616144882564d1*u61
  u96=u243*(3.2986722862692829d2*u81+u66)*u98
  u86=3.45041324740679145d-1*u96
  u71=2.0d0*pd2
  u52=+u7*(2.96880505764235461d3*u81+u66*(9.0d0+u71))*u98
  u66=u52*u229
  value=value+(c(5)*(x*(u66+u86)*u84))
  u59=-u62*u81*u98
  u81=1.15013774913559715d-1*u96
  u98=(u81+u66)
  u62=u81*u229+u59
  value=value+(c(6)*((u98*u128+u62)*z))
  value=value+(c(7)*(y*(u98*u129+u62)))
  u62=u52*u128
  value=value+(c(8)*(u153*(u62+u86)*z))
  value=value+(c(9)*(x*((u81+u62)*u129+u81*u128+u59)))
  value=value+(c(10)*(u146*(u52*u129+u86)))
  if ( lmax .eq. 2 ) return
  u59=A7_(p,pd,erfpd,exppd2)
  u62=p**7
  u66=-1.13817825553971816d2*u243
  u98=+u66*u59*u62
  u52=-5.67185232289765129d1*u57
  u92=u243*(2.96880505764235461d3*u59+u52)*u62
  u87=6.90082649481358289d-1*u92
  u54=(1.1d1+u71)
  u64=u243*(3.26568556340659007d4*u59+u52*u54)*u62
  u79=-1.15013774913559715d-1*u64
  u56=u79*u229
  value=value+(c(11)*((u229*(u87+u56)+u98)*u84))
  u82=3.45041324740679145d-1*u92
  u80=1.15013774913559715d-1*u92
  u93=(u82+u56)
  u72=u80*u229+u98
  value=value+(c(12)*(x*(u93*u128+u72)*z))
  value=value+(c(13)*(u153*(u93*u129+u72)))
  u93=(u80+u56)
  u72=u82*u229+u98
  value=value+(c(14)*(y*(u93*u128+u72)*z))
  u56=-3.28610785467313471d-2*u243*(9.8960168588078487d2*u59-1.41796308&
 &072441282d1*exppd2)*u62
  u78=-1.15013774913559715d-1*u92
  u92=-4.6005509965423886d-1*u243
  u5=+u92*(8.90641517292706383d3*u59+u89*(6.0d0+pd2))*u62
  u59=1.15013774913559715d-1*u64
  u89=u59*u229
  value=value+(c(15)*(u128*(u80+u229*(u89+u5)+(u89+u78)*u128)+u229*(u80&
 &+u78*u229)+u56))
  value=value+(c(16)*(u84*(u93*u129+u72)))
  u89=u79*u128
  value=value+(c(17)*(x*(u128*(u87+u89)+u98)*z))
  value=value+(c(18)*(u153*((u82+u89)*u129+u80*u128+u98)))
  u59=x*z
  value=value+(c(19)*(u59*((u80+u89)*u129+u82*u128+u98)))
  value=value+(c(20)*(u153*(u129*(u87+u79*u129)+u98)))
  if ( lmax .eq. 3 ) return
  u89=A8_(p,pd,erfpd,exppd2)
  u5=p**8
  u98=-5.67185232289765129d1*u61
  u93=u243*(2.96880505764235461d3*u89+u98)*u5
  u72=-1.72520662370339572d0*u93
  u56=3.26568556340659007d4*u89
  u62=u243*(u56+u98*u54)*u5
  u54=1.15013774913559715d0*u62
  u82=pd2**2
  u87=4.0d0*u82
  u79=(u71+1.1d1)
  u8=u243*(4.24539123242856709d5*u89+u98*(1.3d1*u79+u87))*u5
  u6=-1.15013774913559715d-1*u8
  u60=u6*u229
  value=value+(c(21)*(x*(u229*(u54+u60)+u72)*u84))
  u90=-u66*u89*u5
  u66=-3.45041324740679145d-1*u93
  u67=-6.90082649481358289d-1*u93
  u81=6.90082649481358289d-1*u62
  u96=1.15013774913559715d-1*u62
  u73=(u66+u229*(u60+u81))
  u69=u229*(u67+u96*u229)+u90
  value=value+(c(22)*((u73*u128+u69)*z))
  value=value+(c(23)*(y*(u73*u129+u69)))
  u73=-1.03512397422203744d0*u93
  u69=3.45041324740679145d-1*u62
  u68=(u69+u60)
  u75=u69*u229+u73
  value=value+(c(24)*(u153*(u68*u128+u75)*z))
  u74=-2.76033059792543316d0*u243*(3.2986722862692829d2*u89-7.089815403&
 &62206411d0*u61)*u5
  u97=-3.45041324740679145d-1*u62
  u80=(1.3d1+u71)
  u93=u61*u80
  u55=1.15013774913559715d-1*u243*(3.85944657493506099d4*u89-5.67185232&
 &289765129d1*u93)*u5
  u89=-1.84022039861695544d0*u243*(u56+u65*(4.0d0*u79+u82))*u5
  u56=1.15013774913559715d-1*u8
  u5=-1.15013774913559715d-1*u62
  u79=u56*u229
  u65=u229*(u79+u89)
  value=value+(c(25)*(x*(u128*(u69+u65+(u79+u97)*u128)+u229*(u55+u5*u22&
 &9)+u74)))
  value=value+(c(26)*(u146*(u68*u129+u75)))
  u68=(u60+u96)
  u75=u67+u81*u229
  u60=u66*u229+u90
  value=value+(c(27)*((u128*(u75+u68*u128)+u60)*z))
  u8=u55+u65
  u65=u229*(u69+u97*u229)+u74
  u91=(u79+u5)
  value=value+(c(28)*(y*(u128*(u8+u91*u128)+u65)))
  value=value+(c(29)*(z*(u129*(u8+u91*u129)+u65)))
  value=value+(c(30)*(y*(u129*(u75+u68*u129)+u60)))
  u8=u6*u128
  value=value+(c(31)*(u153*(u128*(u54+u8)+u72)*z))
  value=value+(c(32)*(x*((u66+u128*(u8+u81))*u129+u128*(u67+u96*u128)+u&
 &90)))
  value=value+(c(33)*(u146*((u69+u8)*u129+u69*u128+u73)))
  value=value+(c(34)*(x*(u129*(u67+u81*u128+(u8+u96)*u129)+u66*u128+u90&
 &)))
  value=value+(c(35)*(u146*(u129*(u54+u6*u129)+u72)))
  if ( lmax .eq. 4 ) return
  u90=A9_(p,pd,erfpd,exppd2)
  u8=p**9
  u65=u243*u90*u8
  u89=5.12180214992873173d3*u65
  u55=-1.13437046457953026d2*u57
  u91=u243*(3.26568556340659007d4*u90+u55)*u8
  u75=-5.17561987111018717d0*u91
  u60=u243*(4.24539123242856709d5*u90+u55*u80)*u8
  u56=1.72520662370339572d0*u60
  u54=(u71+1.3d1)
  u79=(1.5d1*u54+u87)
  u73=u243*(6.36808684864285064d6*u90+u55*u79)*u8
  u5=-1.15013774913559715d-1*u73
  u97=u5*u229
  value=value+(c(36)*((u229*(u75+u229*(u97+u56))+u89)*u84))
  u68=-1.72520662370339572d0*u91
  u69=-1.15013774913559715d0*u91
  u81=1.15013774913559715d0*u60
  u96=1.15013774913559715d-1*u60
  u94=(u68+u229*(u97+u81))
  u70=u229*(u69+u96*u229)+u89
  value=value+(c(37)*(x*(u94*u128+u70)*z))
  value=value+(c(38)*(u153*(u94*u129+u70)))
  u94=3.07308128995723904d3*u65
  u65=-3.45041324740679145d-1*u91
  u70=-2.07024794844407487d0*u91
  u50=6.90082649481358289d-1*u60
  u51=3.45041324740679145d-1*u60
  u74=(u65+u229*(u97+u50))
  u62=u229*(u70+u51*u229)+u94
  value=value+(c(39)*(y*(u74*u128+u62)*z))
  u95=3.06703399769492573d-1*u243*(2.96880505764235461d3*u90-7.08981540&
 &362206411d0*exppd2)*u8
  u88=3.45041324740679145d-1*u91
  u91=-3.45041324740679145d-1*u243
  u76=+u91*(6.23449062104894468d4*u90-2.26874092915906051d2*u57)*u8
  u86=3.45041324740679145d-1*u243
  u6=4.0d0*pd2
  u72=(2.7d1+u6)
  u57=u86*(8.81735102119779319d5*u90+u55*u72)*u8
  u78=-6.90082649481358289d-1*u60
  u63=2.3002754982711943d-1*u243*(2.93911700706593106d5*u90+u55*(9.0d0+&
 &pd2))*u8
  u9=+u7*(8.9153215880999909d6*u90+u55*(2.1d1*u54+u87))*u8
  u53=1.15013774913559715d-1*u73
  u73=-1.15013774913559715d-1*u60
  u85=u53*u229
  u67=u229*(u9+u85)
  value=value+(c(40)*(u128*(u65+u229*(u67+u57)+(u229*(u78+u85)+u88)*u12&
 &8)+u229*(u76+u229*(u73*u229+u63))+u95))
  value=value+(c(41)*(u84*(u74*u129+u62)))
  u74=(u97+u51)
  u62=u70+u50*u229
  u99=u65*u229+u94
  value=value+(c(42)*(x*(u128*(u62+u74*u128)+u99)*z))
  u66=-2.07024794844407487d0*u243
  u77=+u66*(1.48440252882117731d4*u90+u52)*u8
  u64=(1.5d1+u71)
  u52=u86*(4.89852834510988511d5*u90+u55*u64)*u8
  u58=-3.45041324740679145d-1*u60
  u60=(5.0d0*u54+u82)
  u83=+u92*(2.12269561621428355d6*u90+u55*u60)*u8
  u90=u52+u229*(u85+u83)
  u8=u229*(u52+u58*u229)+u77
  u55=(u85+u58)
  value=value+(c(43)*(u153*(u128*(u90+u55*u128)+u8)))
  value=value+(c(44)*(u59*(u129*(u90+u55*u129)+u8)))
  value=value+(c(45)*(u153*(u129*(u62+u74*u129)+u99)))
  u90=(u97+u96)
  u97=u69+u81*u229
  u74=u68*u229+u89
  value=value+(c(46)*(y*(u128*(u97+u90*u128)+u74)*z))
  u55=u76+u229*(u78*u229+u57)
  u62=u67+u63
  u71=u229*(u65+u88*u229)+u95
  u99=(u73+u85)
  value=value+(c(47)*(u128*(u55+u128*(u99*u128+u62))+u71))
  u8=u53*u128
  value=value+(c(48)*(u84*(u129*(u52+u128*(u8+u83)+(u8+u58)*u129)+u128*&
 &(u52+u58*u128)+u77)))
  value=value+(c(49)*(u129*(u55+u129*(u99*u129+u62))+u71))
  value=value+(c(50)*(u84*(u129*(u97+u90*u129)+u74)))
  u55=u5*u128
  value=value+(c(51)*(x*(u128*(u75+u128*(u55+u56))+u89)*z))
  value=value+(c(52)*(u153*((u68+u128*(u55+u81))*u129+u128*(u69+u96*u12&
 &8)+u89)))
  value=value+(c(53)*(u59*((u65+u128*(u55+u50))*u129+u128*(u70+u51*u128&
 &)+u94)))
  value=value+(c(54)*(u153*(u129*(u70+u50*u128+(u55+u51)*u129)+u65*u128&
 &+u94)))
  value=value+(c(55)*(u59*(u129*(u69+u81*u128+(u55+u96)*u129)+u68*u128+&
 &u89)))
  value=value+(c(56)*(u153*(u129*(u75+u129*(u5*u129+u56))+u89)))
  if ( lmax .eq. 5 ) return
  u5=A10_(p,pd,erfpd,exppd2)
  u56=p**10
  u75=-1.13437046457953026d2*u61
  u94=u243*(3.26568556340659007d4*u5+u75)*u56
  u89=1.20764463659237701d1*u94
  u61=u243*(4.24539123242856709d5*u5-1.13437046457953026d2*u93)*u56
  u55=-1.20764463659237701d1*u61
  u76=u243*(6.36808684864285064d6*u5+u75*u79)*u56
  u50=2.41528927318475401d0*u76
  u93=(u87+1.5d1*u80)
  u63=pd2**3
  u87=8.0d0*u63
  u67=u243*(1.08257476426928461d8*u5+u75*(1.7d1*u93+u87))*u56
  u80=-1.15013774913559715d-1*u67
  u73=u80*u229
  value=value+(c(57)*(x*(u229*(u55+u229*(u73+u50))+u89)*u84))
  u84=u243*u5*u56
  u99=-5.12180214992873173d3*u84
  u83=1.72520662370339572d0*u94
  u79=5.17561987111018717d0*u94
  u52=-5.17561987111018717d0*u61
  u74=-1.72520662370339572d0*u61
  u9=+u74
  u59=1.72520662370339572d0*u76
  u81=1.15013774913559715d-1*u76
  u77=(u83+u229*(u229*(u59+u73)+u52))
  u68=u229*(u79+u229*(u81*u229+u9))+u99
  value=value+(c(58)*((u77*u128+u68)*z))
  value=value+(c(59)*(y*(u77*u129+u68)))
  u77=-3.45041324740679145d0*u61
  u68=1.15013774913559715d0*u76
  u96=3.45041324740679145d-1*u76
  u71=(u9+u229*(u73+u68))
  u62=u229*(u77+u96*u229)+u79
  value=value+(c(60)*(u153*(u71*u128+u62)*z))
  u97=u243*(1.48440252882117731d4*u5+u98)*u56
  u90=3.45041324740679145d0*u97
  u58=-u74
  u74=-5.75068874567798575d-1*u243*(8.81735102119779319d5*u5+u75*u72)*u&
 &56
  u8=8.0d0*u82
  u57=5.75068874567798575d-1*u243*(1.40097910670142714d7*u5+u75*(3.3d1*&
 &u54+u8))*u56
  u72=-u68
  u88=9.20110199308477719d-1*u243*(1.27361736972857013d6*u5+u98*(6.0d0*&
 &u54+u82))*u56
  u69=+u7*(1.71938344913356967d8*u5+u75*(2.7d1*u93+u87))*u56
  u95=1.15013774913559715d-1*u67
  u67=-1.15013774913559715d-1*u76
  u78=u95*u229
  u98=u229*(u69+u78)
  value=value+(c(61)*(x*(u128*(u9+u229*(u98+u57)+(u229*(u72+u78)+u58)*u&
 &128)+u229*(u74+u229*(u67*u229+u88))+u90)))
  value=value+(c(62)*(u146*(u71*u129+u62)))
  u82=-3.07308128995723904d3*u84
  u84=2.07024794844407487d0*u94
  u71=-3.45041324740679145d-1*u61
  u62=-4.14049589688814974d0*u61
  u94=6.90082649481358289d-1*u76
  u51=(u229*(u94+u73)+u71)
  u70=u84+u229*(u94*u229+u62)
  u65=u229*(u84+u71*u229)+u82
  value=value+(c(63)*((u128*(u70+u51*u128)+u65)*z))
  u85=2.07024794844407487d0*u97
  u97=+u91*(4.89852834510988511d5*u5+u75*u64)*u56
  u53=3.45041324740679145d-1*u61
  u91=-1.03512397422203744d0*u243*(8.16421390851647518d5*u5+u75*(2.5d1+&
 &u6))*u56
  u6=u86*(1.48588693134999848d7*u5+u75*(3.5d1*u54+u8))*u56
  u8=-6.90082649481358289d-1*u76
  u64=1.38016529896271658d0*u243*(2.12269561621428355d6*u5+u75*u60)*u56
  u60=+u7*(1.59202171216071266d8*u5+u75*(2.5d1*u93+u87))*u56
  u7=-3.45041324740679145d-1*u76
  u76=u229*(u60+u78)
  u86=u97+u229*(u76+u6)
  u243=u7*u229
  u54=u229*(u91+u229*(u243+u64))+u85
  u61=(u229*(u8+u78)+u53)
  value=value+(c(64)*(y*(u128*(u86+u61*u128)+u54)))
  value=value+(c(65)*(z*(u129*(u86+u61*u129)+u54)))
  value=value+(c(66)*(y*(u129*(u70+u51*u129)+u65)))
  u86=(u73+u96)
  u54=u77+u68*u229
  u61=u9*u229+u79
  value=value+(c(67)*(u153*(u128*(u54+u86*u128)+u61)*z))
  u51=u91+u229*(u8*u229+u6)
  u65=u76+u64
  u70=u229*(u97+u53*u229)+u85
  u76=(u7+u78)
  value=value+(c(68)*(x*(u128*(u51+u128*(u76*u128+u65))+u70)))
  u87=+u66*(1.63284278170329504d5*u5+u75*(5.0d0+pd2))*u56
  u66=+u92*(3.18404342432142532d7*u5+u75*(5.0d0*u93+2.0d0*u63))*u56
  value=value+(c(69)*(u153*(u128*(u96+u229*(u78+u66)+(u78+u7)*u128)+u22&
 &9*(u96+u243)+u87)*z))
  value=value+(c(70)*(x*(u129*(u51+u129*(u76*u129+u65))+u70)))
  value=value+(c(71)*(u146*(u129*(u54+u86*u129)+u61)))
  u61=(u81+u73)
  u65=u79+u52*u229
  u243=u59*u229+u9
  u51=u83*u229+u99
  value=value+(c(72)*((u128*(u65+u128*(u61*u128+u243))+u51)*z))
  u73=u74+u229*(u72*u229+u57)
  u54=u98+u88
  u98=u229*(u9+u58*u229)+u90
  u86=(u67+u78)
  value=value+(c(73)*(y*(u128*(u73+u128*(u86*u128+u54))+u98)))
  u70=u95*u128
  u78=u128*(u60+u70)
  value=value+(c(74)*(z*(u129*(u97+u128*(u78+u6)+(u128*(u8+u70)+u53)*u1&
 &29)+u128*(u91+u128*(u7*u128+u64))+u85)))
  value=value+(c(75)*(y*(u129*(u91+u128*(u8*u128+u6)+u129*((u7+u70)*u12&
 &9+u78+u64))+u128*(u97+u53*u128)+u85)))
  value=value+(c(76)*(z*(u129*(u73+u129*(u86*u129+u54))+u98)))
  value=value+(c(77)*(y*(u129*(u65+u129*(u61*u129+u243))+u51)))
  u229=u80*u128
  value=value+(c(78)*(u153*(u128*(u55+u128*(u229+u50))+u89)*z))
  value=value+(c(79)*(x*((u83+u128*(u128*(u59+u229)+u52))*u129+u128*(u7&
 &9+u128*(u81*u128+u9))+u99)))
  value=value+(c(80)*(u146*((u9+u128*(u229+u68))*u129+u128*(u77+u96*u12&
 &8)+u79)))
  value=value+(c(81)*(x*(u129*(u84+u128*(u94*u128+u62)+(u128*(u94+u229)&
 &+u71)*u129)+u128*(u84+u71*u128)+u82)))
  value=value+(c(82)*(u146*(u129*(u77+u68*u128+(u229+u96)*u129)+u9*u128&
 &+u79)))
  value=value+(c(83)*(x*(u129*(u79+u52*u128+u129*((u81+u229)*u129+u59*u&
 &128+u9))+u83*u128+u99)))
  value=value+(c(84)*(u146*(u129*(u55+u129*(u80*u129+u50))+u89)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_m2=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_m1(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_m1
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u319
  real(kind=8) :: u320
  real(kind=8) :: u321
  real(kind=8) :: u400
  real(kind=8) :: u401
  real(kind=8) :: u402
  real(kind=8) :: u403
  real(kind=8) :: u404
  real(kind=8) :: u405
  real(kind=8) :: u406
  real(kind=8) :: u407
  real(kind=8) :: u409
  real(kind=8) :: u41
  real(kind=8) :: u410
  real(kind=8) :: u411
  real(kind=8) :: u412
  real(kind=8) :: u413
  real(kind=8) :: u414
  real(kind=8) :: u415
  real(kind=8) :: u416
  real(kind=8) :: u417
  real(kind=8) :: u418
  real(kind=8) :: u419
  real(kind=8) :: u42
  real(kind=8) :: u420
  real(kind=8) :: u421
  real(kind=8) :: u422
  real(kind=8) :: u423
  real(kind=8) :: u424
  real(kind=8) :: u425
  real(kind=8) :: u426
  real(kind=8) :: u427
  real(kind=8) :: u428
  real(kind=8) :: u429
  real(kind=8) :: u43
  real(kind=8) :: u430
  real(kind=8) :: u431
  real(kind=8) :: u432
  real(kind=8) :: u433
  real(kind=8) :: u434
  real(kind=8) :: u435
  real(kind=8) :: u436
  real(kind=8) :: u437
  real(kind=8) :: u438
  real(kind=8) :: u439
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u441
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_m1=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u470=a3**(-3)
  u446=exppd2*pd
  u48=-1.41796308072441282d1*u446
  u319=u470*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u48)*p**4
  u7=-7.2741098204156852d-2*u319
  u416=1.8185274551039213d-2*u319
  u319=x**2
  u320=y**2
  u321=z**2
  value=value+(c(1)*(y*(u7*u321+u416*u320+u416*u319)))
  if ( lmax .eq. 0 ) return
  u7=A5_(p,pd,erfpd,exppd2)
  u416=p**5
  u47=u470*u7*u416
  u75=-1.71392174799174651d0*u47
  u58=exppd2*pd2
  u421=-2.83592616144882564d1*u58
  u68=u470*(3.2986722862692829d2*u7+u421)*u416
  u7=-7.2741098204156852d-2*u68
  u416=1.8185274551039213d-2*u68
  u68=x*y
  u447=u416*u320
  u448=u416*u319
  u467=u7*u321+u447+u448
  value=value+(c(2)*(u68*(u467+u75)))
  u75=3.42784349598349302d0*u47
  u89=-2.57088262198761977d0*u47
  u87=-8.56960873995873256d-1*u47
  value=value+(c(3)*((u75+u7*u320)*u321+u320*(u89+u448+u447)+u87*u319))
  u87=6.85568699196698605d0*u47
  u448=y*z
  value=value+(c(4)*(u448*(u467+u87)))
  if ( lmax .eq. 1 ) return
  u87=A6_(p,pd,erfpd,exppd2)
  u89=p**6
  u7=u470*u87*u89
  u447=1.71392174799174651d0*u7
  u47=-2.83592616144882564d1*u446
  u416=u470*(3.2986722862692829d2*u87+u47)*u89
  u75=7.2741098204156852d-2*u416
  u467=-1.8185274551039213d-2*u416
  u98=-9.0926372755196065d-2*u416
  u473=2.0d0*pd2
  u463=(9.0d0+u473)
  u427=u470*(2.96880505764235461d3*u87+u47*u463)*u89
  u87=-7.2741098204156852d-2*u427
  u89=1.8185274551039213d-2*u427
  u427=u89*u319
  value=value+(c(5)*(y*((u75+u87*u319)*u321+(u467+u427)*u320+u319*(u98+&
 &u427)+u447)))
  u449=u87*u320
  u405=(u75+u449)*u321
  u450=u89*u320
  u413=u427+u450
  u451=u467*u319
  value=value+(c(6)*(x*(u405+u320*(u98+u413)+u451+u447)))
  u98=1.09111647306235278d-1*u416
  u447=u68*z
  u452=u87*u321
  value=value+(c(7)*(u447*(u452+u450+u427+u98)))
  u98=5.14176524397523954d0*u7
  u42=2.18223294612470556d-1*u416
  u404=-1.27296921857274491d-1*u416
  u95=-5.4555823653117639d-2*u416
  value=value+(c(8)*(y*((u42+u449)*u321+u320*(u404+u413)+u95*u319+u98))&
 &)
  u95=-6.85568699196698605d0*u7
  u42=9.0926372755196065d-2*u416
  u404=u451+u95
  value=value+(c(9)*(z*(u405+u320*(u42+u413)+u404)))
  u42=3.6370549102078426d-1*u416
  value=value+(c(10)*(y*(u321*(u42+u413+u452)+u467*u320+u404)))
  if ( lmax .eq. 2 ) return
  u42=A7_(p,pd,erfpd,exppd2)
  u95=p**7
  u89=u470*u42*u95
  u467=7.19847134156533535d1*u89
  u75=-5.67185232289765129d1*u58
  u449=u470*(2.96880505764235461d3*u42+u75)*u95
  u98=2.18223294612470556d-1*u449
  u7=-5.4555823653117639d-2*u449
  u405=-1.63667470959352917d-1*u449
  u413=(1.1d1+u473)
  u416=u470*(3.26568556340659007d4*u42+u75*u413)*u95
  u84=-7.2741098204156852d-2*u416
  u436=1.8185274551039213d-2*u416
  u419=u436*u319
  u453=u84*u319
  value=value+(c(11)*(u68*((u98+u453)*u321+(u7+u419)*u320+u319*(u405+u4&
 &19)+u467)))
  u99=4.94800842940392435d3*u42
  u424=2.83592616144882564d1*exppd2
  u412=-5.19579272886834657d-3*u470*(u424+u99)*u95
  u452=1.8185274551039213d-2*u470
  u404=-2.26874092915906051d2*u58
  u428=u452*(1.48440252882117731d4*u42+u404)*u95
  u458=-9.0926372755196065d-2*u449
  u459=-7.2741098204156852d-2*u470
  u415=(1.5d1+u473)
  u78=u58*u415
  u401=+u459*(4.45320758646353191d4*u42-5.67185232289765129d1*u78)*u95
  u88=9.0926372755196065d-2*u416
  u454=u88*u319
  value=value+(c(12)*(u320*(u428+u319*(u454+u401)+(u454+u458)*u320)+u31&
 &9*(u428+u458*u319)+u412))
  u412=-3.59923567078266768d1*u89
  u401=7.2741098204156852d-2*u449
  u88=-1.8185274551039213d-2*u449
  u458=5.4555823653117639d-2*u449
  value=value+(c(13)*(u448*((u401+u453)*u321+(u88+u419)*u320+u319*(u458&
 &+u419)+u412)))
  u428=u84*u320
  u72=(u98+u428)*u321
  u434=u436*u320
  u59=u419+u434
  u435=u7*u319
  value=value+(c(14)*(u68*(u72+u320*(u405+u59)+u435+u467)))
  u453=x*z
  u405=u88*u319+u412
  value=value+(c(15)*(u453*((u401+u428)*u321+u320*(u458+u59)+u405)))
  u458=3.27334941918705834d-1*u449
  u96=u59+u84*u321
  value=value+(c(16)*(u68*(u321*(u458+u96)+u88*u320+u405)))
  u412=-1.55873781866050397d-2*u470*(u424+3.2986722862692829d2*u42)*u95
  u469=-u467
  u467=1.61965605185220046d2*u89
  u456=4.36446589224941112d-1*u449
  u53=-2.18223294612470556d-1*u449
  u73=1.79961783539133384d1*u89
  u74=-1.09111647306235278d-1*u449
  value=value+(c(17)*((u469+u320*(u428+u456))*u321+u320*(u467+u74*u319+&
 &u320*(u434+u419+u53))+u73*u319+u412))
  u467=-1.0797707012348003d2*u89
  u469=1.8185274551039213d-2*u449
  value=value+(c(18)*(u448*(u72+u320*(u469+u59)+u435+u467)))
  u467=2.59789636443417329d-3*u470*(u99+2.26874092915906051d2*exppd2)*u&
 &95
  u456=-1.25973248477393369d2*u89
  u419=-1.8185274551039213d-2*u470
  u73=+u419*(u99+u75)*u95
  u87=7.2741098204156852d-2*u470
  u412=u87*(8.90641517292706383d3*u42+u421*(6.0d0+pd2))*u95
  u98=-1.8185274551039213d-2*u416
  value=value+(c(19)*(u321*(u456+u320*(u434+u458)+(u428+u401)*u321)+u32&
 &0*(u73+u319*(u98*u320+u98*u319+u412))+u319*(u88+u469*u319)+u467))
  u73=-2.87938853662613414d2*u89
  u412=6.54669883837411668d-1*u449
  value=value+(c(20)*(u448*(u321*(u412+u96)+u7*u320+u435+u73)))
  if ( lmax .eq. 3 ) return
  u73=A8_(p,pd,erfpd,exppd2)
  u412=p**8
  u467=u470*u73*u412
  u456=-7.19847134156533535d1*u467
  u428=-5.67185232289765129d1*u446
  u416=u470*(2.96880505764235461d3*u73+u428)*u412
  u7=-2.18223294612470556d-1*u416
  u88=5.4555823653117639d-2*u416
  u401=7.09225707490529307d-1*u416
  u458=3.26568556340659007d4*u73
  u469=u470*(u458+u428*u413)*u412
  u449=4.36446589224941112d-1*u469
  u89=-1.09111647306235278d-1*u469
  u99=-2.54593843714548982d-1*u469
  u435=pd2**2
  u84=4.0d0*u435
  u53=(u473+1.1d1)
  u74=u470*(4.24539123242856709d5*u73+u428*(1.3d1*u53+u84))*u412
  u95=-7.2741098204156852d-2*u74
  u42=1.8185274551039213d-2*u74
  u413=u42*u319
  u436=u95*u319
  value=value+(c(21)*(y*((u7+u319*(u436+u449))*u321+(u88+u319*(u413+u89&
 &))*u320+u319*(u401+u319*(u413+u99))+u456)))
  u75=-4.36446589224941112d-1*u470*(1.64933614313464145d3*u73+u47)*u412
  u47=1.63284278170329504d5*u73
  u434=5.4555823653117639d-2*u470
  u96=8.0d0*pd2
  u72=u434*(u47+u428*(5.5d1+u96))*u412
  u59=-2.72779118265588195d-1*u469
  u98=u446*(6.5d1+u96)
  u400=u452*(1.9297232874675305d5*u73-5.67185232289765129d1*u98)*u412
  u52=-2.90964392816627408d-1*u470*(u47+u428*(5.0d0*u53+u435))*u412
  u47=9.0926372755196065d-2*u74
  u444=-9.0926372755196065d-2*u469
  u437=u47*u319
  u457=u319*(u437+u52)
  value=value+(c(22)*(x*(u320*(u72+u457+(u437+u59)*u320)+u319*(u400+u44&
 &4*u319)+u75)))
  u460=2.18223294612470556d-1*u469
  u85=-5.4555823653117639d-2*u469
  u93=-1.8185274551039213d-2*u469
  value=value+(c(23)*(u447*((u460+u436)*u321+(u85+u413)*u320+u319*(u93+&
 &u413)+u7)))
  value=value+(c(24)*(y*(u320*(u400+u457+(u437+u444)*u320)+u319*(u72+u5&
 &9*u319)+u75)))
  u59=-1.09111647306235278d-1*u470
  u47=-1.13437046457953026d2*u446
  u72=+u59*(5.60774288665778093d3*u73+u47)*u412
  u437=(1.3d1+u473)
  u52=u446*u437
  u75=u470*(3.85944657493506099d4*u73-5.67185232289765129d1*u52)*u412
  u400=7.2741098204156852d-2*u75
  u444=-7.2741098204156852d-2*u469
  u457=1.63667470959352917d-1*u416
  u56=u434*(1.39533837709190667d5*u73+u428*(4.7d1+u96))*u412
  u81=u470*(u458+u48*(4.0d0*u53+u435))*u412
  u458=-1.16385757126650963d0*u81
  u53=7.2741098204156852d-2*u74
  u48=-2.18223294612470556d-1*u469
  u41=-2.36408569163509769d-1*u469
  u455=u53*u319
  value=value+(c(25)*(z*(u321*(u400+u319*(u455+u458)+(u455+u444)*u321)+&
 &u320*(u457+u319*(u413+u48)+(u413+u93)*u320)+u319*(u56+u41*u319)+u72))&
 &)
  u72=u434*(3.62853951489621119d3*u73+u428)*u412
  u400=-3.81890765571823473d-1*u416
  u457=7.2741098204156852d-2*u469
  u56=-1.8185274551039213d-2*u75
  u458=1.8185274551039213d-2*u469
  u48=-5.4555823653117639d-2*u75
  u41=3.27334941918705834d-1*u469
  u75=2.90964392816627408d-1*u81
  u9=-1.8185274551039213d-2*u74
  u81=3.6370549102078426d-2*u469
  u429=u9*u319
  u406=u429+u75
  u445=u319*(u406)
  value=value+(c(26)*(y*(u321*(u400+u319*(u413+u41)+(u436+u457)*u321)+u&
 &320*(u56+u445+(u429+u458)*u320)+u319*(u48+u81*u319)+u72)))
  u420=u95*u320
  u451=(u7+u320*(u420+u449))*u321
  u422=u42*u320
  u462=u422+u413
  u438=u89*u319
  u439=u88*u319
  value=value+(c(27)*(x*(u451+u320*(u401+u438+u320*(u462+u99))+u439+u45&
 &6)))
  u401=u413+u422
  u456=u85*u319
  value=value+(c(28)*(u447*((u460+u420)*u321+u320*(u93+u401)+u456+u7)))
  value=value+(c(29)*(x*(u321*(u400+u320*(u422+u41)+(u420+u457)*u321)+u&
 &320*(u48+u445+(u429+u81)*u320)+u319*(u56+u458*u319)+u72)))
  u56=-7.63781531143646946d-1*u416
  u48=6.18299334735333242d-1*u469
  u457=u95*u321
  u458=u85*u320
  value=value+(c(30)*(u447*(u321*(u48+u401+u457)+u458+u456+u56)))
  u456=-3.59923567078266768d2*u467
  u99=-1.09111647306235278d0*u416
  u72=1.36389559132794098d0*u416
  u41=7.2741098204156852d-1*u469
  u81=-3.27334941918705834d-1*u469
  u430=2.72779118265588195d-1*u416
  u8=-1.8185274551039213d-1*u469
  value=value+(c(31)*(y*((u99+u320*(u420+u41))*u321+u320*(u72+u8*u319+u&
 &320*(u462+u81))+u430*u319+u456)))
  u99=1.0797707012348003d2*u467
  value=value+(c(32)*(z*(u451+u320*(u400+u438+u320*(u462+u444))+u439+u9&
 &9)))
  u99=u434*(4.94800842940392435d3*u73+u428)*u412
  u444=-1.03656064940923514d0*u416
  u456=u446*u415
  u81=+u419*(4.45320758646353191d4*u73-5.67185232289765129d1*u456)*u412
  u401=2.54593843714548982d-1*u469
  u8=5.4555823653117639d-2*u469
  u7=u319*(u85+u8*u319)
  value=value+(c(33)*(y*(u321*(u444+u320*(u422+u401)+(u420+u460)*u321)+&
 &u320*(u81+u319*(u9*u320+u406))+u7+u99)))
  u99=u434*(8.24668071567320725d3*u73+u428)*u412
  u406=-3.6370549102078426d-2*u470
  u81=(2.5d1+pd2)
  u401=u446*u81
  u444=+u406*(7.42201264410588653d4*u73-5.67185232289765129d1*u401)*u41&
 &2
  u449=9.0926372755196065d-2*u469
  value=value+(c(34)*(z*(u321*(u444+u445+u320*(u422+u48)+(u420+u429+u44&
 &9)*u321)+u320*(u56+u458)+u7+u99)))
  u99=2.87938853662613414d2*u467
  u444=-2.83690282996211723d0*u416
  u449=1.01837537485819593d0*u469
  value=value+(c(35)*(y*(u321*(u444+u438+u89*u320+u321*(u457+u462+u449)&
 &)+u88*u320+u439+u99)))
  if ( lmax .eq. 4 ) return
  u99=A9_(p,pd,erfpd,exppd2)
  u444=p**9
  u449=u470*u99*u444
  u93=-4.85896815555660137d3*u449
  u48=-1.13437046457953026d2*u58
  u8=u470*(3.26568556340659007d4*u99+u48)*u444
  u469=-1.09111647306235278d0*u8
  u7=2.72779118265588195d-1*u8
  u400=1.72760108234872524d0*u8
  u95=u470*(4.24539123242856709d5*u99+u48*u437)*u444
  u56=7.2741098204156852d-1*u95
  u88=-1.8185274551039213d-1*u95
  u9=-3.6370549102078426d-1*u95
  u89=(u473+1.3d1)
  u439=1.5d1*u89
  u451=(u439+u84)
  u73=u470*(6.36808684864285064d6*u99+u48*u451)*u444
  u72=-7.2741098204156852d-2*u73
  u41=1.8185274551039213d-2*u73
  u412=u41*u319
  u430=u72*u319
  value=value+(c(36)*(u68*((u469+u319*(u430+u56))*u321+(u7+u319*(u412+u&
 &88))*u320+u319*(u400+u319*(u412+u9))+u93)))
  u467=1.48440252882117731d4*u99
  u416=4.84940654694379013d-2*u470*(u467+u424)*u444
  u420=-5.4555823653117639d-2*u470
  u415=+u420*(1.63284278170329504d5*u99-4.53748185831812103d2*u58)*u444
  u424=+u420*(3.11724531052447234d5*u99-9.07496371663624206d2*u58)*u444
  u422=1.6d1*pd2
  u69=(1.35d2+u422)
  u445=u434*(4.4086755105988966d6*u99+u48*u69)*u444
  u460=-5.4555823653117639d-1*u95
  u42=3.6370549102078426d-2*u470
  u458=4.0d0*pd2
  u462=u42*(1.46955850353296553d6*u99+u48*(4.5d1+u458))*u444
  u438=1.6d1*u435
  u457=1.05d2*u89
  u64=+u419*(4.45766079404999545d7*u99+u48*(u457+u438))*u444
  u44=9.0926372755196065d-2*u73
  u461=-9.0926372755196065d-2*u95
  u423=u44*u319
  u441=u319*(u64+u423)
  value=value+(c(37)*(u320*(u415+u319*(u441+u445)+(u319*(u460+u423)+u7)&
 &*u320)+u319*(u424+u319*(u461*u319+u462))+u416))
  u407=6.47862420740880182d2*u449
  u50=-2.18223294612470556d-1*u8
  u410=5.4555823653117639d-2*u8
  u425=-1.63667470959352917d-1*u8
  u60=4.36446589224941112d-1*u95
  u86=-1.09111647306235278d-1*u95
  u436=u319*(u412+u86)
  value=value+(c(38)*(u448*((u50+u319*(u430+u60))*u321+(u410+u436)*u320&
 &+u319*(u425+u436)+u407)))
  u436=7.42201264410588653d4*u99
  u443=-3.27334941918705834d-1*u470*(u436+u404)*u444
  u57=2.44926417255494255d6*u99
  u471=(7.5d1+u96)
  u96=u434*(u57+u48*u471)*u444
  u94=-2.72779118265588195d-1*u95
  u83=1.06134780810714177d7*u99
  u418=2.5d1*u89
  u61=(u418+u84)
  u440=+u459*(u83+u48*u61)*u444
  u459=u94*u319
  value=value+(c(39)*(u68*(u320*(u96+u319*(u423+u440)+(u423+u94)*u320)+&
 &u319*(u96+u459)+u443)))
  u443=u470*(9.8960168588078487d2*u99-3.54490770181103205d0*u58)*u444
  u440=-2.09494362827971734d1*u443
  u96=u470*(4.89852834510988511d5*u99-1.13437046457953026d2*u78)*u444
  u78=2.18223294612470556d-1*u96
  u58=-2.18223294612470556d-1*u95
  u85=6.00114060184294029d-1*u8
  u90=-5.4555823653117639d-2*u95
  u417=u452*(6.30277313737471884d6*u99+u48*(1.93d2+2.4d1*pd2))*u444
  u75=(5.0d0*u89+u435)
  u82=u470*(2.12269561621428355d6*u99+u48*u75)*u444
  u54=-2.90964392816627408d-1*u82
  u45=7.2741098204156852d-2*u73
  u472=-2.90964392816627408d-1*u95
  u77=-2.36408569163509769d-1*u95
  u55=u319*(u412+u472)
  u431=u45*u319
  value=value+(c(40)*(u453*(u321*(u78+u319*(u431+u54)+(u431+u58)*u321)+&
 &u320*(u85+u55+(u412+u90)*u320)+u319*(u417+u77*u319)+u440)))
  u429=1.63667470959352917d-1*u470
  u79=u429*(3.66152623775890402d4*u99+u48)*u444
  u65=-1.03656064940923514d0*u8
  u413=2.18223294612470556d-1*u95
  u91=-5.4555823653117639d-2*u96
  u426=5.4555823653117639d-2*u95
  u80=+u419*(1.53487221480109733d6*u99+u48*(4.7d1+6.0d0*pd2))*u444
  u464=2.54593843714548982d-1*u95
  u76=7.2741098204156852d-2*u82
  u49=-1.8185274551039213d-2*u73
  u465=3.6370549102078426d-2*u95
  u414=u49*u319
  u468=u319*(u414+u76)
  value=value+(c(41)*(u68*(u321*(u65+u319*(u412+u464)+(u430+u413)*u321)&
 &+u320*(u91+u468+(u414+u426)*u320)+u319*(u80+u465*u319)+u79)))
  u432=u7*u319
  value=value+(c(42)*(u320*(u424+u319*(u460*u319+u445)+u320*((u461+u423&
 &)*u320+u441+u462))+u319*(u415+u432)+u416))
  u460=u45*u320
  u461=u90*u319
  value=value+(c(43)*(u448*(u321*(u78+u320*(u460+u54)+(u460+u58)*u321)+&
 &u320*(u417+u55+(u412+u77)*u320)+u319*(u85+u461)+u440)))
  u58=2.96880505764235461d3*u99
  u472=9.69881309388758027d-2*u470*(u58-7.08981540362206411d0*exppd2)*u&
 &444
  u85=-2.18223294612470556d-1*u470
  u445=+u85*(6.23449062104894468d4*u99+u404)*u444
  u462=2.93911700706593106d5*u99
  u78=1.45482196408313704d-1*u470
  u417=u78*(u462+u48*(9.0d0+pd2))*u444
  u415=-7.2741098204156852d-2*u95
  u424=5.23735907069929335d0*u443
  u440=+u419*(6.85793968315383915d5*u99+u48*(2.1d1+u473))*u444
  u82=1.8185274551039213d-2*u95
  u416=+u85*(8.90641517292706383d3*u99+u421)*u444
  u443=u470*(8.81735102119779319d5*u99+u48*(2.7d1+u458))*u444
  u64=2.18223294612470556d-1*u443
  u77=u470*(8.9153215880999909d6*u99+u48*(2.1d1*u89+u84))*u444
  u421=-7.2741098204156852d-2*u77
  u423=-1.09111647306235278d-1*u443
  u55=u452*(1.14625563275571312d7*u99+u48*(2.7d1*u89+u84))*u444
  u441=+u419*(u462+u48*u463)*u444
  u462=-4.36446589224941112d-1*u95
  u463=-3.6370549102078426d-2*u73
  value=value+(c(44)*(u321*(u445+u319*(u462*u319+u64)+u321*((u415+u431)&
 &*u321+u319*(u421+u431)+u417))+u320*(u424+u319*(u319*(u55+u414)+u423)+&
 &u320*((u82+u414)*u320+u319*(u55+u463*u319)+u440))+u319*(u416+u319*(u8&
 &2*u319+u441))+u472))
  u415=u429*(4.65112792363968889d4*u99+u48)*u444
  u417=+u406*(1.33893108099670193d6*u99+u48*(4.1d1+3.0d0*pd2))*u444
  u445=1.27296921857274491d-1*u95
  u424=-7.63781531143646946d-1*u8
  u472=6.18299334735333242d-1*u95
  u440=u49*u320
  value=value+(c(45)*(u448*(u321*(u417+u319*(u412+u472)+u320*(u440+u76)&
 &+(u440+u430+u445)*u321)+u320*(u91+u426*u320)+u319*(u424+u461)+u415)))
  u416=u72*u320
  u45=(u469+u320*(u416+u56))*u321
  u421=u41*u320
  u423=u421+u412
  u441=u88*u319
  value=value+(c(46)*(u68*(u45+u320*(u400+u441+u320*(u423+u9))+u432+u93&
 &)))
  u462=u86*u319
  u463=u410*u319
  value=value+(c(47)*(u453*((u50+u320*(u416+u60))*u321+u320*(u425+u462+&
 &u320*(u423+u86))+u463+u407)))
  u82=u319*(u91+u426*u319)
  value=value+(c(48)*(u68*(u321*(u65+u320*(u421+u464)+(u416+u413)*u321)&
 &+u320*(u80+u468+(u414+u465)*u320)+u82+u79)))
  value=value+(c(49)*(u453*(u321*(u417+u468+u320*(u421+u472)+(u416+u414&
 &+u445)*u321)+u320*(u424+u90*u320)+u82+u415)))
  u80=2.26751847259308064d3*u449
  u426=-2.61867953534964667d0*u8
  u415=9.82004825756117503d-1*u95
  u82=u72*u321+u423
  u464=u86*u320
  u465=u410*u320
  value=value+(c(50)*(u68*(u321*(u426+u462+u464+u321*(u82+u415))+u465+u&
 &463+u80)))
  u90=1.21235163673594753d-1*u470*(u58+5.67185232289765129d1*exppd2)*u4&
 &44
  u54=3.23931210370440091d3*u449
  u424=-1.53867324925959043d4*u449
  u407=-3.27334941918705834d0*u8
  u463=3.00057030092147015d0*u8
  u58=1.09111647306235278d0*u95
  u93=-4.54631863775980325d-1*u95
  u431=-8.09828025926100228d2*u449
  u472=8.18337354796764585d-1*u8
  value=value+(c(51)*((u54+u320*(u320*(u58+u416)+u407))*u321+u320*(u424&
 &+u472*u319+u320*(u320*(u93+u412+u421)+u459+u463))+u431*u319+u90))
  u424=-9.0926372755196065d-2*u8
  value=value+(c(52)*(u448*(u45+u320*(u424+u441+u320*(u423+u88))+u432+u&
 &54)))
  u424=+u419*(1.13437046457953026d2*exppd2+u467)*u444
  u94=3.07734649851918086d3*u449
  u459=1.09111647306235278d-1*u470
  u58=u459*(4.45320758646353191d4*u99+u48)*u444
  u93=-1.80034218055288209d0*u8
  u431=-1.8185274551039213d-2*u96
  u472=1.63667470959352917d-1*u95
  u90=-5.4555823653117639d-2*u443
  u56=1.8185274551039213d-2*u77
  u54=-5.4555823653117639d-2*u8
  u463=1.09111647306235278d-1*u95
  u468=u319*(u463*u319+u90)
  u413=u319*(u410+u54*u319)
  u407=u56+u414
  value=value+(c(53)*(u321*(u94+u320*(u320*(u472+u421)+u93)+(u320*(u60+&
 &u416)+u50)*u321)+u320*(u58+u468+u320*(u319*(u407+u440)+u431))+u413+u4&
 &24))
  u424=u429*(u436+u48)*u444
  u443=8.16421390851647518d5*u99
  u58=+u59*(u443+u48*u81)*u444
  u93=2.72779118265588195d-1*u95
  u431=(2.5d1+u473)
  u94=+u420*(u443+u48*u431)*u444
  u443=2.0d0*u435
  u77=(u418+u443)
  u440=u42*(u83+u48*u77)*u444
  u45=-9.0926372755196065d-2*u73
  value=value+(c(54)*(u448*(u321*(u58+u440*u320+(u45*u320+u93)*u321)+u9&
 &4*u320+u424)))
  u93=-6.06175818367973767d-3*u470*(9.07496371663624206d2*exppd2+u436)*&
 &u444
  u440=u434*(2.22660379323176596d5*u99+u404)*u444
  u424=+u419*(u57+u48*(7.5d1+u473))*u444
  u73=9.0926372755196065d-2*u95
  value=value+(c(55)*(u321*(u440+u468+u320*(u464+u426)+u321*((u73+u414+&
 &u416)*u321+u320*(u415+u421)+u319*(u407)+u424))+u320*(u80+u465)+u413+u&
 &93))
  u73=1.94358726222264055d4*u449
  u93=-6.91040432939490094d0*u8
  u56=1.45482196408313704d0*u95
  value=value+(c(56)*(u448*(u321*(u93+u441+u88*u320+u321*(u82+u56))+u7*&
 &u320+u432+u73)))
  if ( lmax .eq. 5 ) return
  u73=A10_(p,pd,erfpd,exppd2)
  u93=p**10
  u56=u470*u73*u93
  u464=4.85896815555660137d3*u56
  u407=u470*(3.26568556340659007d4*u73+u47)*u93
  u421=1.09111647306235278d0*u407
  u441=-2.72779118265588195d-1*u407
  u99=-6.81947795663970488d0*u407
  u41=u470*(4.24539123242856709d5*u73-1.13437046457953026d2*u52)*u93
  u95=-3.27334941918705834d0*u41
  u432=8.18337354796764585d-1*u41
  u448=3.54612853745264654d0*u41
  u83=6.36808684864285064d6*u73
  u72=u470*(u83+u47*u451)*u93
  u49=1.09111647306235278d0*u72
  u88=-2.72779118265588195d-1*u72
  u463=-4.91002412878058751d-1*u72
  u440=(u84+1.5d1*u437)
  u90=pd2**3
  u54=8.0d0*u90
  u465=u470*(1.08257476426928461d8*u73+u47*(1.7d1*u440+u54))*u93
  u437=-7.2741098204156852d-2*u465
  u7=1.8185274551039213d-2*u465
  u410=u7*u319
  u424=u437*u319
  value=value+(c(57)*(y*((u421+u319*(u319*(u49+u424)+u95))*u321+(u441+u&
 &319*(u319*(u88+u410)+u432))*u320+u319*(u99+u319*(u319*(u463+u410)+u44&
 &8))+u464)))
  u45=7.42201264410588653d4*u73
  u82=u470*(u45-2.26874092915906051d2*u446)*u93
  u413=5.4555823653117639d-1*u82
  u80=2.12269561621428355d6*u73
  u94=-2.72779118265588195d-1*u470
  u52=+u94*(u80-1.13437046457953026d2*u98)*u93
  u468=1.36389559132794098d0*u41
  u453=-9.0926372755196065d-2*u470
  u98=+u453*(4.4086755105988966d6*u73+u47*u69)*u93
  u472=3.2d1*u435
  u423=9.0926372755196065d-2*u470
  u57=u423*(7.0048955335071357d7*u73+u47*(1.65d2*u89+u472))*u93
  u81=-9.0926372755196065d-1*u72
  u58=u78*(u83+u47*(u439+u443))*u93
  u83=3.2d1*u90
  u443=+u419*(8.59691724566784836d8*u73+u47*(1.35d2*u440+u83))*u93
  u8=9.0926372755196065d-2*u465
  u467=-9.0926372755196065d-2*u72
  u415=u8*u319
  u436=u319*(u443+u415)
  value=value+(c(58)*(x*(u320*(u52+u319*(u436+u57)+(u319*(u81+u415)+u46&
 &8)*u320)+u319*(u98+u319*(u467*u319+u58))+u413)))
  u430=5.4555823653117639d-1*u407
  u96=-1.09111647306235278d0*u41
  u76=2.72779118265588195d-1*u41
  u50=7.2741098204156852d-1*u72
  u439=-1.8185274551039213d-1*u72
  u416=-2.18223294612470556d-1*u72
  value=value+(c(59)*(u447*((u96+u319*(u424+u50))*u321+(u76+u319*(u410+&
 &u439))*u320+u319*(u76+u319*(u410+u416))+u430)))
  u426=3.27334941918705834d-1*u82
  u82=2.44926417255494255d6*u73
  u65=+u420*(u82+u47*u471)*u93
  u449=-1.63667470959352917d-1*u470
  u417=+u449*(4.08210695425823759d6*u73+u47*(1.25d2+u422))*u93
  u59=u434*(7.42943465674999241d7*u73+u47*(1.75d2*u89+u472))*u93
  u445=-5.4555823653117639d-1*u72
  u91=1.06134780810714177d7*u73
  u78=u470*(u91+u47*u61)*u93
  u60=2.18223294612470556d-1*u78
  u69=+u419*(7.9601085608035633d8*u73+u47*(1.25d2*u440+u83))*u93
  u83=u319*(u69+u415)
  u425=u88*u319
  value=value+(c(60)*(y*(u320*(u65+u319*(u83+u59)+(u319*(u445+u415)+u76&
 &)*u320)+u319*(u417+u319*(u425+u60))+u426)))
  u400=2.09494362827971734d1*u470*(9.8960168588078487d2*u73-3.544907701&
 &81103205d0*u446)*u93
  u414=u470*(4.89852834510988511d5*u73-1.13437046457953026d2*u456)*u93
  u444=-2.18223294612470556d-1*u414
  u405=2.18223294612470556d-1*u41
  u418=-6.00114060184294029d-1*u407
  u450=5.4555823653117639d-2*u41
  u471=+u449*(3.49428355284505138d6*u73+u47*(1.07d2+u422))*u93
  u412=8.0d0*u435
  u79=u470*(1.48588693134999848d7*u73+u47*(3.5d1*u89+u412))*u93
  u48=2.18223294612470556d-1*u79
  u455=-4.36446589224941112d-1*u72
  u473=1.47300723863417626d0*u41
  u86=-1.09111647306235278d-1*u72
  u61=u459*(1.82551822994428385d7*u73+u47*(4.3d1*u89+u412))*u93
  u404=1.59202171216071266d8*u73
  u55=2.5d1*u440
  u64=u470*(u404+u47*(u55+u54))*u93
  u53=-7.2741098204156852d-2*u64
  u9=7.2741098204156852d-2*u465
  u462=-3.81890765571823473d-1*u72
  u469=-2.36408569163509769d-1*u72
  u433=u9*u319
  u403=u319*(u53+u433)
  u74=u319*(u462+u410)
  value=value+(c(61)*(z*(u321*(u444+u319*(u403+u48)+(u319*(u455+u433)+u&
 &405)*u321)+u320*(u418+u319*(u74+u473)+(u319*(u86+u410)+u450)*u320)+u3&
 &19*(u471+u319*(u469*u319+u61))+u400)))
  u6=+u449*(3.66152623775890402d4*u73+u47)*u93
  u97=1.03656064940923514d0*u407
  u422=-2.18223294612470556d-1*u41
  u460=5.4555823653117639d-2*u414
  u92=-5.4555823653117639d-2*u41
  u454=6.54669883837411668d-1*u470*(2.28597989438461305d5*u73+u47*(7.0d&
 &0+pd2))*u93
  u456=-1.80034218055288209d0*u41
  u62=4.36446589224941112d-1*u72
  u71=-5.4555823653117639d-2*u79
  u46=1.09111647306235278d-1*u72
  u409=+u420*(8.06624334161427748d6*u73+u47*(1.9d1*u89+u84))*u93
  u63=1.63667470959352917d-1*u72
  u79=1.8185274551039213d-2*u64
  u461=-1.8185274551039213d-2*u465
  u64=3.6370549102078426d-2*u72
  u411=u461*u319
  u44=u319*(u79+u411)
  value=value+(c(62)*(y*(u321*(u97+u319*(u319*(u63+u410)+u456)+(u319*(u&
 &62+u424)+u422)*u321)+u320*(u460+u319*(u44+u71)+(u319*(u46+u411)+u92)*&
 &u320)+u319*(u454+u319*(u64*u319+u409))+u6)))
  u442=u76*u319
  value=value+(c(63)*(x*(u320*(u417+u319*(u445*u319+u59)+u320*((u88+u41&
 &5)*u320+u83+u60))+u319*(u65+u442)+u426)))
  u60=8.16421390851647518d5*u73
  u417=u470*(u60+u47*(2.5d1+u458))*u93
  u426=-3.27334941918705834d-1*u417
  u59=3.18404342432142532d7*u73
  u427=7.5d1*u89
  u65=u434*(u59+u47*(u427+u438))*u93
  value=value+(c(64)*(u68*(u320*(u65+u319*(u415+u53)+(u415+u88)*u320)+u&
 &319*(u65+u425)+u426)*z))
  u426=u470*(1.48440252882117731d4*u73+u428)*u93
  u445=4.36446589224941112d-1*u426
  u68=-6.54669883837411668d-1*u417
  u83=u470*(u80+u47*u75)*u93
  u80=8.72893178449882224d-1*u83
  u69=2.18223294612470556d-1*u470*(1.14298994719230652d6*u73+u428*(7.0d&
 &1+1.1d1*pd2))*u93
  u428=-5.4555823653117639d-2*u78
  u43=5.4555823653117639d-2*u72
  u402=u470*u446
  u446=-4.12576766819373212d0*u402*pd2*u93
  u438=+u406*(5.73127816377856558d7*u73+u47*(1.35d2*u89+u472))*u93
  u472=u452*(2.22883039702499772d8*u73+u47*(3.5d1*u440+u54))*u93
  u78=-1.8185274551039213d-2*u72
  u434=u452*(2.10146866005214071d8*u73+u47*(3.3d1*u440+u54))*u93
  u5=-3.6370549102078426d-2*u465
  u66=1.8185274551039213d-2*u72
  u466=u5*u319
  value=value+(c(65)*(x*(u321*(u68+u319*(u455*u319+u48)+u321*((u416+u43&
 &3)*u321+u403+u80))+u320*(u69+u319*(u319*(u434+u411)+u438)+u320*((u43+&
 &u411)*u320+u319*(u472+u466)+u428))+u319*(u446+u319*(u66*u319+u78))+u4&
 &45)))
  u65=u470*(u60+u47*u431)*u93
  u470=1.63667470959352917d-1*u65
  u431=-1.90945382785911737d0*u41
  u403=+u431
  u67=2.18223294612470556d-1*u72
  u75=-5.4555823653117639d-2*u72
  u51=5.4555823653117639d-1*u72
  u70=u87*(u59+u47*(5.0d0*u440+2.0d0*u90))*u93
  u87=u411+u70
  value=value+(c(66)*(u447*(u321*(u403+u319*(u410+u51)+(u424+u67)*u321)&
 &+u320*(u75+u319*(u87)+(u411+u43)*u320)+u428*u319+u470)))
  value=value+(c(67)*(y*(u320*(u98+u319*(u81*u319+u57)+u320*((u467+u415&
 &)*u320+u436+u58))+u319*(u52+u468*u319)+u413)))
  u443=u9*u320
  u413=u320*(u53+u443)
  u467=u86*u319
  u468=u450*u319
  value=value+(c(68)*(z*(u321*(u444+u320*(u413+u48)+(u320*(u455+u443)+u&
 &405)*u321)+u320*(u471+u319*(u467+u473)+u320*((u469+u410)*u320+u74+u61&
 &))+u319*(u418+u468)+u400)))
  u444=u43*u319
  value=value+(c(69)*(y*(u321*(u68+u320*(u455*u320+u48)+u321*((u416+u44&
 &3)*u321+u413+u80))+u320*(u446+u319*(u319*(u472+u411)+u438)+u320*((u66&
 &+u411)*u320+u319*(u434+u466)+u78))+u319*(u69+u319*(u444+u428))+u445))&
 &)
  u472=1.52756306228729389d0*u426
  u471=+u406*(7.34779251766482766d6*u73+u47*(2.25d2+3.4d1*pd2))*u93
  u469=u42*(1.91042605459285519d7*u73+u47*(4.5d1*u89+u412))*u93
  u68=-7.2741098204156852d-2*u72
  u413=1.63667470959352917d-1*u417
  u473=-2.18223294612470556d-1*u83
  u69=+u420*(6.04151829230219163d6*u73+u47*(1.85d2+2.8d1*pd2))*u93
  u417=u452*(2.35619213399785474d8*u73+u47*(5.55d2*u89+1.36d2*u435))*u9&
 &3
  u446=+u406*(3.24772429280785383d8*u73+u47*(5.1d1*u440+1.6d1*u90))*u93
  u418=2.47546060091623927d1*u402*u435*u93
  u400=+u419*(-u47*(u54-1.5d1*u451)+9.55213027296427596d7*u73)*u93
  u445=5.4555823653117639d-2*u465
  u426=u461*u320
  u402=u320*(u79+u426)
  value=value+(c(70)*(z*(u321*(u471+u319*(u319*(u400+u411)+u417)+u320*(&
 &u402+u71)+u321*((u68+u433)*u321+u320*(u46+u426)+u319*(u446+u445*u319)&
 &+u469))+u320*(u413+u320*(u43*u320+u473))+u319*(u69+u319*(u444+u418))+&
 &u472)))
  u472=+u449*(4.65112792363968889d4*u73+u47)*u93
  u471=u429*(1.40424479226483373d6*u73+u47*(4.3d1+u458))*u93
  u433=+u420*(1.65570258064714117d7*u73+u47*(3.9d1*u89+u84))*u93
  u68=1.27296921857274491d-1*u72
  u9=7.63781531143646946d-1*u407
  u473=-2.61867953534964667d0*u41
  u69=9.82004825756117503d-1*u72
  value=value+(c(71)*(y*(u321*(u471+u319*(u467+u473)+u320*(u46*u320+u71&
 &)+u321*((u68+u424+u426)*u321+u402+u319*(u69+u410)+u433))+u320*(u460+u&
 &92*u320)+u319*(u9+u468)+u472)))
  u417=u437*u320
  u424=(u421+u320*(u320*(u49+u417)+u95))*u321
  u418=u7*u320
  u400=u410+u418
  u445=u432*u319
  u446=u441*u319
  value=value+(c(72)*(x*(u424+u320*(u99+u445+u320*(u320*(u463+u400)+u42&
 &5+u448))+u446+u464)))
  u402=u418+u410
  u469=u439*u319
  value=value+(c(73)*(u447*((u96+u320*(u417+u50))*u321+u320*(u76+u469+u&
 &320*(u402+u416))+u442+u430)))
  u416=u319*(u46*u319+u71)
  u430=u319*(u460+u92*u319)
  value=value+(c(74)*(x*(u321*(u97+u320*(u320*(u63+u418)+u456)+(u320*(u&
 &62+u417)+u422)*u321)+u320*(u454+u416+u320*((u64+u411)*u320+u44+u409))&
 &+u430+u6)))
  value=value+(c(75)*(u447*(u321*(u403+u320*(u418+u51)+(u417+u67)*u321)&
 &+u320*(u428+u319*(u426+u87))+u319*(u75+u444)+u470)))
  u403=u411+u417
  value=value+(c(76)*(x*(u321*(u471+u416+u320*(u86*u320+u473)+u321*((u6&
 &8+u403)*u321+u320*(u69+u418)+u44+u433))+u320*(u9+u450*u320)+u430+u472&
 &)))
  u430=6.00114060184294029d0*u407
  u416=-6.54669883837411668d0*u41
  u70=1.41845141498105861d0*u72
  u470=u439*u320
  u471=u437*u321
  u472=u76*u320
  value=value+(c(77)*(u447*(u321*(u416+u469+u470+u321*(u471+u402+u70))+&
 &u472+u442+u430)))
  u97=3.40127770888962096d4*u56
  u71=7.63781531143646946d0*u407
  u442=-1.71850844507320563d1*u407
  u402=-7.63781531143646946d0*u41
  u473=5.7283614835773521d0*u41
  u447=1.52756306228729389d0*u72
  u6=-6.00114060184294029d-1*u72
  u469=-1.90945382785911737d0*u407
  u409=-u431
  value=value+(c(78)*(y*((u71+u320*(u320*(u447+u417)+u402))*u321+u320*(&
 &u442+u409*u319+u320*(u320*(u6+u400)+u462*u319+u473))+u469*u319+u97)))
  u97=-3.23931210370440091d3*u56
  u473=1.36389559132794098d0*u407
  u6=-3.09149667367666621d-1*u72
  value=value+(c(79)*(z*(u424+u320*(u473+u445+u320*(u320*(u6+u400)+u425&
 &+u432))+u446+u97)))
  u424=+u94*(4.45320758646353191d4*u73+u47)*u93
  u473=4.63724501051499932d0*u407
  u421=1.8185274551039213d-1*u414
  u6=-2.45501206439029376d0*u41
  u49=+u453*(1.40097910670142714d7*u73+u47*(3.3d1*u89+u412))*u93
  u453=u452*(1.71938344913356967d8*u73+u47*(2.7d1*u440+u54))*u93
  u97=-2.72779118265588195d-1*u41
  u71=1.8185274551039213d-1*u72
  u89=u319*(u71*u319+u49)
  u414=u319*(u76+u97*u319)
  u409=u453+u411
  value=value+(c(80)*(y*(u321*(u473+u320*(u320*(u43+u418)+u6)+(u320*(u5&
 &0+u417)+u96)*u321)+u320*(u421+u89+u320*(u319*(u409+u426)+u78))+u414+u&
 &424)))
  u417=+u449*(u45+u47)*u93
  u449=u459*(u60-1.13437046457953026d2*u401)*u93
  u459=3.27334941918705834d-1*u65
  u401=+u85*(u91+u47*u77)*u93
  u77=u42*(u404+u47*(u55+4.0d0*u90))*u93
  u6=-9.0926372755196065d-2*u465
  u473=u6*u320
  value=value+(c(81)*(z*(u321*(u449+u320*(u77*u320+u401)+(u320*(u51+u47&
 &3)+u97)*u321)+u320*(u459+u428*u320)+u417)))
  u428=u429*(u82+u47*(7.5d1+u458))*u93
  u401=+u420*(u59+u47*(u427+u84))*u93
  u82=2.72779118265588195d-1*u72
  u429=5.4555823653117639d-2*u65
  u65=+u420*(u59+u47*(u427+u412))*u93
  u412=u452*(4.77606513648213798d8*u73+u47*(7.5d1*u440+u54))*u93
  value=value+(c(82)*(y*(u321*(u428+u65*u320+u321*((u82+u473)*u321+u412&
 &*u320+u401))+u429*u320+u417)))
  u401=+u94*(1.03908177017482411d5*u73+u47)*u93
  u94=u423*(3.42896984157691957d6*u73+u47*(1.05d2+u458))*u93
  u423=+u419*(4.45766079404999545d7*u73+u47*(u457+u84))*u93
  u419=9.0926372755196065d-2*u72
  value=value+(c(83)*(z*(u321*(u94+u89+u320*(u470+u416)+u321*((u419+u40&
 &3)*u321+u320*(u70+u418)+u319*(u409)+u423))+u320*(u430+u472)+u414+u401&
 &)))
  u401=-1.94358726222264055d4*u56
  u56=2.72779118265588195d1*u407
  u407=-1.41845141498105861d1*u41
  u41=1.96400965151223501d0*u72
  value=value+(c(84)*(y*(u321*(u56+u445+u432*u320+u321*(u321*(u41+u400+&
 &u471)+u88*u320+u425+u407))+u441*u320+u446+u401)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_m1=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_0(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_0
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u337
  real(kind=8) :: u338
  real(kind=8) :: u339
  real(kind=8) :: u413
  real(kind=8) :: u414
  real(kind=8) :: u419
  real(kind=8) :: u422
  real(kind=8) :: u423
  real(kind=8) :: u424
  real(kind=8) :: u425
  real(kind=8) :: u426
  real(kind=8) :: u427
  real(kind=8) :: u428
  real(kind=8) :: u429
  real(kind=8) :: u43
  real(kind=8) :: u430
  real(kind=8) :: u431
  real(kind=8) :: u432
  real(kind=8) :: u433
  real(kind=8) :: u434
  real(kind=8) :: u435
  real(kind=8) :: u436
  real(kind=8) :: u437
  real(kind=8) :: u438
  real(kind=8) :: u439
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u441
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u491
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_0=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u413=a3**(-3)
  u414=exppd2*pd
  u431=-1.41796308072441282d1*u414
  u337=u413*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u431)*p**4
  u471=-2.96964289883110109d-2*u337
  u449=4.45446434824665164d-2*u337
  u337=x**2
  u338=y**2
  u339=z**2
  value=value+(c(1)*(z*(u471*u339+u449*u338+u449*u337)))
  if ( lmax .eq. 0 ) return
  u471=A5_(p,pd,erfpd,exppd2)
  u449=p**5
  u83=u413*u471*u449
  u450=-4.19823374163879816d0*u83
  u86=+u450
  u456=exppd2*pd2
  u90=-2.83592616144882564d1*u456
  u485=u413*(3.2986722862692829d2*u471+u90)*u449
  u471=-2.96964289883110109d-2*u485
  u449=4.45446434824665164d-2*u485
  u485=x*z
  u460=u471*u339
  u461=u449*u338
  u462=u449*u337
  u6=(u460+u461+u462+u86)
  value=value+(c(2)*(u485*u6))
  u494=y*z
  value=value+(c(3)*(u494*u6))
  u86=-u450
  u450=-2.09911687081939908d0*u83
  value=value+(c(4)*(u339*(u86+u462+u461+u460)+u450*u338+u450*u337))
  if ( lmax .eq. 1 ) return
  u86=A6_(p,pd,erfpd,exppd2)
  u471=p**6
  u449=u413*u86*u471
  u450=4.19823374163879816d0*u449
  u83=-2.83592616144882564d1*u414
  u6=u413*(3.2986722862692829d2*u86+u83)*u471
  u97=2.96964289883110109d-2*u6
  u71=-4.45446434824665164d-2*u6
  u47=-2.22723217412332582d-1*u6
  u461=2.0d0*pd2
  u447=u413*(2.96880505764235461d3*u86+u83*(9.0d0+u461))*u471
  u86=-2.96964289883110109d-2*u447
  u471=4.45446434824665164d-2*u447
  u447=u471*u337
  value=value+(c(5)*(z*((u97+u86*u337)*u339+(u71+u447)*u338+u337*(u47+u&
 &447)+u450)))
  u83=-1.78178573929866066d-1*u6
  u460=x*u494
  u463=u86*u339
  u464=u471*u338
  value=value+(c(6)*(u460*(u463+u464+u447+u83)))
  u83=u447+u464
  u70=u83+u463
  u424=u71*u337+u450
  u5=(u339*(u70)+u71*u338+u424)
  value=value+(c(7)*(x*u5))
  value=value+(c(8)*(z*((u97+u86*u338)*u339+u338*(u47+u83)+u424)))
  value=value+(c(9)*(y*u5))
  u71=-8.39646748327759631d0*u449
  u47=2.07875002918177077d-1*u6
  u97=-1.33633930447399549d-1*u6
  value=value+(c(10)*(z*(u339*(u47+u70)+u97*u338+u97*u337+u71)))
  if ( lmax .eq. 2 ) return
  u71=A7_(p,pd,erfpd,exppd2)
  u47=p**7
  u471=u413*u71*u47
  u97=1.76325817148829522d2*u471
  u6=-5.67185232289765129d1*u456
  u450=u413*(2.96880505764235461d3*u71+u6)*u47
  u449=8.90892869649330328d-2*u450
  u5=-1.33633930447399549d-1*u450
  u70=-4.00901791342198648d-1*u450
  u83=(1.1d1+u461)
  u465=u413*(3.26568556340659007d4*u71+u6*u83)*u47
  u82=-2.96964289883110109d-2*u465
  u91=4.45446434824665164d-2*u465
  u436=u91*u337
  u451=u82*u337
  value=value+(c(11)*(u485*((u449+u451)*u339+(u5+u436)*u338+u337*(u70+u&
 &436)+u97)))
  u433=5.87752723829431742d1*u471
  u440=2.96964289883110109d-2*u450
  u434=-4.45446434824665164d-2*u450
  u466=-3.11812504377265615d-1*u450
  value=value+(c(12)*(u494*((u440+u451)*u339+(u434+u436)*u338+u337*(u46&
 &6+u436)+u433)))
  u459=1.64933614313464145d3*u71
  u463=-5.67185232289765129d1*exppd2
  u85=6.36352049749521663d-3*u413*(u459+u463)*u47
  u84=-1.46938180957357935d1*u471
  u87=4.45446434824665164d-2*u450
  u424=-4.45446434824665164d-2*u413
  u448=+u424*(u459+u6)*u47
  u459=-8.90892869649330328d-2*u450
  u86=1.78178573929866066d-1*u413
  u444=u86*(8.90641517292706383d3*u71+u90*(6.0d0+pd2))*u47
  u90=-4.45446434824665164d-2*u465
  u465=u90*u337
  u425=u465+u444
  value=value+(c(13)*(u339*(u84+u337*(u436+u459)+(u451+u440)*u339)+u338&
 &*(u434+u337*(u425)+(u465+u87)*u338)+u448*u337+u85))
  u452=u91*u338
  u98=u436+u452
  u426=u434*u337+u433
  u453=u82*u338
  value=value+(c(14)*(u485*((u440+u453)*u339+u338*(u466+u98)+u426)))
  u451=x*y
  u466=u82*u339
  u441=u98+u466
  value=value+(c(15)*(u451*(u339*(u459+u441)+u434*u338+u426)))
  u433=2.93876361914715871d1*u471
  u72=1.18785715953244044d-1*u450
  u467=u5*u337
  u423=(u339*(u72+u441)+u5*u338+u467+u433)
  value=value+(c(16)*(u485*u423))
  value=value+(c(17)*(u494*((u449+u453)*u339+u338*(u70+u98)+u467+u97)))
  value=value+(c(18)*(u339*(u84+u338*(u452+u459)+(u453+u440)*u339)+u338&
 &*(u448+u337*(u90*u338+u425))+u337*(u434+u87*u337)+u85))
  value=value+(c(19)*(u494*u423))
  u444=2.54540819899808665d-2*u413*(3.2986722862692829d2*u71+2.83592616&
 &144882564d1*exppd2)*u47
  u5=-2.64488725723244284d2*u471
  u434=3.56357147859732131d-1*u450
  u70=4.40814542872073806d1*u471
  u453=-2.67267860894799098d-1*u450
  value=value+(c(20)*(u339*(u5+u453*u337+u453*u338+u339*(u466+u452+u436&
 &+u434))+u70*u338+u70*u337+u444))
  if ( lmax .eq. 3 ) return
  u444=A8_(p,pd,erfpd,exppd2)
  u5=p**8
  u434=u413*u444*u5
  u91=-1.76325817148829522d2*u434
  u453=-5.67185232289765129d1*u414
  u70=u413*(2.96880505764235461d3*u444+u453)*u5
  u440=-8.90892869649330328d-2*u70
  u449=1.33633930447399549d-1*u70
  u87=1.73724109581619414d0*u70
  u72=3.26568556340659007d4*u444
  u450=u413*(u72+u453*u83)*u5
  u85=1.78178573929866066d-1*u450
  u84=-2.67267860894799098d-1*u450
  u97=-6.2362500875453123d-1*u450
  u82=pd2**2
  u425=4.0d0*u82
  u471=(u461+1.1d1)
  u71=u413*(4.24539123242856709d5*u444+u453*(1.3d1*u471+u425))*u5
  u459=-2.96964289883110109d-2*u71
  u47=4.45446434824665164d-2*u71
  u433=u47*u337
  u90=u449+u337*(u433+u84)
  u448=u459*u337
  value=value+(c(21)*(z*((u440+u337*(u448+u85))*u339+(u90)*u338+u337*(u&
 &87+u337*(u433+u97))+u91)))
  u423=8.01803582684397295d-1*u70
  u441=8.90892869649330328d-2*u450
  u83=-1.33633930447399549d-1*u450
  u98=-4.8999107830713168d-1*u450
  value=value+(c(22)*(u460*((u441+u448)*u339+(u83+u433)*u338+u337*(u98+&
 &u433)+u423)))
  u436=1.33633930447399549d-1*u413
  u493=u436*(1.64933614313464145d3*u444+u453)*u5
  u488=1.33633930447399549d-1*u450
  u75=(5.0d0+u461)
  u452=u414*u75
  u99=+u424*(1.48440252882117731d4*u444-5.67185232289765129d1*u452)*u5
  u79=u413*(u72+u431*(4.0d0*u471+u82))*u5
  u72=7.12714295719464262d-1*u79
  u431=-4.45446434824665164d-2*u71
  u442=u431*u337
  u427=u442+u72
  u53=u337*(u427)
  value=value+(c(23)*(x*(u339*(u90+(u448+u441)*u339)+u338*(u83+u53+(u44&
 &2+u488)*u338)+u99*u337+u493)))
  u90=-8.90892869649330328d-2*u413
  u483=+u90*(3.62853951489621119d3*u444+u453)*u5
  u426=(1.3d1+u461)
  u466=u414*u426
  u480=u413*(3.85944657493506099d4*u444-5.67185232289765129d1*u466)*u5
  u68=2.96964289883110109d-2*u480
  u490=-2.96964289883110109d-2*u450
  u445=4.00901791342198648d-1*u70
  u46=-4.45446434824665164d-2*u450
  u465=4.45446434824665164d-2*u413
  u447=4.0d0*pd2
  u55=u465*(9.20329567869129929d4*u444+u453*(3.1d1+u447))*u5
  u469=-4.75142863812976175d-1*u79
  u57=2.96964289883110109d-2*u71
  u470=-5.34535721789598197d-1*u450
  u454=u83*u337
  u468=u57*u337
  value=value+(c(24)*(z*(u339*(u68+u337*(u468+u469)+(u468+u490)*u339)+u&
 &338*(u445+u337*(u433+u470)+(u433+u46)*u338)+u337*(u55+u454)+u483)))
  u483=u436*(2.52898208613978356d3*u444+u453)*u5
  u68=-4.45446434824665164d-2*u70
  u490=2.96964289883110109d-2*u450
  u445=-4.45446434824665164d-2*u480
  u46=4.45446434824665164d-2*u450
  u79=6.0d0*pd2
  u469=+u424*(8.60953466716282837d4*u444+u453*(2.9d1+u79))*u5
  u470=-8.90892869649330328d-2*u450
  value=value+(c(25)*(y*(u339*(u68+u337*(u433+u470)+(u448+u490)*u339)+u&
 &338*(u445+u53+(u442+u46)*u338)+u337*(u469+u441*u337)+u483)))
  u480=u436*(2.74889357189106908d3*u444+u453)*u5
  u448=7.42201264410588653d4*u444
  u55=-2.96964289883110109d-2*u413
  u467=3.0d0*pd2
  u487=(2.5d1+u467)
  u468=u414*u487
  u439=+u55*(u448-5.67185232289765129d1*u468)*u5
  u8=7.42410724707775273d-2*u450
  u475=(2.5d1+u79)
  u57=u414*u475
  u443=+u424*(u448-5.67185232289765129d1*u57)*u5
  u448=2.96964289883110109d-2*u413
  u59=6.0d0*u82
  u419=u448*(8.16421390851647518d5*u444+u453*(2.5d1*u471+u59))*u5
  u444=-7.42410724707775273d-2*u71
  value=value+(c(26)*(z*(u339*(u439+u419*u337+(u444*u337+u8)*u339)+u443&
 &*u337+u480)))
  u443=u47*u338
  u419=u433+u443
  u444=u459*u338
  value=value+(c(27)*(u460*((u441+u444)*u339+u338*(u98+u419)+u454+u423)&
 &))
  value=value+(c(28)*(x*(u339*(u68+u338*(u443+u470)+(u444+u490)*u339)+u&
 &338*(u469+u53+(u442+u441)*u338)+u337*(u445+u46*u337)+u483)))
  u445=3.56357147859732131d-1*u70
  u469=u459*u339
  u470=u83*u338
  value=value+(c(29)*(u460*(u339*(u490+u419+u469)+u470+u454+u445)))
  u46=-2.93876361914715871d1*u434
  u68=-2.67267860894799098d-1*u70
  u423=2.67267860894799098d-1*u450
  u483=u443+u433
  u5=u469+u483
  u471=u84*u337
  u472=u449*u337
  u48=(u339*(u68+u471+u84*u338+u339*(u5+u423))+u449*u338+u472+u46)
  value=value+(c(30)*(x*u48))
  value=value+(c(31)*(z*((u440+u338*(u444+u85))*u339+u338*(u87+u471+u33&
 &8*(u483+u97))+u472+u91)))
  u440=u337*(u83+u488*u337)
  value=value+(c(32)*(y*(u339*(u449+u338*(u443+u84)+(u444+u441)*u339)+u&
 &338*(u99+u337*(u431*u338+u427))+u440+u493)))
  value=value+(c(33)*(z*(u339*(u439+u53+u338*(u443+u490)+(u444+u442+u8)&
 &*u339)+u338*(u445+u470)+u440+u480)))
  value=value+(c(34)*(y*u48))
  u439=5.87752723829431742d2*u434
  u441=-2.22723217412332582d0*u70
  u490=5.34535721789598197d-1*u450
  u423=6.68169652236997746d-1*u70
  u8=-4.45446434824665164d-1*u450
  value=value+(c(35)*(z*(u339*(u441+u8*u337+u8*u338+u339*(u5+u490))+u42&
 &3*u338+u423*u337+u439)))
  if ( lmax .eq. 4 ) return
  u439=A9_(p,pd,erfpd,exppd2)
  u441=p**9
  u490=u413*u439*u441
  u8=-1.19019926575459928d4*u490
  u423=-1.13437046457953026d2*u456
  u450=u413*(3.26568556340659007d4*u439+u423)*u441
  u459=-4.45446434824665164d-1*u450
  u431=6.68169652236997746d-1*u450
  u440=4.23174113083431906d0*u450
  u68=u413*(4.24539123242856709d5*u439+u423*u426)*u441
  u469=2.96964289883110109d-1*u68
  u87=-4.45446434824665164d-1*u68
  u97=-8.90892869649330328d-1*u68
  u47=(u461+1.3d1)
  u443=1.5d1*u47
  u488=(u443+u425)
  u70=u413*(6.36808684864285064d6*u439+u423*u488)*u441
  u470=-2.96964289883110109d-2*u70
  u46=4.45446434824665164d-2*u70
  u434=u46*u337
  u445=u470*u337
  value=value+(c(36)*(u485*((u459+u337*(u445+u469))*u339+(u431+u337*(u4&
 &34+u87))*u338+u337*(u440+u337*(u434+u97))+u8)))
  u480=-2.38039853150919855d3*u490
  u48=-8.90892869649330328d-2*u450
  u5=1.33633930447399549d-1*u450
  u472=2.27177681760579234d0*u450
  u53=1.78178573929866066d-1*u68
  u85=-2.67267860894799098d-1*u68
  u91=-7.12714295719464262d-1*u68
  u493=u5+u337*(u434+u85)
  u449=u337*(u434+u91)
  value=value+(c(37)*(u494*((u48+u337*(u445+u53))*u339+(u493)*u338+u337&
 &*(u472+u449)+u480)))
  u483=1.48440252882117731d4*u439
  u89=-1.48482144941555055d-2*u413*(u483-2.26874092915906051d2*exppd2)*&
 &u441
  u432=-3.96733088584866426d2*u490
  u45=-1.33633930447399549d-1*u450
  u52=2.67267860894799098d-1*u413*(u483+u423)*u441
  u483=9.35437513131796845d-1*u450
  u60=u413*(8.81735102119779319d5*u439+u423*(2.7d1+u447))*u441
  u95=-1.33633930447399549d-1*u60
  u54=2.67267860894799098d-1*u68
  u74=+u424*(1.63284278170329504d5*u439+u423*u75)*u441
  u419=-4.8999107830713168d-1*u68
  u75=u413*(8.9153215880999909d6*u439+u423*(2.1d1*u47+u425))*u441
  u56=4.45446434824665164d-2*u75
  u69=-4.45446434824665164d-2*u70
  u435=u69*u337
  u428=u56+u435
  u427=u337*(u428)
  value=value+(c(38)*(u339*(u432+u337*(u337*(u419+u434)+u483)+(u337*(u5&
 &3+u445)+u48)*u339)+u338*(u5+u337*(u427+u95)+(u337*(u54+u435)+u45)*u33&
 &8)+u337*(u52+u74*u337)+u89))
  u61=-5.34535721789598197d-1*u413*(2.07816354034964823d4*u439+u6)*u441
  u51=(1.5d1+u461)
  u442=u413*(4.89852834510988511d5*u439+u423*u51)*u441
  u84=8.90892869649330328d-2*u442
  u437=-8.90892869649330328d-2*u68
  u478=1.46997323492139504d0*u450
  u88=-1.33633930447399549d-1*u68
  u481=u465*(1.40424479226483373d6*u439+u423*(4.3d1+u447))*u441
  u422=5.0d0*u47
  u44=(u422+u82)
  u80=u413*(2.12269561621428355d6*u439+u423*u44)*u441
  u58=-1.18785715953244044d-1*u80
  u49=2.96964289883110109d-2*u70
  u479=u449+(u434+u88)*u338
  u449=u49*u337
  u455=u88*u337
  value=value+(c(39)*(u485*(u339*(u84+u337*(u449+u58)+(u449+u437)*u339)&
 &+u338*(u478+u479)+u337*(u481+u455)+u61)))
  u66=4.00901791342198648d-1*u413
  u78=u66*(2.67192455187811915d4*u439+u423)*u441
  u477=8.90892869649330328d-2*u68
  u92=-1.33633930447399549d-1*u442
  u442=1.33633930447399549d-1*u68
  u429=+u424*(1.20830365846043833d6*u439+u423*(3.7d1+u79))*u441
  u73=1.78178573929866066d-1*u80
  u444=u337*(u435+u73)
  value=value+(c(40)*(u451*(u339*(u493+(u445+u477)*u339)+u338*(u92+u444&
 &+(u435+u442)*u338)+u337*(u429+u477*u337)+u78)))
  u493=u413*(2.47400421470196218d4*u439+u423)*u441
  u81=4.00901791342198648d-1*u493
  u476=8.16421390851647518d5*u439
  u71=+u90*(u476+u423*u487)*u441
  u487=2.22723217412332582d-1*u68
  u93=+u424*(u476+u423*u475)*u441
  u475=1.06134780810714177d7*u439
  u72=2.5d1*u47
  u80=(u72+u59)
  u59=u448*(u475+u423*u80)*u441
  u77=-7.42410724707775273d-2*u70
  u473=u77*u337
  value=value+(c(41)*(u485*(u339*(u71+u59*u337+(u473+u487)*u339)+u93*u3&
 &37+u81)))
  u474=u49*u338
  value=value+(c(42)*(u494*(u339*(u84+u338*(u474+u58)+(u474+u437)*u339)&
 &+u338*(u481+u479)+u337*(u478+u455)+u61)))
  u437=2.96880505764235461d3*u439
  u84=-1.58380954604325392d-1*u413*(u437-7.08981540362206411d0*exppd2)*&
 &u441
  u9=-2.26874092915906051d2*u456
  u61=+u90*(6.23449062104894468d4*u439+u9)*u441
  u478=5.93928579766220219d-2*u413*(2.93911700706593106d5*u439+u423*(9.&
 &0d0+pd2))*u441
  u481=-2.96964289883110109d-2*u68
  u479=1.28288573229503567d1*u413*(9.8960168588078487d2*u439-3.54490770&
 &181103205d0*u456)*u441
  u456=+u424*(6.85793968315383915d5*u439+u423*(2.1d1+u461))*u441
  u64=4.45446434824665164d-2*u68
  u464=6.2362500875453123d-1*u413*(1.56922553046810172d4*u439+u6)*u441
  u6=8.90892869649330328d-2*u60
  u96=-2.96964289883110109d-2*u75
  u430=-2.67267860894799098d-1*u60
  u60=u465*(1.14625563275571312d7*u439+u423*(2.7d1*u47+u425))*u441
  u433=+u424*(6.20480257047252114d5*u439+u423*(1.9d1+u461))*u441
  u474=-1.78178573929866066d-1*u68
  u438=-8.90892869649330328d-2*u70
  value=value+(c(43)*(u339*(u61+u337*(u474*u337+u6)+u339*((u481+u449)*u&
 &339+u337*(u96+u449)+u478))+u338*(u479+u337*(u337*(u60+u435)+u430)+u33&
 &8*((u64+u435)*u338+u337*(u60+u438*u337)+u456))+u337*(u464+u337*(u64*u&
 &337+u433))+u84))
  u60=u66*(3.00179178050504744d4*u439+u423)*u441
  u61=+u55*(2.38395046128681075d6*u439+u423*(7.3d1+9.0d0*pd2))*u441
  u478=1.6333035943571056d-1*u68
  u481=3.56357147859732131d-1*u450
  u479=2.96964289883110109d-2*u68
  u456=u69*u338
  value=value+(c(44)*(u494*(u339*(u61+u337*(u434+u479)+u338*(u456+u73)+&
 &(u456+u445+u478)*u339)+u338*(u92+u442*u338)+u337*(u481+u455)+u60)))
  u430=7.42201264410588653d4*u439
  u445=-4.94940483138516849d-3*u413*(u430-1.13437046457953026d2*exppd2)&
 &*u441
  u96=u436*(u430+u9)*u441
  u430=(2.5d1+u461)
  u433=+u424*(u476+u423*u430)*u441
  u455=7.42410724707775273d-2*u68
  u438=1.33633930447399549d-1*u493
  u84=-1.33633930447399549d-1*u413
  u9=(2.5d1+u447)
  u70=+u84*(u476+u423*u9)*u441
  u461=(u72+u425)
  u439=u465*(u475+u423*u461)*u441
  value=value+(c(45)*(u339*(u96+u70*u337+u339*((u455+u473)*u339+u439*u3&
 &37+u433))+u438*u337+u445))
  u438=u46*u338
  u70=u438+u434
  u439=u470*u338
  u475=u85*u337
  u476=u5*u337
  value=value+(c(46)*(u485*((u48+u338*(u439+u53))*u339+u338*(u472+u475+&
 &u338*(u70+u91))+u476+u480)))
  u474=u337*(u92+u442*u337)
  value=value+(c(47)*(u451*(u339*(u5+u338*(u438+u85)+(u439+u477)*u339)+&
 &u338*(u429+u444+(u435+u477)*u338)+u474+u78)))
  value=value+(c(48)*(u485*(u339*(u61+u444+u338*(u438+u479)+(u439+u435+&
 &u478)*u339)+u338*(u481+u88*u338)+u474+u60)))
  u429=-1.05795490289297714d3*u490
  u444=2.67267860894799098d-1*u450
  u477=u470*u339
  u474=u477+u70
  u478=u85*u338
  u479=u5*u338
  value=value+(c(49)*(u451*(u339*(u444+u475+u478+u339*(u474+u53))+u479+&
 &u476+u429)))
  u91=1.32244362861622142d3*u490
  u73=-1.33633930447399549d0*u450
  u475=4.45446434824665164d-1*u68
  u480=u87*u337
  u481=u431*u337
  u60=(u339*(u73+u480+u87*u338+u339*(u474+u475))+u431*u338+u481+u91)
  value=value+(c(50)*(u485*u60))
  value=value+(c(51)*(u494*((u459+u338*(u439+u469))*u339+u338*(u440+u48&
 &0+u338*(u70+u97))+u481+u8)))
  u464=u337*(u54*u337+u95)
  u474=u337*(u5+u45*u337)
  value=value+(c(52)*(u339*(u432+u338*(u338*(u419+u438)+u483)+(u338*(u5&
 &3+u439)+u48)*u339)+u338*(u52+u464+u338*(u337*(u428+u456)+u74))+u474+u&
 &89))
  value=value+(c(53)*(u494*(u339*(u71+u59*u338+(u77*u338+u487)*u339)+u9&
 &3*u338+u81)))
  value=value+(c(54)*(u339*(u96+u464+u338*(u478+u444)+u339*((u455+u435+&
 &u439)*u339+u338*(u53+u438)+u427+u433))+u338*(u429+u479)+u474+u445))
  value=value+(c(55)*(u494*u60))
  u73=-1.9797619325540674d-1*u413*(-u463+u437)*u441
  u60=2.5126428943708207d4*u490
  u475=-4.8999107830713168d0*u450
  u444=7.42410724707775274d-1*u68
  u464=-1.98366544292433213d3*u490
  u474=2.00450895671099324d0*u450
  u54=-6.68169652236997746d-1*u68
  value=value+(c(56)*(u339*(u60+u474*u337+u474*u338+u339*(u339*(u444+u4&
 &34+u438+u477)+u54*u338+u54*u337+u475))+u464*u338+u464*u337+u73))
  if ( lmax .eq. 5 ) return
  u73=A10_(p,pd,erfpd,exppd2)
  u60=p**10
  u475=u413*u73*u60
  u444=1.19019926575459928d4*u475
  u54=3.26568556340659007d4*u73
  u474=-1.13437046457953026d2*u414
  u464=u413*(u54+u474)*u60
  u95=4.45446434824665164d-1*u464
  u433=-6.68169652236997746d-1*u464
  u442=-1.67042413059249437d1*u464
  u70=u413*(4.24539123242856709d5*u73-1.13437046457953026d2*u466)*u60
  u466=-1.33633930447399549d0*u70
  u85=2.00450895671099324d0*u70
  u46=8.6862054790809707d0*u70
  u427=6.36808684864285064d6*u73
  u69=u413*(u427+u474*u488)*u60
  u48=4.45446434824665164d-1*u69
  u87=-6.68169652236997746d-1*u69
  u91=-1.20270537402659594d0*u69
  u92=(u425+1.5d1*u426)
  u75=pd2**3
  u473=8.0d0*u75
  u438=u413*(1.08257476426928461d8*u73+u474*(1.7d1*u92+u473))*u60
  u426=-2.96964289883110109d-2*u438
  u5=4.45446434824665164d-2*u438
  u431=u5*u337
  u440=u426*u337
  value=value+(c(57)*(z*((u95+u337*(u337*(u48+u440)+u466))*u339+(u433+u&
 &337*(u337*(u87+u431)+u85))*u338+u337*(u442+u337*(u337*(u91+u431)+u46)&
 &)+u444)))
  u469=-5.34535721789598197d0*u464
  u89=-4.45446434824665164d-1*u70
  u462=6.68169652236997746d-1*u70
  u477=5.12263400048364939d0*u70
  u52=2.96964289883110109d-1*u69
  u472=-4.45446434824665164d-1*u69
  u445=-9.79982156614263361d-1*u69
  value=value+(c(58)*(u460*((u89+u337*(u440+u52))*u339+(u462+u337*(u431&
 &+u472))*u338+u337*(u477+u337*(u431+u445))+u469)))
  u81=1.48440252882117731d4*u73
  u455=-6.68169652236997746d-1*u413
  u439=+u455*(u81+u474)*u60
  u479=-2.00450895671099324d0*u464
  u96=-6.68169652236997746d-1*u70
  u476=4.45446434824665164d-1*u413*(1.63284278170329504d5*u73-1.1343704&
 &6457953026d2*u452)*u60
  u59=2.89540182636032357d0*u70
  u494=8.0d0*u82
  u88=-2.22723217412332582d-1*u413*(1.40097910670142714d7*u73+u474*(3.3&
 &d1*u47+u494))*u60
  u77=2.12269561621428355d6*u73
  u449=+u424*(u77+u474*(u422+u425))*u60
  u49=-7.57258939201930779d-1*u69
  u8=u465*(1.71938344913356967d8*u73+u474*(2.7d1*u92+u473))*u60
  u58=-4.45446434824665164d-2*u438
  u432=u58*u337
  u429=u8+u432
  u419=u337*(u429)
  value=value+(c(59)*(x*(u339*(u479+u337*(u337*(u49+u431)+u59)+(u337*(u&
 &52+u440)+u89)*u339)+u338*(u462+u337*(u419+u88)+(u337*(u48+u432)+u96)*&
 &u338)+u337*(u476+u449*u337)+u439)))
  u78=5.34535721789598197d-1*u413
  u437=u78*(2.07816354034964823d4*u73+u453)*u60
  u93=u413*(4.89852834510988511d5*u73+u474*u51)*u60
  u493=-8.90892869649330328d-2*u93
  u71=8.90892869649330328d-2*u70
  u490=-1.46997323492139504d0*u464
  u481=1.33633930447399549d-1*u70
  u452=+u84*(2.31863675001867895d6*u73+u474*(7.1d1+8.0d0*pd2))*u60
  u97=1.48588693134999848d7*u73
  u470=3.5d1*u47
  u74=u413*(u97+u474*(u470+u494))*u60
  u53=8.90892869649330328d-2*u74
  u488=-1.78178573929866066d-1*u69
  u459=3.60811612207978783d0*u70
  u478=-2.67267860894799098d-1*u69
  u45=8.90892869649330328d-2*u413
  u61=u45*(1.23116345740428446d7*u73+u474*(2.9d1*u47+u425))*u60
  u64=1.59202171216071266d8*u73
  u483=2.5d1*u92
  u55=u413*(u64+u474*(u483+u473))*u60
  u66=-2.96964289883110109d-2*u55
  u6=2.96964289883110109d-2*u438
  u428=-9.35437513131796845d-1*u69
  u456=-1.33633930447399549d-1*u69
  u450=u6*u337
  u485=u337*(u66+u450)
  u454=u337*(u428+u431)
  value=value+(c(60)*(z*(u339*(u493+u337*(u485+u53)+(u337*(u488+u450)+u&
 &71)*u339)+u338*(u490+u337*(u454+u459)+(u337*(u478+u431)+u481)*u338)+u&
 &337*(u452+u337*(u456*u337+u61))+u437)))
  u441=-4.00901791342198648d-1*u413
  u56=+u441*(2.67192455187811915d4*u73+u474)*u60
  u480=-1.33633930447399549d-1*u464
  u68=-8.90892869649330328d-2*u70
  u434=1.33633930447399549d-1*u93
  u93=-1.33633930447399549d-1*u70
  u463=8.55257154863357115d0*u413*(u54-7.08981540362206411d0*u414*(1.6d&
 &1+u467))*u60
  u422=9.35437513131796845d-1*u70
  u54=1.78178573929866066d-1*u69
  u435=-1.33633930447399549d-1*u74
  u51=2.67267860894799098d-1*u69
  u487=1.2d1*u82
  u423=+u424*(1.99533387924142653d7*u73+u474*(4.7d1*u47+u487))*u60
  u492=-4.8999107830713168d-1*u69
  u7=4.45446434824665164d-2*u55
  u55=8.90892869649330328d-2*u69
  u99=u337*(u7+u432)
  value=value+(c(61)*(y*(u339*(u480+u337*(u337*(u492+u431)+u422)+(u337*&
 &(u54+u440)+u68)*u339)+u338*(u434+u337*(u99+u435)+(u337*(u51+u432)+u93&
 &)*u338)+u337*(u463+u337*(u55*u337+u423))+u56)))
  u83=+u441*(2.47400421470196218d4*u73+u474)*u60
  u489=8.16421390851647518d5*u73
  u467=u45*(u489-1.13437046457953026d2*u468)*u60
  u94=-2.22723217412332582d-1*u70
  u43=u413*(u489-1.13437046457953026d2*u57)*u60
  u57=2.67267860894799098d-1*u43
  u486=1.06134780810714177d7*u73
  u76=u413*(u486+u474*u80)*u60
  u471=-1.78178573929866066d-1*u76
  u468=+u424*(u486+u474*(u72+u487))*u60
  u80=u448*(u64+u474*(u483+1.2d1*u75))*u60
  u448=-7.42410724707775273d-2*u438
  u457=u448*u337
  u482=u468*u337
  value=value+(c(62)*(z*(u339*(u467+u337*(u80*u337+u471)+(u337*(u48+u45&
 &7)+u94)*u339)+u337*(u57+u482)+u83)))
  u50=-2.67267860894799098d-1*u413*(u489+u474*u430)*u60
  u430=3.18404342432142532d7*u73
  u62=u465*(u430+u474*(7.5d1*u47+u494))*u60
  u495=-2.22723217412332582d-1*u69
  u446=-5.93928579766220219d-2*u413
  u98=4.0d0*u75
  u67=+u446*(u64+u474*(u483+u98))*u60
  u64=7.42410724707775273d-2*u438
  u483=u64*u337
  value=value+(c(63)*(u451*(u338*(u62+u337*(u483+u67)+(u483+u495)*u338)&
 &+u337*(u62+u495*u337)+u50)*z))
  u62=u413*(u81+u453)*u60
  u67=-1.60360716536879459d0*u62
  u64=u413*(u489+u474*u9)*u60
  u489=-2.67267860894799098d-1*u64
  u81=u413*(u77+u474*u44)*u60
  u77=3.56357147859732131d-1*u81
  u495=-8.90892869649330328d-2*u69
  u483=1.14298994719230652d6*u73
  u9=1.1d1*pd2
  u44=u78*(u483+u453*(7.0d1+u9))*u60
  u78=u413*(u486+u474*u461)*u60
  u461=-1.33633930447399549d-1*u78
  u50=1.33633930447399549d-1*u69
  u65=u45*(2.44926417255494255d6*u73+u474*(7.5d1+u9))*u60
  u45=5.73127816377856558d7*u73
  u453=+u90*(u45+u474*(1.35d2*u47+3.2d1*u82))*u60
  u9=u465*(2.22883039702499772d8*u73+u474*(3.5d1*u92+u473))*u60
  u90=-4.45446434824665164d-2*u78
  u491=u465*(2.10146866005214071d8*u73+u474*(3.3d1*u92+u473))*u60
  u78=-8.90892869649330328d-2*u438
  u63=4.45446434824665164d-2*u69
  u484=u78*u337
  value=value+(c(64)*(x*(u339*(u489+u337*(u488*u337+u53)+u339*((u495+u4&
 &50)*u339+u485+u77))+u338*(u44+u337*(u337*(u491+u432)+u453)+u338*((u50&
 &+u432)*u338+u337*(u9+u484)+u461))+u337*(u65+u337*(u63*u337+u90))+u67)&
 &))
  u473=1.33633930447399549d-1*u43
  u451=-1.48482144941555055d-1*u69
  u82=u86*(u430+u474*(5.0d0*u92+2.0d0*u75))*u60
  u430=u432+u82
  value=value+(c(65)*(u460*(u339*(u94+u337*(u431+u451)+(u440+u55)*u339)&
 &+u338*(u456+u337*(u430)+(u432+u50)*u338)+u482+u473)))
  u482=4.00901791342198648d-1*u64
  u64=2.22723217412332582d-1*u69
  u86=4.45446434824665164d-2*u43
  u43=+u84*(u486+u474*(u72+u494))*u60
  value=value+(c(66)*(x*(u339*(u482+u43*u337+u339*((u64+u457)*u339+u7*u&
 &337+u461))+u86*u337+u83)))
  u84=u6*u338
  u72=u338*(u66+u84)
  u485=u478*u337
  u486=u481*u337
  value=value+(c(67)*(z*(u339*(u493+u338*(u72+u53)+(u338*(u488+u84)+u71&
 &)*u339)+u338*(u452+u337*(u485+u459)+u338*((u456+u431)*u338+u454+u61))&
 &+u337*(u490+u486)+u437)))
  u459=u50*u337
  value=value+(c(68)*(y*(u339*(u489+u338*(u488*u338+u53)+u339*((u495+u8&
 &4)*u339+u72+u77))+u338*(u65+u337*(u337*(u9+u432)+u453)+u338*((u63+u43&
 &2)*u338+u337*(u491+u484)+u90))+u337*(u44+u337*(u459+u461))+u67)))
  u489=-7.12714295719464262d-1*u62
  u491=6.73735038956467824d0*u413*u414*pd2*u60
  u44=2.96964289883110109d-2*u69
  u65=-2.96964289883110109d-2*u69
  u490=-5.34535721789598197d-1*u81
  u67=u465*(3.10240128523626057d6*u73+u474*(9.5d1+1.6d1*pd2))*u60
  u66=1.48482144941555055d-2*u413
  u414=u66*(u427+u474*(u443+u494))*u60
  u488=+u446*(u45+u474*(9.0d0*u92+u98))*u60
  u437=-8.90892869649330328d-2*u76
  u45=u66*(3.50244776675356785d8*u73+u474*(5.5d1*u92+2.4d1*u75))*u60
  u66=-1.48482144941555055d-2*u438
  u446=u58*u338
  u493=u338*(u7+u446)
  value=value+(c(69)*(z*(u339*(u491+u337*(u337*(u45+u432)+u414)+u338*(u&
 &493+u435)+u339*((u65+u450)*u339+u338*(u51+u446)+u337*(u488+u66*u337)+&
 &u44))+u338*(u482+u338*(u50*u338+u490))+u337*(u67+u337*(u459+u437))+u4&
 &89)))
  u489=+u441*(3.00179178050504744d4*u73+u474)*u60
  u491=u436*(2.57989159509120616d6*u73+u474*(7.9d1+1.2d1*pd2))*u60
  u44=+u424*(2.84441212572713995d7*u73+u474*(6.7d1*u47+u487))*u60
  u65=1.6333035943571056d-1*u69
  u490=-3.56357147859732131d-1*u464
  u67=2.67267860894799098d-1*u70
  value=value+(c(70)*(y*(u339*(u491+u337*(u485+u67)+u338*(u51*u338+u435&
 &)+u339*((u65+u440+u446)*u339+u493+u337*(u54+u431)+u44))+u338*(u434+u9&
 &3*u338)+u337*(u490+u486)+u489)))
  u440=+u455*(3.46360590058274705d4*u73+u474)*u60
  u494=2.22723217412332582d-1*u413
  u455=u494*(u483+u474*(3.5d1+u447))*u60
  u45=+u424*(u97+u474*(u470+u425))*u60
  u66=7.42410724707775273d-2*u69
  u437=u494*(u483+u474*(3.5d1+u79))*u60
  u494=-2.22723217412332582d-1*u74
  value=value+(c(71)*(z*(u339*(u455+u494*u337+u339*((u66+u457)*u339+u9*&
 &u337+u45))+u437*u337+u440)))
  u437=u5*u338
  u494=u437+u431
  u441=u426*u338
  u487=u472*u337
  u488=u462*u337
  value=value+(c(72)*(u460*((u89+u338*(u441+u52))*u339+u338*(u477+u487+&
 &u338*(u494+u445))+u488+u469)))
  u493=u337*(u51*u337+u435)
  u413=u337*(u434+u93*u337)
  value=value+(c(73)*(x*(u339*(u480+u338*(u338*(u492+u437)+u422)+(u338*&
 &(u54+u441)+u68)*u339)+u338*(u463+u493+u338*((u55+u432)*u338+u99+u423)&
 &)+u413+u56)))
  value=value+(c(74)*(u460*(u339*(u94+u338*(u437+u451)+(u441+u55)*u339)&
 &+u338*(u468+u337*(u446+u430))+u337*(u456+u459)+u473)))
  u422=u432+u441
  value=value+(c(75)*(x*(u339*(u491+u493+u338*(u478*u338+u67)+u339*((u6&
 &5+u422)*u339+u338*(u54+u437)+u99+u44))+u338*(u490+u481*u338)+u413+u48&
 &9)))
  u413=-8.90892869649330328d-1*u464
  u67=3.56357147859732131d-1*u69
  u489=u472*u338
  u490=u426*u339
  u491=u462*u338
  value=value+(c(76)*(u460*(u339*(u89+u487+u489+u339*(u490+u494+u67))+u&
 &491+u488+u413)))
  u487=-1.32244362861622142d3*u475
  u488=4.45446434824665164d0*u464
  u460=-3.56357147859732131d0*u70
  u68=6.53321437742842241d-1*u69
  u423=u431+u437
  u431=u423+u490
  u492=u85*u337
  u493=u87*u337
  u494=u433*u337
  u490=(u339*(u488+u492+u85*u338+u339*(u339*(u68+u431)+u87*u338+u493+u4&
 &60))+u433*u338+u494+u487)
  value=value+(c(77)*(x*u490))
  value=value+(c(78)*(z*((u95+u338*(u338*(u48+u441)+u466))*u339+u338*(u&
 &442+u492+u338*(u338*(u91+u423)+u493+u46))+u494+u444)))
  u414=u337*(u48*u337+u88)
  u423=u337*(u462+u96*u337)
  value=value+(c(79)*(y*(u339*(u479+u338*(u338*(u49+u437)+u59)+(u338*(u&
 &52+u441)+u89)*u339)+u338*(u476+u414+u338*(u337*(u429+u446)+u449))+u42&
 &3+u439)))
  u495=u448*u338
  value=value+(c(80)*(z*(u339*(u467+u338*(u80*u338+u471)+(u338*(u48+u49&
 &5)+u94)*u339)+u338*(u57+u468*u338)+u83)))
  value=value+(c(81)*(y*(u339*(u482+u43*u338+u339*((u64+u495)*u339+u7*u&
 &338+u461))+u86*u338+u83)))
  value=value+(c(82)*(z*(u339*(u455+u414+u338*(u489+u89)+u339*((u66+u42&
 &2)*u339+u338*(u67+u437)+u419+u45))+u338*(u413+u491)+u423+u440)))
  value=value+(c(83)*(y*u490))
  u460=-5.55426324018812996d4*u475
  u475=2.80631253939539053d1*u464
  u487=-9.35437513131796844d0*u70
  u433=9.79982156614263361d-1*u69
  u69=-4.67718756565898422d0*u464
  u464=4.67718756565898422d0*u70
  value=value+(c(84)*(z*(u339*(u475+u464*u337+u464*u338+u339*(u339*(u43&
 &3+u431)+u428*u338+u428*u337+u487))+u69*u338+u69*u337+u460)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_0=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_1(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_1
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u310
  real(kind=8) :: u311
  real(kind=8) :: u312
  real(kind=8) :: u313
  real(kind=8) :: u350
  real(kind=8) :: u377
  real(kind=8) :: u383
  real(kind=8) :: u385
  real(kind=8) :: u386
  real(kind=8) :: u387
  real(kind=8) :: u388
  real(kind=8) :: u389
  real(kind=8) :: u39
  real(kind=8) :: u390
  real(kind=8) :: u391
  real(kind=8) :: u392
  real(kind=8) :: u393
  real(kind=8) :: u394
  real(kind=8) :: u395
  real(kind=8) :: u396
  real(kind=8) :: u397
  real(kind=8) :: u398
  real(kind=8) :: u399
  real(kind=8) :: u4
  real(kind=8) :: u40
  real(kind=8) :: u400
  real(kind=8) :: u401
  real(kind=8) :: u402
  real(kind=8) :: u403
  real(kind=8) :: u404
  real(kind=8) :: u405
  real(kind=8) :: u406
  real(kind=8) :: u407
  real(kind=8) :: u408
  real(kind=8) :: u409
  real(kind=8) :: u41
  real(kind=8) :: u410
  real(kind=8) :: u411
  real(kind=8) :: u412
  real(kind=8) :: u413
  real(kind=8) :: u414
  real(kind=8) :: u415
  real(kind=8) :: u416
  real(kind=8) :: u417
  real(kind=8) :: u418
  real(kind=8) :: u419
  real(kind=8) :: u42
  real(kind=8) :: u420
  real(kind=8) :: u421
  real(kind=8) :: u422
  real(kind=8) :: u423
  real(kind=8) :: u424
  real(kind=8) :: u425
  real(kind=8) :: u426
  real(kind=8) :: u427
  real(kind=8) :: u428
  real(kind=8) :: u429
  real(kind=8) :: u43
  real(kind=8) :: u430
  real(kind=8) :: u431
  real(kind=8) :: u432
  real(kind=8) :: u433
  real(kind=8) :: u434
  real(kind=8) :: u435
  real(kind=8) :: u436
  real(kind=8) :: u437
  real(kind=8) :: u438
  real(kind=8) :: u439
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u441
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u46
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_1=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u313=a3**(-3)
  u6=exppd2*pd
  u406=-1.41796308072441282d1*u6
  u310=u313*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u406)*p**4
  u84=-7.2741098204156852d-2*u310
  u425=1.8185274551039213d-2*u310
  u310=x**2
  u311=y**2
  u312=z**2
  value=value+(c(1)*(x*(u84*u312+u425*u311+u425*u310)))
  if ( lmax .eq. 0 ) return
  u84=A5_(p,pd,erfpd,exppd2)
  u425=p**5
  u427=u313*u84*u425
  u81=3.42784349598349302d0*u427
  u66=-8.56960873995873256d-1*u427
  u46=-2.57088262198761977d0*u427
  u419=exppd2*pd2
  u446=-2.83592616144882564d1*u419
  u414=u313*(3.2986722862692829d2*u84+u446)*u425
  u84=-7.2741098204156852d-2*u414
  u425=1.8185274551039213d-2*u414
  u414=u425*u310
  value=value+(c(2)*((u81+u84*u310)*u312+(u66+u414)*u311+u310*(u46+u414&
 &)))
  u81=-1.71392174799174651d0*u427
  u66=x*y
  u46=u84*u312+u425*u311+u414
  value=value+(c(3)*(u66*(u46+u81)))
  u81=6.85568699196698605d0*u427
  u414=x*z
  value=value+(c(4)*(u414*(u46+u81)))
  if ( lmax .eq. 1 ) return
  u81=A6_(p,pd,erfpd,exppd2)
  u84=p**6
  u425=u313*u81*u84
  u427=5.14176524397523954d0*u425
  u46=-2.83592616144882564d1*u6
  u411=u313*(3.2986722862692829d2*u81+u46)*u84
  u72=2.18223294612470556d-1*u411
  u385=-5.4555823653117639d-2*u411
  u93=-1.27296921857274491d-1*u411
  u350=2.0d0*pd2
  u413=(9.0d0+u350)
  u400=u313*(2.96880505764235461d3*u81+u46*u413)*u84
  u81=-7.2741098204156852d-2*u400
  u84=1.8185274551039213d-2*u400
  u400=u84*u310
  u424=u81*u310
  value=value+(c(5)*(x*((u72+u424)*u312+(u385+u400)*u311+u310*(u93+u400&
 &)+u427)))
  u427=1.71392174799174651d0*u425
  u72=7.2741098204156852d-2*u411
  u385=-1.8185274551039213d-2*u411
  u93=-9.0926372755196065d-2*u411
  u386=(u72+u424)*u312+(u385+u400)*u311
  value=value+(c(6)*(y*(u386+u310*(u93+u400)+u427)))
  u435=-6.85568699196698605d0*u425
  u425=9.0926372755196065d-2*u411
  value=value+(c(7)*(z*(u386+u310*(u425+u400)+u435)))
  u425=u84*u311
  u386=u400+u425
  u426=u385*u310
  value=value+(c(8)*(x*((u72+u81*u311)*u312+u311*(u93+u386)+u426+u427))&
 &)
  u93=1.09111647306235278d-1*u411
  u424=u66*z
  u427=u81*u312
  value=value+(c(9)*(u424*(u427+u425+u400+u93)))
  u93=3.6370549102078426d-1*u411
  value=value+(c(10)*(x*(u312*(u93+u386+u427)+u385*u311+u426+u435)))
  if ( lmax .eq. 2 ) return
  u93=A7_(p,pd,erfpd,exppd2)
  u84=p**7
  u385=2.83592616144882564d1*exppd2
  u411=-1.55873781866050397d-2*u313*(u385+3.2986722862692829d2*u93)*u84
  u435=u313*u93*u84
  u72=-7.19847134156533535d1*u435
  u90=+u72
  u65=1.79961783539133384d1*u435
  u70=1.61965605185220046d2*u435
  u430=-5.67185232289765129d1*u419
  u76=u313*(2.96880505764235461d3*u93+u430)*u84
  u427=4.36446589224941112d-1*u76
  u47=-1.09111647306235278d-1*u76
  u82=-2.18223294612470556d-1*u76
  u94=(1.1d1+u350)
  u429=u313*(3.26568556340659007d4*u93+u430*u94)*u84
  u80=-7.2741098204156852d-2*u429
  u399=1.8185274551039213d-2*u429
  u397=u399*u310
  u407=u80*u310
  value=value+(c(11)*((u90+u310*(u407+u427))*u312+(u65+u310*(u397+u47))&
 &*u311+u310*(u70+u310*(u397+u82))+u411))
  u411=-u72
  u90=2.18223294612470556d-1*u76
  u65=-5.4555823653117639d-2*u76
  u70=-1.63667470959352917d-1*u76
  u72=(u90+u407)*u312+(u65+u397)*u311
  value=value+(c(12)*(u66*(u72+u310*(u70+u397)+u411)))
  u47=-1.0797707012348003d2*u435
  u82=1.8185274551039213d-2*u76
  value=value+(c(13)*(u414*(u72+u310*(u82+u397)+u47)))
  u47=4.94800842940392435d3*u93
  u72=-5.19579272886834657d-3*u313*(u385+u47)*u84
  u81=1.8185274551039213d-2*u313
  u427=-2.26874092915906051d2*u419
  u426=u81*(1.48440252882117731d4*u93+u427)*u84
  u69=-9.0926372755196065d-2*u76
  u86=-7.2741098204156852d-2*u313
  u99=(1.5d1+u350)
  u442=u419*u99
  u40=+u86*(4.45320758646353191d4*u93-5.67185232289765129d1*u442)*u84
  u388=9.0926372755196065d-2*u429
  u428=u388*u310
  value=value+(c(14)*(u311*(u426+u310*(u428+u40)+(u428+u69)*u311)+u310*&
 &(u426+u69*u310)+u72))
  u72=-3.59923567078266768d1*u435
  u40=7.2741098204156852d-2*u76
  u388=-1.8185274551039213d-2*u76
  u69=5.4555823653117639d-2*u76
  u426=y*z
  value=value+(c(15)*(u426*((u40+u407)*u312+(u388+u397)*u311+u310*(u69+&
 &u397)+u72)))
  u431=2.59789636443417329d-3*u313*(u47+2.26874092915906051d2*exppd2)*u&
 &84
  u391=-1.25973248477393369d2*u435
  u428=-1.8185274551039213d-2*u313
  u401=+u428*(u47+u430)*u84
  u47=3.27334941918705834d-1*u76
  u386=7.2741098204156852d-2*u313
  u430=u386*(8.90641517292706383d3*u93+u446*(6.0d0+pd2))*u84
  u93=-1.8185274551039213d-2*u429
  u429=u93*u310
  value=value+(c(16)*(u312*(u391+u310*(u397+u47)+(u407+u40)*u312)+u311*&
 &(u388+u310*(u429+u430)+(u429+u82)*u311)+u401*u310+u431))
  u84=u397+u399*u311
  u430=u80*u311
  u431=u65*u310
  value=value+(c(17)*(u66*((u90+u430)*u312+u311*(u70+u84)+u431+u411)))
  u391=u388*u310+u72
  value=value+(c(18)*(u414*((u40+u430)*u312+u311*(u69+u84)+u391)))
  u82=u84+u80*u312
  value=value+(c(19)*(u66*(u312*(u47+u82)+u388*u311+u391)))
  u388=-2.87938853662613414d2*u435
  u90=6.54669883837411668d-1*u76
  value=value+(c(20)*(u414*(u312*(u90+u82)+u65*u311+u431+u388)))
  if ( lmax .eq. 3 ) return
  u388=A8_(p,pd,erfpd,exppd2)
  u90=p**8
  u399=u313*u388*u90
  u65=-3.59923567078266768d2*u399
  u391=-5.67185232289765129d1*u6
  u82=u313*(2.96880505764235461d3*u388+u391)*u90
  u69=-1.09111647306235278d0*u82
  u47=2.72779118265588195d-1*u82
  u76=1.36389559132794098d0*u82
  u72=3.26568556340659007d4*u388
  u411=u313*(u72+u391*u94)*u90
  u435=7.2741098204156852d-1*u411
  u84=-1.8185274551039213d-1*u411
  u94=-3.27334941918705834d-1*u411
  u431=pd2**2
  u80=4.0d0*u431
  u40=(u350+1.1d1)
  u70=u313*(4.24539123242856709d5*u388+u391*(1.3d1*u40+u80))*u90
  u401=-7.2741098204156852d-2*u70
  u41=1.8185274551039213d-2*u70
  u394=u41*u310
  u403=u401*u310
  value=value+(c(21)*(x*((u69+u310*(u403+u435))*u312+(u47+u310*(u394+u8&
 &4))*u311+u310*(u76+u310*(u394+u94))+u65)))
  u65=-7.19847134156533535d1*u399
  u69=-2.18223294612470556d-1*u82
  u47=5.4555823653117639d-2*u82
  u76=7.09225707490529307d-1*u82
  u435=4.36446589224941112d-1*u411
  u84=-1.09111647306235278d-1*u411
  u94=-2.54593843714548982d-1*u411
  u447=(u69+u310*(u403+u435))*u312+(u47+u310*(u394+u84))*u311
  value=value+(c(22)*(y*(u447+u310*(u76+u310*(u394+u94))+u65)))
  u98=1.0797707012348003d2*u399
  u49=-3.81890765571823473d-1*u82
  u95=-7.2741098204156852d-2*u411
  value=value+(c(23)*(z*(u447+u310*(u49+u310*(u394+u95))+u98)))
  u98=-4.36446589224941112d-1*u313*(1.64933614313464145d3*u388+u46)*u90
  u46=1.63284278170329504d5*u388
  u447=5.4555823653117639d-2*u313
  u78=8.0d0*pd2
  u416=u447*(u46+u391*(5.5d1+u78))*u90
  u96=-2.72779118265588195d-1*u411
  u430=u6*(6.5d1+u78)
  u4=u81*(1.9297232874675305d5*u388-5.67185232289765129d1*u430)*u90
  u51=-2.90964392816627408d-1*u313*(u46+u391*(5.0d0*u40+u431))*u90
  u46=9.0926372755196065d-2*u70
  u97=-9.0926372755196065d-2*u411
  u415=u46*u310
  u58=u310*(u415+u51)
  value=value+(c(24)*(x*(u311*(u416+u58+(u415+u96)*u311)+u310*(u4+u97*u&
 &310)+u98)))
  u377=2.18223294612470556d-1*u411
  u85=-5.4555823653117639d-2*u411
  u89=-1.8185274551039213d-2*u411
  value=value+(c(25)*(u424*((u377+u403)*u312+(u85+u394)*u311+u310*(u89+&
 &u394)+u69)))
  u439=u447*(4.94800842940392435d3*u388+u391)*u90
  u52=-1.03656064940923514d0*u82
  u55=5.4555823653117639d-2*u411
  u397=u6*u99
  u99=+u428*(4.45320758646353191d4*u388-5.67185232289765129d1*u397)*u90
  u436=2.54593843714548982d-1*u411
  u77=u313*(u72+u406*(4.0d0*u40+u431))*u90
  u72=2.90964392816627408d-1*u77
  u406=-1.8185274551039213d-2*u70
  u408=u406*u310
  u68=u310*(u408+u72)
  value=value+(c(26)*(x*(u312*(u52+u310*(u394+u436)+(u403+u377)*u312)+u&
 &311*(u85+u68+(u408+u55)*u311)+u99*u310+u439)))
  value=value+(c(27)*(y*(u311*(u4+u58+(u415+u97)*u311)+u310*(u416+u96*u&
 &310)+u98)))
  u439=-1.09111647306235278d-1*u313
  u51=-1.13437046457953026d2*u6
  u55=+u439*(5.60774288665778093d3*u388+u51)*u90
  u46=(1.3d1+u350)
  u97=u6*u46
  u416=u313*(3.85944657493506099d4*u388-5.67185232289765129d1*u97)*u90
  u4=7.2741098204156852d-2*u416
  u98=1.63667470959352917d-1*u82
  u436=u447*(1.39533837709190667d5*u388+u391*(4.7d1+u78))*u90
  u99=-1.16385757126650963d0*u77
  u52=7.2741098204156852d-2*u70
  u58=-2.18223294612470556d-1*u411
  u390=-2.36408569163509769d-1*u411
  u432=u52*u310
  value=value+(c(28)*(z*(u312*(u4+u310*(u432+u99)+(u432+u95)*u312)+u311&
 &*(u98+u310*(u394+u58)+(u394+u89)*u311)+u310*(u436+u390*u310)+u55)))
  u55=u447*(3.62853951489621119d3*u388+u391)*u90
  u4=7.2741098204156852d-2*u411
  u98=-1.8185274551039213d-2*u416
  u436=1.8185274551039213d-2*u411
  u99=-5.4555823653117639d-2*u416
  u58=3.27334941918705834d-1*u411
  u390=3.6370549102078426d-2*u411
  value=value+(c(29)*(y*(u312*(u49+u310*(u394+u58)+(u403+u4)*u312)+u311&
 &*(u98+u68+(u408+u436)*u311)+u310*(u99+u390*u310)+u55)))
  u416=u447*(8.24668071567320725d3*u388+u391)*u90
  u52=7.42201264410588653d4*u388
  u432=-3.6370549102078426d-2*u313
  u450=(2.5d1+pd2)
  u415=u6*u450
  u387=+u432*(u52-5.67185232289765129d1*u415)*u90
  u417=9.0926372755196065d-2*u411
  u403=-5.4555823653117639d-2*u313
  u75=(2.5d1+u350)
  u77=u6*u75
  u433=+u403*(u52-5.67185232289765129d1*u77)*u90
  u52=3.6370549102078426d-2*u313
  u95=2.0d0*u431
  u434=u52*(8.16421390851647518d5*u388+u391*(2.5d1*u40+u95))*u90
  u388=-9.0926372755196065d-2*u70
  value=value+(c(30)*(z*(u312*(u387+u434*u310+(u388*u310+u417)*u312)+u4&
 &33*u310+u416)))
  u416=u41*u311
  u387=u416+u394
  u417=u401*u311
  u433=u84*u310
  u434=u47*u310
  value=value+(c(31)*(x*((u69+u311*(u417+u435))*u312+u311*(u76+u433+u31&
 &1*(u387+u94))+u434+u65)))
  u388=u394+u416
  u435=u85*u310
  value=value+(c(32)*(u424*((u377+u417)*u312+u311*(u89+u388)+u435+u69))&
 &)
  value=value+(c(33)*(x*(u312*(u49+u311*(u416+u58)+(u417+u4)*u312)+u311&
 &*(u99+u68+(u408+u390)*u311)+u310*(u98+u436*u310)+u55)))
  u377=-7.63781531143646946d-1*u82
  u4=6.18299334735333242d-1*u411
  u436=u401*u312
  value=value+(c(34)*(u424*(u312*(u4+u388+u436)+u85*u311+u435+u377)))
  u377=2.87938853662613414d2*u399
  u4=-2.83690282996211723d0*u82
  u58=1.01837537485819593d0*u411
  value=value+(c(35)*(x*(u312*(u4+u433+u84*u311+u312*(u436+u387+u58))+u&
 &47*u311+u434+u377)))
  if ( lmax .eq. 4 ) return
  u377=A9_(p,pd,erfpd,exppd2)
  u4=2.96880505764235461d3*u377
  u58=p**9
  u390=1.21235163673594753d-1*u313*(u4+5.67185232289765129d1*exppd2)*u5&
 &8
  u411=u313*u377*u58
  u436=3.23931210370440091d3*u411
  u49=-8.09828025926100228d2*u411
  u401=-1.53867324925959043d4*u411
  u47=-1.13437046457953026d2*u419
  u406=u313*(3.26568556340659007d4*u377+u47)*u58
  u76=-3.27334941918705834d0*u406
  u55=8.18337354796764585d-1*u406
  u82=3.00057030092147015d0*u406
  u65=u313*(4.24539123242856709d5*u377+u47*u46)*u58
  u399=1.09111647306235278d0*u65
  u90=-2.72779118265588195d-1*u65
  u72=-4.54631863775980325d-1*u65
  u433=(u350+1.3d1)
  u41=1.5d1*u433
  u387=(u41+u80)
  u69=u313*(6.36808684864285064d6*u377+u47*u387)*u58
  u68=-7.2741098204156852d-2*u69
  u40=1.8185274551039213d-2*u69
  u396=u40*u310
  u402=u68*u310
  value=value+(c(36)*((u436+u310*(u310*(u399+u402)+u76))*u312+(u49+u310&
 &*(u310*(u90+u396)+u55))*u311+u310*(u401+u310*(u310*(u72+u396)+u82))+u&
 &390))
  u390=-4.85896815555660137d3*u411
  u49=-1.09111647306235278d0*u406
  u401=2.72779118265588195d-1*u406
  u76=1.72760108234872524d0*u406
  u55=7.2741098204156852d-1*u65
  u82=-1.8185274551039213d-1*u65
  u399=-3.6370549102078426d-1*u65
  u72=u310*(u396+u82)
  u410=(u49+u310*(u402+u55))*u312+(u401+u72)*u311
  value=value+(c(37)*(u66*(u410+u310*(u76+u310*(u396+u399))+u390)))
  u441=-9.0926372755196065d-2*u406
  value=value+(c(38)*(u414*(u410+u310*(u441+u72)+u436)))
  u441=1.48440252882117731d4*u377
  u436=4.84940654694379013d-2*u313*(u441+u385)*u58
  u385=+u403*(1.63284278170329504d5*u377-4.53748185831812103d2*u419)*u5&
 &8
  u410=+u403*(3.11724531052447234d5*u377-9.07496371663624206d2*u419)*u5&
 &8
  u72=1.6d1*pd2
  u394=(1.35d2+u72)
  u91=u447*(4.4086755105988966d6*u377+u47*u394)*u58
  u56=-5.4555823653117639d-1*u65
  u408=4.0d0*pd2
  u440=u52*(1.46955850353296553d6*u377+u47*(4.5d1+u408))*u58
  u417=1.6d1*u431
  u89=1.05d2*u433
  u63=+u428*(4.45766079404999545d7*u377+u47*(u89+u417))*u58
  u43=9.0926372755196065d-2*u69
  u8=-9.0926372755196065d-2*u65
  u404=u43*u310
  u429=u310*(u63+u404)
  value=value+(c(39)*(u311*(u385+u310*(u429+u91)+(u310*(u56+u404)+u401)&
 &*u311)+u310*(u410+u310*(u8*u310+u440))+u436))
  u84=6.47862420740880182d2*u411
  u5=-2.18223294612470556d-1*u406
  u395=5.4555823653117639d-2*u406
  u435=-1.63667470959352917d-1*u406
  u39=4.36446589224941112d-1*u65
  u83=-1.09111647306235278d-1*u65
  u425=u310*(u396+u83)
  value=value+(c(40)*(u426*((u5+u310*(u402+u39))*u312+(u395+u425)*u311+&
 &u310*(u435+u425)+u84)))
  u425=+u428*(1.13437046457953026d2*exppd2+u441)*u58
  u441=3.07734649851918086d3*u411
  u64=-5.4555823653117639d-2*u406
  u423=1.09111647306235278d-1*u313
  u434=u423*(4.45320758646353191d4*u377+u47)*u58
  u42=-1.80034218055288209d0*u406
  u54=u313*(8.81735102119779319d5*u377+u47*(2.7d1+u408))*u58
  u57=-5.4555823653117639d-2*u54
  u437=1.09111647306235278d-1*u65
  u98=u313*(4.89852834510988511d5*u377-1.13437046457953026d2*u442)*u58
  u442=-1.8185274551039213d-2*u98
  u383=1.63667470959352917d-1*u65
  u73=u313*(8.9153215880999909d6*u377+u47*(2.1d1*u433+u80))*u58
  u443=1.8185274551039213d-2*u73
  u92=-1.8185274551039213d-2*u69
  u398=u92*u310
  value=value+(c(41)*(u312*(u441+u310*(u310*(u383+u396)+u42)+(u310*(u39&
 &+u402)+u5)*u312)+u311*(u395+u310*(u310*(u443+u398)+u57)+(u310*(u437+u&
 &398)+u64)*u311)+u310*(u434+u442*u310)+u425))
  u425=7.42201264410588653d4*u377
  u443=-3.27334941918705834d-1*u313*(u425+u427)*u58
  u64=2.44926417255494255d6*u377
  u434=(7.5d1+u78)
  u383=u447*(u64+u47*u434)*u58
  u57=1.06134780810714177d7*u377
  u437=2.5d1*u433
  u85=(u437+u80)
  u441=+u86*(u57+u47*u85)*u58
  value=value+(c(42)*(u66*(u311*(u383+u310*(u404+u441)+(u404+u90)*u311)&
 &+u310*(u383+u90*u310)+u443)))
  u443=u313*(9.8960168588078487d2*u377-3.54490770181103205d0*u419)*u58
  u441=-2.09494362827971734d1*u443
  u383=2.18223294612470556d-1*u98
  u42=-2.18223294612470556d-1*u65
  u442=6.00114060184294029d-1*u406
  u86=-5.4555823653117639d-2*u65
  u419=u81*(6.30277313737471884d6*u377+u47*(1.93d2+2.4d1*pd2))*u58
  u70=(5.0d0*u433+u431)
  u78=u313*(2.12269561621428355d6*u377+u47*u70)*u58
  u53=-2.90964392816627408d-1*u78
  u44=7.2741098204156852d-2*u69
  u67=-2.90964392816627408d-1*u65
  u393=-2.36408569163509769d-1*u65
  u400=u310*(u396+u67)
  u409=u44*u310
  value=value+(c(43)*(u414*(u312*(u383+u310*(u409+u53)+(u409+u42)*u312)&
 &+u311*(u442+u400+(u396+u86)*u311)+u310*(u419+u393*u310)+u441)))
  u90=1.63667470959352917d-1*u313
  u50=u90*(3.66152623775890402d4*u377+u47)*u58
  u7=-1.03656064940923514d0*u406
  u388=2.18223294612470556d-1*u65
  u87=-5.4555823653117639d-2*u98
  u98=5.4555823653117639d-2*u65
  u74=+u428*(1.53487221480109733d6*u377+u47*(4.7d1+6.0d0*pd2))*u58
  u48=2.54593843714548982d-1*u65
  u71=7.2741098204156852d-2*u78
  u96=3.6370549102078426d-2*u65
  u94=u310*(u398+u71)
  value=value+(c(44)*(u66*(u312*(u7+u310*(u396+u48)+(u402+u388)*u312)+u&
 &311*(u87+u94+(u398+u98)*u311)+u310*(u74+u96*u310)+u50)))
  u79=u313*(u425+u47)*u58
  u418=1.63667470959352917d-1*u79
  u88=8.16421390851647518d5*u377
  u438=+u439*(u88+u47*u450)*u58
  u439=2.72779118265588195d-1*u65
  u450=+u403*(u88+u47*u75)*u58
  u78=(u437+u95)
  u88=u52*(u57+u47*u78)*u58
  u57=-9.0926372755196065d-2*u69
  u437=u57*u310
  value=value+(c(45)*(u414*(u312*(u438+u88*u310+(u437+u439)*u312)+u450*&
 &u310+u418)))
  u418=u401*u310
  value=value+(c(46)*(u311*(u410+u310*(u56*u310+u91)+u311*((u8+u404)*u3&
 &11+u429+u440))+u310*(u385+u418)+u436))
  u438=u44*u311
  u439=u86*u310
  value=value+(c(47)*(u426*(u312*(u383+u311*(u438+u53)+(u438+u42)*u312)&
 &+u311*(u419+u400+(u396+u393)*u311)+u310*(u442+u439)+u441)))
  u429=9.69881309388758027d-2*u313*(u4-7.08981540362206411d0*exppd2)*u5&
 &8
  u450=-2.18223294612470556d-1*u313
  u56=+u450*(6.23449062104894468d4*u377+u427)*u58
  u436=2.93911700706593106d5*u377
  u8=1.45482196408313704d-1*u313
  u4=u8*(u436+u47*(9.0d0+pd2))*u58
  u393=-7.2741098204156852d-2*u65
  u91=5.23735907069929335d0*u443
  u440=+u428*(6.85793968315383915d5*u377+u47*(2.1d1+u350))*u58
  u43=1.8185274551039213d-2*u65
  u419=+u450*(8.90641517292706383d3*u377+u446)*u58
  u385=2.18223294612470556d-1*u54
  u410=-7.2741098204156852d-2*u73
  u441=-1.09111647306235278d-1*u54
  u54=u81*(1.14625563275571312d7*u377+u47*(2.7d1*u433+u80))*u58
  u442=+u428*(u436+u47*u413)*u58
  u436=-4.36446589224941112d-1*u65
  u443=-3.6370549102078426d-2*u69
  value=value+(c(48)*(u312*(u56+u310*(u436*u310+u385)+u312*((u393+u409)&
 &*u312+u310*(u410+u409)+u4))+u311*(u91+u310*(u310*(u54+u398)+u441)+u31&
 &1*((u43+u398)*u311+u310*(u54+u443*u310)+u440))+u310*(u419+u310*(u43*u&
 &310+u442))+u429))
  u429=u90*(4.65112792363968889d4*u377+u47)*u58
  u56=+u432*(1.33893108099670193d6*u377+u47*(4.1d1+3.0d0*pd2))*u58
  u4=1.27296921857274491d-1*u65
  u393=-7.63781531143646946d-1*u406
  u91=6.18299334735333242d-1*u65
  u440=u92*u311
  value=value+(c(49)*(u426*(u312*(u56+u310*(u396+u91)+u311*(u440+u71)+(&
 &u440+u402+u4)*u312)+u311*(u87+u98*u311)+u310*(u393+u439)+u429)))
  u419=-6.06175818367973767d-3*u313*(9.07496371663624206d2*exppd2+u425)&
 &*u58
  u385=u447*(2.22660379323176596d5*u377+u427)*u58
  u410=+u428*(u64+u47*(7.5d1+u350))*u58
  u441=9.0926372755196065d-2*u65
  u442=5.4555823653117639d-2*u79
  u436=(7.5d1+u408)
  u443=+u403*(u64+u47*u436)*u58
  u43=7.5d1*u433
  u427=(u43+u80)
  u438=u81*(3.18404342432142532d7*u377+u47*u427)*u58
  value=value+(c(50)*(u312*(u385+u443*u310+u312*((u441+u437)*u312+u438*&
 &u310+u410))+u442*u310+u419))
  u419=u40*u311
  u385=u419+u396
  u410=u68*u311
  u441=u82*u310
  value=value+(c(51)*(u66*((u49+u311*(u410+u55))*u312+u311*(u76+u441+u3&
 &11*(u385+u399))+u418+u390)))
  u442=u83*u310
  u443=u395*u310
  value=value+(c(52)*(u414*((u5+u311*(u410+u39))*u312+u311*(u435+u442+u&
 &311*(u385+u83))+u443+u84)))
  u437=u310*(u87+u98*u310)
  value=value+(c(53)*(u66*(u312*(u7+u311*(u419+u48)+(u410+u388)*u312)+u&
 &311*(u74+u94+(u398+u96)*u311)+u437+u50)))
  value=value+(c(54)*(u414*(u312*(u56+u94+u311*(u419+u91)+(u410+u398+u4&
 &)*u312)+u311*(u393+u86*u311)+u437+u429)))
  u437=2.26751847259308064d3*u411
  u438=-2.61867953534964667d0*u406
  u87=9.82004825756117503d-1*u65
  u419=u68*u312+u385
  value=value+(c(55)*(u66*(u312*(u438+u442+u83*u311+u312*(u419+u87))+u3&
 &95*u311+u443+u437)))
  u437=1.94358726222264055d4*u411
  u438=-6.91040432939490094d0*u406
  u87=1.45482196408313704d0*u65
  value=value+(c(56)*(u414*(u312*(u438+u441+u82*u311+u312*(u419+u87))+u&
 &401*u311+u418+u437)))
  if ( lmax .eq. 5 ) return
  u437=A10_(p,pd,erfpd,exppd2)
  u438=p**10
  u87=u313*u437*u438
  u419=3.40127770888962096d4*u87
  u425=u313*(3.26568556340659007d4*u437+u51)*u438
  u86=7.63781531143646946d0*u425
  u418=-1.90945382785911737d0*u425
  u441=-1.71850844507320563d1*u425
  u94=u313*(4.24539123242856709d5*u437-1.13437046457953026d2*u97)*u438
  u91=-7.63781531143646946d0*u94
  u65=1.90945382785911737d0*u94
  u429=5.7283614835773521d0*u94
  u64=6.36808684864285064d6*u437
  u68=u313*(u64+u51*u387)*u438
  u96=1.52756306228729389d0*u68
  u53=-3.81890765571823473d-1*u68
  u48=-6.00114060184294029d-1*u68
  u84=(u80+1.5d1*u46)
  u400=pd2**3
  u402=8.0d0*u400
  u40=u313*(1.08257476426928461d8*u437+u51*(1.7d1*u84+u402))*u438
  u46=-7.2741098204156852d-2*u40
  u7=1.8185274551039213d-2*u40
  u393=u7*u310
  u97=u310*(u53+u393)
  u401=u46*u310
  value=value+(c(57)*(x*((u86+u310*(u310*(u96+u401)+u91))*u312+(u418+u3&
 &10*(u97+u65))*u311+u310*(u441+u310*(u310*(u48+u393)+u429))+u419)))
  u419=4.85896815555660137d3*u87
  u86=1.09111647306235278d0*u425
  u418=-2.72779118265588195d-1*u425
  u441=-6.81947795663970488d0*u425
  u91=-3.27334941918705834d0*u94
  u429=8.18337354796764585d-1*u94
  u96=3.54612853745264654d0*u94
  u48=1.09111647306235278d0*u68
  u82=-2.72779118265588195d-1*u68
  u388=-4.91002412878058751d-1*u68
  u422=(u86+u310*(u310*(u48+u401)+u91))*u312+(u418+u310*(u310*(u82+u393&
 &)+u429))*u311
  value=value+(c(58)*(y*(u422+u310*(u441+u310*(u310*(u388+u393)+u96))+u&
 &419)))
  u76=-3.23931210370440091d3*u87
  u50=1.36389559132794098d0*u425
  u443=-3.09149667367666621d-1*u68
  value=value+(c(59)*(z*(u422+u310*(u50+u310*(u310*(u443+u393)+u429))+u&
 &76)))
  u76=7.42201264410588653d4*u437
  u50=u313*(u76-2.26874092915906051d2*u6)*u438
  u443=5.4555823653117639d-1*u50
  u422=2.12269561621428355d6*u437
  u409=-2.72779118265588195d-1*u313
  u98=+u409*(u422-1.13437046457953026d2*u430)*u438
  u414=1.36389559132794098d0*u94
  u44=-9.0926372755196065d-2*u313
  u430=+u44*(4.4086755105988966d6*u437+u51*u394)*u438
  u390=3.2d1*u431
  u394=9.0926372755196065d-2*u313
  u55=u394*(7.0048955335071357d7*u437+u51*(1.65d2*u433+u390))*u438
  u404=-9.0926372755196065d-1*u68
  u56=u8*(u64+u51*(u41+u95))*u438
  u64=3.2d1*u400
  u4=+u428*(8.59691724566784836d8*u437+u51*(1.35d2*u84+u64))*u438
  u8=9.0926372755196065d-2*u40
  u435=-9.0926372755196065d-2*u68
  u399=u8*u310
  u377=u310*(u4+u399)
  value=value+(c(60)*(x*(u311*(u98+u310*(u377+u55)+(u310*(u404+u399)+u4&
 &14)*u311)+u310*(u430+u310*(u435*u310+u56))+u443)))
  u83=5.4555823653117639d-1*u425
  u92=-1.09111647306235278d0*u94
  u396=2.72779118265588195d-1*u94
  u49=7.2741098204156852d-1*u68
  u410=-1.8185274551039213d-1*u68
  u71=-2.18223294612470556d-1*u68
  value=value+(c(61)*(u424*((u92+u310*(u401+u49))*u312+(u396+u310*(u393&
 &+u410))*u311+u310*(u396+u310*(u393+u71))+u83)))
  u79=+u409*(4.45320758646353191d4*u437+u51)*u438
  u446=4.63724501051499932d0*u425
  u63=-2.72779118265588195d-1*u94
  u88=u313*(4.89852834510988511d5*u437-1.13437046457953026d2*u397)*u438
  u406=1.8185274551039213d-1*u88
  u440=-2.45501206439029376d0*u94
  u439=8.0d0*u431
  u39=+u44*(1.40097910670142714d7*u437+u51*(3.3d1*u433+u439))*u438
  u57=1.8185274551039213d-1*u68
  u426=-1.8185274551039213d-2*u68
  u42=5.4555823653117639d-2*u68
  u445=u81*(1.71938344913356967d8*u437+u51*(2.7d1*u84+u402))*u438
  u397=-1.8185274551039213d-2*u40
  u395=u397*u310
  value=value+(c(62)*(x*(u312*(u446+u310*(u310*(u42+u393)+u440)+(u310*(&
 &u49+u401)+u92)*u312)+u311*(u396+u310*(u310*(u445+u395)+u39)+(u310*(u5&
 &7+u395)+u63)*u311)+u310*(u406+u426*u310)+u79)))
  u79=3.27334941918705834d-1*u50
  u446=2.44926417255494255d6*u437
  u406=+u403*(u446+u51*u434)*u438
  u440=-1.63667470959352917d-1*u313
  u39=+u440*(4.08210695425823759d6*u437+u51*(1.25d2+u72))*u438
  u57=u447*(7.42943465674999241d7*u437+u51*(1.75d2*u433+u390))*u438
  u445=-5.4555823653117639d-1*u68
  u50=1.06134780810714177d7*u437
  u74=u313*(u50+u51*u85)*u438
  u58=2.18223294612470556d-1*u74
  u5=+u428*(7.9601085608035633d8*u437+u51*(1.25d2*u84+u64))*u438
  u64=u310*(u5+u399)
  u411=u82*u310
  value=value+(c(63)*(y*(u311*(u406+u310*(u64+u57)+(u310*(u445+u399)+u3&
 &96)*u311)+u310*(u39+u310*(u411+u58))+u79)))
  u383=2.09494362827971734d1*u313*(9.8960168588078487d2*u437-3.54490770&
 &181103205d0*u6)*u438
  u73=-2.18223294612470556d-1*u88
  u95=2.18223294612470556d-1*u94
  u67=-6.00114060184294029d-1*u425
  u434=5.4555823653117639d-2*u94
  u416=+u440*(3.49428355284505138d6*u437+u51*(1.07d2+u72))*u438
  u75=u313*(1.48588693134999848d7*u437+u51*(3.5d1*u433+u439))*u438
  u47=2.18223294612470556d-1*u75
  u413=-4.36446589224941112d-1*u68
  u69=1.47300723863417626d0*u94
  u54=-1.09111647306235278d-1*u68
  u59=u423*(1.82551822994428385d7*u437+u51*(4.3d1*u433+u439))*u438
  u444=1.59202171216071266d8*u437
  u420=2.5d1*u84
  u62=u313*(u444+u51*(u420+u402))*u438
  u389=-7.2741098204156852d-2*u62
  u9=7.2741098204156852d-2*u40
  u85=-2.36408569163509769d-1*u68
  u412=u9*u310
  u392=u310*(u389+u412)
  value=value+(c(64)*(z*(u312*(u73+u310*(u392+u47)+(u310*(u413+u412)+u9&
 &5)*u312)+u311*(u67+u310*(u97+u69)+(u310*(u54+u393)+u434)*u311)+u310*(&
 &u416+u310*(u85*u310+u59))+u383)))
  u451=+u440*(3.66152623775890402d4*u437+u51)*u438
  u385=1.03656064940923514d0*u425
  u72=-2.18223294612470556d-1*u94
  u398=5.4555823653117639d-2*u88
  u88=-5.4555823653117639d-2*u94
  u93=6.54669883837411668d-1*u313*(2.28597989438461305d5*u437+u51*(7.0d&
 &0+pd2))*u438
  u41=-1.80034218055288209d0*u94
  u60=4.36446589224941112d-1*u68
  u442=-5.4555823653117639d-2*u75
  u45=1.09111647306235278d-1*u68
  u99=+u403*(8.06624334161427748d6*u437+u51*(1.9d1*u433+u80))*u438
  u61=1.63667470959352917d-1*u68
  u75=1.8185274551039213d-2*u62
  u62=3.6370549102078426d-2*u68
  u407=u310*(u75+u395)
  value=value+(c(65)*(y*(u312*(u385+u310*(u310*(u61+u393)+u41)+(u310*(u&
 &60+u401)+u72)*u312)+u311*(u398+u310*(u407+u442)+(u310*(u45+u395)+u88)&
 &*u311)+u310*(u93+u310*(u62*u310+u99))+u451)))
  u405=+u440*(u76+u51)*u438
  u76=8.16421390851647518d5*u437
  u421=u423*(u76-1.13437046457953026d2*u415)*u438
  u423=u313*(u76-1.13437046457953026d2*u77)*u438
  u449=3.27334941918705834d-1*u423
  u448=+u450*(u50+u51*u78)*u438
  u50=5.4555823653117639d-1*u68
  u78=-5.4555823653117639d-2*u74
  u450=u52*(u444+u51*(u420+4.0d0*u400))*u438
  u74=-9.0926372755196065d-2*u40
  u420=u74*u310
  u444=u78*u310
  value=value+(c(66)*(z*(u312*(u421+u310*(u450*u310+u448)+(u310*(u50+u4&
 &20)+u63)*u312)+u310*(u449+u444)+u405)))
  u421=u396*u310
  value=value+(c(67)*(x*(u311*(u39+u310*(u445*u310+u57)+u311*((u82+u399&
 &)*u311+u64+u58))+u310*(u406+u421)+u79)))
  u449=u313*(u76+u51*(2.5d1+u408))*u438
  u448=-3.27334941918705834d-1*u449
  u450=3.18404342432142532d7*u437
  u63=u447*(u450+u51*(u43+u417))*u438
  value=value+(c(68)*(u66*(u311*(u63+u310*(u399+u389)+(u399+u82)*u311)+&
 &u310*(u63+u411)+u448)*z))
  u448=u313*(1.48440252882117731d4*u437+u391)*u438
  u406=4.36446589224941112d-1*u448
  u39=-6.54669883837411668d-1*u449
  u79=u313*(u422+u51*u70)*u438
  u76=8.72893178449882224d-1*u79
  u70=1.14298994719230652d6*u437
  u77=2.18223294612470556d-1*u313*(u70+u391*(7.0d1+1.1d1*pd2))*u438
  u391=u313*u6
  u58=-4.12576766819373212d0*u391*pd2*u438
  u417=+u432*(5.73127816377856558d7*u437+u51*(1.35d2*u433+u390))*u438
  u390=u81*(2.22883039702499772d8*u437+u51*(3.5d1*u84+u402))*u438
  u66=u81*(2.10146866005214071d8*u437+u51*(3.3d1*u84+u402))*u438
  u6=-3.6370549102078426d-2*u40
  u64=1.8185274551039213d-2*u68
  u445=u6*u310
  value=value+(c(69)*(x*(u312*(u39+u310*(u413*u310+u47)+u312*((u71+u412&
 &)*u312+u392+u76))+u311*(u77+u310*(u310*(u66+u395)+u417)+u311*((u42+u3&
 &95)*u311+u310*(u390+u445)+u78))+u310*(u58+u310*(u64*u310+u426))+u406)&
 &))
  u63=1.63667470959352917d-1*u423
  u5=-u65
  u65=2.18223294612470556d-1*u68
  u57=-5.4555823653117639d-2*u68
  u415=u386*(u450+u51*(5.0d0*u84+2.0d0*u400))*u438
  u392=u395+u415
  value=value+(c(70)*(u424*(u312*(u5+u310*(u393+u50)+(u401+u65)*u312)+u&
 &311*(u57+u310*(u392)+(u395+u42)*u311)+u444+u63)))
  u422=u90*(u446+u51*u436)*u438
  u436=+u403*(u450+u51*u427)*u438
  u446=2.72779118265588195d-1*u68
  u447=5.4555823653117639d-2*u423
  u423=+u403*(u450+u51*(u43+u439))*u438
  u450=u81*(4.77606513648213798d8*u437+u51*(7.5d1*u84+u402))*u438
  value=value+(c(71)*(x*(u312*(u422+u423*u310+u312*((u446+u420)*u312+u4&
 &50*u310+u436))+u447*u310+u405)))
  value=value+(c(72)*(y*(u311*(u430+u310*(u404*u310+u55)+u311*((u435+u3&
 &99)*u311+u377+u56))+u310*(u98+u414*u310)+u443)))
  u422=u9*u311
  u450=u311*(u389+u422)
  u446=u54*u310
  u447=u434*u310
  value=value+(c(73)*(z*(u312*(u73+u311*(u450+u47)+(u311*(u413+u422)+u9&
 &5)*u312)+u311*(u416+u310*(u446+u69)+u311*((u85+u393)*u311+u97+u59))+u&
 &310*(u67+u447)+u383)))
  u423=u42*u310
  value=value+(c(74)*(y*(u312*(u39+u311*(u413*u311+u47)+u312*((u71+u422&
 &)*u312+u450+u76))+u311*(u58+u310*(u310*(u390+u395)+u417)+u311*((u64+u&
 &395)*u311+u310*(u66+u445)+u426))+u310*(u77+u310*(u423+u78))+u406)))
  u450=1.52756306228729389d0*u448
  u390=+u432*(7.34779251766482766d6*u437+u51*(2.25d2+3.4d1*pd2))*u438
  u39=u52*(1.91042605459285519d7*u437+u51*(4.5d1*u433+u439))*u438
  u66=-7.2741098204156852d-2*u68
  u52=1.63667470959352917d-1*u449
  u449=-2.18223294612470556d-1*u79
  u67=+u403*(6.04151829230219163d6*u437+u51*(1.85d2+2.8d1*pd2))*u438
  u405=u81*(2.35619213399785474d8*u437+u51*(5.55d2*u433+1.36d2*u431))*u&
 &438
  u389=+u432*(3.24772429280785383d8*u437+u51*(5.1d1*u84+1.6d1*u400))*u4&
 &38
  u383=2.47546060091623927d1*u391*u431*u438
  u406=+u428*(-u51*(u402-1.5d1*u387)+9.55213027296427596d7*u437)*u438
  u448=5.4555823653117639d-2*u40
  u413=u397*u311
  u40=u311*(u75+u413)
  value=value+(c(75)*(z*(u312*(u390+u310*(u310*(u406+u395)+u405)+u311*(&
 &u40+u442)+u312*((u66+u412)*u312+u311*(u45+u413)+u310*(u389+u448*u310)&
 &+u39))+u311*(u52+u311*(u42*u311+u449))+u310*(u67+u310*(u423+u383))+u4&
 &50)))
  u412=+u440*(4.65112792363968889d4*u437+u51)*u438
  u440=u90*(1.40424479226483373d6*u437+u51*(4.3d1+u408))*u438
  u39=+u403*(1.65570258064714117d7*u437+u51*(3.9d1*u433+u80))*u438
  u66=1.27296921857274491d-1*u68
  u433=7.63781531143646946d-1*u425
  u403=-2.61867953534964667d0*u94
  u67=9.82004825756117503d-1*u68
  value=value+(c(76)*(y*(u312*(u440+u310*(u446+u403)+u311*(u45*u311+u44&
 &2)+u312*((u66+u401+u413)*u312+u40+u310*(u67+u393)+u39))+u311*(u398+u8&
 &8*u311)+u310*(u433+u447)+u412)))
  u405=+u409*(1.03908177017482411d5*u437+u51)*u438
  u389=u394*(3.42896984157691957d6*u437+u51*(1.05d2+u408))*u438
  u450=4.45766079404999545d7*u437
  u406=+u428*(u450+u51*(u89+u80))*u438
  u448=9.0926372755196065d-2*u68
  u449=2.72779118265588195d-1*u313*(u70+u51*(3.5d1+u350))*u438
  u390=+u44*(u450+u51*(u89+u439))*u438
  u450=u81*(6.68649119107499317d8*u437+u51*(1.05d2*u84+u402))*u438
  value=value+(c(77)*(z*(u312*(u389+u390*u310+u312*((u448+u420)*u312+u4&
 &50*u310+u406))+u449*u310+u405)))
  u405=u7*u311
  u389=u393+u405
  u406=u46*u311
  u448=u429*u310
  u449=u418*u310
  value=value+(c(78)*(x*((u86+u311*(u311*(u48+u406)+u91))*u312+u311*(u4&
 &41+u448+u311*(u311*(u388+u389)+u411+u96))+u449+u419)))
  u390=u405+u393
  u450=u410*u310
  value=value+(c(79)*(u424*((u92+u311*(u406+u49))*u312+u311*(u396+u450+&
 &u311*(u390+u71))+u421+u83)))
  u49=u310*(u45*u310+u442)
  u383=u310*(u398+u88*u310)
  value=value+(c(80)*(x*(u312*(u385+u311*(u311*(u61+u405)+u41)+(u311*(u&
 &60+u406)+u72)*u312)+u311*(u93+u49+u311*((u62+u395)*u311+u407+u99))+u3&
 &83+u451)))
  value=value+(c(81)*(u424*(u312*(u5+u311*(u405+u50)+(u406+u65)*u312)+u&
 &311*(u78+u310*(u413+u392))+u310*(u57+u423)+u63)))
  value=value+(c(82)*(x*(u312*(u440+u49+u311*(u54*u311+u403)+u312*((u66&
 &+u395+u406)*u312+u311*(u67+u405)+u407+u39))+u311*(u433+u434*u311)+u38&
 &3+u412)))
  u383=6.00114060184294029d0*u425
  u39=-6.54669883837411668d0*u94
  u395=1.41845141498105861d0*u68
  u451=u46*u312
  value=value+(c(83)*(u424*(u312*(u39+u450+u410*u311+u312*(u451+u390+u3&
 &95))+u396*u311+u421+u383)))
  u383=-1.94358726222264055d4*u87
  u87=2.72779118265588195d1*u425
  u425=-1.41845141498105861d1*u94
  u94=1.96400965151223501d0*u68
  value=value+(c(84)*(x*(u312*(u87+u448+u429*u311+u312*(u312*(u94+u389+&
 &u451)+u82*u311+u411+u425))+u418*u311+u449+u383)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_1=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_2(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_2
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u227
  real(kind=8) :: u228
  real(kind=8) :: u268
  real(kind=8) :: u336
  real(kind=8) :: u365
  real(kind=8) :: u366
  real(kind=8) :: u367
  real(kind=8) :: u368
  real(kind=8) :: u369
  real(kind=8) :: u37
  real(kind=8) :: u370
  real(kind=8) :: u371
  real(kind=8) :: u372
  real(kind=8) :: u373
  real(kind=8) :: u374
  real(kind=8) :: u375
  real(kind=8) :: u376
  real(kind=8) :: u377
  real(kind=8) :: u378
  real(kind=8) :: u379
  real(kind=8) :: u38
  real(kind=8) :: u380
  real(kind=8) :: u381
  real(kind=8) :: u382
  real(kind=8) :: u383
  real(kind=8) :: u384
  real(kind=8) :: u385
  real(kind=8) :: u386
  real(kind=8) :: u387
  real(kind=8) :: u388
  real(kind=8) :: u389
  real(kind=8) :: u39
  real(kind=8) :: u390
  real(kind=8) :: u391
  real(kind=8) :: u392
  real(kind=8) :: u393
  real(kind=8) :: u394
  real(kind=8) :: u395
  real(kind=8) :: u396
  real(kind=8) :: u397
  real(kind=8) :: u398
  real(kind=8) :: u399
  real(kind=8) :: u4
  real(kind=8) :: u400
  real(kind=8) :: u401
  real(kind=8) :: u41
  real(kind=8) :: u42
  real(kind=8) :: u43
  real(kind=8) :: u44
  real(kind=8) :: u45
  real(kind=8) :: u46
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_2=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u393=a3**(-3)
  u8=exppd2*pd
  u96=-1.41796308072441282d1*u8
  u227=u393*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u96)*p**4
  u395=5.75068874567798574d-2*u227
  u48=-5.75068874567798574d-2*u227
  u227=x**2
  u228=y**2
  value=value+(c(1)*((u395*u228+u48*u227)*z))
  if ( lmax .eq. 0 ) return
  u395=A5_(p,pd,erfpd,exppd2)
  u48=p**5
  u380=u393*u395*u48
  u65=5.41989645495103886d0*u380
  u398=exppd2*pd2
  u64=-2.83592616144882564d1*u398
  u376=u393*(3.2986722862692829d2*u395+u64)*u48
  u395=5.75068874567798574d-2*u376
  u48=-5.75068874567798574d-2*u376
  u376=u395*u228
  u377=u48*u227
  u336=u376+u377
  value=value+(c(2)*(x*(u336+u65)*z))
  u268=-u65
  value=value+(c(3)*(y*(u336+u268)*z))
  u268=-2.70994822747551943d0*u380
  u65=+u268
  u85=-u268
  u268=z**2
  value=value+(c(4)*((u377+u376)*u268+u65*u228+u85*u227))
  if ( lmax .eq. 1 ) return
  u85=A6_(p,pd,erfpd,exppd2)
  u65=p**6
  u48=u393*u85*u65
  u395=-5.41989645495103886d0*u48
  u380=+u395
  u376=-2.83592616144882564d1*u8
  u79=u393*(3.2986722862692829d2*u85+u376)*u65
  u400=-5.75068874567798574d-2*u79
  u336=2.87534437283899287d-1*u79
  u377=2.0d0*pd2
  u368=u393*(2.96880505764235461d3*u85+u376*(9.0d0+u377))*u65
  u85=5.75068874567798574d-2*u368
  u65=-5.75068874567798574d-2*u368
  u368=u65*u227
  value=value+(c(5)*(((u400+u85*u227)*u228+u227*(u336+u368)+u380)*z))
  u336=x*y
  u378=u85*u228
  value=value+(c(6)*(u336*(u378+u368)*z))
  u383=1.15013774913559715d-1*u79
  u68=5.75068874567798574d-2*u79
  u382=u368+u378
  u379=u68*u227
  u392=u400*u228+u379
  value=value+(c(7)*(x*((u383+u382)*u268+u392+u380)))
  u383=-u395
  u380=-2.87534437283899287d-1*u79
  value=value+(c(8)*((u228*(u380+u382)+u379+u383)*z))
  u380=-1.15013774913559715d-1*u79
  value=value+(c(9)*(y*((u380+u382)*u268+u392+u383)))
  u380=-1.72520662370339572d-1*u79
  u400=1.72520662370339572d-1*u79
  value=value+(c(10)*(z*((u382)*u268+u380*u228+u400*u227)))
  if ( lmax .eq. 2 ) return
  u380=A7_(p,pd,erfpd,exppd2)
  u400=p**7
  u68=u393*u380*u400
  u79=-2.27635651107943632d2*u68
  u383=+u79
  u48=2.96880505764235461d3*u380
  u395=-5.67185232289765129d1*u398
  u382=u393*(u48+u395)*u400
  u392=-1.72520662370339572d-1*u382
  u391=5.17561987111018717d-1*u382
  u66=(1.1d1+u377)
  u87=u393*(3.26568556340659007d4*u380+u395*u66)*u400
  u83=5.75068874567798574d-2*u87
  u62=-5.75068874567798574d-2*u87
  u87=u62*u227
  u365=u83*u227
  value=value+(c(11)*(x*((u392+u365)*u228+u227*(u391+u87)+u383)*z))
  u383=-5.75068874567798574d-2*u382
  u391=1.72520662370339572d-1*u382
  value=value+(c(12)*(y*((u383+u365)*u228+u227*(u391+u87))*z))
  u46=5.67185232289765129d1*exppd2
  u369=8.21526963668283677d-3*u393*(u48+u46)*u400
  u384=-5.69089127769859081d1*u68
  u49=+u384
  u82=5.75068874567798574d-2*u382
  u70=u393*(4.94800842940392435d3*u380+u395)*u400
  u72=-5.75068874567798574d-2*u70
  u75=3.45041324740679145d-1*u382
  u5=u393*(8.90641517292706383d3*u380+u64*(6.0d0+pd2))*u400
  u380=2.3002754982711943d-1*u5
  u64=1.15013774913559715d-1*u382
  value=value+(c(13)*((u49+u227*(u87+u75))*u268+u228*(u383+u227*(u87+u3&
 &80)+(u87+u82)*u228)+u227*(u72+u64*u227)+u369))
  u369=u83*u228
  u72=u87+u369
  u380=u82*u227
  value=value+(c(14)*(x*(u228*(u392+u72)+u380)*z))
  value=value+(c(15)*(u336*((u72)*u268+u383*u228+u380)))
  u380=-1.13817825553971816d2*u68
  u370=+u380
  u367=x*z
  u381=u391*u227
  u81=u392*u228+u381
  value=value+(c(16)*(u367*((u64+u72)*u268+u81+u370)))
  u370=-u79
  u64=-5.17561987111018717d-1*u382
  value=value+(c(17)*(y*(u228*(u64+u72)+u381+u370)*z))
  u370=-8.21526963668283677d-3*u393*(u46+u48)*u400
  u64=-u384
  u48=5.75068874567798574d-2*u70
  u70=-3.45041324740679145d-1*u382
  u400=-1.15013774913559715d-1*u382
  u382=-2.3002754982711943d-1*u5
  value=value+(c(18)*((u64+u228*(u369+u70))*u268+u228*(u48+u227*(u365+u&
 &382)+(u365+u400)*u228)+u227*(u82+u383*u227)+u370))
  u382=-u380
  u365=y*z
  value=value+(c(19)*(u365*((u400+u72)*u268+u81+u382)))
  value=value+(c(20)*(u268*(u75*u227+u70*u228+(u369+u87)*u268)+u64*u228&
 &+u49*u227))
  if ( lmax .eq. 3 ) return
  u382=A8_(p,pd,erfpd,exppd2)
  u370=p**8
  u5=u393*u382*u370
  u392=2.27635651107943632d2*u5
  u383=2.96880505764235461d3*u382
  u83=-5.67185232289765129d1*u8
  u400=u393*(u383+u83)*u370
  u391=1.72520662370339572d-1*u400
  u82=-2.24276861081441444d0*u400
  u75=+u82
  u49=3.26568556340659007d4*u382
  u64=u393*(u49+u83*u66)*u370
  u68=-3.45041324740679145d-1*u64
  u66=8.05096424394918004d-1*u64
  u380=pd2**2
  u62=4.0d0*u380
  u70=(u377+1.1d1)
  u48=u393*(4.24539123242856709d5*u382+u83*(1.3d1*u70+u62))*u370
  u79=5.75068874567798574d-2*u48
  u46=-5.75068874567798574d-2*u48
  u384=u46*u227
  u63=u79*u227
  value=value+(c(21)*(((u391+u227*(u63+u68))*u228+u227*(u75+u227*(u384+&
 &u66))+u392)*z))
  u75=-3.45041324740679145d-1*u400
  u66=-1.72520662370339572d-1*u64
  u72=4.02548212197459002d-1*u64
  value=value+(c(22)*(u336*((u66+u63)*u228+u227*(u72+u384)+u75)*z))
  u75=u393*(4.28827397215006777d3*u382+u83)*u370
  u72=1.72520662370339572d-1*u75
  u81=-8.62603311851697862d-1*u400
  u87=1.72520662370339572d-1*u64
  u74=u393*(6.8282516325774156d4*u382+u83*(2.3d1+u377))*u370
  u4=-5.75068874567798574d-2*u74
  u95=5.75068874567798575d-1*u64
  u59=u393*(u49+u96*(4.0d0*u70+u380))*u370
  u49=9.20110199308477719d-1*u59
  u96=1.15013774913559715d-1*u64
  u389=u227*(u384+u49)
  value=value+(c(23)*(x*((u81+u227*(u384+u95))*u268+u228*(u66+u389+(u38&
 &4+u87)*u228)+u227*(u4+u96*u227)+u72)))
  u72=-5.75068874567798574d-2*u64
  u4=-1.72520662370339572d-1*u400
  u93=5.75068874567798574d-2*u64
  u381=x**4
  u379=(u63+u72)
  value=value+(c(24)*((u228*(u391+u46*u381+u379*u228)+u227*(u4+u93*u227&
 &))*z))
  u369=(1.3d1+u377)
  u80=u8*u369
  u84=u393*(3.85944657493506099d4*u382-5.67185232289765129d1*u80)*u370
  u386=-5.75068874567798574d-2*u84
  u397=-1.72520662370339572d-1*u84
  u88=3.45041324740679145d-1*u64
  u41=2.3002754982711943d-1*u64
  u77=(u384+u93)
  value=value+(c(25)*(y*((u4+u227*(u384+u88))*u268+u228*(u386+u389+u77*&
 &u228)+u227*(u397+u41*u227)+u391)))
  u386=u393*(3.62853951489621119d3*u382+u83)*u370
  u397=1.72520662370339572d-1*u386
  u41=(8.0d0+pd2)
  u389=u393*(u383-7.08981540362206411d0*u8*u41)*u370
  u383=-9.20110199308477719d-1*u389
  u372=-1.72520662370339572d-1*u393
  u366=+u372*(5.04696859799200284d4*u382+u83*(1.7d1+u377))*u370
  u374=2.0d0*u380
  u45=1.15013774913559715d-1*u393*(3.59225411974724908d5*u382+u83*(1.1d&
 &1*u70+u374))*u370
  u382=-1.15013774913559715d-1*u48
  u370=u88*u227
  value=value+(c(26)*(z*(u268*(u383+u227*(u382*u227+u45)+u77*u268)+u227&
 &*(u366+u370)+u397)))
  u397=3.45041324740679145d-1*u400
  u383=-4.02548212197459002d-1*u64
  u366=u79*u228
  u45=u384+u366
  u382=u87*u227
  value=value+(c(27)*(u336*(u228*(u383+u45)+u382+u397)*z))
  u397=1.72520662370339572d-1*u84
  u383=-2.3002754982711943d-1*u64
  u70=5.75068874567798574d-2*u84
  u84=-9.20110199308477719d-1*u59
  u77=u227*(u63+u84)
  u371=u228*(u366+u68)
  value=value+(c(28)*(x*((u391+u371)*u268+u228*(u397+u77+(u63+u383)*u22&
 &8)+u227*(u70+u72*u227)+u4)))
  u59=u336*z
  u383=u66*u228
  value=value+(c(29)*(u59*((u45)*u268+u383+u382)))
  u70=1.13817825553971816d2*u5
  u382=-6.90082649481358289d-1*u400
  u45=u366+u384
  u397=u370+u68*u228
  u384=u4*u227
  u44=u391*u228+u384
  value=value+(c(30)*(x*(u268*(u382+u397+(u45+u96)*u268)+u44+u70)))
  u96=-u392
  u392=-u82
  u382=-8.05096424394918004d-1*u64
  value=value+(c(31)*((u228*(u392+u370+u228*(u45+u382))+u384+u96)*z))
  u96=-1.72520662370339572d-1*u75
  u392=8.62603311851697862d-1*u400
  u382=5.75068874567798574d-2*u74
  u74=-5.75068874567798575d-1*u64
  u75=-1.15013774913559715d-1*u64
  u64=u227*(u87+u66*u227)
  value=value+(c(32)*(y*((u392+u228*(u366+u74))*u268+u228*(u382+u77+(u6&
 &3+u75)*u228)+u64+u96)))
  u96=-1.72520662370339572d-1*u386
  u382=9.20110199308477719d-1*u389
  u389=1.03512397422203744d0*u400
  value=value+(c(33)*(z*(u268*(u382+u77+u371+u379*u268)+u228*(u389+u383&
 &)+u64+u96)))
  u389=-u70
  u87=6.90082649481358289d-1*u400
  value=value+(c(34)*(y*(u268*(u87+u397+(u45+u75)*u268)+u44+u389)))
  value=value+(c(35)*(z*(u268*(u95*u227+u74*u228+(u45)*u268)+u392*u228+&
 &u81*u227)))
  if ( lmax .eq. 4 ) return
  u389=A9_(p,pd,erfpd,exppd2)
  u87=p**9
  u382=u393*u389*u87
  u4=1.53654064497861952d4*u382
  u81=3.26568556340659007d4*u389
  u391=-1.13437046457953026d2*u398
  u392=u393*(u81+u391)*u87
  u46=8.62603311851697862d-1*u392
  u400=-5.46315430839408646d0*u392
  u386=+u400
  u5=u393*(4.24539123242856709d5*u389+u391*u369)*u87
  u70=-5.75068874567798575d-1*u5
  u79=1.15013774913559715d0*u5
  u77=6.36808684864285064d6*u389
  u74=(u377+1.3d1)
  u371=1.5d1*u74
  u64=(u371+u62)
  u45=u393*(u77+u391*u64)*u87
  u397=5.75068874567798574d-2*u45
  u44=-5.75068874567798574d-2*u45
  u96=u44*u227
  u93=u397*u227
  value=value+(c(36)*(x*((u46+u227*(u93+u70))*u228+u227*(u386+u227*(u96&
 &+u79))+u4)*z))
  u386=1.02436042998574635d3*u382
  u84=1.72520662370339572d-1*u392
  u82=-1.55268596133305615d0*u392
  u379=+u82
  u63=-3.45041324740679145d-1*u5
  u97=6.90082649481358289d-1*u5
  value=value+(c(37)*(y*((u84+u227*(u93+u63))*u228+u227*(u379+u227*(u96&
 &+u97))+u386)*z))
  u379=3.85944657493506099d4*u389
  u39=-1.91689624855932858d-2*u393
  u378=2.26874092915906051d2*exppd2
  u67=+u39*(u378+u379)*u87
  u90=2.56090107496436587d3*u382
  u42=-1.72520662370339572d-1*u392
  u55=u393*(2.67192455187811915d4*u389+u395)*u87
  u9=6.90082649481358289d-1*u55
  u394=-2.58780993555509359d0*u392
  u6=+u394
  u72=4.0d0*pd2
  u95=(2.7d1+u72)
  u54=u393*(8.81735102119779319d5*u389+u391*u95)*u87
  u399=-1.72520662370339572d-1*u54
  u89=3.45041324740679145d-1*u5
  u78=u393*(1.07767623592417472d6*u389+u391*(3.3d1+u377))*u87
  u94=-5.75068874567798574d-2*u78
  u98=8.62603311851697862d-1*u5
  u68=(2.1d1*u74+u62)
  u50=u393*(8.9153215880999909d6*u389+u391*u68)*u87
  u383=5.75068874567798574d-2*u50
  u99=1.15013774913559715d-1*u5
  value=value+(c(38)*((u90+u227*(u227*(u98+u96)+u6))*u268+u228*(u84+u22&
 &7*(u227*(u383+u96)+u399)+(u227*(u89+u96)+u42)*u228)+u227*(u9+u227*(u9&
 &9*u227+u94))+u67))
  u67=-1.72520662370339572d-1*u5
  u9=-4.02548212197459002d-1*u392
  u399=2.3002754982711943d-1*u5
  u94=5.75068874567798574d-2*u5
  u383=(u93+u67)
  value=value+(c(39)*(x*(u228*(u84+u227*(u96+u399)+u383*u228)+u227*(u9+&
 &u94*u227)+u386)*z))
  u9=u393*(3.46360590058274705d4*u389+u391)*u87
  u396=5.17561987111018717d-1*u9
  u71=-8.62603311851697862d-1*u392
  u66=(1.5d1+u377)
  u43=u393*(4.89852834510988511d5*u389+u391*u66)*u87
  u76=-1.72520662370339572d-1*u43
  u86=1.72520662370339572d-1*u5
  u38=u393*(1.79612705987362454d6*u389+u391*(5.5d1+6.0d0*pd2))*u87
  u390=-5.75068874567798574d-2*u38
  u91=5.75068874567798575d-1*u5
  u75=(5.0d0*u74+u380)
  u60=u393*(2.12269561621428355d6*u389+u391*u75)*u87
  u51=2.3002754982711943d-1*u60
  u69=(u96+u86)
  value=value+(c(40)*(u336*((u71+u227*(u96+u91))*u268+u228*(u76+u227*(u&
 &96+u51)+u69*u228)+u227*(u390+u399*u227)+u396)))
  u396=u393*(4.45320758646353191d4*u389+u391)*u87
  u390=5.17561987111018717d-1*u396
  u399=(1.0d1+pd2)
  u48=u393*(1.63284278170329504d5*u389+u395*u399)*u87
  u370=-6.90082649481358289d-1*u48
  u88=(2.5d1+u377)
  u53=u393*(8.16421390851647518d5*u389+u391*u88)*u87
  u73=-1.72520662370339572d-1*u53
  u52=u393*(u77+u391*(u371+u374))*u87
  u77=1.15013774913559715d-1*u52
  u374=-1.15013774913559715d-1*u45
  u371=u89*u227
  u385=u374*u227
  value=value+(c(41)*(u367*(u268*(u370+u227*(u385+u77)+u69*u268)+u227*(&
 &u73+u371)+u390)))
  u390=-u386
  u370=4.02548212197459002d-1*u392
  u73=-5.75068874567798574d-2*u5
  u77=-2.3002754982711943d-1*u5
  u386=u86*u227
  value=value+(c(42)*(y*(u228*(u370+u227*(u96+u77)+(u93+u73)*u228)+u227&
 &*(u42+u386)+u390)*z))
  u370=u393*(1.48440252882117731d4*u389+u395)*u87
  u395=3.45041324740679145d-1*u370
  u69=-5.75068874567798574d-2*u43
  u57=-3.45041324740679145d-1*u370
  u370=5.75068874567798574d-2*u43
  u366=(u94+u96)
  value=value+(c(43)*(u228*(u395+u381*(u93+u44)+u228*(u366*u228+u93+u69&
 &))+u227*(u57+u227*(u73*u227+u370))))
  u395=5.17561987111018717d-1*u392
  u69=u393*(u81-1.41796308072441282d1*u398*u41)*u87
  u57=-2.76033059792543316d0*u69
  u370=+u57
  u41=-1.03512397422203744d0*u392
  u7=+u41
  u387=u44*u228
  value=value+(c(44)*(u365*(u268*(u370+u227*(u96+u89)+u228*(u387+u51)+(&
 &u387+u86)*u268)+u228*(u76+u86*u228)+u227*(u7+u386)+u395)))
  u395=1.13437046457953026d2*exppd2
  u370=+u39*(u395+u81)*u87
  u7=u393*(8.01577365563435745d4*u389-2.26874092915906051d2*u398)*u87
  u39=1.72520662370339572d-1*u7
  u398=u393*(6.85793968315383915d5*u389+u391*(2.1d1+u377))*u87
  u49=-5.75068874567798574d-2*u398
  u56=1.72520662370339572d-1*u393*(5.04696859799200284d4*u389+u391)*u87
  u388=+u372*(1.27361736972857013d6*u389+u391*(3.9d1+u72))*u87
  u387=(2.7d1*u74+u62)
  u386=5.75068874567798574d-2*u393
  u372=u386*(1.14625563275571312d7*u389+u391*u387)*u87
  u389=-3.45041324740679145d-1*u392
  value=value+(c(45)*(u268*(u39+u227*(u97*u227+u388)+u268*(u366*u268+u2&
 &27*(u372+u385)+u49))+u227*(u56+u389*u227)+u370))
  u372=-u82
  u389=-6.90082649481358289d-1*u5
  u97=u397*u228
  u370=u97+u96
  u388=u42*u227
  value=value+(c(46)*(x*(u228*(u372+u371+u228*(u370+u389))+u388+u390)*z&
 &))
  u372=-5.17561987111018717d-1*u9
  u389=5.75068874567798574d-2*u38
  u390=1.72520662370339572d-1*u43
  u39=-2.3002754982711943d-1*u60
  u49=u227*(u93+u39)
  u51=u227*(u390+u67*u227)
  value=value+(c(47)*(u336*((u46+u228*(u97+u70))*u268+u228*(u389+u49+(u&
 &93+u77)*u228)+u51+u372)))
  u372=-5.17561987111018717d-1*u392
  u389=-u57
  u69=-u41
  value=value+(c(48)*(u367*(u268*(u389+u49+u228*(u97+u63)+u383*u268)+u2&
 &28*(u69+u67*u228)+u51+u372)))
  u372=u63*u228
  u389=u84*u228
  value=value+(c(49)*(u336*(u268*(u371+u372+(u370)*u268)+u389+u388)))
  u41=5.12180214992873173d3*u382
  u69=-1.15013774913559715d0*u392
  u49=+u69
  u390=u91*u227
  u51=u390+u70*u228
  u391=u71*u227
  u86=u46*u228+u391
  value=value+(c(50)*(u367*(u268*(u49+u51+(u370+u99)*u268)+u86+u41)))
  u99=-u4
  u49=-u400
  u4=-u79
  value=value+(c(51)*(y*(u228*(u49+u390+u228*(u370+u4))+u391+u99)*z))
  u391=1.91689624855932858d-2*u393
  u49=u391*(u379+u378)*u87
  u4=-u90
  u99=-6.90082649481358289d-1*u55
  u390=-u394
  u388=5.75068874567798574d-2*u78
  u78=-8.62603311851697862d-1*u5
  u79=-1.15013774913559715d-1*u5
  u371=1.72520662370339572d-1*u54
  u54=-5.75068874567798574d-2*u50
  u400=u227*(u63*u227+u371)
  u385=u227*(u54+u93)
  u89=u227*(u42+u84*u227)
  value=value+(c(52)*((u4+u228*(u228*(u78+u97)+u390))*u268+u228*(u99+u4&
 &00+u228*((u79+u93)*u228+u385+u388))+u89+u49))
  u49=-5.17561987111018717d-1*u396
  u99=6.90082649481358289d-1*u48
  u48=1.72520662370339572d-1*u53
  u50=-1.15013774913559715d-1*u52
  u52=1.15013774913559715d-1*u45
  value=value+(c(53)*(u365*(u268*(u99+u228*(u52*u228+u50)+(u97+u67)*u26&
 &8)+u228*(u48+u372)+u49)))
  u45=u391*(u81+u395)*u87
  u99=-1.72520662370339572d-1*u7
  u7=5.75068874567798574d-2*u398
  u50=-3.07308128995723904d3*u382
  u52=2.07024794844407487d0*u392
  value=value+(c(54)*(u268*(u99+u400+u228*(u372+u52)+u268*((u73+u93)*u2&
 &68+u228*(u63+u97)+u385+u7))+u228*(u50+u389)+u89+u45))
  u45=-u41
  u385=-u69
  value=value+(c(55)*(u365*(u268*(u385+u51+(u370+u79)*u268)+u86+u45)))
  value=value+(c(56)*(u268*(u6*u227+u390*u228+u268*((u96+u97)*u268+u78*&
 &u228+u98*u227))+u4*u228+u90*u227))
  if ( lmax .eq. 5 ) return
  u70=A10_(p,pd,erfpd,exppd2)
  u385=p**10
  u51=u393*u70*u385
  u45=-1.53654064497861952d4*u51
  u99=+u45
  u49=-1.13437046457953026d2*u8
  u389=u393*(3.26568556340659007d4*u70+u49)*u385
  u98=-8.62603311851697862d-1*u389
  u52=2.15650827962924466d1*u389
  u372=u393*(4.24539123242856709d5*u70-1.13437046457953026d2*u80)*u385
  u50=2.58780993555509359d0*u372
  u390=-1.12138430540720722d1*u372
  u84=+u390
  u44=u393*(6.36808684864285064d6*u70+u49*u64)*u385
  u86=-8.62603311851697862d-1*u44
  u391=1.55268596133305615d0*u44
  u79=(u62+1.5d1*u369)
  u398=pd2**3
  u73=8.0d0*u398
  u7=u393*(1.08257476426928461d8*u70+u49*(1.7d1*u79+u73))*u385
  u4=5.75068874567798574d-2*u7
  u369=-5.75068874567798574d-2*u7
  u382=u369*u227
  u48=u4*u227
  value=value+(c(57)*(((u98+u227*(u227*(u86+u48)+u50))*u228+u227*(u52+u&
 &227*(u227*(u391+u382)+u84))+u99)*z))
  u99=3.45041324740679145d0*u389
  u84=8.62603311851697862d-1*u372
  u371=-4.31301655925848931d0*u372
  u93=+u371
  u365=-5.75068874567798575d-1*u44
  u388=1.03512397422203744d0*u44
  value=value+(c(58)*(u336*((u84+u227*(u48+u365))*u228+u227*(u93+u227*(&
 &u382+u388))+u99)*z))
  u93=u393*(5.04696859799200284d4*u70+u49)*u385
  u400=-8.62603311851697862d-1*u93
  u89=6.03822318296188503d0*u389
  u64=-8.62603311851697862d-1*u372
  u91=u393*(9.79705669021977021d4*u70+u376*(1.2d1+pd2))*u385
  u60=4.6005509965423886d0*u91
  u370=-6.03822318296188503d0*u372
  u80=+u370
  u63=8.0d0*u380
  u53=u393*(1.40097910670142714d7*u70+u49*(3.3d1*u74+u63))*u385
  u379=-2.87534437283899287d-1*u53
  u97=5.75068874567798575d-1*u44
  u366=1.91042605459285519d7*u70
  u394=4.5d1*u74
  u54=u393*(u366+u49*(u394+u62))*u385
  u78=-5.75068874567798574d-2*u54
  u378=1.20764463659237701d0*u44
  u8=u393*(1.71938344913356967d8*u70+u49*(2.7d1*u79+u73))*u385
  u90=5.75068874567798574d-2*u8
  u41=1.15013774913559715d-1*u44
  value=value+(c(59)*(x*((u89+u227*(u227*(u378+u382)+u80))*u268+u228*(u&
 &84+u227*(u227*(u90+u382)+u379)+(u227*(u97+u382)+u64)*u228)+u227*(u60+&
 &u227*(u41*u227+u78))+u400)))
  u400=-1.02436042998574635d3*u51
  u379=+u400
  u78=-1.72520662370339572d-1*u389
  u90=1.72520662370339572d-1*u372
  u395=1.55268596133305615d0*u389
  u94=-5.17561987111018717d-1*u372
  u67=-3.45041324740679145d-1*u44
  u85=-6.90082649481358289d-1*u372
  u69=5.17561987111018717d-1*u44
  u380=5.75068874567798574d-2*u44
  u397=u227*(u67+u48)
  value=value+(c(60)*((u228*(u78+u227*(u227*(u69+u382)+u94)+(u397+u90)*&
 &u228)+u227*(u395+u227*(u380*u227+u85))+u379)*z))
  u379=u393*(3.46360590058274705d4*u70+u49)*u385
  u78=-5.17561987111018717d-1*u379
  u94=8.62603311851697862d-1*u389
  u85=u393*(4.89852834510988511d5*u70+u49*u66)*u385
  u87=1.72520662370339572d-1*u85
  u69=-1.72520662370339572d-1*u372
  u66=1.03512397422203744d0*u85
  u71=-u50
  u77=1.48588693134999848d7*u70
  u6=3.5d1*u74
  u55=u393*(u77+u49*(u6+u63))*u385
  u368=-1.72520662370339572d-1*u55
  u81=3.45041324740679145d-1*u44
  u46=u393*(1.06134780810714177d7*u70+u49*(2.5d1*u74+u62))*u385
  u392=-1.72520662370339572d-1*u46
  u76=8.62603311851697862d-1*u44
  u9=u393*(1.59202171216071266d8*u70+u49*(2.5d1*u79+u73))*u385
  u5=5.75068874567798574d-2*u9
  u42=2.3002754982711943d-1*u44
  u43=u227*(u81+u382)
  u38=(u43+u69)
  value=value+(c(61)*(y*((u94+u227*(u227*(u76+u382)+u71))*u268+u228*(u8&
 &7+u227*(u227*(u5+u382)+u368)+u38*u228)+u227*(u66+u227*(u42*u227+u392)&
 &)+u78)))
  u78=u393*(4.45320758646353191d4*u70+u49)*u385
  u96=-5.17561987111018717d-1*u78
  u57=1.63284278170329504d5*u70
  u376=u393*(u57+u83*u399)*u385
  u399=6.90082649481358289d-1*u376
  u39=4.14049589688814974d0*u376
  u383=-3.45041324740679145d-1*u46
  u56=u393*(u77+u49*(u6+u62))*u385
  u77=-1.72520662370339572d-1*u56
  u6=3.18404342432142532d7*u70
  u396=5.0d0*u79
  u62=u393*(u6+u49*(u396+u398))*u385
  u374=4.6005509965423886d-1*u62
  u82=-1.15013774913559715d-1*u7
  u367=u81*u227
  u373=u82*u227
  value=value+(c(62)*(z*(u268*(u399+u227*(u227*(u374+u373)+u383)+u38*u2&
 &68)+u227*(u39+u227*(u367+u77))+u96)))
  u77=-1.72520662370339572d-1*u44
  u383=1.72520662370339572d-1*u44
  value=value+(c(63)*(u336*(u228*(u84+u369*u381+(u48+u77)*u228)+u227*(u&
 &64+u383*u227))*z))
  u399=u393*(1.48440252882117731d4*u70+u83)*u385
  u381=6.90082649481358289d-1*u399
  u401=u393*(u57+u49*(5.0d0+pd2))*u385
  u57=3.45041324740679145d-1*u401
  u374=u393*(1.46955850353296553d6*u70+u49*(4.5d1+7.0d0*pd2))*u385
  u38=-1.15013774913559715d-1*u374
  u65=u393*(9.55213027296427596d7*u70+u49*(1.5d1*u79+u73))*u385
  u61=5.75068874567798574d-2*u65
  u47=u393*(8.9153215880999909d6*u70+u49*u68)*u385
  u58=5.75068874567798574d-2*u47
  u37=u393*(1.33729823821499863d8*u70+u49*(2.1d1*u79+u73))*u385
  u375=-5.75068874567798574d-2*u37
  u83=-5.75068874567798574d-2*u44
  u384=(u383+u382)
  value=value+(c(64)*(x*(u228*(u57+u227*(u227*(u375+u48)+u42)+u228*(u38&
 &4*u228+u61*u227+u77))+u227*(u38+u227*(u83*u227+u58))+u381)))
  u58=5.17561987111018717d-1*u85
  u42=u393*(u6+u49*(u396+2.0d0*u398))*u385
  u381=2.3002754982711943d-1*u42
  value=value+(c(65)*(u59*((u64+u227*(u382+u97))*u268+u228*(u77+u227*(u&
 &382+u381)+(u382+u383)*u228)+u227*(u392+u367)+u58)))
  u381=u393*(1.14298994719230652d6*u70+u49*(3.5d1+u72))*u385
  u58=5.17561987111018717d-1*u381
  u375=8.16421390851647518d5*u70
  u68=u393*(u375+u49*u88)*u385
  u38=1.72520662370339572d-1*u68
  u57=u393*(2.3349651778357119d7*u70+u49*(5.5d1*u74+u63))*u385
  u61=-1.72520662370339572d-1*u57
  u74=u393*(2.22883039702499772d8*u70+u49*(3.5d1*u79+u73))*u385
  u398=5.75068874567798574d-2*u74
  u6=-3.45041324740679145d-1*u372
  u396=6.90082649481358289d-1*u44
  value=value+(c(66)*(x*(u268*(u58+u227*(u396*u227+u61)+u268*(u384*u268&
 &+u227*(u398+u373)+u392))+u227*(u38+u6*u227)+u96)))
  u58=-u400
  u38=-u395
  u61=6.90082649481358289d-1*u372
  u398=1.72520662370339572d-1*u389
  u6=5.17561987111018717d-1*u372
  u396=-5.17561987111018717d-1*u44
  u384=(u83+u48)
  u392=u69*u227
  value=value+(c(67)*((u228*(u38+u227*(u367+u6)+u228*(u384*u228+u227*(u&
 &396+u382)+u61))+u227*(u398+u392)+u58)*z))
  u58=-6.90082649481358289d-1*u399
  u38=1.15013774913559715d-1*u374
  u61=-5.75068874567798574d-2*u47
  u398=-3.45041324740679145d-1*u401
  u6=-2.3002754982711943d-1*u44
  u396=5.75068874567798574d-2*u37
  u37=-5.75068874567798574d-2*u65
  u96=(u380+u382)
  u374=u77*u227
  value=value+(c(68)*(y*(u228*(u38+u227*(u227*(u37+u48)+u6)+u228*(u96*u&
 &228+u396*u227+u61))+u227*(u398+u227*(u374+u383))+u58)))
  u37=u393*(u375+u49*(2.5d1+u72))*u385
  u38=5.17561987111018717d-1*u37
  u61=u393*(2.12269561621428355d6*u70+u49*u75)*u385
  u398=-6.90082649481358289d-1*u61
  u396=-5.17561987111018717d-1*u37
  u37=1.72520662370339572d-1*u55
  u58=6.90082649481358289d-1*u61
  u401=-5.75068874567798574d-2*u9
  u399=u227*(u401+u48)
  u375=u369*u228
  u400=u228*(u5+u375)
  value=value+(c(69)*(z*(u268*(u227*(u399+u37)+u228*(u400+u368)+(u228*(&
 &u81+u375)+u397)*u268)+u228*(u38+u228*(u383*u228+u398))+u227*(u396+u22&
 &7*(u374+u58)))))
  u38=-5.17561987111018717d-1*u389
  u398=u393*(8.81735102119779319d5*u70+u49*u95)*u385
  u396=5.17561987111018717d-1*u398
  u58=-1.72520662370339572d-1*u47
  u95=1.03512397422203744d0*u389
  u395=-2.07024794844407487d0*u372
  u397=+u395
  value=value+(c(70)*(y*(u268*(u396+u227*(u367+u397)+u228*(u81*u228+u36&
 &8)+u268*((u383+u375)*u268+u400+u43+u58))+u228*(u87+u69*u228)+u227*(u9&
 &5+u392)+u38)))
  u367=u393*(3.85944657493506099d4*u70+u49)*u385
  u396=-8.62603311851697862d-1*u367
  u375=u393*(1.07767623592417472d6*u70+u49*(3.3d1+u72))*u385
  u397=2.87534437283899287d-1*u375
  u58=u393*(1.14625563275571312d7*u70+u49*u387)*u385
  u38=-5.75068874567798574d-2*u58
  u43=8.62603311851697862d-1*u393*(6.20480257047252114d5*u70+u49*(1.9d1&
 &+u377))*u385
  u400=-2.87534437283899287d-1*u393*(u366+u49*(u394+u63))*u385
  u393=u386*(2.10146866005214071d8*u70+u49*(3.3d1*u79+u73))*u385
  u385=-1.72520662370339572d0*u372
  u81=+u385
  u394=1.15013774913559715d0*u44
  value=value+(c(71)*(z*(u268*(u397+u227*(u394*u227+u400)+u268*(u96*u26&
 &8+u227*(u393+u373)+u38))+u227*(u43+u81*u227)+u396)))
  u396=-u99
  u397=-u371
  u38=-u388
  u371=u4*u228
  u388=u371+u382
  u393=u97*u227
  u394=u64*u227
  value=value+(c(72)*(u336*(u228*(u397+u393+u228*(u388+u38))+u394+u396)&
 &*z))
  u396=5.17561987111018717d-1*u379
  u397=-u66
  u38=1.72520662370339572d-1*u46
  u82=-1.72520662370339572d-1*u85
  u400=u227*(u67*u227+u37)
  u66=u227*(u82+u90*u227)
  value=value+(c(73)*(x*((u98+u228*(u228*(u86+u371)+u50))*u268+u228*(u3&
 &97+u400+u228*((u6+u48)*u228+u399+u38))+u66+u396)))
  u396=-5.17561987111018717d-1*u85
  u397=-2.3002754982711943d-1*u42
  value=value+(c(74)*(u59*((u84+u228*(u371+u365))*u268+u228*(u38+u227*(&
 &u48+u397)+(u48+u67)*u228)+u227*(u383+u374)+u396)))
  u396=5.17561987111018717d-1*u389
  u397=-5.17561987111018717d-1*u398
  u398=1.72520662370339572d-1*u47
  u43=-u95
  u6=-u395
  u47=u228*(u67+u371)
  u395=u67*u228
  value=value+(c(75)*(x*(u268*(u397+u400+u228*(u395+u6)+u268*((u77+u48)&
 &*u268+u47+u399+u398))+u228*(u43+u90*u228)+u66+u396)))
  u396=u365*u228
  u397=u84*u228
  value=value+(c(76)*(u59*(u268*(u393+u396+(u388)*u268)+u397+u394)))
  u393=-5.12180214992873173d3*u51
  u43=+u393
  u388=5.17561987111018717d0*u389
  u394=u382+u371
  u398=u71*u227
  u382=u398+u50*u228
  u399=u76*u227
  u59=u86*u228+u399
  u400=u94*u227
  u97=u98*u228+u400
  value=value+(c(77)*(x*(u268*(u388+u382+u268*((u41+u394)*u268+u59+u81)&
 &)+u97+u43)))
  u41=-u45
  u43=-u52
  u6=-u390
  u401=-u391
  value=value+(c(78)*((u228*(u43+u398+u228*(u228*(u401+u394)+u399+u6))+&
 &u400+u41)*z))
  u398=8.62603311851697862d-1*u93
  u93=-u89
  u6=-u60
  u60=-u370
  u401=5.75068874567798574d-2*u54
  u54=-u378
  u370=-1.15013774913559715d-1*u44
  u43=2.87534437283899287d-1*u53
  u53=-5.75068874567798574d-2*u8
  u91=u227*(u365*u227+u43)
  u399=u227*(u53+u48)
  u400=u227*(u64+u84*u227)
  value=value+(c(79)*(y*((u93+u228*(u228*(u54+u371)+u60))*u268+u228*(u6&
 &+u91+u228*((u370+u48)*u228+u399+u401))+u400+u398)))
  u8=5.17561987111018717d-1*u78
  u398=-6.90082649481358289d-1*u376
  u78=-u39
  u376=3.45041324740679145d-1*u46
  u46=1.72520662370339572d-1*u56
  u56=-4.6005509965423886d-1*u62
  u6=1.15013774913559715d-1*u7
  u401=u6*u228
  value=value+(c(80)*(z*(u268*(u398+u228*(u228*(u56+u401)+u376)+(u47+u9&
 &0)*u268)+u228*(u78+u228*(u395+u46))+u8)))
  u395=-5.17561987111018717d-1*u381
  u381=-1.72520662370339572d-1*u68
  u68=1.72520662370339572d-1*u57
  u376=-5.75068874567798574d-2*u74
  u74=3.45041324740679145d-1*u372
  u57=-6.90082649481358289d-1*u44
  value=value+(c(81)*(y*(u268*(u395+u228*(u57*u228+u68)+u268*((u77+u371&
 &)*u268+u228*(u376+u401)+u38))+u228*(u381+u74*u228)+u8)))
  u371=8.62603311851697862d-1*u367
  u367=-2.87534437283899287d-1*u375
  u375=5.75068874567798574d-2*u58
  u58=-u388
  u388=3.45041324740679145d0*u372
  value=value+(c(82)*(z*(u268*(u367+u91+u228*(u396+u388)+u268*(u384*u26&
 &8+u47+u399+u375))+u228*(u58+u397)+u400+u371)))
  u365=-u393
  u393=-u385
  value=value+(c(83)*(y*(u268*(u58+u382+u268*((u370+u394)*u268+u59+u393&
 &))+u97+u365)))
  value=value+(c(84)*(z*(u268*(u80*u227+u60*u228+u268*((u394)*u268+u54*&
 &u228+u378*u227))+u93*u228+u89*u227)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_2=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_Y_opt_3_3(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_Y_opt_3_3
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u195
  real(kind=8) :: u196
  real(kind=8) :: u229
  real(kind=8) :: u270
  real(kind=8) :: u302
  real(kind=8) :: u303
  real(kind=8) :: u304
  real(kind=8) :: u305
  real(kind=8) :: u306
  real(kind=8) :: u307
  real(kind=8) :: u308
  real(kind=8) :: u309
  real(kind=8) :: u31
  real(kind=8) :: u310
  real(kind=8) :: u311
  real(kind=8) :: u312
  real(kind=8) :: u313
  real(kind=8) :: u314
  real(kind=8) :: u315
  real(kind=8) :: u316
  real(kind=8) :: u317
  real(kind=8) :: u318
  real(kind=8) :: u319
  real(kind=8) :: u32
  real(kind=8) :: u320
  real(kind=8) :: u321
  real(kind=8) :: u322
  real(kind=8) :: u323
  real(kind=8) :: u324
  real(kind=8) :: u325
  real(kind=8) :: u326
  real(kind=8) :: u327
  real(kind=8) :: u328
  real(kind=8) :: u329
  real(kind=8) :: u33
  real(kind=8) :: u330
  real(kind=8) :: u331
  real(kind=8) :: u332
  real(kind=8) :: u333
  real(kind=8) :: u334
  real(kind=8) :: u335
  real(kind=8) :: u34
  real(kind=8) :: u35
  real(kind=8) :: u36
  real(kind=8) :: u37
  real(kind=8) :: u38
  real(kind=8) :: u39
  real(kind=8) :: u4
  real(kind=8) :: u40
  real(kind=8) :: u41
  real(kind=8) :: u42
  real(kind=8) :: u43
  real(kind=8) :: u44
  real(kind=8) :: u45
  real(kind=8) :: u46
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_opt_3_3=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u270=a3**(-3)
  u335=exppd2*pd
  u323=-1.41796308072441282d1*u335
  u195=u270*(4.71238898038468986d1*A4_(p,pd,erfpd,exppd2)+u323)*p**4
  u63=7.04312654823844319d-2*u195
  u51=-2.3477088494128144d-2*u195
  u195=x**2
  u196=y**2
  value=value+(c(1)*(x*(u63*u196+u51*u195)))
  if ( lmax .eq. 0 ) return
  u63=A5_(p,pd,erfpd,exppd2)
  u51=p**5
  u81=u270*u63*u51
  u58=-3.31899519333736975d0*u81
  u71=+u58
  u229=-u58
  u58=exppd2*pd2
  u67=-2.83592616144882564d1*u58
  u315=u270*(3.2986722862692829d2*u63+u67)*u51
  u63=7.04312654823844319d-2*u315
  u51=-2.3477088494128144d-2*u315
  u315=u51*u195
  value=value+(c(2)*((u71+u63*u195)*u196+u195*(u229+u315)))
  u71=-6.6379903866747395d0*u81
  u229=x*y
  u81=u63*u196+u315
  value=value+(c(3)*(u229*(u81+u71)))
  value=value+(c(4)*(x*(u81)*z))
  if ( lmax .eq. 1 ) return
  u71=A6_(p,pd,erfpd,exppd2)
  u51=p**6
  u63=u270*u71*u51
  u81=-6.6379903866747395d0*u63
  u77=+u81
  u315=-2.83592616144882564d1*u335
  u95=u270*(3.2986722862692829d2*u71+u315)*u51
  u62=-2.11293796447153296d-1*u95
  u317=1.64339619458897008d-1*u95
  u89=2.0d0*pd2
  u308=(9.0d0+u89)
  u99=u270*(2.96880505764235461d3*u71+u315*u308)*u51
  u71=7.04312654823844319d-2*u99
  u51=-2.3477088494128144d-2*u99
  u98=u51*u195
  u316=u71*u195
  value=value+(c(5)*(x*((u62+u316)*u196+u195*(u317+u98)+u77)))
  u77=-u81
  u62=-7.04312654823844319d-2*u95
  u81=(u62+u316)*u196
  value=value+(c(6)*(y*(u81+u195*(u62+u98)+u77)))
  u63=7.04312654823844319d-2*u95
  value=value+(c(7)*((u81+u195*(u63+u98))*z))
  u63=-3.5215632741192216d-1*u95
  u81=2.3477088494128144d-2*u95
  u317=u71*u196
  u68=u98+u317
  u318=u81*u195
  value=value+(c(8)*(x*(u196*(u63+u68)+u318+u77)))
  u77=-1.40862530964768864d-1*u95
  value=value+(c(9)*(u229*(u317+u98+u77)*z))
  u317=z**2
  value=value+(c(10)*(x*((u68)*u317+u62*u196+u318)))
  if ( lmax .eq. 2 ) return
  u62=A7_(p,pd,erfpd,exppd2)
  u81=3.2986722862692829d2*u62
  u95=p**7
  u77=2.83592616144882564d1*exppd2
  u63=2.01232187092526948d-2*u270*(u81+u77)*u95
  u68=u270*u62*u95
  u98=6.96988990600847647d1*u68
  u55=-2.09096697180254294d2*u68
  u56=-5.67185232289765129d1*u58
  u53=u270*(2.96880505764235461d3*u62+u56)*u95
  u42=-4.22587592894306592d-1*u53
  u64=2.81725061929537728d-1*u53
  u54=(1.1d1+u89)
  u97=u270*(3.26568556340659007d4*u62+u56*u54)*u95
  u70=7.04312654823844319d-2*u97
  u50=-2.3477088494128144d-2*u97
  u51=u50*u195
  u33=u70*u195
  value=value+(c(11)*((u98+u195*(u33+u42))*u196+u195*(u55+u195*(u51+u64&
 &))+u63))
  u64=9.29318654134463529d1*u68
  u98=-2.11293796447153296d-1*u53
  u55=2.3477088494128144d-2*u53
  u42=(u98+u33)*u196
  value=value+(c(12)*(u229*(u42+u195*(u55+u51)+u64)))
  u64=-4.64659327067231765d1*u68
  u63=+u64
  u41=1.64339619458897008d-1*u53
  value=value+(c(13)*(x*(u42+u195*(u41+u51)+u63)*z))
  u63=-2.01232187092526948d-2*u270*(u77+u81)*u95
  u41=1.16164831766807941d2*u68
  u81=-7.04312654823844319d-2*u53
  u77=2.32329663533615882d1*u68
  u42=-2.81725061929537728d-1*u53
  u319=u55*u195
  value=value+(c(14)*(u196*(u41+u195*(u51+u42)+(u33+u81)*u196)+u195*(u7&
 &7+u319)+u63))
  u63=-u64
  value=value+(c(15)*(y*((u81+u33)*u196+u195*(u81+u51)+u63)*z))
  u41=-u77
  u42=7.04312654823844319d-2*u53
  u318=-7.04312654823844319d-2*u270
  u64=+u318*(3.62853951489621119d3*u62+u56)*u95
  u56=1.40862530964768864d-1*u53
  u33=2.81725061929537728d-1*u270
  u321=u33*(8.90641517292706383d3*u62+u67*(6.0d0+pd2))*u95
  u62=-7.04312654823844319d-2*u97
  u95=9.39083539765125759d-2*u53
  u320=u62*u195
  value=value+(c(16)*((u41+u195*(u51+u56))*u317+u196*(u81+u195*(u320+u3&
 &21)+(u320+u42)*u196)+u195*(u64+u95*u195)+u77))
  u64=2.78795596240339059d2*u68
  u95=-6.33881389341459887d-1*u53
  u68=u51+u70*u196
  u321=u42*u195
  value=value+(c(17)*(u229*(u196*(u95+u68)+u321+u64)))
  u64=-3.5215632741192216d-1*u53
  u95=u319+u63
  value=value+(c(18)*(x*(u196*(u64+u68)+u95)*z))
  u64=-1.40862530964768864d-1*u53
  value=value+(c(19)*(u229*((u64+u68)*u317+u81*u196+u95)))
  u320=x*z
  value=value+(c(20)*(u320*((u68)*u317+u98*u196+u321)))
  if ( lmax .eq. 3 ) return
  u64=A8_(p,pd,erfpd,exppd2)
  u81=p**8
  u98=u270*u64*u81
  u55=4.64659327067231765d2*u98
  u70=-5.67185232289765129d1*u335
  u53=u270*(2.96880505764235461d3*u64+u70)*u81
  u63=1.05646898223576648d0*u53
  u68=-1.7607816370596108d0*u53
  u42=3.26568556340659007d4*u64
  u95=u270*(u42+u70*u54)*u81
  u54=-7.0431265482384432d-1*u95
  u77=4.22587592894306592d-1*u95
  u321=pd2**2
  u50=4.0d0*u321
  u56=(u89+1.1d1)
  u41=u270*(4.24539123242856709d5*u64+u70*(1.3d1*u56+u50))*u81
  u51=7.04312654823844319d-2*u41
  u82=-2.3477088494128144d-2*u41
  u37=u82*u195
  u302=u51*u195
  value=value+(c(21)*(x*((u63+u195*(u302+u54))*u196+u195*(u68+u195*(u37&
 &+u77))+u55)))
  u63=-9.29318654134463529d1*u98
  u68=2.11293796447153296d-1*u53
  u54=-4.22587592894306592d-1*u95
  u77=1.40862530964768864d-1*u95
  u55=(u68+u195*(u302+u54))*u196
  u324=u195*(u37+u77)
  value=value+(c(22)*(y*(u55+u195*(u68+u324)+u63)))
  u310=4.64659327067231765d1*u98
  u49=-6.33881389341459887d-1*u53
  u83=2.81725061929537728d-1*u95
  value=value+(c(23)*((u55+u195*(u49+u195*(u37+u83))+u310)*z))
  u49=9.15606451270997615d-1*u53
  u55=-2.11293796447153296d-1*u95
  u319=-2.3477088494128144d-2*u53
  u85=-1.87816707953025152d-1*u95
  u80=2.3477088494128144d-2*u95
  u322=u80*u195
  value=value+(c(24)*(x*(u196*(u49+u195*(u37+u85)+(u302+u55)*u196)+u195&
 &*(u319+u322)+u63)))
  u319=2.81725061929537728d-1*u53
  value=value+(c(25)*(u229*((u55+u302)*u196+u195*(u80+u37)+u319)*z))
  u319=2.11293796447153296d-1*u270
  u85=u319*(3.18871654339364014d3*u64+u70)*u81
  u49=-3.5215632741192216d-1*u53
  u63=2.11293796447153296d-1*u95
  u62=-2.3477088494128144d-2*u270
  u328=6.0d0*pd2
  u303=+u62*(1.45471447824475376d5*u64+u70*(4.9d1+u328))*u81
  u84=2.3477088494128144d-1*u95
  u48=u270*(u42+u323*(4.0d0*u56+u321))*u81
  u42=1.12690024771815091d0*u48
  u323=-7.04312654823844319d-2*u41
  u72=9.39083539765125759d-2*u95
  u96=u323*u195
  u34=u195*(u96+u42)
  value=value+(c(26)*(x*((u49+u195*(u37+u84))*u317+u196*(u55+u34+(u96+u&
 &63)*u196)+u195*(u303+u72*u195)+u85)))
  u85=-2.78795596240339059d2*u98
  u49=6.33881389341459887d-1*u53
  u63=-7.04312654823844319d-2*u95
  u303=-5.63450123859075456d-1*u95
  u72=7.04312654823844319d-2*u95
  u73=(u302+u63)*u196
  u302=u72*u195
  value=value+(c(27)*(y*(u196*(u49+u195*(u37+u303)+u73)+u195*(u49+u302)&
 &+u85)))
  u303=-u310
  u49=3.5215632741192216d-1*u53
  u98=7.04312654823844319d-2*u53
  u310=-2.81725061929537728d-1*u95
  value=value+(c(28)*((u196*(u49+u195*(u37+u310)+u73)+u195*(u98+u322)+u&
 &303)*z))
  u303=u319*(2.74889357189106908d3*u64+u70)*u81
  u49=-7.04312654823844319d-2*u53
  u322=(1.3d1+u89)
  u80=u335*u322
  u98=u270*(3.85944657493506099d4*u64-5.67185232289765129d1*u80)*u81
  u73=-7.04312654823844319d-2*u98
  u63=u335*(3.5d1+u328)
  u310=+u318*(1.03908177017482411d5*u64-5.67185232289765129d1*u63)*u81
  u31=(u96+u72)
  value=value+(c(29)*(y*((u49+u324)*u317+u196*(u73+u34+u31*u196)+u195*(&
 &u310+u84*u195)+u303)))
  u42=-1.40862530964768864d-1*u270
  u73=+u42*(2.07816354034964823d4*u64+u70*(7.0d0+pd2))*u81
  u99=-2.11293796447153296d-1*u98
  u84=1.40862530964768864d-1*u270
  u303=u84*(2.93911700706593106d5*u64+u70*(9.0d0*u56+2.0d0*u321))*u81
  u56=-9.39083539765125759d-2*u41
  value=value+(c(30)*(z*(u317*(u73+u195*(u56*u195+u303)+u31*u317)+u195*&
 &(u99+u83*u195)+u68)))
  u73=2.74681935381299285d0*u53
  u99=-9.86037716753382047d-1*u95
  u303=u51*u196
  u56=u303+u37
  u323=u77*u195
  u324=u49*u195
  value=value+(c(31)*(x*(u196*(u73+u323+u196*(u56+u99))+u324+u85)))
  u73=8.45175185788613183d-1*u53
  u99=-6.33881389341459887d-1*u95
  u85=u37+u303
  value=value+(c(32)*(u229*(u196*(u99+u85)+u302+u73)*z))
  u73=+u318*(3.62853951489621119d3*u64+u70)*u81
  u99=7.04312654823844319d-2*u270
  u310=(1.7d1+u89)
  u83=u335*u310
  u34=u99*(5.04696859799200284d4*u64-5.67185232289765129d1*u83)*u81
  u64=-1.40862530964768864d-1*u95
  u81=2.3477088494128144d-2*u98
  u31=-3.75633415906050304d-1*u48
  u37=2.3477088494128144d-2*u41
  u96=-2.3477088494128144d-2*u95
  u325=u37*u195
  value=value+(c(33)*(x*((u68+u196*(u303+u54))*u317+u196*(u34+u195*(u32&
 &5+u31)+(u325+u64)*u196)+u195*(u81+u96*u195)+u73)))
  u81=4.22587592894306592d-1*u53
  u303=u229*z
  value=value+(c(34)*(u303*((u64+u85)*u317+u55*u196+u302+u81)))
  value=value+(c(35)*(x*(u317*(u323+u54*u196+(u56)*u317)+u68*u196+u324)&
 &))
  if ( lmax .eq. 4 ) return
  u81=A9_(p,pd,erfpd,exppd2)
  u31=2.96880505764235461d3*u81
  u96=p**9
  u73=5.67185232289765129d1*exppd2
  u49=-1.56513923294187627d-1*u270*(u73+u31)*u96
  u68=u270*u81*u96
  u82=-3.13645045770381441d3*u68
  u53=1.9864186232124158d4*u68
  u34=-1.13437046457953026d2*u58
  u51=u270*(3.26568556340659007d4*u81+u34)*u96
  u56=3.16940694670729944d0*u51
  u85=-3.87371960153114376d0*u51
  u94=u270*(4.24539123242856709d5*u81+u34*u322)*u96
  u69=-1.05646898223576648d0*u94
  u9=5.869272123532036d-1*u94
  u302=(u89+1.3d1)
  u77=(1.5d1*u302+u50)
  u40=u270*(6.36808684864285064d6*u81+u34*u77)*u96
  u95=7.04312654823844319d-2*u40
  u330=-2.3477088494128144d-2*u40
  u97=u330*u195
  u64=u95*u195
  value=value+(c(36)*((u82+u195*(u195*(u69+u64)+u56))*u196+u195*(u53+u1&
 &95*(u195*(u9+u97)+u85))+u49))
  u9=-2.09096697180254294d3*u68
  u82=1.05646898223576648d0*u51
  u53=-3.5215632741192216d-1*u51
  u56=-7.0431265482384432d-1*u94
  u85=2.81725061929537728d-1*u94
  u69=(u82+u195*(u64+u56))*u196
  value=value+(c(37)*(u229*(u69+u195*(u53+u195*(u97+u85))+u9)))
  u9=4.18193394360508588d3*u68
  u49=-1.7607816370596108d0*u51
  u75=+u49
  u86=4.22587592894306592d-1*u94
  value=value+(c(38)*(x*(u69+u195*(u75+u195*(u97+u86))+u9)*z))
  u9=u270*(u31+u73)*u96
  u75=3.13027846588375253d-2*u9
  u73=-2.71825706334330582d3*u68
  u69=2.11293796447153296d-1*u51
  u7=-6.27290091540762882d2*u68
  u313=1.47905657513007307d0*u51
  u57=-4.22587592894306592d-1*u94
  u78=-1.40862530964768864d-1*u51
  u52=-7.04312654823844319d-2*u94
  u87=2.3477088494128144d-2*u94
  u326=u87*u195
  value=value+(c(39)*(u196*(u73+u195*(u195*(u52+u97)+u313)+(u195*(u57+u&
 &64)+u69)*u196)+u195*(u7+u195*(u326+u78))+u75))
  u75=-8.36386788721017177d2*u68
  u73=1.40862530964768864d-1*u94
  u313=u195*(u97+u73)
  value=value+(c(40)*(y*((u69+u195*(u64+u57))*u196+u195*(u69+u313)+u75)&
 &*z))
  u78=-7.82569616470938133d-3*u270*(1.13437046457953026d2*exppd2+8.6095&
 &3466716282837d4*u81)*u96
  u72=1.04548348590127147d3*u68
  u59=-2.11293796447153296d-1*u51
  u5=u270*(3.85944657493506099d4*u81+u34)*u96
  u334=4.22587592894306592d-1*u5
  u79=-u82
  u323=4.0d0*pd2
  u60=u270*(8.81735102119779319d5*u81+u34*(2.7d1+u323))*u96
  u74=-2.11293796447153296d-1*u60
  u39=7.51107679583515716d5*u81
  u43=+u318*(u39+u34*(2.3d1+u89))*u96
  u304=3.5215632741192216d-1*u94
  u38=u99*(8.9153215880999909d6*u81+u34*(2.1d1*u302+u50))*u96
  u88=-7.04312654823844319d-2*u40
  u65=9.39083539765125759d-2*u94
  u48=u88*u195
  value=value+(c(41)*((u72+u195*(u195*(u304+u97)+u79))*u317+u196*(u69+u&
 &195*(u195*(u38+u48)+u74)+(u195*(u86+u48)+u59)*u196)+u195*(u334+u195*(&
 &u65*u195+u43))+u78))
  u334=-6.27290091540762882d3*u68
  u65=-u49
  u59=-2.11293796447153296d-1*u94
  u38=3.5215632741192216d-1*u51
  u72=-4.6954176988256288d-1*u94
  u74=7.04312654823844319d-2*u94
  u78=(u64+u59)*u196
  u304=u74*u195
  value=value+(c(42)*(u229*(u196*(u65+u195*(u97+u72)+u78)+u195*(u38+u30&
 &4)+u334)))
  u72=9.15606451270997615d-1*u51
  u334=-2.3477088494128144d-2*u51
  u38=-1.87816707953025152d-1*u94
  value=value+(c(43)*(x*(u196*(u72+u195*(u97+u38)+u78)+u195*(u334+u326)&
 &+u75)*z))
  u72=6.33881389341459887d-1*u270
  u334=u72*(3.13373867195581876d4*u81+u34)*u96
  u87=(1.5d1+u89)
  u38=u270*(4.89852834510988511d5*u81+u34*u87)*u96
  u65=-2.11293796447153296d-1*u38
  u78=2.11293796447153296d-1*u94
  u75=+u62*(4.7352440669395556d6*u81+u34*(1.45d2+1.8d1*pd2))*u96
  u79=2.3477088494128144d-1*u94
  u326=5.0d0*u302
  u55=(u326+u321)
  u49=u270*(2.12269561621428355d6*u81+u34*u55)*u96
  u43=2.81725061929537728d-1*u49
  u329=(u48+u78)
  u305=u79*u195
  value=value+(c(44)*(u229*((u53+u195*(u97+u79))*u317+u196*(u65+u195*(u&
 &48+u43)+u329*u196)+u195*(u75+u305)+u334)))
  u334=u72*(3.46360590058274705d4*u81+u34)*u96
  u75=8.16421390851647518d5*u81
  u44=3.0d0*pd2
  u324=(2.5d1+u44)
  u66=+u42*(u75+u34*u324)*u96
  u86=(5.5d1+u328)
  u328=+u318*(1.79612705987362454d6*u81+u34*u86)*u96
  u54=3.5d1*u302
  u8=4.6954176988256288d-2*u270*(1.48588693134999848d7*u81+u34*(u54+6.0&
 &d0*u321))*u96
  u35=-9.39083539765125759d-2*u40
  u327=u35*u195
  value=value+(c(45)*(u320*(u317*(u66+u195*(u327+u8)+u329*u317)+u195*(u&
 &328+u85*u195)+u334)))
  u334=9.39083539765125759d-2*u9
  u66=-8.15477119002991747d3*u68
  u328=9.86037716753382047d-1*u51
  u8=-1.88187027462228865d3*u68
  u9=2.32423176091868626d0*u51
  u329=-9.15606451270997615d-1*u94
  u93=-7.04312654823844319d-2*u51
  u306=u73*u195
  u307=u93*u195
  value=value+(c(46)*(u196*(u66+u195*(u306+u9)+u196*((u52+u64)*u196+u19&
 &5*(u329+u97)+u328))+u195*(u8+u307)+u334))
  u334=-2.50916036616305153d3*u68
  u9=6.33881389341459887d-1*u51
  u8=-5.63450123859075456d-1*u94
  value=value+(c(47)*(y*(u196*(u9+u195*(u97+u8)+(u64+u52)*u196)+u195*(u&
 &9+u304)+u334)*z))
  u8=-1.25211138635350101d-1*u270*(u31-7.08981540362206411d0*exppd2)*u9&
 &6
  u9=1.40862530964768864d0*u270*(7.71889314987012199d3*u81+u67)*u96
  u329=+u318*(5.55166545779120312d5*u81+u34*u310)*u96
  u328=u33*(8.90641517292706383d3*u81+u67)*u96
  u66=-1.40862530964768864d-1*u60
  u60=u99*(8.06624334161427748d6*u81+u34*(1.9d1*u302+u50))*u96
  u31=2.93911700706593106d5*u81
  u41=2.3477088494128144d-2*u270
  u33=u41*(u31+u34*u308)*u96
  u64=+u62*(1.27361736972857013d6*u81+u34*(3.0d0*u302+u50))*u96
  u67=-4.6954176988256288d-2*u40
  u308=-2.3477088494128144d-2*u94
  u325=2.3477088494128144d-2*u40
  u310=(u74+u48)
  u40=u325*u195
  value=value+(c(48)*(u196*(u9+u195*(u195*(u64+u40)+u66)+u196*(u310*u19&
 &6+u195*(u60+u67*u195)+u329))+u195*(u328+u195*(u308*u195+u33))+u8))
  u66=u72*(3.0677652262304331d4*u81+u34)*u96
  u8=+u42*(u39+u34*(2.3d1+u44))*u96
  u48=-4.22587592894306592d-1*u51
  u328=u88*u196
  value=value+(c(49)*(y*z*(u317*(u8+u313+u196*(u328+u43)+(u328+u78)*u31&
 &7)+u196*(u65+u78*u196)+u195*(u48+u304)+u66)))
  u66=u319*(6.8282516325774156d4*u81-2.26874092915906051d2*u58)*u96
  u8=+u318*(6.20480257047252114d5*u81+u34*(1.9d1+u89))*u96
  u48=2.11293796447153296d-1*u5
  u43=-2.11293796447153296d-1*u270
  u304=(3.1d1+u323)
  u308=+u43*(1.01236252465604292d6*u81+u34*u304)*u96
  u328=(2.3d1*u302+u50)
  u72=u99*(9.76439983458570431d6*u81+u34*u328)*u96
  u329=-2.81725061929537728d-1*u51
  u39=5.63450123859075456d-1*u94
  value=value+(c(50)*(u317*(u66+u195*(u39*u195+u308)+u317*(u310*u317+u1&
 &95*(u72+u327)+u8))+u195*(u48+u329*u195)+u7))
  u66=-1.88187027462228865d4*u68
  u39=6.69097022082652103d0*u51
  u8=-1.40862530964768864d0*u94
  u308=u95*u196
  u327=u308+u97
  u329=u53*u195
  value=value+(c(51)*(u229*(u196*(u39+u305+u196*(u327+u8))+u329+u66)))
  u8=2.74681935381299285d0*u51
  u72=-9.86037716753382047d-1*u94
  value=value+(c(52)*(x*(u196*(u8+u306+u196*(u327+u72))+u307+u334)*z))
  u8=+u43*(4.45320758646353191d4*u81+u34)*u96
  u72=(2.5d1+u89)
  u39=u99*(u75+u34*u72)*u96
  u66=-1.40862530964768864d-1*u94
  u88=7.04312654823844319d-2*u38
  u38=-9.39083539765125759d-2*u49
  u49=u195*(u40+u38)
  u48=u195*(u88+u52*u195)
  value=value+(c(53)*(u229*((u82+u196*(u308+u56))*u317+u196*(u39+u49+(u&
 &40+u66)*u196)+u48+u8)))
  u8=-2.11293796447153296d-1*u5
  u39=u84*(u31+u34*(9.0d0+pd2))*u96
  u75=1.26776277868291978d0*u51
  value=value+(c(54)*(u320*(u317*(u39+u49+u196*(u308+u57)+(u40+u52)*u31&
 &7)+u196*(u75+u59*u196)+u48+u8)))
  u39=-1.25458018308152576d3*u68
  u308=8.45175185788613183d-1*u51
  value=value+(c(55)*(u229*(u317*(u308+u306+u57*u196+(u327+u66)*u317)+u&
 &69*u196+u307+u39)))
  value=value+(c(56)*(u320*(u317*(u305+u56*u196+(u327)*u317)+u82*u196+u&
 &329)))
  if ( lmax .eq. 5 ) return
  u49=A10_(p,pd,erfpd,exppd2)
  u73=p**10
  u308=u270*u49*u73
  u53=-4.39103064078534018d4*u308
  u48=-1.13437046457953026d2*u335
  u320=u270*(3.26568556340659007d4*u49+u48)*u73
  u69=-7.39528287565036535d0*u320
  u51=2.21858486269510961d1*u320
  u93=u270*(4.24539123242856709d5*u49-1.13437046457953026d2*u80)*u73
  u67=7.39528287565036535d0*u93
  u66=-u67
  u39=u270*(6.36808684864285064d6*u49+u48*u77)*u73
  u75=-1.47905657513007307d0*u39
  u38=7.74743920306228751d-1*u39
  u305=(u50+1.5d1*u322)
  u327=pd2**3
  u329=8.0d0*u327
  u8=u270*(1.08257476426928461d8*u49+u48*(1.7d1*u305+u329))*u73
  u5=7.04312654823844319d-2*u8
  u322=-2.3477088494128144d-2*u8
  u80=u322*u195
  u325=u5*u195
  value=value+(c(57)*(x*((u69+u195*(u195*(u75+u325)+u67))*u196+u195*(u5&
 &1+u195*(u195*(u38+u80)+u66))+u53)))
  u53=2.09096697180254294d3*u308
  u38=-1.05646898223576648d0*u320
  u66=3.5215632741192216d-1*u320
  u75=3.16940694670729944d0*u93
  u67=-1.7607816370596108d0*u93
  u51=+u67
  u65=-1.05646898223576648d0*u39
  u59=4.46064681388434736d-1*u39
  u94=(u38+u195*(u195*(u65+u325)+u75))*u196
  value=value+(c(58)*(y*(u94+u195*(u66+u195*(u195*(u59+u80)+u51))+u53))&
 &)
  u51=-4.18193394360508588d3*u308
  u59=6.69097022082652103d0*u320
  u88=-3.87371960153114376d0*u93
  u81=5.869272123532036d-1*u39
  value=value+(c(59)*((u94+u195*(u59+u195*(u195*(u81+u80)+u88))+u51)*z)&
 &)
  u51=-3.87371960153114376d0*u320
  u88=1.05646898223576648d0*u93
  u81=-u67
  u94=-7.0431265482384432d-1*u39
  u67=-2.81725061929537728d-1*u93
  u74=7.04312654823844319d-2*u39
  u33=2.3477088494128144d-2*u39
  u330=u33*u195
  value=value+(c(60)*(x*(u196*(u51+u195*(u195*(u74+u80)+u81)+(u195*(u94&
 &+u325)+u88)*u196)+u195*(u66+u195*(u330+u67))+u53)))
  u51=-7.0431265482384432d-1*u320
  u53=-3.5215632741192216d-1*u93
  u34=2.81725061929537728d-1*u39
  value=value+(c(61)*(u229*((u88+u195*(u325+u94))*u196+u195*(u53+u195*(&
 &u80+u34))+u51)*z))
  u51=-1.05646898223576648d0*u270*(3.66152623775890402d4*u49+u48)*u73
  u89=2.46509429188345512d0*u320
  u58=-u88
  u82=7.0431265482384432d-1*u270*(5.55166545779120312d5*u49-1.134370464&
 &57953026d2*u83)*u73
  u68=-2.46509429188345512d0*u93
  u56=8.0d0*u321
  u307=-3.5215632741192216d-1*u270
  u57=+u307*(1.40097910670142714d7*u49+u48*(3.3d1*u302+u56))*u73
  u52=7.0431265482384432d-1*u39
  u60=+u318*(1.3160712820528558d7*u49+u48*(3.1d1*u302+u50))*u73
  u79=4.93018858376691024d-1*u39
  u64=u99*(1.71938344913356967d8*u49+u48*(2.7d1*u305+u329))*u73
  u83=-7.04312654823844319d-2*u8
  u96=9.39083539765125759d-2*u39
  u95=u83*u195
  value=value+(c(62)*(x*((u89+u195*(u195*(u79+u80)+u68))*u317+u196*(u88&
 &+u195*(u195*(u64+u95)+u57)+(u195*(u52+u95)+u58)*u196)+u195*(u82+u195*&
 &(u96*u195+u60))+u51)))
  u51=6.27290091540762882d3*u308
  u79=-1.7607816370596108d0*u320
  u82=2.11293796447153296d-1*u93
  u64=-3.16940694670729944d0*u320
  u57=-4.22587592894306592d-1*u39
  u96=-3.5215632741192216d-1*u39
  u60=(u195*(u57+u325)+u82)*u196
  value=value+(c(63)*(y*(u196*(u79+u195*(u195*(u96+u80)+u75)+u60)+u195*&
 &(u64+u74*x**4)+u51)))
  u79=8.36386788721017177d2*u308
  u64=-9.15606451270997615d-1*u320
  u96=-2.11293796447153296d-1*u320
  u89=1.47905657513007307d0*u93
  u68=-1.40862530964768864d-1*u93
  u52=-7.04312654823844319d-2*u39
  value=value+(c(64)*((u196*(u64+u195*(u195*(u52+u80)+u89)+u60)+u195*(u&
 &96+u195*(u330+u68))+u79)*z))
  u79=-6.33881389341459887d-1*u270
  u64=+u79*(3.13373867195581876d4*u49+u48)*u73
  u96=u270*(4.89852834510988511d5*u49+u48*u87)*u73
  u89=2.11293796447153296d-1*u96
  u60=-2.11293796447153296d-1*u93
  u40=1.63284278170329504d5*u49
  u87=u270*(u40+u315*(2.0d1+u44))*u73
  u315=3.38070074315445273d0*u87
  u97=1.48588693134999848d7*u49
  u44=u270*(u97+u48*(u54+u56))*u73
  u334=-2.11293796447153296d-1*u44
  u31=4.22587592894306592d-1*u39
  u330=2.75950430107856861d7*u49
  u306=1.2d1*u321
  u313=6.5d1*u302
  u78=+u318*(u330+u48*(u313+u306))*u73
  u35=3.5215632741192216d-1*u39
  u9=u270*(1.59202171216071266d8*u49+u48*(2.5d1*u305+u329))*u73
  u7=7.04312654823844319d-2*u9
  u37=2.3477088494128144d-1*u39
  u310=(u195*(u31+u95)+u60)
  u316=u37*u195
  value=value+(c(65)*(y*((u66+u195*(u195*(u35+u80)+u58))*u317+u196*(u89&
 &+u195*(u195*(u7+u95)+u334)+u310*u196)+u195*(u315+u195*(u316+u78))+u64&
 &)))
  u64=+u79*(3.46360590058274705d4*u49+u48)*u73
  u315=8.16421390851647518d5*u49
  u32=u84*(u315+u48*u324)*u73
  u98=1.26776277868291978d0*u96
  u324=2.12269561621428355d6*u49
  u47=u270*(u324+u48*u55)*u73
  u333=-1.69035037157722637d0*u47
  u45=u270*(1.06134780810714177d7*u49+u48*(2.5d1*u302+u50))*u73
  u91=-2.11293796447153296d-1*u45
  u61=u84*(9.55213027296427596d7*u49+u48*(1.5d1*u305+4.0d0*u327))*u73
  u84=-9.39083539765125759d-2*u8
  u309=u84*u195
  u331=u34*u195
  value=value+(c(66)*(z*(u317*(u32+u195*(u195*(u61+u309)+u333)+u310*u31&
 &7)+u195*(u98+u195*(u331+u91))+u64)))
  u55=2.81725061929537728d0*u93
  u98=-2.11293796447153296d-1*u39
  u333=-3.5215632741192216d-1*u320
  u91=-8.2169809729448504d-1*u39
  u61=-7.04312654823844319d-2*u93
  u32=1.40862530964768864d-1*u39
  u310=u32*u195
  u311=u61*u195
  value=value+(c(67)*(x*(u196*(u69+u195*(u310+u81)+u196*((u98+u325)*u19&
 &6+u195*(u91+u80)+u55))+u195*(u333+u311)+u51)))
  u55=-2.11293796447153296d0*u320
  u333=3.5215632741192216d-1*u93
  u91=-4.6954176988256288d-1*u39
  value=value+(c(68)*(u229*(u196*(u81+u195*(u80+u91)+(u325+u98)*u196)+u&
 &195*(u333+u74*u195)+u55)*z))
  u333=u270*(1.48440252882117731d4*u49+u70)*u73
  u91=-5.63450123859075456d-1*u333
  u69=2.25380049543630182d0*u270*(u40-7.08981540362206411d0*u335*(8.0d1&
 &+1.3d1*pd2))*u73
  u51=+u318*(2.3349651778357119d7*u49+u48*(5.5d1*u302+u306))*u73
  u71=2.11293796447153296d-1*u39
  u46=5.32634315641177742d0*u270*u335*pd2*u73
  u85=3.18404342432142532d7*u49
  u81=1.6d1*u321
  u335=-4.6954176988256288d-2*u270*(u85+u48*(7.5d1*u302+u81))*u73
  u36=2.4d1*u327
  u312=u41*(4.13925645161785292d8*u49+u48*(6.5d1*u305+u36))*u73
  u92=+u62*(5.73127816377856558d7*u49+u48*(9.0d0*u305+u329))*u73
  u4=-4.6954176988256288d-2*u8
  u314=-2.3477088494128144d-2*u39
  u6=2.3477088494128144d-2*u8
  u8=(u71+u95)
  u62=u6*u195
  u332=u4*u195
  value=value+(c(69)*(x*(u196*(u69+u195*(u195*(u92+u62)+u335)+u196*(u8*&
 &u196+u195*(u312+u332)+u51))+u195*(u46+u195*(u314*u195+u33))+u91)))
  u92=u319*(1.14298994719230652d6*u49-1.13437046457953026d2*u63)*u73
  u63=u270*(u85+u48*(5.0d0*u305+2.0d0*u327))*u73
  u69=2.81725061929537728d-1*u63
  value=value+(c(70)*(u303*((u53+u195*(u80+u37))*u317+u196*(u98+u195*(u&
 &95+u69)+(u95+u71)*u196)+u195*(u51+u331)+u92)))
  u331=1.2d1*pd2
  u69=u319*(2.77583272889560156d6*u49+u48*(8.5d1+u331))*u73
  u92=u99*(1.79612705987362454d6*u49+u48*u86)*u73
  u312=+u318*(5.30673904053570887d7*u49+u48*(1.25d2*u302+2.4d1*u321))*u&
 &73
  u91=u41*(5.41287382134642304d8*u49+u48*(8.5d1*u305+u36))*u73
  u46=5.63450123859075456d-1*u39
  value=value+(c(71)*(x*(u317*(u69+u195*(u46*u195+u312)+u317*(u8*u317+u&
 &195*(u91+u309)+u78))+u195*(u92+u67*u195)+u64)))
  u67=1.88187027462228865d4*u308
  u92=-u59
  u59=1.40862530964768864d0*u93
  u91=-5.2823449111788324d0*u320
  u46=5.98665756600267671d0*u93
  u69=-1.33819404416530421d0*u39
  u335=(u52+u325)*u196
  u312=u53*u195
  value=value+(c(72)*(y*(u196*(u92+u195*(u316+u46)+u196*(u335+u195*(u69&
 &+u80)+u59))+u195*(u91+u312)+u67)))
  u92=2.50916036616305153d3*u308
  u91=-2.74681935381299285d0*u320
  u46=9.86037716753382047d-1*u93
  u69=-6.33881389341459887d-1*u320
  u36=2.32423176091868626d0*u93
  u314=-9.15606451270997615d-1*u39
  value=value+(c(73)*((u196*(u91+u195*(u310+u36)+u196*(u335+u195*(u314+&
 &u80)+u46))+u195*(u69+u311)+u92)*z))
  u92=-1.69035037157722637d0*u333
  u91=1.69035037157722637d0*u87
  u46=u270*(9.76439983458570431d6*u49+u48*u328)*u73
  u69=-7.04312654823844319d-2*u46
  u36=+u42*(u330+u48*(u313+u81))*u73
  u314=u99*(u324+u48*(u326+u50))*u73
  u335=u41*(u85-u48*(u329-5.0d0*u77))*u73
  u41=(u74+u95)
  u313=u52*u195
  value=value+(c(74)*(y*(u196*(u91+u195*(u195*(u335+u62)+u36)+u196*(u41&
 &*u196+u195*(u7+u332)+u69))+u195*(u91+u195*(u313+u314))+u92)))
  u92=-8.45175185788613183d-1*u333
  u69=1.40862530964768864d-1*u96
  u36=u270*(u315+u48*(2.5d1+u323))*u73
  u91=6.33881389341459887d-1*u36
  u332=-8.45175185788613183d-1*u47
  u333=-2.11293796447153296d-1*u36
  u36=7.04312654823844319d-2*u44
  u44=-1.40862530964768864d-1*u39
  u4=2.81725061929537728d-1*u47
  u95=-2.3477088494128144d-2*u9
  u9=u195*(u95+u62)
  u314=u83*u196
  u335=u196*(u7+u314)
  u47=(u44+u62)
  value=value+(c(75)*(z*(u317*(u69+u195*(u9+u36)+u196*(u335+u334)+(u196&
 &*(u31+u314)+u195*u47+u68)*u317)+u196*(u91+u196*(u71*u196+u332))+u195*&
 &(u333+u195*(u313+u4))+u92)))
  u332=+u79*(3.0677652262304331d4*u49+u48)*u73
  u92=u319*(2.51457788382307436d6*u49+u48*(7.7d1+u331))*u73
  u69=+u318*(2.58968865178142593d7*u49+u48*(6.1d1*u302+u306))*u73
  u306=4.22587592894306592d-1*u320
  u333=-8.45175185788613183d-1*u93
  value=value+(c(76)*(y*(u317*(u92+u195*(u310+u333)+u196*(u31*u196+u334&
 &)+u317*((u71+u314)*u317+u335+u195*(u32+u80)+u69))+u196*(u89+u60*u196)&
 &+u195*(u306+u311)+u332)))
  u306=3.5215632741192216d-1*u270*(9.47048813387911121d5*u49+u48*(2.9d1&
 &+u323))*u73
  u92=-7.04312654823844319d-2*u45
  u69=1.05646898223576648d0*u96
  u45=+u307*(1.57079475599856982d7*u49+u48*(3.7d1*u302+u56))*u73
  u335=u99*(1.84674518610642669d8*u49+u48*(2.9d1*u305+u329))*u73
  u333=-u59
  u334=9.39083539765125759d-1*u39
  value=value+(c(77)*(z*(u317*(u306+u195*(u334*u195+u45)+u317*(u41*u317&
 &+u195*(u335+u309)+u92))+u195*(u69+u333*u195)+u38)))
  u309=-2.6411724555894162d1*u320
  u92=1.37340967690649642d1*u93
  u69=-1.90164416802437966d0*u39
  u41=u5*u196
  u306=u80+u41
  u333=u58*u195
  u334=u35*u195
  u335=u66*u195
  value=value+(c(78)*(x*(u196*(u309+u333+u196*(u196*(u69+u306)+u334+u92&
 &))+u335+u67)))
  u67=-6.33881389341459888d0*u320
  u92=6.69097022082652103d0*u93
  u69=-1.40862530964768864d0*u39
  u309=u41+u80
  value=value+(c(79)*(u229*(u196*(u92+u316+u196*(u309+u69))+u312+u67)*z&
 &))
  u67=u319*(4.45320758646353191d4*u49+u48)*u73
  u229=-1.69035037157722637d0*u270*(u40+u70*(1.0d1+pd2))*u73
  u40=u99*(u97+u48*(u54+u50))*u73
  u69=-7.04312654823844319d-2*u96
  u92=7.04312654823844319d-2*u93
  u96=u195*(u44*u195+u36)
  u270=u195*(u69+u92*u195)
  value=value+(c(80)*(x*((u38+u196*(u196*(u65+u41)+u75))*u317+u196*(u22&
 &9+u96+u196*(u47*u196+u9+u40))+u270+u67)))
  u229=+u43*(u315+u48*u72)*u73
  u315=u99*(1.91042605459285519d7*u49+u48*(4.5d1*u302+u50))*u73
  u302=-2.81725061929537728d-1*u39
  u39=-9.39083539765125759d-2*u63
  value=value+(c(81)*(u303*((u88+u196*(u41+u94))*u317+u196*(u315+u195*(&
 &u62+u39)+(u62+u302)*u196)+u195*(u74+u313)+u229)))
  u229=u319*(3.85944657493506099d4*u49+u48)*u73
  u319=+u43*(1.01236252465604292d6*u49+u48*u304)*u73
  u304=7.04312654823844319d-2*u46
  u46=-1.26776277868291978d0*u320
  u320=2.53552555736583955d0*u93
  value=value+(c(82)*(x*(u317*(u319+u96+u196*(u57*u196+u320)+u317*((u52&
 &+u62)*u317+u196*(u57+u41)+u9+u304))+u196*(u46+u82*u196)+u270+u229)))
  value=value+(c(83)*(u303*(u317*(u59+u316+u94*u196+(u309+u44)*u317)+u8&
 &8*u196+u312+u55)))
  value=value+(c(84)*(x*(u317*(u333+u75*u196+u317*((u306)*u317+u65*u196&
 &+u334))+u38*u196+u335)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_opt_3_3=.false.
end function

  
  
!> Compute D X Y coulomb integral 
!!
recursive function D_X_Y_opt_3(a12,a3,r3,m3,c,lmax,value)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  integer     , intent(in)  :: m3       !< m index of the solid harmonic
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< hermit coefficients of the two fisrt obrital produt
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition
  real(kind=8), intent(out) :: value    !< result 
  logical                   :: D_X_Y_opt_3 !< true if the routine knows how to calculate the requested value
  
  ! init return value
  D_X_Y_opt_3 = .true.
  ! select case on m component
  select case (m3)
    case (-3)
      D_X_Y_opt_3 = D_X_Y_opt_3_m3(a12,a3,r3,c,lmax,value)
    case (-2)
      D_X_Y_opt_3 = D_X_Y_opt_3_m2(a12,a3,r3,c,lmax,value)
    case (-1)
      D_X_Y_opt_3 = D_X_Y_opt_3_m1(a12,a3,r3,c,lmax,value)
    case (0)
      D_X_Y_opt_3 = D_X_Y_opt_3_0(a12,a3,r3,c,lmax,value)
    case (1)
      D_X_Y_opt_3 = D_X_Y_opt_3_1(a12,a3,r3,c,lmax,value)
    case (2)
      D_X_Y_opt_3 = D_X_Y_opt_3_2(a12,a3,r3,c,lmax,value)
    case (3)
      D_X_Y_opt_3 = D_X_Y_opt_3_3(a12,a3,r3,c,lmax,value)
    case default
      D_X_Y_opt_3 = .false.
  end select
end function
  
end module
