module mod_D_X_R_shell_opt_1
  
  use mod_A_functions
  
  implicit none
  
  private
  public :: D_X_R_shell_opt_1
  
contains
  
  

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
recursive function D_X_R_shell_opt_1(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value(*) !< result value
  
  ! return value
  
  logical :: D_X_R_shell_opt_1
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_shell_opt_1=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value(1:3)=0.0d0
  u86=a3**(-1)
  u58=-5.0d-1*u86*A2_(p,pd,erfpd,exppd2)*p**2
  value(1)=value(1)+(c(1)*(u58*x))
  value(2)=value(2)+(c(1)*(u58*y))
  value(3)=value(3)+(c(1)*(u58*z))
  if ( lmax .eq. 0 ) return
  u80=A3_(p,pd,erfpd,exppd2)
  u91=p**3
  u92=9.40315972579593812d-2*u86*(5.31736155271654808d0*u80+4.0d0*exppd&
 &2)*u91
  u55=-1.5d0*u86*u80*u91
  u83=x**2
  value(1)=value(1)+(c(2)*(u55*u83+u92))
  u80=x*y
  u84=(u55*u80)
  value(2)=value(2)+(c(2)*u84)
  u91=x*z
  u85=(u55*u91)
  value(3)=value(3)+(c(2)*u85)
  value(1)=value(1)+(c(3)*u84)
  u84=y**2
  value(2)=value(2)+(c(3)*(u55*u84+u92))
  u58=y*z
  u81=(u55*u58)
  value(3)=value(3)+(c(3)*u81)
  value(1)=value(1)+(c(4)*u85)
  value(2)=value(2)+(c(4)*u81)
  u85=z**2
  value(3)=value(3)+(c(4)*(u55*u85+u92))
  if ( lmax .eq. 1 ) return
  u81=A4_(p,pd,erfpd,exppd2)
  u92=p**4
  u74=u86*u81*u92
  u67=4.5d0*u74
  u82=-2.82094791773878144d-1*u86
  u55=exppd2*pd
  u98=-8.0d0*u55
  u89=+u82*(2.65868077635827404d1*u81+u98)*u92
  u68=u89*u83
  value(1)=value(1)+(c(5)*(x*(u68+u67)))
  u64=1.5d0*u74
  u7=(u68+u64)
  u68=(u7*y)
  value(2)=value(2)+(c(5)*u68)
  u8=(u7*z)
  value(3)=value(3)+(c(5)*u8)
  value(1)=value(1)+(c(6)*u68)
  u68=u89*u84
  u7=(u68+u64)
  u97=(x*u7)
  value(2)=value(2)+(c(6)*u97)
  u96=u80*z
  u72=(u89*u96)
  value(3)=value(3)+(c(6)*u72)
  value(1)=value(1)+(c(7)*u8)
  value(2)=value(2)+(c(7)*u72)
  u8=u89*u85
  u74=(u8+u64)
  u78=(x*u74)
  value(3)=value(3)+(c(7)*u78)
  value(1)=value(1)+(c(8)*u97)
  value(2)=value(2)+(c(8)*(y*(u68+u67)))
  u97=(u7*z)
  value(3)=value(3)+(c(8)*u97)
  value(1)=value(1)+(c(9)*u72)
  value(2)=value(2)+(c(9)*u97)
  u97=(y*u74)
  value(3)=value(3)+(c(9)*u97)
  value(1)=value(1)+(c(10)*u78)
  value(2)=value(2)+(c(10)*u97)
  value(3)=value(3)+(c(10)*(z*(u8+u67)))
  if ( lmax .eq. 2 ) return
  u78=A5_(p,pd,erfpd,exppd2)
  u89=p**5
  u97=8.0d0*exppd2
  u7=u86*(u97+2.65868077635827404d1*u78)*u89
  u74=-1.69256875064326886d-1*u7
  u72=u86*u78*u89
  u68=4.5d1*u72
  u8=-1.6d1*exppd2
  u99=+u8*pd2
  u79=+u82*(1.86107654345079183d2*u78+u99)*u89
  u94=u79*u83
  value(1)=value(1)+(c(11)*(u83*(u68+u94)+u74))
  u65=2.25d1*u72
  u62=x*(u94+u65)
  u78=(u62*y)
  value(2)=value(2)+(c(11)*u78)
  u75=(u62*z)
  value(3)=value(3)+(c(11)*u75)
  value(1)=value(1)+(c(12)*u78)
  u78=-5.64189583547756287d-2*u7
  u62=7.5d0*u72
  u7=(u62+u94)
  u90=u62*u83+u78
  u54=(u7*u84+u90)
  value(2)=value(2)+(c(12)*u54)
  u6=((u94+u62)*u58)
  value(3)=value(3)+(c(12)*u6)
  value(1)=value(1)+(c(13)*u75)
  value(2)=value(2)+(c(13)*u6)
  u75=(u7*u85+u90)
  value(3)=value(3)+(c(13)*u75)
  value(1)=value(1)+(c(14)*u54)
  u54=u79*u84
  u7=(u54+u65)
  u90=(u80*u7)
  value(2)=value(2)+(c(14)*u90)
  u94=(x*(u54+u62)*z)
  value(3)=value(3)+(c(14)*u94)
  value(1)=value(1)+(c(15)*u6)
  value(2)=value(2)+(c(15)*u94)
  u6=u79*u85
  u73=(u80*(u6+u62))
  value(3)=value(3)+(c(15)*u73)
  value(1)=value(1)+(c(16)*u75)
  value(2)=value(2)+(c(16)*u73)
  u75=(u6+u65)
  u59=(u91*u75)
  value(3)=value(3)+(c(16)*u59)
  value(1)=value(1)+(c(17)*u90)
  value(2)=value(2)+(c(17)*(u84*(u68+u54)+u74))
  u90=(y*u7*z)
  value(3)=value(3)+(c(17)*u90)
  value(1)=value(1)+(c(18)*u94)
  value(2)=value(2)+(c(18)*u90)
  u90=((u62+u54)*u85+u62*u84+u78)
  value(3)=value(3)+(c(18)*u90)
  value(1)=value(1)+(c(19)*u73)
  value(2)=value(2)+(c(19)*u90)
  u90=(u58*u75)
  value(3)=value(3)+(c(19)*u90)
  value(1)=value(1)+(c(20)*u59)
  value(2)=value(2)+(c(20)*u90)
  value(3)=value(3)+(c(20)*(u85*(u68+u6)+u74))
  if ( lmax .eq. 3 ) return
  u79=A6_(p,pd,erfpd,exppd2)
  u90=p**6
  u73=u86*u79*u90
  u59=-1.125d2*u73
  u94=-1.6d1*u55
  u7=u86*(1.86107654345079183d2*u79+u94)*u90
  u75=2.82094791773878144d0*u7
  u68=2.0d0*pd2
  u54=+u82*(1.67496888910571265d3*u79+u94*(9.0d0+u68))*u90
  u94=u54*u83
  value(1)=value(1)+(c(21)*(x*(u83*(u75+u94)+u59)))
  u6=-2.25d1*u73
  u78=1.69256875064326886d0*u7
  u74=(u83*(u78+u94)+u6)
  u66=(u74*y)
  value(2)=value(2)+(c(21)*u66)
  u76=(u74*z)
  value(3)=value(3)+(c(21)*u76)
  value(1)=value(1)+(c(22)*u66)
  u66=8.46284375321634431d-1*u7
  u74=2.82094791773878144d-1*u7
  u7=(u66+u94)
  u89=u74*u83
  u70=u89+u6
  u9=(x*(u7*u84+u70))
  value(2)=value(2)+(c(22)*u9)
  u60=(x*(u94+u66)*u58)
  value(3)=value(3)+(c(22)*u60)
  value(1)=value(1)+(c(23)*u76)
  value(2)=value(2)+(c(23)*u60)
  u76=(x*(u7*u85+u70))
  value(3)=value(3)+(c(23)*u76)
  value(1)=value(1)+(c(24)*u9)
  u9=(u74+u94)
  u7=u9*u84
  u70=u66*u83+u6
  u94=(y*(u7+u70))
  value(2)=value(2)+(c(24)*u94)
  u56=-7.5d0*u73
  u73=u89+u56
  u89=((u7+u73)*z)
  value(3)=value(3)+(c(24)*u89)
  value(1)=value(1)+(c(25)*u60)
  value(2)=value(2)+(c(25)*u89)
  u60=u9*u85
  u7=(y*(u60+u73))
  value(3)=value(3)+(c(25)*u7)
  value(1)=value(1)+(c(26)*u76)
  value(2)=value(2)+(c(26)*u7)
  u73=(z*(u60+u70))
  value(3)=value(3)+(c(26)*u73)
  value(1)=value(1)+(c(27)*u94)
  u94=u54*u84
  u60=(u84*(u78+u94)+u6)
  u9=(x*u60)
  value(2)=value(2)+(c(27)*u9)
  u70=(u80*(u94+u66)*z)
  value(3)=value(3)+(c(27)*u70)
  value(1)=value(1)+(c(28)*u89)
  value(2)=value(2)+(c(28)*u70)
  u89=(u74+u94)*u85
  u95=u74*u84
  u76=(x*(u89+u95+u56))
  value(3)=value(3)+(c(28)*u76)
  value(1)=value(1)+(c(29)*u7)
  value(2)=value(2)+(c(29)*u76)
  u7=u54*u85
  u77=(u96*(u7+u66))
  value(3)=value(3)+(c(29)*u77)
  value(1)=value(1)+(c(30)*u73)
  value(2)=value(2)+(c(30)*u77)
  u73=(u85*(u78+u7)+u6)
  u88=(x*u73)
  value(3)=value(3)+(c(30)*u88)
  value(1)=value(1)+(c(31)*u9)
  value(2)=value(2)+(c(31)*(y*(u84*(u75+u94)+u59)))
  u9=(u60*z)
  value(3)=value(3)+(c(31)*u9)
  value(1)=value(1)+(c(32)*u70)
  value(2)=value(2)+(c(32)*u9)
  u70=(y*((u66+u94)*u85+u95+u6))
  value(3)=value(3)+(c(32)*u70)
  value(1)=value(1)+(c(33)*u76)
  value(2)=value(2)+(c(33)*u70)
  u76=(z*(u89+u66*u84+u6))
  value(3)=value(3)+(c(33)*u76)
  value(1)=value(1)+(c(34)*u77)
  value(2)=value(2)+(c(34)*u76)
  u76=(y*u73)
  value(3)=value(3)+(c(34)*u76)
  value(1)=value(1)+(c(35)*u88)
  value(2)=value(2)+(c(35)*u76)
  value(3)=value(3)+(c(35)*(z*(u85*(u75+u7)+u59)))
  if ( lmax .eq. 4 ) return
  u76=A7_(p,pd,erfpd,exppd2)
  u88=p**7
  u54=u86*(1.86107654345079183d2*u76-u8)*u88
  u8=6.04488839515453165d-1*u54
  u70=u86*u76*u88
  u60=-2.3625d3*u70
  u73=-3.2d1*exppd2*pd2
  u77=u86*(1.67496888910571265d3*u76+u73)*u88
  u89=4.23142187660817215d0*u77
  u94=(1.1d1+u68)
  u7=u86*(1.84246577801628391d4*u76+u73*u94)*u88
  u73=-2.82094791773878144d-1*u7
  u95=u73*u83
  value(1)=value(1)+(c(36)*(u83*(u60+u83*(u95+u89))+u8))
  u74=-7.875d2*u70
  u66=2.82094791773878144d0*u77
  u78=x*(u83*(u66+u95)+u74)
  u59=(u78*y)
  value(2)=value(2)+(c(36)*u59)
  u75=(u78*z)
  value(3)=value(3)+(c(36)*u75)
  value(1)=value(1)+(c(37)*u59)
  u59=1.20897767903090633d-1*u54
  u78=-1.575d2*u70
  u54=-3.15d2*u70
  u56=1.69256875064326886d0*u77
  u9=2.82094791773878144d-1*u77
  u6=(u78+u83*(u95+u56))
  u82=u9*u83
  u61=u83*(u54+u82)+u59
  u57=(u6*u84+u61)
  value(2)=value(2)+(c(37)*u57)
  u87=((u83*(u56+u95)+u78)*u58)
  value(3)=value(3)+(c(37)*u87)
  value(1)=value(1)+(c(38)*u75)
  value(2)=value(2)+(c(38)*u87)
  u75=(u6*u85+u61)
  value(3)=value(3)+(c(38)*u75)
  value(1)=value(1)+(c(39)*u57)
  u57=-4.725d2*u70
  u6=8.46284375321634431d-1*u77
  u61=(u6+u95)
  u69=u61*u84
  u67=u6*u83
  u93=u67+u57
  u79=(u80*(u69+u93))
  value(2)=value(2)+(c(39)*u79)
  u71=u82+u78
  u82=(x*(u69+u71)*z)
  value(3)=value(3)+(c(39)*u82)
  value(1)=value(1)+(c(40)*u87)
  value(2)=value(2)+(c(40)*u82)
  u87=u61*u85
  u69=(u80*(u87+u71))
  value(3)=value(3)+(c(40)*u69)
  value(1)=value(1)+(c(41)*u75)
  value(2)=value(2)+(c(41)*u69)
  u75=(u91*(u87+u93))
  value(3)=value(3)+(c(41)*u75)
  value(1)=value(1)+(c(42)*u79)
  u79=(u95+u9)
  u87=u54+u56*u83
  u61=u78*u83+u59
  u93=(u84*(u87+u79*u84)+u61)
  value(2)=value(2)+(c(42)*u93)
  u71=(u9+u95)
  u62=u67+u78
  u67=(y*(u71*u84+u62)*z)
  value(3)=value(3)+(c(42)*u67)
  value(1)=value(1)+(c(43)*u82)
  value(2)=value(2)+(c(43)*u67)
  u82=-8.05985119353937553d-2*u86*(5.58322963035237549d2*u76-u97)*u88
  u97=-2.82094791773878144d-1*u77
  u95=-1.12837916709551257d0*u86*(5.02490666731713794d3*u76+u99*(6.0d0+&
 &pd2))*u88
  u77=2.82094791773878144d-1*u7
  u7=u77*u83
  u72=(u84*(u9+u83*(u7+u95)+(u7+u97)*u84)+u83*(u9+u97*u83)+u82)
  value(3)=value(3)+(c(43)*u72)
  value(1)=value(1)+(c(44)*u69)
  value(2)=value(2)+(c(44)*u72)
  u69=(u58*(u71*u85+u62))
  value(3)=value(3)+(c(44)*u69)
  value(1)=value(1)+(c(45)*u75)
  value(2)=value(2)+(c(45)*u69)
  u75=(u85*(u87+u79*u85)+u61)
  value(3)=value(3)+(c(45)*u75)
  value(1)=value(1)+(c(46)*u93)
  u93=u73*u84
  u79=(u84*(u66+u93)+u74)
  u71=(u80*u79)
  value(2)=value(2)+(c(46)*u71)
  u87=(x*(u84*(u56+u93)+u78)*z)
  value(3)=value(3)+(c(46)*u87)
  value(1)=value(1)+(c(47)*u67)
  value(2)=value(2)+(c(47)*u87)
  u67=(u6+u93)*u85
  u7=u9*u84
  u62=(u80*(u67+u7+u78))
  value(3)=value(3)+(c(47)*u62)
  value(1)=value(1)+(c(48)*u72)
  value(2)=value(2)+(c(48)*u62)
  u61=u6*u84
  u77=(u91*((u9+u93)*u85+u61+u78))
  value(3)=value(3)+(c(48)*u77)
  value(1)=value(1)+(c(49)*u69)
  value(2)=value(2)+(c(49)*u77)
  u95=u73*u85
  u69=(u80*(u85*(u56+u95)+u78))
  value(3)=value(3)+(c(49)*u69)
  value(1)=value(1)+(c(50)*u75)
  value(2)=value(2)+(c(50)*u69)
  u75=(u85*(u66+u95)+u74)
  u97=(u91*u75)
  value(3)=value(3)+(c(50)*u97)
  value(1)=value(1)+(c(51)*u71)
  value(2)=value(2)+(c(51)*(u84*(u60+u84*(u93+u89))+u8))
  u71=(y*u79*z)
  value(3)=value(3)+(c(51)*u71)
  value(1)=value(1)+(c(52)*u87)
  value(2)=value(2)+(c(52)*u71)
  u87=((u78+u84*(u93+u56))*u85+u84*(u54+u7)+u59)
  value(3)=value(3)+(c(52)*u87)
  value(1)=value(1)+(c(53)*u62)
  value(2)=value(2)+(c(53)*u87)
  u87=(u58*(u67+u61+u57))
  value(3)=value(3)+(c(53)*u87)
  value(1)=value(1)+(c(54)*u77)
  value(2)=value(2)+(c(54)*u87)
  u77=(u85*(u54+u56*u84+(u93+u9)*u85)+u78*u84+u59)
  value(3)=value(3)+(c(54)*u77)
  value(1)=value(1)+(c(55)*u69)
  value(2)=value(2)+(c(55)*u77)
  u77=(u58*u75)
  value(3)=value(3)+(c(55)*u77)
  value(1)=value(1)+(c(56)*u97)
  value(2)=value(2)+(c(56)*u77)
  value(3)=value(3)+(c(56)*(u85*(u60+u85*(u95+u89))+u8))
  if ( lmax .eq. 5 ) return
  u77=A8_(p,pd,erfpd,exppd2)
  u87=p**8
  u71=u86*u77*u87
  u69=5.5125d3*u71
  u97=-3.2d1*u55
  u62=u86*(1.67496888910571265d3*u77+u97)*u87
  u79=-2.96199531362572051d1*u62
  u75=1.84246577801628391d4*u77
  u67=u86*(u75+u97*u94)*u87
  u89=5.92399062725144101d0*u67
  u93=pd2**2
  u95=(u68+1.1d1)
  u7=u86*(2.39520551142116908d5*u77+u97*(1.3d1*u95+4.0d0*u93))*u87
  u94=-2.82094791773878144d-1*u7
  u74=u94*u83
  value(1)=value(1)+(c(57)*(x*(u83*(u79+u83*(u74+u89))+u69)))
  u61=7.875d2*u71
  u92=-1.26942656298245165d1*u62
  u56=4.23142187660817215d0*u67
  u91=(u83*(u92+u83*(u74+u56))+u61)
  u73=(u91*y)
  value(2)=value(2)+(c(57)*u73)
  u72=(u91*z)
  value(3)=value(3)+(c(57)*u72)
  value(1)=value(1)+(c(58)*u73)
  u73=-4.23142187660817215d0*u62
  u91=-2.82094791773878144d0*u62
  u82=2.82094791773878144d0*u67
  u9=2.82094791773878144d-1*u67
  u60=(u73+u83*(u74+u82))
  u6=u9*u83
  u59=u83*(u91+u6)+u61
  u66=(x*(u60*u84+u59))
  value(2)=value(2)+(c(58)*u66)
  u88=(x*(u83*(u82+u74)+u73)*u58)
  value(3)=value(3)+(c(58)*u88)
  value(1)=value(1)+(c(59)*u72)
  value(2)=value(2)+(c(59)*u88)
  u72=(x*(u60*u85+u59))
  value(3)=value(3)+(c(59)*u72)
  value(1)=value(1)+(c(60)*u66)
  u66=4.725d2*u71
  u60=-8.46284375321634431d-1*u62
  u59=-5.07770625192980658d0*u62
  u78=1.69256875064326886d0*u67
  u8=8.46284375321634431d-1*u67
  u81=(u60+u83*(u74+u78))
  u70=u81*u84
  u57=u8*u83
  u90=u83*(u59+u57)+u66
  u54=(y*(u70+u90))
  value(2)=value(2)+(c(60)*u54)
  u63=1.575d2*u71
  u71=-1.69256875064326886d0*u62
  u99=u83*(u71+u6)+u63
  u6=((u70+u99)*z)
  value(3)=value(3)+(c(60)*u6)
  value(1)=value(1)+(c(61)*u88)
  value(2)=value(2)+(c(61)*u6)
  u58=u81*u85
  u70=(y*(u58+u99))
  value(3)=value(3)+(c(61)*u70)
  value(1)=value(1)+(c(62)*u72)
  value(2)=value(2)+(c(62)*u70)
  u72=(z*(u58+u90))
  value(3)=value(3)+(c(62)*u72)
  value(1)=value(1)+(c(63)*u54)
  u58=(u74+u8)
  u88=u78*u83
  u90=u59+u88
  u99=u60*u83
  u81=u99+u66
  u54=(x*(u84*(u90+u58*u84)+u81))
  value(2)=value(2)+(c(63)*u54)
  u65=-2.53885312596490329d0*u62
  u62=(u8+u74)
  u64=u57+u65
  u57=(u80*(u62*u84+u64)*z)
  value(3)=value(3)+(c(63)*u57)
  value(1)=value(1)+(c(64)*u6)
  value(2)=value(2)+(c(64)*u57)
  u76=-6.77027500257307545d0*u86*(1.86107654345079183d2*u77-4.0d0*u55)*&
 &u87
  u6=-8.46284375321634431d-1*u67
  u55=2.82094791773878144d-1*u86*(2.17745955583742644d4*u77+u97*(1.3d1+&
 &u68))*u87
  u68=-4.5135166683820503d0*u86*(u75+u98*(4.0d0*u95+u93))*u87
  u75=2.82094791773878144d-1*u7
  u7=-2.82094791773878144d-1*u67
  u93=u75*u83
  u98=u83*(u93+u68)
  u86=(x*(u84*(u8+u98+(u93+u6)*u84)+u83*(u55+u7*u83)+u76))
  value(3)=value(3)+(c(64)*u86)
  value(1)=value(1)+(c(65)*u70)
  value(2)=value(2)+(c(65)*u86)
  u70=(u96*(u62*u85+u64))
  value(3)=value(3)+(c(65)*u70)
  value(1)=value(1)+(c(66)*u72)
  value(2)=value(2)+(c(66)*u70)
  u95=(x*(u85*(u90+u58*u85)+u81))
  value(3)=value(3)+(c(66)*u95)
  value(1)=value(1)+(c(67)*u54)
  u87=(u74+u9)
  u54=u87*u84
  u74=u91+u82*u83
  u81=u73*u83+u61
  u58=(y*(u84*(u74+u54)+u81))
  value(2)=value(2)+(c(67)*u58)
  u72=u71+u88
  u90=u99+u63
  u88=((u84*(u72+u54)+u90)*z)
  value(3)=value(3)+(c(67)*u88)
  value(1)=value(1)+(c(68)*u57)
  value(2)=value(2)+(c(68)*u88)
  u54=u55+u98
  u98=u83*(u8+u6*u83)+u76
  u57=(u93+u7)
  u99=(y*(u84*(u54+u57*u84)+u98))
  value(3)=value(3)+(c(68)*u99)
  value(1)=value(1)+(c(69)*u86)
  value(2)=value(2)+(c(69)*u99)
  u93=(z*(u85*(u54+u57*u85)+u98))
  value(3)=value(3)+(c(69)*u93)
  value(1)=value(1)+(c(70)*u70)
  value(2)=value(2)+(c(70)*u93)
  u54=u87*u85
  u86=(y*(u85*(u72+u54)+u90))
  value(3)=value(3)+(c(70)*u86)
  value(1)=value(1)+(c(71)*u95)
  value(2)=value(2)+(c(71)*u86)
  u87=(z*(u85*(u74+u54)+u81))
  value(3)=value(3)+(c(71)*u87)
  value(1)=value(1)+(c(72)*u58)
  u54=u94*u84
  u81=(u84*(u92+u84*(u54+u56))+u61)
  u74=(x*u81)
  value(2)=value(2)+(c(72)*u74)
  u72=(u80*(u84*(u82+u54)+u73)*z)
  value(3)=value(3)+(c(72)*u72)
  value(1)=value(1)+(c(73)*u88)
  value(2)=value(2)+(c(73)*u72)
  u88=(u60+u84*(u54+u78))*u85
  u57=u9*u84
  u58=(x*(u88+u84*(u71+u57)+u63))
  value(3)=value(3)+(c(73)*u58)
  value(1)=value(1)+(c(74)*u99)
  value(2)=value(2)+(c(74)*u58)
  u95=u8*u84
  u99=(u96*((u8+u54)*u85+u95+u65))
  value(3)=value(3)+(c(74)*u99)
  value(1)=value(1)+(c(75)*u93)
  value(2)=value(2)+(c(75)*u99)
  u6=(u54+u9)*u85
  u7=u78*u84
  u75=u60*u84
  u68=(x*(u85*(u71+u7+u6)+u75+u63))
  value(3)=value(3)+(c(75)*u68)
  value(1)=value(1)+(c(76)*u86)
  value(2)=value(2)+(c(76)*u68)
  u86=u94*u85
  u55=(u96*(u85*(u82+u86)+u73))
  value(3)=value(3)+(c(76)*u55)
  value(1)=value(1)+(c(77)*u87)
  value(2)=value(2)+(c(77)*u55)
  u87=(u85*(u92+u85*(u86+u56))+u61)
  u83=(x*u87)
  value(3)=value(3)+(c(77)*u83)
  value(1)=value(1)+(c(78)*u74)
  value(2)=value(2)+(c(78)*(y*(u84*(u79+u84*(u54+u89))+u69)))
  u74=(u81*z)
  value(3)=value(3)+(c(78)*u74)
  value(1)=value(1)+(c(79)*u72)
  value(2)=value(2)+(c(79)*u74)
  u74=(y*((u73+u84*(u54+u82))*u85+u84*(u91+u57)+u61))
  value(3)=value(3)+(c(79)*u74)
  value(1)=value(1)+(c(80)*u58)
  value(2)=value(2)+(c(80)*u74)
  u74=(z*(u88+u84*(u59+u95)+u66))
  value(3)=value(3)+(c(80)*u74)
  value(1)=value(1)+(c(81)*u99)
  value(2)=value(2)+(c(81)*u74)
  u74=(y*(u85*(u59+u7+(u54+u8)*u85)+u75+u66))
  value(3)=value(3)+(c(81)*u74)
  value(1)=value(1)+(c(82)*u68)
  value(2)=value(2)+(c(82)*u74)
  u59=(z*(u85*(u91+u82*u84+u6)+u73*u84+u61))
  value(3)=value(3)+(c(82)*u59)
  value(1)=value(1)+(c(83)*u55)
  value(2)=value(2)+(c(83)*u59)
  u59=(y*u87)
  value(3)=value(3)+(c(83)*u59)
  value(1)=value(1)+(c(84)*u83)
  value(2)=value(2)+(c(84)*u59)
  value(3)=value(3)+(c(84)*(z*(u85*(u79+u85*(u86+u89))+u69)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_shell_opt_1=.false.
end function

  
end module
