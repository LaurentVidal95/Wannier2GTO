module mod_D_X_Y_shell_optv4_1
  
  implicit none
  
  private
  public :: D_X_Y_shell_optv4_1
  integer, parameter :: NVEC=4
  
contains
  
  

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
recursive function D_X_Y_shell_optv4_1(a12,a3,r3,c,lmax,value)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12          !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3(NVEC)     !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(NVEC,3)   !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)         !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax         !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value(*)     !< result value
  
  ! return value
  logical :: D_X_Y_shell_optv4_1
  
  ! local variables
  integer      :: i
  real(kind=8) :: d(NVEC)
  real(kind=8) :: p(NVEC)
  real(kind=8) :: pd(NVEC)
  real(kind=8) :: pd2(NVEC)
  real(kind=8) :: erfpd(NVEC)
  real(kind=8) :: exppd2(NVEC)
  real(kind=8) :: x(NVEC)
  real(kind=8) :: y(NVEC)
  real(kind=8) :: z(NVEC)
  
  ! C function interface
  INTERFACE
    PURE RECURSIVE SUBROUTINE my_erf_v4(pd, exppd2, erfpd) BIND(C,NAME="my_erf_v4_")
     real(kind=8), intent(in)  :: pd(4)
     real(kind=8), intent(out) :: erfpd(4)
     real(kind=8), intent(out) :: exppd2(4)
    END SUBROUTINE my_erf_v4
  END INTERFACE
  
  ! temporary variables
  real(kind=8) :: u50(NVEC)
  real(kind=8) :: u55(NVEC)
  real(kind=8) :: u56(NVEC)
  real(kind=8) :: u57(NVEC)
  real(kind=8) :: u58(NVEC)
  real(kind=8) :: u59(NVEC)
  real(kind=8) :: u6(NVEC)
  real(kind=8) :: u60(NVEC)
  real(kind=8) :: u62(NVEC)
  real(kind=8) :: u63(NVEC)
  real(kind=8) :: u64(NVEC)
  real(kind=8) :: u65(NVEC)
  real(kind=8) :: u66(NVEC)
  real(kind=8) :: u67(NVEC)
  real(kind=8) :: u68(NVEC)
  real(kind=8) :: u69(NVEC)
  real(kind=8) :: u7(NVEC)
  real(kind=8) :: u70(NVEC)
  real(kind=8) :: u71(NVEC)
  real(kind=8) :: u72(NVEC)
  real(kind=8) :: u73(NVEC)
  real(kind=8) :: u74(NVEC)
  real(kind=8) :: u75(NVEC)
  real(kind=8) :: u77(NVEC)
  real(kind=8) :: u78(NVEC)
  real(kind=8) :: u79(NVEC)
  real(kind=8) :: u8(NVEC)
  real(kind=8) :: u80(NVEC)
  real(kind=8) :: u82(NVEC)
  real(kind=8) :: u83(NVEC)
  real(kind=8) :: u84(NVEC)
  real(kind=8) :: u85(NVEC)
  real(kind=8) :: u86(NVEC)
  real(kind=8) :: u87(NVEC)
  real(kind=8) :: u88(NVEC)
  real(kind=8) :: u89(NVEC)
  real(kind=8) :: u9(NVEC)
  real(kind=8) :: u90(NVEC)
  real(kind=8) :: u91(NVEC)
  real(kind=8) :: u92(NVEC)
  real(kind=8) :: u93(NVEC)
  real(kind=8) :: u94(NVEC)
  real(kind=8) :: u95(NVEC)
  real(kind=8) :: u96(NVEC)
  real(kind=8) :: u97(NVEC)
  real(kind=8) :: u98(NVEC)
  real(kind=8) :: u99(NVEC)
  real(kind=8) :: value_1_(NVEC)
  real(kind=8) :: value_2_(NVEC)
  real(kind=8) :: value_3_(NVEC)

  
  ! init values
  value_1_ = 0.0d0
  value_2_ = 0.0d0
  value_3_ = 0.0d0
  
  ! init computation flag
  D_X_Y_shell_optv4_1=.true.
  
  ! compute local quantities
  d=sqrt(sum(r3**2,dim=2))+1.0d-32
  p=sqrt((a12*a3)/(a12+a3))
  pd=p*d
  call my_erf_v4(pd, exppd2, erfpd)
  pd2=pd*pd
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  x=r3(:,1)/d
  y=r3(:,2)/d
  z=r3(:,3)/d
  
  ! computation section
  u99=a3**(-1)
  u70=-2.44301255951459961d-1*u99*p**2*A2_v(pd,exppd2,erfpd)
  value_1_=value_1_+(c(1)*(u70*y))
  value_2_=value_2_+(c(1)*(u70*z))
  value_3_=value_3_+(c(1)*(u70*x))
  if ( lmax .eq. 0 ) go to 100
  u86=A3_v(pd,exppd2,erfpd)
  u95=u99*p**3
  u68=-7.32903767854379883d-1*u95*u86
  u70=x*y
  u98=(u68*u70)
  value_1_=value_1_+(c(2)*u98)
  u80=x*z
  u87=(u68*u80)
  value_2_=value_2_+(c(2)*u87)
  u50=7.08981540362206411d0*exppd2
  u85=2.59211683254887779d-2*u95*(9.42477796076937972d0*u86+u50)
  u96=x**2
  value_3_=value_3_+(c(2)*(u68*u96+u85))
  u97=y**2
  value_1_=value_1_+(c(3)*(u68*u97+u85))
  u86=y*z
  u92=(u68*u86)
  value_2_=value_2_+(c(3)*u92)
  value_3_=value_3_+(c(3)*u98)
  value_1_=value_1_+(c(4)*u92)
  u98=z**2
  value_2_=value_2_+(c(4)*(u68*u98+u85))
  value_3_=value_3_+(c(4)*u87)
  if ( lmax .eq. 1 ) go to 100
  u87=A5_v(pd,exppd2,erfpd)
  u92=u99*p**4*pd
  u68=1.41796308072441282d1*exppd2
  u85=u92*(4.71238898038468986d1*u87+u68)
  u90=1.55527009952932667d-2*u85
  u57=-3.66451883927189941d0*u92*u87
  u78=u57*u96
  u66=(u78+u90)
  u75=(u66*y)
  value_1_=value_1_+(c(5)*u75)
  u77=(u66*z)
  value_2_=value_2_+(c(5)*u77)
  u66=4.66581029858798002d-2*u85
  value_3_=value_3_+(c(5)*(x*(u78+u66)))
  u78=u57*u97
  u85=(u78+u90)
  u94=(x*u85)
  value_1_=value_1_+(c(6)*u94)
  u87=u70*z
  u64=(u57*u87)
  value_2_=value_2_+(c(6)*u64)
  value_3_=value_3_+(c(6)*u75)
  value_1_=value_1_+(c(7)*u64)
  u75=u57*u98
  u84=(u75+u90)
  u83=(x*u84)
  value_2_=value_2_+(c(7)*u83)
  value_3_=value_3_+(c(7)*u77)
  value_1_=value_1_+(c(8)*(y*(u78+u66)))
  u77=(u85*z)
  value_2_=value_2_+(c(8)*u77)
  value_3_=value_3_+(c(8)*u94)
  value_1_=value_1_+(c(9)*u77)
  u77=(y*u84)
  value_2_=value_2_+(c(9)*u77)
  value_3_=value_3_+(c(9)*u64)
  value_1_=value_1_+(c(10)*u77)
  value_2_=value_2_+(c(10)*(z*(u75+u66)))
  value_3_=value_3_+(c(10)*u83)
  if ( lmax .eq. 2 ) go to 100
  u83=A7_v(pd,exppd2,erfpd)
  u77=3.2986722862692829d2*u83
  u94=u99*p**5
  u85=2.83592616144882564d1*exppd2
  u84=u94*pd2*(u77+u85)
  u64=3.33272164184855715d-2*u84
  u78=pd2*u83
  u75=-2.56516318749032959d1*u94*u78
  u90=u75*u96
  u57=x*(u90+u64)
  u66=(u57*y)
  value_1_=value_1_+(c(11)*u66)
  u72=(u57*z)
  value_2_=value_2_+(c(11)*u72)
  u57=2.0d0*pd2
  u93=u94*(u68*(u57+7.0d0)+3.2986722862692829d2*u78)
  u73=-6.66544328369711431d-3*u93
  u62=6.66544328369711431d-2*u84
  value_3_=value_3_+(c(11)*(u96*(u62+u90)+u73))
  u71=-2.2218144278990381d-3*u93
  u93=1.11090721394951905d-2*u84
  u84=(u93+u90)
  u95=u93*u96+u71
  u89=(u84*u97+u95)
  value_1_=value_1_+(c(12)*u89)
  u9=((u90+u93)*u86)
  value_2_=value_2_+(c(12)*u9)
  value_3_=value_3_+(c(12)*u66)
  value_1_=value_1_+(c(13)*u9)
  u66=(u84*u98+u95)
  value_2_=value_2_+(c(13)*u66)
  value_3_=value_3_+(c(13)*u72)
  u72=u75*u97
  u84=(u72+u64)
  u95=(u70*u84)
  value_1_=value_1_+(c(14)*u95)
  u90=(x*(u72+u93)*z)
  value_2_=value_2_+(c(14)*u90)
  value_3_=value_3_+(c(14)*u89)
  value_1_=value_1_+(c(15)*u90)
  u89=u75*u98
  u8=(u70*(u89+u93))
  value_2_=value_2_+(c(15)*u8)
  value_3_=value_3_+(c(15)*u9)
  value_1_=value_1_+(c(16)*u8)
  u9=(u89+u64)
  u74=(u80*u9)
  value_2_=value_2_+(c(16)*u74)
  value_3_=value_3_+(c(16)*u66)
  value_1_=value_1_+(c(17)*(u97*(u62+u72)+u73))
  u66=(y*u84*z)
  value_2_=value_2_+(c(17)*u66)
  value_3_=value_3_+(c(17)*u95)
  value_1_=value_1_+(c(18)*u66)
  u95=((u93+u72)*u98+u93*u97+u71)
  value_2_=value_2_+(c(18)*u95)
  value_3_=value_3_+(c(18)*u90)
  value_1_=value_1_+(c(19)*u95)
  u90=(u86*u9)
  value_2_=value_2_+(c(19)*u90)
  value_3_=value_3_+(c(19)*u8)
  value_1_=value_1_+(c(20)*u90)
  value_2_=value_2_+(c(20)*(u98*(u62+u89)+u73))
  value_3_=value_3_+(c(20)*u74)
  if ( lmax .eq. 3 ) go to 100
  u90=u99*p**6*pd
  u8=u90*(u85+u77)
  u95=-3.33272164184855715d-2*u8
  u74=u90*u83
  u66=1.53909791249419775d2*u74
  u77=exppd2*pd2
  u84=-7.77635049764663336d-2*u90*(2.96880505764235461d3*u83-5.67185232&
 &289765129d1*u77)
  u9=u84*u96
  u72=(u96*(u66+u9)+u95)
  u89=(u72*y)
  value_1_=value_1_+(c(21)*u89)
  u93=(u72*z)
  value_2_=value_2_+(c(21)*u93)
  u72=-1.66636082092427858d-1*u8
  u71=2.56516318749032959d2*u74
  value_3_=value_3_+(c(21)*(x*(u96*(u71+u9)+u72)))
  u64=7.69548956247098877d1*u74
  u62=2.56516318749032959d1*u74
  u73=(u64+u9)
  u75=u62*u96
  u55=u75+u95
  u79=(x*(u73*u97+u55))
  value_1_=value_1_+(c(22)*u79)
  u83=(x*(u9+u64)*u86)
  value_2_=value_2_+(c(22)*u83)
  value_3_=value_3_+(c(22)*u89)
  value_1_=value_1_+(c(23)*u83)
  u89=(x*(u73*u98+u55))
  value_2_=value_2_+(c(23)*u89)
  value_3_=value_3_+(c(23)*u93)
  u93=(u62+u9)
  u73=u93*u97
  u55=u64*u96+u95
  u9=(y*(u73+u55))
  value_1_=value_1_+(c(24)*u9)
  u78=-1.11090721394951905d-2*u8
  u74=u75+u78
  u75=((u73+u74)*z)
  value_2_=value_2_+(c(24)*u75)
  value_3_=value_3_+(c(24)*u79)
  value_1_=value_1_+(c(25)*u75)
  u79=u93*u98
  u73=(y*(u79+u74))
  value_2_=value_2_+(c(25)*u73)
  value_3_=value_3_+(c(25)*u83)
  value_1_=value_1_+(c(26)*u73)
  u83=(z*(u79+u55))
  value_2_=value_2_+(c(26)*u83)
  value_3_=value_3_+(c(26)*u89)
  u89=u84*u97
  u79=(u97*(u66+u89)+u95)
  u93=(x*u79)
  value_1_=value_1_+(c(27)*u93)
  u55=(u70*(u89+u64)*z)
  value_2_=value_2_+(c(27)*u55)
  value_3_=value_3_+(c(27)*u9)
  value_1_=value_1_+(c(28)*u55)
  u9=(u62+u89)*u98
  u74=u62*u97
  u8=(x*(u9+u74+u78))
  value_2_=value_2_+(c(28)*u8)
  value_3_=value_3_+(c(28)*u75)
  value_1_=value_1_+(c(29)*u8)
  u75=u84*u98
  u67=(u87*(u75+u64))
  value_2_=value_2_+(c(29)*u67)
  value_3_=value_3_+(c(29)*u73)
  value_1_=value_1_+(c(30)*u67)
  u73=(u98*(u66+u75)+u95)
  u91=(x*u73)
  value_2_=value_2_+(c(30)*u91)
  value_3_=value_3_+(c(30)*u83)
  value_1_=value_1_+(c(31)*(y*(u97*(u71+u89)+u72)))
  u83=(u79*z)
  value_2_=value_2_+(c(31)*u83)
  value_3_=value_3_+(c(31)*u93)
  value_1_=value_1_+(c(32)*u83)
  u93=(y*((u64+u89)*u98+u74+u95))
  value_2_=value_2_+(c(32)*u93)
  value_3_=value_3_+(c(32)*u55)
  value_1_=value_1_+(c(33)*u93)
  u93=(z*(u9+u64*u97+u95))
  value_2_=value_2_+(c(33)*u93)
  value_3_=value_3_+(c(33)*u8)
  value_1_=value_1_+(c(34)*u93)
  u93=(y*u73)
  value_2_=value_2_+(c(34)*u93)
  value_3_=value_3_+(c(34)*u67)
  value_1_=value_1_+(c(35)*u93)
  value_2_=value_2_+(c(35)*(z*(u98*(u71+u75)+u72)))
  value_3_=value_3_+(c(35)*u91)
  if ( lmax .eq. 4 ) go to 100
  u84=A9_v(pd,exppd2,erfpd)
  u93=u99*p**7
  u91=u93*pd2
  u83=5.67185232289765129d1*exppd2
  u66=u91*(u83+2.96880505764235461d3*u84)
  u55=-1.29605841627443889d-1*u66
  u79=pd2*u84
  u73=u93*u79
  u67=2.30864686874129663d3*u73
  u9=u91*(3.26568556340659007d4*u84-1.13437046457953026d2*u77)
  u89=-7.77635049764663336d-2*u9
  u95=u89*u96
  u75=x*(u96*(u67+u95)+u55)
  u74=(u75*y)
  value_1_=value_1_+(c(36)*u74)
  u78=(u75*z)
  value_2_=value_2_+(c(36)*u78)
  u75=2.96880505764235461d3*u79
  u79=u93*(u75+u85*(9.0d0+u57))
  u85=1.85151202324919842d-2*u79
  u62=-3.88817524882331668d-1*u66
  u72=3.46297030311194495d3*u73
  value_3_=value_3_+(c(36)*(u96*(u62+u96*(u95+u72))+u85))
  u8=3.70302404649839684d-3*u79
  u79=-2.59211683254887779d-2*u66
  u71=-5.18423366509775557d-2*u66
  u65=1.38518812124477798d3*u73
  u82=2.30864686874129663d2*u73
  u63=(u79+u96*(u95+u65))
  u60=u82*u96
  u88=u96*(u71+u60)+u8
  u94=(u63*u97+u88)
  value_1_=value_1_+(c(37)*u94)
  u56=((u96*(u65+u95)+u79)*u86)
  value_2_=value_2_+(c(37)*u56)
  value_3_=value_3_+(c(37)*u74)
  value_1_=value_1_+(c(38)*u56)
  u74=(u63*u98+u88)
  value_2_=value_2_+(c(38)*u74)
  value_3_=value_3_+(c(38)*u78)
  u78=-7.77635049764663336d-2*u66
  u63=6.9259406062238899d2*u73
  u92=(u63+u95)
  u88=u92*u97
  u66=u63*u96
  u64=u66+u78
  u6=(u70*(u88+u64))
  value_1_=value_1_+(c(39)*u6)
  u69=u60+u79
  u60=(x*(u88+u69)*z)
  value_2_=value_2_+(c(39)*u60)
  value_3_=value_3_+(c(39)*u94)
  value_1_=value_1_+(c(40)*u60)
  u94=u92*u98
  u88=(u70*(u94+u69))
  value_2_=value_2_+(c(40)*u88)
  value_3_=value_3_+(c(40)*u56)
  value_1_=value_1_+(c(41)*u88)
  u56=(u80*(u94+u64))
  value_2_=value_2_+(c(41)*u56)
  value_3_=value_3_+(c(41)*u74)
  u74=(u95+u82)
  u94=u71+u65*u96
  u92=u79*u96+u8
  u64=(u97*(u94+u74*u97)+u92)
  value_1_=value_1_+(c(42)*u64)
  u69=(u82+u95)
  u95=u66+u79
  u66=(y*(u69*u97+u95)*z)
  value_2_=value_2_+(c(42)*u66)
  value_3_=value_3_+(c(42)*u6)
  value_1_=value_1_+(c(43)*u66)
  u6=-7.40604809299679367d-3*u93*(u68*(4.0d0*pd2-3.0d0)+u75)
  u59=-u82
  u7=-3.11054019905865334d-1*u91*(8.90641517292706383d3*u84-2.835926161&
 &44882564d1*u77)
  u84=7.77635049764663336d-2*u9
  u9=u84*u96
  u58=(u97*(u82+u96*(u9+u7)+(u9+u59)*u97)+u96*(u82+u59*u96)+u6)
  value_2_=value_2_+(c(43)*u58)
  value_3_=value_3_+(c(43)*u60)
  value_1_=value_1_+(c(44)*u58)
  u60=(u86*(u69*u98+u95))
  value_2_=value_2_+(c(44)*u60)
  value_3_=value_3_+(c(44)*u88)
  value_1_=value_1_+(c(45)*u60)
  u88=(u98*(u94+u74*u98)+u92)
  value_2_=value_2_+(c(45)*u88)
  value_3_=value_3_+(c(45)*u56)
  u56=u89*u97
  u74=(u97*(u67+u56)+u55)
  u69=(u70*u74)
  value_1_=value_1_+(c(46)*u69)
  u94=(x*(u97*(u65+u56)+u79)*z)
  value_2_=value_2_+(c(46)*u94)
  value_3_=value_3_+(c(46)*u64)
  value_1_=value_1_+(c(47)*u94)
  u93=(u63+u56)*u98
  u92=u82*u97
  u95=(u70*(u93+u92+u79))
  value_2_=value_2_+(c(47)*u95)
  value_3_=value_3_+(c(47)*u66)
  value_1_=value_1_+(c(48)*u95)
  u68=u63*u97
  u9=(u80*((u82+u56)*u98+u68+u79))
  value_2_=value_2_+(c(48)*u9)
  value_3_=value_3_+(c(48)*u58)
  value_1_=value_1_+(c(49)*u9)
  u6=u89*u98
  u7=(u70*(u98*(u65+u6)+u79))
  value_2_=value_2_+(c(49)*u7)
  value_3_=value_3_+(c(49)*u60)
  value_1_=value_1_+(c(50)*u7)
  u60=(u98*(u67+u6)+u55)
  u58=(u80*u60)
  value_2_=value_2_+(c(50)*u58)
  value_3_=value_3_+(c(50)*u88)
  value_1_=value_1_+(c(51)*(u97*(u62+u97*(u56+u72))+u85))
  u88=(y*u74*z)
  value_2_=value_2_+(c(51)*u88)
  value_3_=value_3_+(c(51)*u69)
  value_1_=value_1_+(c(52)*u88)
  u88=((u79+u97*(u56+u65))*u98+u97*(u71+u92)+u8)
  value_2_=value_2_+(c(52)*u88)
  value_3_=value_3_+(c(52)*u94)
  value_1_=value_1_+(c(53)*u88)
  u88=(u86*(u93+u68+u78))
  value_2_=value_2_+(c(53)*u88)
  value_3_=value_3_+(c(53)*u95)
  value_1_=value_1_+(c(54)*u88)
  u88=(u98*(u71+u65*u97+(u56+u82)*u98)+u79*u97+u8)
  value_2_=value_2_+(c(54)*u88)
  value_3_=value_3_+(c(54)*u9)
  value_1_=value_1_+(c(55)*u88)
  u71=(u86*u60)
  value_2_=value_2_+(c(55)*u71)
  value_3_=value_3_+(c(55)*u7)
  value_1_=value_1_+(c(56)*u71)
  value_2_=value_2_+(c(56)*(u98*(u62+u98*(u6+u72))+u85))
  value_3_=value_3_+(c(56)*u58)
  if ( lmax .eq. 5 ) go to 100
  u85=A11_v(pd,exppd2,erfpd)
  u80=pd2*u85
  u71=3.26568556340659007d4*u80
  u89=u99*p**8*pd
  u9=u89*(u71+u83*(1.1d1+u57))
  u57=1.17823492388585354d-2*u9
  u83=3.26568556340659007d4*u85
  u88=u89*pd2
  u79=u88*(1.13437046457953026d2*exppd2+u83)
  u6=-3.18123429449180456d-1*u79
  u69=u89*u80
  u58=3.80926733342313945d4*u69
  u82=4.24539123242856709d5*u85
  u92=u88*(u82-2.26874092915906051d2*u77)
  u85=-7.77635049764663336d-2*u92
  u95=u85*u96
  u7=(u96*(u6+u96*(u95+u58))+u57)
  u93=(u7*y)
  value_1_=value_1_+(c(57)*u93)
  u68=(u7*z)
  value_2_=value_2_+(c(57)*u68)
  u7=8.24764446720097477d-2*u9
  u65=-7.4228800204808773d-1*u79
  u60=5.33297426679239522d4*u69
  value_3_=value_3_+(c(57)*(x*(u96*(u65+u96*(u95+u60))+u7)))
  u99=-1.06041143149726819d-1*u79
  u72=-7.06940954331512123d-2*u79
  u56=2.5395115556154263d4*u69
  u80=2.5395115556154263d3*u69
  u74=(u99+u96*(u95+u56))
  u94=u80*u96
  u55=u96*(u72+u94)+u57
  u84=(x*(u74*u97+u55))
  value_1_=value_1_+(c(58)*u84)
  u66=(x*(u96*(u56+u95)+u99)*u86)
  value_2_=value_2_+(c(58)*u66)
  value_3_=value_3_+(c(58)*u93)
  value_1_=value_1_+(c(59)*u66)
  u93=(x*(u74*u98+u55))
  value_2_=value_2_+(c(59)*u93)
  value_3_=value_3_+(c(59)*u68)
  u68=7.06940954331512123d-3*u9
  u74=-2.12082286299453637d-2*u79
  u63=-1.27249371779672182d-1*u79
  u55=1.52370693336925578d4*u69
  u67=7.61853466684627889d3*u69
  u73=(u74+u96*(u95+u55))
  u64=u73*u97
  u62=u67*u96
  u75=u96*(u63+u62)+u68
  u91=(y*(u64+u75))
  value_1_=value_1_+(c(60)*u91)
  u59=2.35646984777170708d-3*u9
  u9=-4.24164572598907274d-2*u79
  u8=u96*(u9+u94)+u59
  u94=((u64+u8)*z)
  value_2_=value_2_+(c(60)*u94)
  value_3_=value_3_+(c(60)*u84)
  value_1_=value_1_+(c(61)*u94)
  u84=u73*u98
  u64=(y*(u84+u8))
  value_2_=value_2_+(c(61)*u64)
  value_3_=value_3_+(c(61)*u66)
  value_1_=value_1_+(c(62)*u64)
  u66=(z*(u84+u75))
  value_2_=value_2_+(c(62)*u66)
  value_3_=value_3_+(c(62)*u93)
  u84=(u95+u67)
  u73=u55*u96
  u75=u63+u73
  u93=u74*u96
  u8=u93+u68
  u78=(x*(u97*(u75+u84*u97)+u8))
  value_1_=value_1_+(c(63)*u78)
  u86=-6.36246858898360912d-2*u79
  u90=(u67+u95)
  u79=u62+u86
  u62=(u70*(u90*u97+u79)*z)
  value_2_=value_2_+(c(63)*u62)
  value_3_=value_3_+(c(63)*u91)
  value_1_=value_1_+(c(64)*u62)
  u91=-1.88517587821736566d-2*u89*(u50*(1.6d1*pd2-1.1d1)+u71)
  u50=-u67
  u71=7.06940954331512123d-3*u88*(u82+2.26874092915906051d2*exppd2)
  u82=-1.24421607962346134d0*u88*(u83-1.41796308072441282d1*u77)
  u77=7.77635049764663336d-2*u92
  u92=-u80
  u89=u77*u96
  u83=u96*(u89+u82)
  u69=(x*(u97*(u67+u83+(u89+u50)*u97)+u96*(u71+u92*u96)+u91))
  value_2_=value_2_+(c(64)*u69)
  value_3_=value_3_+(c(64)*u94)
  value_1_=value_1_+(c(65)*u69)
  u94=(u87*(u90*u98+u79))
  value_2_=value_2_+(c(65)*u94)
  value_3_=value_3_+(c(65)*u64)
  value_1_=value_1_+(c(66)*u94)
  u79=(x*(u98*(u75+u84*u98)+u8))
  value_2_=value_2_+(c(66)*u79)
  value_3_=value_3_+(c(66)*u66)
  u90=(u95+u80)
  u66=u90*u97
  u88=u72+u56*u96
  u8=u99*u96+u57
  u75=(y*(u97*(u88+u66)+u8))
  value_1_=value_1_+(c(67)*u75)
  u64=u9+u73
  u73=u93+u59
  u84=((u97*(u64+u66)+u73)*z)
  value_2_=value_2_+(c(67)*u84)
  value_3_=value_3_+(c(67)*u78)
  value_1_=value_1_+(c(68)*u84)
  u66=u71+u83
  u93=u96*(u67+u50*u96)+u91
  u83=(u89+u92)
  u78=(y*(u97*(u66+u83*u97)+u93))
  value_2_=value_2_+(c(68)*u78)
  value_3_=value_3_+(c(68)*u62)
  value_1_=value_1_+(c(69)*u78)
  u62=(z*(u98*(u66+u83*u98)+u93))
  value_2_=value_2_+(c(69)*u62)
  value_3_=value_3_+(c(69)*u69)
  value_1_=value_1_+(c(70)*u62)
  u93=u90*u98
  u90=(y*(u98*(u64+u93)+u73))
  value_2_=value_2_+(c(70)*u90)
  value_3_=value_3_+(c(70)*u94)
  value_1_=value_1_+(c(71)*u90)
  u64=(z*(u98*(u88+u93)+u8))
  value_2_=value_2_+(c(71)*u64)
  value_3_=value_3_+(c(71)*u79)
  u79=u85*u97
  u93=(u97*(u6+u97*(u79+u58))+u57)
  u8=(x*u93)
  value_1_=value_1_+(c(72)*u8)
  u89=(u70*(u97*(u56+u79)+u99)*z)
  value_2_=value_2_+(c(72)*u89)
  value_3_=value_3_+(c(72)*u75)
  value_1_=value_1_+(c(73)*u89)
  u83=(u74+u97*(u79+u55))*u98
  u75=u80*u97
  u88=(x*(u83+u97*(u9+u75)+u59))
  value_2_=value_2_+(c(73)*u88)
  value_3_=value_3_+(c(73)*u84)
  value_1_=value_1_+(c(74)*u88)
  u94=u67*u97
  u73=(u87*((u67+u79)*u98+u94+u86))
  value_2_=value_2_+(c(74)*u73)
  value_3_=value_3_+(c(74)*u78)
  value_1_=value_1_+(c(75)*u73)
  u78=(u79+u80)*u98
  u84=u55*u97
  u66=u74*u97
  u69=(x*(u98*(u9+u84+u78)+u66+u59))
  value_2_=value_2_+(c(75)*u69)
  value_3_=value_3_+(c(75)*u62)
  value_1_=value_1_+(c(76)*u69)
  u50=u85*u98
  u62=(u87*(u98*(u56+u50)+u99))
  value_2_=value_2_+(c(76)*u62)
  value_3_=value_3_+(c(76)*u90)
  value_1_=value_1_+(c(77)*u62)
  u71=(u98*(u6+u98*(u50+u58))+u57)
  u90=(x*u71)
  value_2_=value_2_+(c(77)*u90)
  value_3_=value_3_+(c(77)*u64)
  value_1_=value_1_+(c(78)*(y*(u97*(u65+u97*(u79+u60))+u7)))
  u64=(u93*z)
  value_2_=value_2_+(c(78)*u64)
  value_3_=value_3_+(c(78)*u8)
  value_1_=value_1_+(c(79)*u64)
  u64=(y*((u99+u97*(u79+u56))*u98+u97*(u72+u75)+u57))
  value_2_=value_2_+(c(79)*u64)
  value_3_=value_3_+(c(79)*u89)
  value_1_=value_1_+(c(80)*u64)
  u64=(z*(u83+u97*(u63+u94)+u68))
  value_2_=value_2_+(c(80)*u64)
  value_3_=value_3_+(c(80)*u88)
  value_1_=value_1_+(c(81)*u64)
  u64=(y*(u98*(u63+u84+(u79+u67)*u98)+u66+u68))
  value_2_=value_2_+(c(81)*u64)
  value_3_=value_3_+(c(81)*u73)
  value_1_=value_1_+(c(82)*u64)
  u63=(z*(u98*(u72+u56*u97+u78)+u99*u97+u57))
  value_2_=value_2_+(c(82)*u63)
  value_3_=value_3_+(c(82)*u69)
  value_1_=value_1_+(c(83)*u63)
  u63=(y*u71)
  value_2_=value_2_+(c(83)*u63)
  value_3_=value_3_+(c(83)*u62)
  value_1_=value_1_+(c(84)*u63)
  value_2_=value_2_+(c(84)*(z*(u98*(u65+u98*(u50+u60))+u7)))
  value_3_=value_3_+(c(84)*u90)
  if ( lmax .eq. 6 ) go to 100

  ! set computation flag
  D_X_Y_shell_optv4_1 = .false.

  ! setting results
100  continue
  value(1:1+3*(NVEC-1):3) = value_1_
  value(2:2+3*(NVEC-1):3) = value_2_
  value(3:3+3*(NVEC-1):3) = value_3_

  contains

    include "Av_functions.h"

end function

  
end module
