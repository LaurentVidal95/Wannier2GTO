module mod_D_X_R_shell_optv1_1
  
  implicit none
  
  private
  public :: D_X_R_shell_optv1_1
 
  integer, parameter :: NVEC=1 
 
contains
  
  

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
recursive function D_X_R_shell_optv1_1(a12,a3,r3,c,lmax,value)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12          !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3(NVEC)     !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(NVEC,3)   !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)         !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax         !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value(*)     !< result value
  
  ! return value
  logical :: D_X_R_shell_optv1_1
  
  ! local variables
  integer      :: i
  real(kind=8) :: d(NVEC)
  real(kind=8) :: p(NVEC)
  real(kind=8) :: pd(NVEC)
  real(kind=8) :: pd2(NVEC)
  real(kind=8) :: erfpd(NVEC)
  real(kind=8) :: exppd2(NVEC)
  real(kind=8) :: x(NVEC)
  real(kind=8) :: y(NVEC)
  real(kind=8) :: z(NVEC)
  
  ! temporary variables
  real(kind=8) :: u51(NVEC)
  real(kind=8) :: u56(NVEC)
  real(kind=8) :: u57(NVEC)
  real(kind=8) :: u58(NVEC)
  real(kind=8) :: u59(NVEC)
  real(kind=8) :: u6(NVEC)
  real(kind=8) :: u60(NVEC)
  real(kind=8) :: u62(NVEC)
  real(kind=8) :: u63(NVEC)
  real(kind=8) :: u64(NVEC)
  real(kind=8) :: u65(NVEC)
  real(kind=8) :: u66(NVEC)
  real(kind=8) :: u67(NVEC)
  real(kind=8) :: u68(NVEC)
  real(kind=8) :: u69(NVEC)
  real(kind=8) :: u7(NVEC)
  real(kind=8) :: u70(NVEC)
  real(kind=8) :: u71(NVEC)
  real(kind=8) :: u72(NVEC)
  real(kind=8) :: u73(NVEC)
  real(kind=8) :: u74(NVEC)
  real(kind=8) :: u75(NVEC)
  real(kind=8) :: u76(NVEC)
  real(kind=8) :: u77(NVEC)
  real(kind=8) :: u78(NVEC)
  real(kind=8) :: u79(NVEC)
  real(kind=8) :: u8(NVEC)
  real(kind=8) :: u80(NVEC)
  real(kind=8) :: u81(NVEC)
  real(kind=8) :: u82(NVEC)
  real(kind=8) :: u83(NVEC)
  real(kind=8) :: u84(NVEC)
  real(kind=8) :: u85(NVEC)
  real(kind=8) :: u86(NVEC)
  real(kind=8) :: u87(NVEC)
  real(kind=8) :: u88(NVEC)
  real(kind=8) :: u89(NVEC)
  real(kind=8) :: u9(NVEC)
  real(kind=8) :: u90(NVEC)
  real(kind=8) :: u91(NVEC)
  real(kind=8) :: u92(NVEC)
  real(kind=8) :: u93(NVEC)
  real(kind=8) :: u94(NVEC)
  real(kind=8) :: u95(NVEC)
  real(kind=8) :: u96(NVEC)
  real(kind=8) :: u97(NVEC)
  real(kind=8) :: u98(NVEC)
  real(kind=8) :: u99(NVEC)
  real(kind=8) :: value_1_(NVEC)
  real(kind=8) :: value_2_(NVEC)
  real(kind=8) :: value_3_(NVEC)

  
  ! init values
  value_1_ = 0.0d0
  value_2_ = 0.0d0
  value_3_ = 0.0d0
  
  ! init computation flag
  D_X_R_shell_optv1_1=.true.
  
  ! compute local quantities
  d=sqrt(sum(r3**2,dim=2))+1.0d-32
  p=sqrt((a12*a3)/(a12+a3))
  pd=p*d
  pd2=pd*pd
  erfpd  = erf (pd)
  exppd2 = exp(-pd2)
 
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  x=r3(:,1)/d
  y=r3(:,2)/d
  z=r3(:,3)/d
  
  ! computation section
  u99=a3**(-1)
  u70=-5.0d-1*u99*p**2*A2_v(pd,exppd2,erfpd)
  value_1_=value_1_+(c(1)*(u70*x))
  value_2_=value_2_+(c(1)*(u70*y))
  value_3_=value_3_+(c(1)*(u70*z))
  if ( lmax .eq. 0 ) go to 100
  u86=A3_v(pd,exppd2,erfpd)
  u95=u99*p**3
  u70=4.0d0*exppd2
  u92=9.40315972579593812d-2*u95*(5.31736155271654808d0*u86+u70)
  u68=-1.5d0*u95*u86
  u96=x**2
  value_1_=value_1_+(c(2)*(u68*u96+u92))
  u86=x*y
  u97=(u68*u86)
  value_2_=value_2_+(c(2)*u97)
  u95=x*z
  u98=(u68*u95)
  value_3_=value_3_+(c(2)*u98)
  value_1_=value_1_+(c(3)*u97)
  u97=y**2
  value_2_=value_2_+(c(3)*(u68*u97+u92))
  u51=y*z
  u87=(u68*u51)
  value_3_=value_3_+(c(3)*u87)
  value_1_=value_1_+(c(4)*u98)
  value_2_=value_2_+(c(4)*u87)
  u98=z**2
  value_3_=value_3_+(c(4)*(u68*u98+u92))
  if ( lmax .eq. 1 ) go to 100
  u87=A5_v(pd,exppd2,erfpd)
  u92=u99*p**4*pd
  u68=8.0d0*exppd2
  u94=u92*(2.65868077635827404d1*u87+u68)
  u7=1.69256875064326886d-1*u94
  u57=-7.5d0*u92*u87
  u78=u57*u96
  value_1_=value_1_+(c(5)*(x*(u78+u7)))
  u90=5.64189583547756287d-2*u94
  u94=(u78+u90)
  u78=(u94*y)
  value_2_=value_2_+(c(5)*u78)
  u85=(u94*z)
  value_3_=value_3_+(c(5)*u85)
  value_1_=value_1_+(c(6)*u78)
  u78=u57*u97
  u94=(u78+u90)
  u77=(x*u94)
  value_2_=value_2_+(c(6)*u77)
  u87=u86*z
  u88=(u57*u87)
  value_3_=value_3_+(c(6)*u88)
  value_1_=value_1_+(c(7)*u85)
  value_2_=value_2_+(c(7)*u88)
  u85=u57*u98
  u66=(u85+u90)
  u83=(x*u66)
  value_3_=value_3_+(c(7)*u83)
  value_1_=value_1_+(c(8)*u77)
  value_2_=value_2_+(c(8)*(y*(u78+u7)))
  u77=(u94*z)
  value_3_=value_3_+(c(8)*u77)
  value_1_=value_1_+(c(9)*u88)
  value_2_=value_2_+(c(9)*u77)
  u77=(y*u66)
  value_3_=value_3_+(c(9)*u77)
  value_1_=value_1_+(c(10)*u83)
  value_2_=value_2_+(c(10)*u77)
  value_3_=value_3_+(c(10)*(z*(u85+u7)))
  if ( lmax .eq. 2 ) go to 100
  u83=A7_v(pd,exppd2,erfpd)
  u77=pd2*u83
  u94=u99*p**5
  u57=2.0d0*pd2
  u66=u94*(u68*(u57+7.0d0)+1.86107654345079183d2*u77)
  u88=-2.41795535806181266d-2*u66
  u78=1.86107654345079183d2*u83
  u85=1.6d1*exppd2
  u90=u94*pd2*(u78+u85)
  u7=2.41795535806181266d-1*u90
  u67=-5.25d1*u94*u77
  u74=u67*u96
  value_1_=value_1_+(c(11)*(u96*(u7+u74)+u88))
  u64=1.20897767903090633d-1*u90
  u71=x*(u74+u64)
  u62=(u71*y)
  value_2_=value_2_+(c(11)*u62)
  u84=(u71*z)
  value_3_=value_3_+(c(11)*u84)
  value_1_=value_1_+(c(12)*u62)
  u62=-8.05985119353937553d-3*u66
  u66=4.02992559676968776d-2*u90
  u71=(u66+u74)
  u90=u66*u96+u62
  u73=(u71*u97+u90)
  value_2_=value_2_+(c(12)*u73)
  u72=((u74+u66)*u51)
  value_3_=value_3_+(c(12)*u72)
  value_1_=value_1_+(c(13)*u84)
  value_2_=value_2_+(c(13)*u72)
  u84=(u71*u98+u90)
  value_3_=value_3_+(c(13)*u84)
  value_1_=value_1_+(c(14)*u73)
  u73=u67*u97
  u71=(u73+u64)
  u90=(u86*u71)
  value_2_=value_2_+(c(14)*u90)
  u74=(x*(u73+u66)*z)
  value_3_=value_3_+(c(14)*u74)
  value_1_=value_1_+(c(15)*u72)
  value_2_=value_2_+(c(15)*u74)
  u72=u67*u98
  u76=(u86*(u72+u66))
  value_3_=value_3_+(c(15)*u76)
  value_1_=value_1_+(c(16)*u84)
  value_2_=value_2_+(c(16)*u76)
  u84=(u72+u64)
  u8=(u95*u84)
  value_3_=value_3_+(c(16)*u8)
  value_1_=value_1_+(c(17)*u90)
  value_2_=value_2_+(c(17)*(u97*(u7+u73)+u88))
  u90=(y*u71*z)
  value_3_=value_3_+(c(17)*u90)
  value_1_=value_1_+(c(18)*u74)
  value_2_=value_2_+(c(18)*u90)
  u90=((u66+u73)*u98+u66*u97+u62)
  value_3_=value_3_+(c(18)*u90)
  value_1_=value_1_+(c(19)*u76)
  value_2_=value_2_+(c(19)*u90)
  u90=(u51*u84)
  value_3_=value_3_+(c(19)*u90)
  value_1_=value_1_+(c(20)*u8)
  value_2_=value_2_+(c(20)*u90)
  value_3_=value_3_+(c(20)*(u98*(u7+u72)+u88))
  if ( lmax .eq. 3 ) go to 100
  u90=u99*p**6*pd
  u76=u90*(u85+u78)
  u8=-6.04488839515453165d-1*u76
  u74=u90*u83
  u71=5.25d2*u74
  u78=exppd2*pd2
  u84=-2.82094791773878144d-1*u90*(1.67496888910571265d3*u83-3.2d1*u78)
  u73=u84*u96
  value_1_=value_1_+(c(21)*(x*(u96*(u71+u73)+u8)))
  u72=-1.20897767903090633d-1*u76
  u66=3.15d2*u74
  u62=(u96*(u66+u73)+u72)
  u64=(u62*y)
  value_2_=value_2_+(c(21)*u64)
  u7=(u62*z)
  value_3_=value_3_+(c(21)*u7)
  value_1_=value_1_+(c(22)*u64)
  u64=1.575d2*u74
  u62=5.25d1*u74
  u88=(u64+u73)
  u67=u62*u96
  u58=u67+u72
  u93=(x*(u88*u97+u58))
  value_2_=value_2_+(c(22)*u93)
  u91=(x*(u73+u64)*u51)
  value_3_=value_3_+(c(22)*u91)
  value_1_=value_1_+(c(23)*u7)
  value_2_=value_2_+(c(23)*u91)
  u7=(x*(u88*u98+u58))
  value_3_=value_3_+(c(23)*u7)
  value_1_=value_1_+(c(24)*u93)
  u93=(u62+u73)
  u88=u93*u97
  u58=u64*u96+u72
  u73=(y*(u88+u58))
  value_2_=value_2_+(c(24)*u73)
  u80=-4.02992559676968776d-2*u76
  u76=u67+u80
  u67=((u88+u76)*z)
  value_3_=value_3_+(c(24)*u67)
  value_1_=value_1_+(c(25)*u91)
  value_2_=value_2_+(c(25)*u67)
  u91=u93*u98
  u88=(y*(u91+u76))
  value_3_=value_3_+(c(25)*u88)
  value_1_=value_1_+(c(26)*u7)
  value_2_=value_2_+(c(26)*u88)
  u7=(z*(u91+u58))
  value_3_=value_3_+(c(26)*u7)
  value_1_=value_1_+(c(27)*u73)
  u73=u84*u97
  u91=(u97*(u66+u73)+u72)
  u93=(x*u91)
  value_2_=value_2_+(c(27)*u93)
  u58=(u86*(u73+u64)*z)
  value_3_=value_3_+(c(27)*u58)
  value_1_=value_1_+(c(28)*u67)
  value_2_=value_2_+(c(28)*u58)
  u67=(u62+u73)*u98
  u76=u62*u97
  u79=(x*(u67+u76+u80))
  value_3_=value_3_+(c(28)*u79)
  value_1_=value_1_+(c(29)*u88)
  value_2_=value_2_+(c(29)*u79)
  u88=u84*u98
  u56=(u87*(u88+u64))
  value_3_=value_3_+(c(29)*u56)
  value_1_=value_1_+(c(30)*u7)
  value_2_=value_2_+(c(30)*u56)
  u7=(u98*(u66+u88)+u72)
  u75=(x*u7)
  value_3_=value_3_+(c(30)*u75)
  value_1_=value_1_+(c(31)*u93)
  value_2_=value_2_+(c(31)*(y*(u97*(u71+u73)+u8)))
  u93=(u91*z)
  value_3_=value_3_+(c(31)*u93)
  value_1_=value_1_+(c(32)*u58)
  value_2_=value_2_+(c(32)*u93)
  u93=(y*((u64+u73)*u98+u76+u72))
  value_3_=value_3_+(c(32)*u93)
  value_1_=value_1_+(c(33)*u79)
  value_2_=value_2_+(c(33)*u93)
  u79=(z*(u67+u64*u97+u72))
  value_3_=value_3_+(c(33)*u79)
  value_1_=value_1_+(c(34)*u56)
  value_2_=value_2_+(c(34)*u79)
  u79=(y*u7)
  value_3_=value_3_+(c(34)*u79)
  value_1_=value_1_+(c(35)*u75)
  value_2_=value_2_+(c(35)*u79)
  value_3_=value_3_+(c(35)*(z*(u98*(u71+u88)+u8)))
  if ( lmax .eq. 4 ) go to 100
  u84=A9_v(pd,exppd2,erfpd)
  u79=pd2*u84
  u75=1.67496888910571265d3*u79
  u93=u99*p**7
  u58=u93*(u75+u85*(9.0d0+u57))
  u85=6.71654266128281294d-2*u58
  u91=u93*pd2
  u7=3.2d1*exppd2
  u56=u91*(u7+1.67496888910571265d3*u84)
  u62=-1.41047395886939072d0*u56
  u73=u93*u79
  u72=7.0875d3*u73
  u88=u91*(1.84246577801628391d4*u84-6.4d1*u78)
  u76=-2.82094791773878144d-1*u88
  u80=u76*u96
  value_1_=value_1_+(c(36)*(u96*(u62+u96*(u80+u72))+u85))
  u64=-4.70157986289796906d-1*u56
  u67=4.725d3*u73
  u79=x*(u96*(u67+u80)+u64)
  u8=(u79*y)
  value_2_=value_2_+(c(36)*u8)
  u60=(u79*z)
  value_3_=value_3_+(c(36)*u60)
  value_1_=value_1_+(c(37)*u8)
  u8=1.34330853225656259d-2*u58
  u58=-9.40315972579593812d-2*u56
  u79=-1.88063194515918762d-1*u56
  u65=2.835d3*u73
  u94=4.725d2*u73
  u63=(u58+u96*(u80+u65))
  u6=u94*u96
  u92=u96*(u79+u6)+u8
  u66=(u63*u97+u92)
  value_2_=value_2_+(c(37)*u66)
  u9=((u96*(u65+u80)+u58)*u51)
  value_3_=value_3_+(c(37)*u9)
  value_1_=value_1_+(c(38)*u60)
  value_2_=value_2_+(c(38)*u9)
  u60=(u63*u98+u92)
  value_3_=value_3_+(c(38)*u60)
  value_1_=value_1_+(c(39)*u66)
  u66=-2.82094791773878144d-1*u56
  u63=1.4175d3*u73
  u92=(u63+u80)
  u56=u92*u97
  u82=u63*u96
  u90=u82+u66
  u69=(u86*(u56+u90))
  value_2_=value_2_+(c(39)*u69)
  u81=u6+u58
  u6=(x*(u56+u81)*z)
  value_3_=value_3_+(c(39)*u6)
  value_1_=value_1_+(c(40)*u9)
  value_2_=value_2_+(c(40)*u6)
  u9=u92*u98
  u56=(u86*(u9+u81))
  value_3_=value_3_+(c(40)*u56)
  value_1_=value_1_+(c(41)*u60)
  value_2_=value_2_+(c(41)*u56)
  u60=(u95*(u9+u90))
  value_3_=value_3_+(c(41)*u60)
  value_1_=value_1_+(c(42)*u69)
  u69=(u80+u94)
  u9=u79+u65*u96
  u92=u58*u96+u8
  u90=(u97*(u9+u69*u97)+u92)
  value_2_=value_2_+(c(42)*u90)
  u81=(u94+u80)
  u80=u82+u58
  u82=(y*(u81*u97+u80)*z)
  value_3_=value_3_+(c(42)*u82)
  value_1_=value_1_+(c(43)*u6)
  value_2_=value_2_+(c(43)*u82)
  u6=-2.68661706451312518d-2*u93*(u68*(4.0d0*pd2-3.0d0)+u75)
  u59=-u94
  u89=-1.12837916709551257d0*u91*(5.02490666731713794d3*u84-1.6d1*u78)
  u71=2.82094791773878144d-1*u88
  u88=u71*u96
  u68=(u97*(u94+u96*(u88+u89)+(u88+u59)*u97)+u96*(u94+u59*u96)+u6)
  value_3_=value_3_+(c(43)*u68)
  value_1_=value_1_+(c(44)*u56)
  value_2_=value_2_+(c(44)*u68)
  u56=(u51*(u81*u98+u80))
  value_3_=value_3_+(c(44)*u56)
  value_1_=value_1_+(c(45)*u60)
  value_2_=value_2_+(c(45)*u56)
  u60=(u98*(u9+u69*u98)+u92)
  value_3_=value_3_+(c(45)*u60)
  value_1_=value_1_+(c(46)*u90)
  u90=u76*u97
  u69=(u97*(u67+u90)+u64)
  u81=(u86*u69)
  value_2_=value_2_+(c(46)*u81)
  u9=(x*(u97*(u65+u90)+u58)*z)
  value_3_=value_3_+(c(46)*u9)
  value_1_=value_1_+(c(47)*u82)
  value_2_=value_2_+(c(47)*u9)
  u82=(u63+u90)*u98
  u91=u94*u97
  u80=(u86*(u82+u91+u58))
  value_3_=value_3_+(c(47)*u80)
  value_1_=value_1_+(c(48)*u68)
  value_2_=value_2_+(c(48)*u80)
  u59=u63*u97
  u89=(u95*((u94+u90)*u98+u59+u58))
  value_3_=value_3_+(c(48)*u89)
  value_1_=value_1_+(c(49)*u56)
  value_2_=value_2_+(c(49)*u89)
  u56=u76*u98
  u88=(u86*(u98*(u65+u56)+u58))
  value_3_=value_3_+(c(49)*u88)
  value_1_=value_1_+(c(50)*u60)
  value_2_=value_2_+(c(50)*u88)
  u60=(u98*(u67+u56)+u64)
  u71=(u95*u60)
  value_3_=value_3_+(c(50)*u71)
  value_1_=value_1_+(c(51)*u81)
  value_2_=value_2_+(c(51)*(u97*(u62+u97*(u90+u72))+u85))
  u81=(y*u69*z)
  value_3_=value_3_+(c(51)*u81)
  value_1_=value_1_+(c(52)*u9)
  value_2_=value_2_+(c(52)*u81)
  u9=((u58+u97*(u90+u65))*u98+u97*(u79+u91)+u8)
  value_3_=value_3_+(c(52)*u9)
  value_1_=value_1_+(c(53)*u80)
  value_2_=value_2_+(c(53)*u9)
  u80=(u51*(u82+u59+u66))
  value_3_=value_3_+(c(53)*u80)
  value_1_=value_1_+(c(54)*u89)
  value_2_=value_2_+(c(54)*u80)
  u80=(u98*(u79+u65*u97+(u90+u94)*u98)+u58*u97+u8)
  value_3_=value_3_+(c(54)*u80)
  value_1_=value_1_+(c(55)*u88)
  value_2_=value_2_+(c(55)*u80)
  u80=(u51*u60)
  value_3_=value_3_+(c(55)*u80)
  value_1_=value_1_+(c(56)*u71)
  value_2_=value_2_+(c(56)*u80)
  value_3_=value_3_+(c(56)*(u98*(u62+u98*(u56+u72))+u85))
  if ( lmax .eq. 5 ) go to 100
  u85=A11_v(pd,exppd2,erfpd)
  u80=pd2*u85
  u76=1.84246577801628391d4*u80
  u89=u99*p**8*pd
  u9=u89*(u76+u7*(1.1d1+u57))
  u7=2.99191445820779849d-1*u9
  u81=1.84246577801628391d4*u85
  u88=u89*pd2
  u62=u88*(6.4d1*exppd2+u81)
  u8=-2.69272301238701864d0*u62
  u69=u89*u80
  u60=1.091475d5*u69
  u82=2.39520551142116908d5*u85
  u94=u88*(u82-1.28d2*u78)
  u80=-2.82094791773878144d-1*u94
  u71=u80*u96
  value_1_=value_1_+(c(57)*(x*(u96*(u8+u96*(u71+u60))+u7)))
  u85=4.27416351172542642d-2*u9
  u72=-1.15402414816586513d0*u62
  u58=7.79625d4*u69
  u67=(u96*(u72+u96*(u71+u58))+u85)
  u99=(u67*y)
  value_2_=value_2_+(c(57)*u99)
  u90=(u67*z)
  value_3_=value_3_+(c(57)*u90)
  value_1_=value_1_+(c(58)*u99)
  u99=-3.84674716055288378d-1*u62
  u67=-2.56449810703525585d-1*u62
  u56=5.1975d4*u69
  u57=5.1975d3*u69
  u59=(u99+u96*(u71+u56))
  u91=u57*u96
  u95=u96*(u67+u91)+u85
  u68=(x*(u59*u97+u95))
  value_2_=value_2_+(c(58)*u68)
  u84=(x*(u96*(u56+u71)+u99)*u51)
  value_3_=value_3_+(c(58)*u84)
  value_1_=value_1_+(c(59)*u90)
  value_2_=value_2_+(c(59)*u84)
  u90=(x*(u59*u98+u95))
  value_3_=value_3_+(c(59)*u90)
  value_1_=value_1_+(c(60)*u68)
  u68=2.56449810703525585d-2*u9
  u59=-7.69349432110576755d-2*u62
  u95=-4.61609659266346053d-1*u62
  u92=3.1185d4*u69
  u64=1.55925d4*u69
  u73=(u59+u96*(u71+u92))
  u79=u73*u97
  u66=u64*u96
  u75=u96*(u95+u66)+u68
  u63=(y*(u79+u75))
  value_2_=value_2_+(c(60)*u63)
  u6=8.54832702345085284d-3*u9
  u9=-1.53869886422115351d-1*u62
  u65=u96*(u9+u91)+u6
  u91=((u79+u65)*z)
  value_3_=value_3_+(c(60)*u91)
  value_1_=value_1_+(c(61)*u84)
  value_2_=value_2_+(c(61)*u91)
  u84=u73*u98
  u79=(y*(u84+u65))
  value_3_=value_3_+(c(61)*u79)
  value_1_=value_1_+(c(62)*u90)
  value_2_=value_2_+(c(62)*u79)
  u90=(z*(u84+u75))
  value_3_=value_3_+(c(62)*u90)
  value_1_=value_1_+(c(63)*u63)
  u84=(u71+u64)
  u73=u92*u96
  u75=u95+u73
  u93=u59*u96
  u65=u93+u68
  u63=(x*(u97*(u75+u84*u97)+u65))
  value_2_=value_2_+(c(63)*u63)
  u83=-2.30804829633173027d-1*u62
  u74=(u64+u71)
  u62=u66+u83
  u66=(u86*(u74*u97+u62)*z)
  value_3_=value_3_+(c(63)*u66)
  value_1_=value_1_+(c(64)*u91)
  value_2_=value_2_+(c(64)*u66)
  u91=-6.83866161876068227d-2*u89*(u70*(1.6d1*pd2-1.1d1)+u76)
  u77=-u64
  u89=2.56449810703525585d-2*u88*(u82+1.28d2*exppd2)
  u82=-4.5135166683820503d0*u88*(u81-8.0d0*u78)
  u78=2.82094791773878144d-1*u94
  u51=-u57
  u88=u78*u96
  u76=u96*(u88+u82)
  u94=(x*(u97*(u64+u76+(u88+u77)*u97)+u96*(u89+u51*u96)+u91))
  value_3_=value_3_+(c(64)*u94)
  value_1_=value_1_+(c(65)*u79)
  value_2_=value_2_+(c(65)*u94)
  u69=(u87*(u74*u98+u62))
  value_3_=value_3_+(c(65)*u69)
  value_1_=value_1_+(c(66)*u90)
  value_2_=value_2_+(c(66)*u69)
  u70=(x*(u98*(u75+u84*u98)+u65))
  value_3_=value_3_+(c(66)*u70)
  value_1_=value_1_+(c(67)*u63)
  u81=(u71+u57)
  u63=u81*u97
  u71=u67+u56*u96
  u84=u99*u96+u85
  u65=(y*(u97*(u71+u63)+u84))
  value_2_=value_2_+(c(67)*u65)
  u62=u9+u73
  u73=u93+u6
  u75=((u97*(u62+u63)+u73)*z)
  value_3_=value_3_+(c(67)*u75)
  value_1_=value_1_+(c(68)*u66)
  value_2_=value_2_+(c(68)*u75)
  u63=u89+u76
  u66=u96*(u64+u77*u96)+u91
  u76=(u88+u51)
  u93=(y*(u97*(u63+u76*u97)+u66))
  value_3_=value_3_+(c(68)*u93)
  value_1_=value_1_+(c(69)*u94)
  value_2_=value_2_+(c(69)*u93)
  u88=(z*(u98*(u63+u76*u98)+u66))
  value_3_=value_3_+(c(69)*u88)
  value_1_=value_1_+(c(70)*u69)
  value_2_=value_2_+(c(70)*u88)
  u69=u81*u98
  u76=(y*(u98*(u62+u69)+u73))
  value_3_=value_3_+(c(70)*u76)
  value_1_=value_1_+(c(71)*u70)
  value_2_=value_2_+(c(71)*u76)
  u81=(z*(u98*(u71+u69)+u84))
  value_3_=value_3_+(c(71)*u81)
  value_1_=value_1_+(c(72)*u65)
  u66=u80*u97
  u73=(u97*(u72+u97*(u66+u58))+u85)
  u71=(x*u73)
  value_2_=value_2_+(c(72)*u71)
  u62=(u86*(u97*(u56+u66)+u99)*z)
  value_3_=value_3_+(c(72)*u62)
  value_1_=value_1_+(c(73)*u75)
  value_2_=value_2_+(c(73)*u62)
  u69=(u59+u97*(u66+u92))*u98
  u63=u57*u97
  u65=(x*(u69+u97*(u9+u63)+u6))
  value_3_=value_3_+(c(73)*u65)
  value_1_=value_1_+(c(74)*u93)
  value_2_=value_2_+(c(74)*u65)
  u70=u64*u97
  u84=(u87*((u64+u66)*u98+u70+u83))
  value_3_=value_3_+(c(74)*u84)
  value_1_=value_1_+(c(75)*u88)
  value_2_=value_2_+(c(75)*u84)
  u51=(u66+u57)*u98
  u78=u92*u97
  u82=u59*u97
  u77=(x*(u98*(u9+u78+u51)+u82+u6))
  value_3_=value_3_+(c(75)*u77)
  value_1_=value_1_+(c(76)*u76)
  value_2_=value_2_+(c(76)*u77)
  u76=u80*u98
  u88=(u87*(u98*(u56+u76)+u99))
  value_3_=value_3_+(c(76)*u88)
  value_1_=value_1_+(c(77)*u81)
  value_2_=value_2_+(c(77)*u88)
  u81=(u98*(u72+u98*(u76+u58))+u85)
  u96=(x*u81)
  value_3_=value_3_+(c(77)*u96)
  value_1_=value_1_+(c(78)*u71)
  value_2_=value_2_+(c(78)*(y*(u97*(u8+u97*(u66+u60))+u7)))
  u71=(u73*z)
  value_3_=value_3_+(c(78)*u71)
  value_1_=value_1_+(c(79)*u62)
  value_2_=value_2_+(c(79)*u71)
  u71=(y*((u99+u97*(u66+u56))*u98+u97*(u67+u63)+u85))
  value_3_=value_3_+(c(79)*u71)
  value_1_=value_1_+(c(80)*u65)
  value_2_=value_2_+(c(80)*u71)
  u71=(z*(u69+u97*(u95+u70)+u68))
  value_3_=value_3_+(c(80)*u71)
  value_1_=value_1_+(c(81)*u84)
  value_2_=value_2_+(c(81)*u71)
  u71=(y*(u98*(u95+u78+(u66+u64)*u98)+u82+u68))
  value_3_=value_3_+(c(81)*u71)
  value_1_=value_1_+(c(82)*u77)
  value_2_=value_2_+(c(82)*u71)
  u59=(z*(u98*(u67+u56*u97+u51)+u99*u97+u85))
  value_3_=value_3_+(c(82)*u59)
  value_1_=value_1_+(c(83)*u88)
  value_2_=value_2_+(c(83)*u59)
  u56=(y*u81)
  value_3_=value_3_+(c(83)*u56)
  value_1_=value_1_+(c(84)*u96)
  value_2_=value_2_+(c(84)*u56)
  value_3_=value_3_+(c(84)*(z*(u98*(u8+u98*(u76+u60))+u7)))
  if ( lmax .eq. 6 ) go to 100

  ! set computation flag
  D_X_R_shell_optv1_1 = .false.

  ! setting results
100  continue
  value(1:1+3*(NVEC-1):3) = value_1_
  value(2:2+3*(NVEC-1):3) = value_2_
  value(3:3+3*(NVEC-1):3) = value_3_

  contains

    include "Av_functions.h"

end function

  
end module
