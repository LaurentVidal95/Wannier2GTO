module mod_D_X_Y_shell_opt_1
  
  use mod_A_functions
  
  implicit none
  
  private
  public :: D_X_Y_shell_opt_1
  
contains
  
  

!> Compute D X Y/R coulomb integral for the right hand shell 
!!
recursive function D_X_Y_shell_opt_1(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value(*) !< result value
  
  ! return value
  
  logical :: D_X_Y_shell_opt_1
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_Y_shell_opt_1=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value(1:3)=0.0d0
  u86=a3**(-1)
  u58=-2.44301255951459961d-1*u86*A2_(p,pd,erfpd,exppd2)*p**2
  value(1)=value(1)+(c(1)*(u58*y))
  value(2)=value(2)+(c(1)*(u58*z))
  value(3)=value(3)+(c(1)*(u58*x))
  if ( lmax .eq. 0 ) return
  u80=A3_(p,pd,erfpd,exppd2)
  u91=p**3
  u55=-7.32903767854379883d-1*u86*u80*u91
  u58=x*y
  u85=(u55*u58)
  value(1)=value(1)+(c(2)*u85)
  u77=x*z
  u81=(u55*u77)
  value(2)=value(2)+(c(2)*u81)
  u74=2.59211683254887779d-2*u86*(9.42477796076937972d0*u80+7.089815403&
 &62206411d0*exppd2)*u91
  u83=x**2
  value(3)=value(3)+(c(2)*(u55*u83+u74))
  u84=y**2
  value(1)=value(1)+(c(3)*(u55*u84+u74))
  u80=y*z
  u92=(u55*u80)
  value(2)=value(2)+(c(3)*u92)
  value(3)=value(3)+(c(3)*u85)
  value(1)=value(1)+(c(4)*u92)
  u85=z**2
  value(2)=value(2)+(c(4)*(u55*u85+u74))
  value(3)=value(3)+(c(4)*u81)
  if ( lmax .eq. 1 ) return
  u81=A4_(p,pd,erfpd,exppd2)
  u92=p**4
  u74=u86*u81*u92
  u64=7.32903767854379883d-1*u74
  u82=-7.77635049764663336d-2*u86
  u55=exppd2*pd
  u98=-1.41796308072441282d1*u55
  u72=+u82*(4.71238898038468986d1*u81+u98)*u92
  u90=u72*u83
  u67=(u90+u64)
  u93=(u67*y)
  value(1)=value(1)+(c(5)*u93)
  u89=(u67*z)
  value(2)=value(2)+(c(5)*u89)
  u67=2.19871130356313965d0*u74
  value(3)=value(3)+(c(5)*(x*(u90+u67)))
  u90=u72*u84
  u54=(u90+u64)
  u65=(x*u54)
  value(1)=value(1)+(c(6)*u65)
  u96=u58*z
  u79=(u72*u96)
  value(2)=value(2)+(c(6)*u79)
  value(3)=value(3)+(c(6)*u93)
  value(1)=value(1)+(c(7)*u79)
  u93=u72*u85
  u99=(u93+u64)
  u78=(x*u99)
  value(2)=value(2)+(c(7)*u78)
  value(3)=value(3)+(c(7)*u89)
  value(1)=value(1)+(c(8)*(y*(u90+u67)))
  u89=(u54*z)
  value(2)=value(2)+(c(8)*u89)
  value(3)=value(3)+(c(8)*u65)
  value(1)=value(1)+(c(9)*u89)
  u89=(y*u99)
  value(2)=value(2)+(c(9)*u89)
  value(3)=value(3)+(c(9)*u79)
  value(1)=value(1)+(c(10)*u89)
  value(2)=value(2)+(c(10)*(z*(u93+u67)))
  value(3)=value(3)+(c(10)*u78)
  if ( lmax .eq. 2 ) return
  u78=A5_(p,pd,erfpd,exppd2)
  u89=p**5
  u72=u86*u78*u89
  u65=1.09935565178156983d1*u72
  u54=-2.83592616144882564d1*exppd2
  u99=+u54*pd2
  u79=+u82*(3.2986722862692829d2*u78+u99)*u89
  u90=u79*u83
  u93=x*(u90+u65)
  u53=(u93*y)
  value(1)=value(1)+(c(11)*u53)
  u59=(u93*z)
  value(2)=value(2)+(c(11)*u59)
  u93=1.41796308072441282d1*exppd2
  u62=u86*(u93+4.71238898038468986d1*u78)*u89
  u60=-4.66581029858798002d-2*u62
  u68=2.19871130356313965d1*u72
  value(3)=value(3)+(c(11)*(u83*(u68+u90)+u60))
  u76=-1.55527009952932667d-2*u62
  u62=3.66451883927189941d0*u72
  u74=(u62+u90)
  u64=u62*u83+u76
  u75=(u74*u84+u64)
  value(1)=value(1)+(c(12)*u75)
  u78=((u90+u62)*u80)
  value(2)=value(2)+(c(12)*u78)
  value(3)=value(3)+(c(12)*u53)
  value(1)=value(1)+(c(13)*u78)
  u53=(u74*u85+u64)
  value(2)=value(2)+(c(13)*u53)
  value(3)=value(3)+(c(13)*u59)
  u59=u79*u84
  u74=(u59+u65)
  u64=(u58*u74)
  value(1)=value(1)+(c(14)*u64)
  u90=(x*(u59+u62)*z)
  value(2)=value(2)+(c(14)*u90)
  value(3)=value(3)+(c(14)*u75)
  value(1)=value(1)+(c(15)*u90)
  u75=u79*u85
  u73=(u58*(u75+u62))
  value(2)=value(2)+(c(15)*u73)
  value(3)=value(3)+(c(15)*u78)
  value(1)=value(1)+(c(16)*u73)
  u78=(u75+u65)
  u87=(u77*u78)
  value(2)=value(2)+(c(16)*u87)
  value(3)=value(3)+(c(16)*u53)
  value(1)=value(1)+(c(17)*(u84*(u68+u59)+u60))
  u53=(y*u74*z)
  value(2)=value(2)+(c(17)*u53)
  value(3)=value(3)+(c(17)*u64)
  value(1)=value(1)+(c(18)*u53)
  u64=((u62+u59)*u85+u62*u84+u76)
  value(2)=value(2)+(c(18)*u64)
  value(3)=value(3)+(c(18)*u90)
  value(1)=value(1)+(c(19)*u64)
  u90=(u80*u78)
  value(2)=value(2)+(c(19)*u90)
  value(3)=value(3)+(c(19)*u73)
  value(1)=value(1)+(c(20)*u90)
  value(2)=value(2)+(c(20)*(u85*(u68+u75)+u60))
  value(3)=value(3)+(c(20)*u87)
  if ( lmax .eq. 3 ) return
  u79=A6_(p,pd,erfpd,exppd2)
  u90=p**6
  u73=u86*u79*u90
  u64=-1.09935565178156983d1*u73
  u87=-2.83592616144882564d1*u55
  u53=u86*(3.2986722862692829d2*u79+u87)*u90
  u74=4.66581029858798002d-1*u53
  u65=2.0d0*pd2
  u78=+u82*(2.96880505764235461d3*u79+u87*(9.0d0+u65))*u90
  u87=u78*u83
  u59=(u83*(u74+u87)+u64)
  u75=(u59*y)
  value(1)=value(1)+(c(21)*u75)
  u76=(u59*z)
  value(2)=value(2)+(c(21)*u76)
  u59=-5.49677825890784912d1*u73
  u82=7.77635049764663336d-1*u53
  value(3)=value(3)+(c(21)*(x*(u83*(u82+u87)+u59)))
  u60=2.33290514929399001d-1*u53
  u57=7.77635049764663336d-2*u53
  u53=(u60+u87)
  u62=u57*u83
  u79=u62+u64
  u97=(x*(u53*u84+u79))
  value(1)=value(1)+(c(22)*u97)
  u70=(x*(u87+u60)*u80)
  value(2)=value(2)+(c(22)*u70)
  value(3)=value(3)+(c(22)*u75)
  value(1)=value(1)+(c(23)*u70)
  u75=(x*(u53*u85+u79))
  value(2)=value(2)+(c(23)*u75)
  value(3)=value(3)+(c(23)*u76)
  u76=(u57+u87)
  u53=u76*u84
  u79=u60*u83+u64
  u87=(y*(u53+u79))
  value(1)=value(1)+(c(24)*u87)
  u56=-3.66451883927189941d0*u73
  u66=u62+u56
  u62=((u53+u66)*z)
  value(2)=value(2)+(c(24)*u62)
  value(3)=value(3)+(c(24)*u97)
  value(1)=value(1)+(c(25)*u62)
  u97=u76*u85
  u73=(y*(u97+u66))
  value(2)=value(2)+(c(25)*u73)
  value(3)=value(3)+(c(25)*u70)
  value(1)=value(1)+(c(26)*u73)
  u70=(z*(u97+u79))
  value(2)=value(2)+(c(26)*u70)
  value(3)=value(3)+(c(26)*u75)
  u75=u78*u84
  u97=(u84*(u74+u75)+u64)
  u76=(x*u97)
  value(1)=value(1)+(c(27)*u76)
  u79=(u58*(u75+u60)*z)
  value(2)=value(2)+(c(27)*u79)
  value(3)=value(3)+(c(27)*u87)
  value(1)=value(1)+(c(28)*u79)
  u87=(u57+u75)*u85
  u66=u57*u84
  u53=(x*(u87+u66+u56))
  value(2)=value(2)+(c(28)*u53)
  value(3)=value(3)+(c(28)*u62)
  value(1)=value(1)+(c(29)*u53)
  u62=u78*u85
  u94=(u96*(u62+u60))
  value(2)=value(2)+(c(29)*u94)
  value(3)=value(3)+(c(29)*u73)
  value(1)=value(1)+(c(30)*u94)
  u73=(u85*(u74+u62)+u64)
  u88=(x*u73)
  value(2)=value(2)+(c(30)*u88)
  value(3)=value(3)+(c(30)*u70)
  value(1)=value(1)+(c(31)*(y*(u84*(u82+u75)+u59)))
  u70=(u97*z)
  value(2)=value(2)+(c(31)*u70)
  value(3)=value(3)+(c(31)*u76)
  value(1)=value(1)+(c(32)*u70)
  u76=(y*((u60+u75)*u85+u66+u64))
  value(2)=value(2)+(c(32)*u76)
  value(3)=value(3)+(c(32)*u79)
  value(1)=value(1)+(c(33)*u76)
  u76=(z*(u87+u60*u84+u64))
  value(2)=value(2)+(c(33)*u76)
  value(3)=value(3)+(c(33)*u53)
  value(1)=value(1)+(c(34)*u76)
  u76=(y*u73)
  value(2)=value(2)+(c(34)*u76)
  value(3)=value(3)+(c(34)*u94)
  value(1)=value(1)+(c(35)*u76)
  value(2)=value(2)+(c(35)*(z*(u85*(u82+u62)+u59)))
  value(3)=value(3)+(c(35)*u88)
  if ( lmax .eq. 4 ) return
  u76=A7_(p,pd,erfpd,exppd2)
  u88=p**7
  u70=u86*u76*u88
  u53=-3.84774478123549439d2*u70
  u79=-5.67185232289765129d1*exppd2*pd2
  u97=u86*(2.96880505764235461d3*u76+u79)*u88
  u73=7.77635049764663336d-1*u97
  u94=(1.1d1+u65)
  u87=u86*(3.26568556340659007d4*u76+u79*u94)*u88
  u79=-7.77635049764663336d-2*u87
  u75=u79*u83
  u74=x*(u83*(u73+u75)+u53)
  u66=(u74*y)
  value(1)=value(1)+(c(36)*u66)
  u57=(u74*z)
  value(2)=value(2)+(c(36)*u57)
  u74=u86*(3.2986722862692829d2*u76-u54)*u88
  u78=1.66636082092427858d-1*u74
  u60=-1.15432343437064832d3*u70
  u82=1.166452574646995d0*u97
  value(3)=value(3)+(c(36)*(u83*(u60+u83*(u75+u82))+u78))
  u62=3.33272164184855715d-2*u74
  u74=-7.69548956247098877d1*u70
  u54=-1.53909791249419775d2*u70
  u56=4.66581029858798002d-1*u97
  u64=7.77635049764663336d-2*u97
  u8=(u74+u83*(u75+u56))
  u7=u64*u83
  u9=u83*(u54+u7)+u62
  u61=(u8*u84+u9)
  value(1)=value(1)+(c(37)*u61)
  u69=((u83*(u56+u75)+u74)*u80)
  value(2)=value(2)+(c(37)*u69)
  value(3)=value(3)+(c(37)*u66)
  value(1)=value(1)+(c(38)*u69)
  u66=(u8*u85+u9)
  value(2)=value(2)+(c(38)*u66)
  value(3)=value(3)+(c(38)*u57)
  u57=-2.30864686874129663d2*u70
  u8=2.33290514929399001d-1*u97
  u9=(u8+u75)
  u71=u9*u84
  u81=u8*u83
  u95=u81+u57
  u68=(u58*(u71+u95))
  value(1)=value(1)+(c(39)*u68)
  u67=u7+u74
  u7=(x*(u71+u67)*z)
  value(2)=value(2)+(c(39)*u7)
  value(3)=value(3)+(c(39)*u61)
  value(1)=value(1)+(c(40)*u7)
  u61=u9*u85
  u71=(u58*(u61+u67))
  value(2)=value(2)+(c(40)*u71)
  value(3)=value(3)+(c(40)*u69)
  value(1)=value(1)+(c(41)*u71)
  u69=(u77*(u61+u95))
  value(2)=value(2)+(c(41)*u69)
  value(3)=value(3)+(c(41)*u66)
  u66=(u75+u64)
  u61=u54+u56*u83
  u9=u74*u83+u62
  u95=(u84*(u61+u66*u84)+u9)
  value(1)=value(1)+(c(42)*u95)
  u67=(u64+u75)
  u75=u81+u74
  u81=(y*(u67*u84+u75)*z)
  value(2)=value(2)+(c(42)*u81)
  value(3)=value(3)+(c(42)*u68)
  value(1)=value(1)+(c(43)*u81)
  u68=-2.2218144278990381d-2*u86*(9.8960168588078487d2*u76-u93)*u88
  u91=-7.77635049764663336d-2*u97
  u93=-3.11054019905865334d-1*u86*(8.90641517292706383d3*u76+u99*(6.0d0&
 &+pd2))*u88
  u97=7.77635049764663336d-2*u87
  u87=u97*u83
  u70=(u84*(u64+u83*(u87+u93)+(u87+u91)*u84)+u83*(u64+u91*u83)+u68)
  value(2)=value(2)+(c(43)*u70)
  value(3)=value(3)+(c(43)*u7)
  value(1)=value(1)+(c(44)*u70)
  u7=(u80*(u67*u85+u75))
  value(2)=value(2)+(c(44)*u7)
  value(3)=value(3)+(c(44)*u71)
  value(1)=value(1)+(c(45)*u7)
  u71=(u85*(u61+u66*u85)+u9)
  value(2)=value(2)+(c(45)*u71)
  value(3)=value(3)+(c(45)*u69)
  u69=u79*u84
  u66=(u84*(u73+u69)+u53)
  u67=(u58*u66)
  value(1)=value(1)+(c(46)*u67)
  u61=(x*(u84*(u56+u69)+u74)*z)
  value(2)=value(2)+(c(46)*u61)
  value(3)=value(3)+(c(46)*u95)
  value(1)=value(1)+(c(47)*u61)
  u95=(u8+u69)*u85
  u9=u64*u84
  u75=(u58*(u95+u9+u74))
  value(2)=value(2)+(c(47)*u75)
  value(3)=value(3)+(c(47)*u81)
  value(1)=value(1)+(c(48)*u75)
  u76=u8*u84
  u87=(u77*((u64+u69)*u85+u76+u74))
  value(2)=value(2)+(c(48)*u87)
  value(3)=value(3)+(c(48)*u70)
  value(1)=value(1)+(c(49)*u87)
  u70=u79*u85
  u97=(u58*(u85*(u56+u70)+u74))
  value(2)=value(2)+(c(49)*u97)
  value(3)=value(3)+(c(49)*u7)
  value(1)=value(1)+(c(50)*u97)
  u93=(u85*(u73+u70)+u53)
  u7=(u77*u93)
  value(2)=value(2)+(c(50)*u7)
  value(3)=value(3)+(c(50)*u71)
  value(1)=value(1)+(c(51)*(u84*(u60+u84*(u69+u82))+u78))
  u71=(y*u66*z)
  value(2)=value(2)+(c(51)*u71)
  value(3)=value(3)+(c(51)*u67)
  value(1)=value(1)+(c(52)*u71)
  u71=((u74+u84*(u69+u56))*u85+u84*(u54+u9)+u62)
  value(2)=value(2)+(c(52)*u71)
  value(3)=value(3)+(c(52)*u61)
  value(1)=value(1)+(c(53)*u71)
  u71=(u80*(u95+u76+u57))
  value(2)=value(2)+(c(53)*u71)
  value(3)=value(3)+(c(53)*u75)
  value(1)=value(1)+(c(54)*u71)
  u71=(u85*(u54+u56*u84+(u69+u64)*u85)+u74*u84+u62)
  value(2)=value(2)+(c(54)*u71)
  value(3)=value(3)+(c(54)*u87)
  value(1)=value(1)+(c(55)*u71)
  u87=(u80*u93)
  value(2)=value(2)+(c(55)*u87)
  value(3)=value(3)+(c(55)*u97)
  value(1)=value(1)+(c(56)*u87)
  value(2)=value(2)+(c(56)*(u85*(u60+u85*(u70+u82))+u78))
  value(3)=value(3)+(c(56)*u7)
  if ( lmax .eq. 5 ) return
  u77=A8_(p,pd,erfpd,exppd2)
  u87=p**8
  u71=u86*u77*u87
  u61=3.84774478123549439d2*u71
  u97=-5.67185232289765129d1*u55
  u67=u86*(2.96880505764235461d3*u77+u97)*u87
  u60=-3.49935772394098501d0*u67
  u75=3.26568556340659007d4*u77
  u76=u86*(u75+u97*u94)*u87
  u53=1.166452574646995d0*u76
  u93=pd2**2
  u95=(u65+1.1d1)
  u7=u86*(4.24539123242856709d5*u77+u97*(1.3d1*u95+4.0d0*u93))*u87
  u94=-7.77635049764663336d-2*u7
  u54=u94*u83
  u69=(u83*(u60+u83*(u54+u53))+u61)
  u70=(u69*y)
  value(1)=value(1)+(c(57)*u70)
  u66=(u69*z)
  value(2)=value(2)+(c(57)*u66)
  u69=2.69342134686484607d3*u71
  u91=-8.16516802252896503d0*u67
  u79=1.63303360450579301d0*u76
  value(3)=value(3)+(c(57)*(x*(u83*(u91+u83*(u54+u79))+u69)))
  u64=-1.166452574646995d0*u67
  u73=-7.77635049764663336d-1*u67
  u82=7.77635049764663336d-1*u76
  u9=7.77635049764663336d-2*u76
  u68=(u64+u83*(u54+u82))
  u81=u9*u83
  u92=u83*(u73+u81)+u61
  u78=(x*(u68*u84+u92))
  value(1)=value(1)+(c(58)*u78)
  u74=(x*(u83*(u82+u54)+u64)*u80)
  value(2)=value(2)+(c(58)*u74)
  value(3)=value(3)+(c(58)*u70)
  value(1)=value(1)+(c(59)*u74)
  u70=(x*(u68*u85+u92))
  value(2)=value(2)+(c(59)*u70)
  value(3)=value(3)+(c(59)*u66)
  u66=2.30864686874129663d2*u71
  u68=-2.33290514929399001d-1*u67
  u92=-1.39974308957639401d0*u67
  u57=4.66581029858798002d-1*u76
  u8=2.33290514929399001d-1*u76
  u90=(u68+u83*(u54+u57))
  u56=u90*u84
  u62=u8*u83
  u88=u83*(u92+u62)+u66
  u6=(y*(u56+u88))
  value(1)=value(1)+(c(60)*u6)
  u63=7.69548956247098877d1*u71
  u71=-4.66581029858798002d-1*u67
  u59=u83*(u71+u81)+u63
  u81=((u56+u59)*z)
  value(2)=value(2)+(c(60)*u81)
  value(3)=value(3)+(c(60)*u78)
  value(1)=value(1)+(c(61)*u81)
  u78=u90*u85
  u56=(y*(u78+u59))
  value(2)=value(2)+(c(61)*u56)
  value(3)=value(3)+(c(61)*u74)
  value(1)=value(1)+(c(62)*u56)
  u74=(z*(u78+u88))
  value(2)=value(2)+(c(62)*u74)
  value(3)=value(3)+(c(62)*u70)
  u80=(u54+u8)
  u78=u57*u83
  u88=u92+u78
  u70=u68*u83
  u59=u70+u66
  u90=(x*(u84*(u88+u80*u84)+u59))
  value(1)=value(1)+(c(63)*u90)
  u72=-6.99871544788197003d-1*u67
  u67=(u8+u54)
  u89=u62+u72
  u62=(u58*(u67*u84+u89)*z)
  value(2)=value(2)+(c(63)*u62)
  value(3)=value(3)+(c(63)*u6)
  value(1)=value(1)+(c(64)*u62)
  u99=-1.86632411943519201d0*u86*(3.2986722862692829d2*u77-7.0898154036&
 &2206411d0*u55)*u87
  u6=-2.33290514929399001d-1*u76
  u55=7.77635049764663336d-2*u86*(3.85944657493506099d4*u77+u97*(1.3d1+&
 &u65))*u87
  u65=-1.24421607962346134d0*u86*(u75+u98*(4.0d0*u95+u93))*u87
  u75=7.77635049764663336d-2*u7
  u7=-7.77635049764663336d-2*u76
  u98=u75*u83
  u86=u83*(u98+u65)
  u77=(x*(u84*(u8+u86+(u98+u6)*u84)+u83*(u55+u7*u83)+u99))
  value(2)=value(2)+(c(64)*u77)
  value(3)=value(3)+(c(64)*u81)
  value(1)=value(1)+(c(65)*u77)
  u76=(u96*(u67*u85+u89))
  value(2)=value(2)+(c(65)*u76)
  value(3)=value(3)+(c(65)*u56)
  value(1)=value(1)+(c(66)*u76)
  u95=(x*(u85*(u88+u80*u85)+u59))
  value(2)=value(2)+(c(66)*u95)
  value(3)=value(3)+(c(66)*u74)
  u87=(u54+u9)
  u54=u87*u84
  u93=u73+u82*u83
  u80=u64*u83+u61
  u88=(y*(u84*(u93+u54)+u80))
  value(1)=value(1)+(c(67)*u88)
  u56=u71+u78
  u78=u70+u63
  u59=((u84*(u56+u54)+u78)*z)
  value(2)=value(2)+(c(67)*u59)
  value(3)=value(3)+(c(67)*u90)
  value(1)=value(1)+(c(68)*u59)
  u70=u55+u86
  u54=u83*(u8+u6*u83)+u99
  u86=(u98+u7)
  u90=(y*(u84*(u70+u86*u84)+u54))
  value(2)=value(2)+(c(68)*u90)
  value(3)=value(3)+(c(68)*u62)
  value(1)=value(1)+(c(69)*u90)
  u98=(z*(u85*(u70+u86*u85)+u54))
  value(2)=value(2)+(c(69)*u98)
  value(3)=value(3)+(c(69)*u77)
  value(1)=value(1)+(c(70)*u98)
  u54=u87*u85
  u87=(y*(u85*(u56+u54)+u78))
  value(2)=value(2)+(c(70)*u87)
  value(3)=value(3)+(c(70)*u76)
  value(1)=value(1)+(c(71)*u87)
  u56=(z*(u85*(u93+u54)+u80))
  value(2)=value(2)+(c(71)*u56)
  value(3)=value(3)+(c(71)*u95)
  u54=u94*u84
  u70=(u84*(u60+u84*(u54+u53))+u61)
  u80=(x*u70)
  value(1)=value(1)+(c(72)*u80)
  u95=(u58*(u84*(u82+u54)+u64)*z)
  value(2)=value(2)+(c(72)*u95)
  value(3)=value(3)+(c(72)*u88)
  value(1)=value(1)+(c(73)*u95)
  u86=(u68+u84*(u54+u57))*u85
  u88=u9*u84
  u93=(x*(u86+u84*(u71+u88)+u63))
  value(2)=value(2)+(c(73)*u93)
  value(3)=value(3)+(c(73)*u59)
  value(1)=value(1)+(c(74)*u93)
  u76=u8*u84
  u78=(u96*((u8+u54)*u85+u76+u72))
  value(2)=value(2)+(c(74)*u78)
  value(3)=value(3)+(c(74)*u90)
  value(1)=value(1)+(c(75)*u78)
  u62=(u54+u9)*u85
  u90=u57*u84
  u77=u68*u84
  u59=(x*(u85*(u71+u90+u62)+u77+u63))
  value(2)=value(2)+(c(75)*u59)
  value(3)=value(3)+(c(75)*u98)
  value(1)=value(1)+(c(76)*u59)
  u6=u94*u85
  u55=(u96*(u85*(u82+u6)+u64))
  value(2)=value(2)+(c(76)*u55)
  value(3)=value(3)+(c(76)*u87)
  value(1)=value(1)+(c(77)*u55)
  u65=(u85*(u60+u85*(u6+u53))+u61)
  u87=(x*u65)
  value(2)=value(2)+(c(77)*u87)
  value(3)=value(3)+(c(77)*u56)
  value(1)=value(1)+(c(78)*(y*(u84*(u91+u84*(u54+u79))+u69)))
  u56=(u70*z)
  value(2)=value(2)+(c(78)*u56)
  value(3)=value(3)+(c(78)*u80)
  value(1)=value(1)+(c(79)*u56)
  u56=(y*((u64+u84*(u54+u82))*u85+u84*(u73+u88)+u61))
  value(2)=value(2)+(c(79)*u56)
  value(3)=value(3)+(c(79)*u95)
  value(1)=value(1)+(c(80)*u56)
  u56=(z*(u86+u84*(u92+u76)+u66))
  value(2)=value(2)+(c(80)*u56)
  value(3)=value(3)+(c(80)*u93)
  value(1)=value(1)+(c(81)*u56)
  u56=(y*(u85*(u92+u90+(u54+u8)*u85)+u77+u66))
  value(2)=value(2)+(c(81)*u56)
  value(3)=value(3)+(c(81)*u78)
  value(1)=value(1)+(c(82)*u56)
  u56=(z*(u85*(u73+u82*u84+u62)+u64*u84+u61))
  value(2)=value(2)+(c(82)*u56)
  value(3)=value(3)+(c(82)*u59)
  value(1)=value(1)+(c(83)*u56)
  u56=(y*u65)
  value(2)=value(2)+(c(83)*u56)
  value(3)=value(3)+(c(83)*u55)
  value(1)=value(1)+(c(84)*u56)
  value(2)=value(2)+(c(84)*(z*(u85*(u91+u85*(u6+u79))+u69)))
  value(3)=value(3)+(c(84)*u87)
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_Y_shell_opt_1=.false.
end function

  
end module
