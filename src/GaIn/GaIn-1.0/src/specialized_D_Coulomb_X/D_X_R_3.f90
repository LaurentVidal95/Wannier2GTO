module mod_D_X_R_opt_3
  
  use mod_A_functions
  
  implicit none
  
  private
  public :: D_X_R_opt_3
  
contains
  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_1(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_1
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u348
  real(kind=8) :: u351
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u441
  real(kind=8) :: u449
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u496
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_1=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u59=A4_(p,pd,erfpd,exppd2)
  u351=p**2
  u469=a3**(-3)
  u55=3.75d-1*u469*u351*(3.0d0*u59*u351-2.0d0*a3*A2_(p,pd,erfpd,exppd2)&
 &)
  u89=2.65868077635827404d1*u59
  u440=-7.05236979434695359d-2*u469
  u470=p**4
  u7=exppd2*pd
  u6=-8.0d0*u7
  u449=+u440*(u89+u6)*u470
  u348=x**2
  value=value+(c(1)*(x*(u449*u348+u55)))
  if ( lmax .eq. 0 ) return
  u55=A5_(p,pd,erfpd,exppd2)
  u449=u55*u351
  u484=A3_(p,pd,erfpd,exppd2)
  u98=u469*p**3
  u57=exppd2*u351
  u54=4.0d0*exppd2
  u488=-1.41047395886939072d-2*u98*(7.97604232907482212d1*u449+2.0d0*(1&
 &.2d1*u57-5.0d0*a3*(u54+5.31736155271654808d0*u484)))
  u468=5.0d0*u449
  u449=-a3*u484
  u484=2.25d0*u98*(u468+u449)
  u86=1.86107654345079183d2*u55
  u58=p**5
  u70=exppd2*pd2
  u63=-1.6d1*u70
  u474=+u440*(u86+u63)*u58
  u480=u474*u348
  value=value+(c(2)*(u348*(u484+u480)+u488))
  u488=1.125d0*u98*(u468-2.0d0*(-u449))
  u468=x*(u480+u488)
  value=value+(c(3)*(u468*y))
  value=value+(c(4)*(u468*z))
  if ( lmax .eq. 1 ) return
  u488=A6_(p,pd,erfpd,exppd2)
  u474=u488*u351
  u468=a3*u59
  u449=u469*u470
  u59=-1.125d0*u449
  u98=+u59*(2.5d1*u474-6.0d0*u468)
  u470=1.86107654345079183d2*u488
  u484=-1.6d1*u7
  u91=(u470+u484)
  u457=u91*u351
  u493=a3*(-u6-u89)
  u89=1.41047395886939072d-1*u449*(5.0d0*u457+3.0d0*u493)
  u61=1.67496888910571265d3*u488
  u496=2.0d0*pd2
  u48=+u484*(9.0d0+u496)
  u44=p**6
  u99=(u61+u48)*u44
  u82=+u440*u99
  u477=u82*u348
  value=value+(c(5)*(x*(u348*(u89+u477)+u98)))
  u98=+u59*(5.0d0*u474-2.0d0*u468)
  u89=4.23142187660817215d-1*u449*(u457+u493)
  u59=(u348*(u89+u477)+u98)
  value=value+(c(6)*(u59*y))
  value=value+(c(7)*(u59*z))
  u468=u7*u351
  u59=2.11571093830408608d-1*u449*(2.0d0*(u493-8.0d0*u468)+1.8610765434&
 &5079183d2*u474)
  u493=u91*u44
  u474=7.05236979434695359d-2*u469
  u449=u474*u493
  u89=y**2
  u88=(u59+u477)
  u457=u449*u348+u98
  value=value+(c(8)*(x*(u88*u89+u457)))
  u64=y*z
  value=value+(c(9)*(x*(u477+u59)*u64))
  u477=z**2
  value=value+(c(10)*(x*(u88*u477+u457)))
  if ( lmax .eq. 2 ) return
  u479=A7_(p,pd,erfpd,exppd2)
  u449=u479*u351
  u82=8.0d0*exppd2
  u88=a3*(u82+2.65868077635827404d1*u55)
  u94=u469*u58
  u58=6.04488839515453165d-3*u94
  u75=u58*(2.0d0*(2.0d2*u57-2.1d1*u88)+4.65269135862697957d3*u449)
  u96=3.5d1*u449
  u490=a3*u55
  u55=-1.6875d1*u94*(u96-4.0d0*u490)
  u8=a3*(-u63-u86)
  u86=2.11571093830408608d-1*u94
  u59=pd2*u351
  u478=exppd2*u59
  u76=-8.0d1*u478
  u457=u86*(2.0d0*(u8+u76)+8.37484444552856323d3*u449)
  u71=1.84246577801628391d4*u479
  u471=(1.1d1+u496)
  u480=-3.2d1*u70
  u66=+u480*u471
  u46=p**7
  u98=(u71+u66)*u46
  u65=+u440*u98
  u476=u65*u348
  value=value+(c(11)*(u348*(u55+u348*(u476+u457))+u75))
  u75=-5.625d0*u94*(u96-6.0d0*u490)
  u55=1.67496888910571265d3*u479
  u457=(u55+u480)
  u96=u457*u351
  u80=1.41047395886939072d-1*u94*(5.0d0*u96+3.0d0*u8)
  u97=x*(u348*(u80+u476)+u75)
  value=value+(c(12)*(u97*y))
  value=value+(c(13)*(u97*z))
  u75=u58*(2.0d0*(4.0d1*u57-7.0d0*u88)+9.30538271725395914d2*u449)
  u88=7.0d0*u449
  u58=u94*(u88-2.0d0*u490)
  u97=-5.625d0*u58
  u84=-1.125d1*u94*(u88-u490)
  u88=4.23142187660817215d-1*u94*(u96+u8)
  u94=u457*u46
  u96=u469*u94
  u490=7.05236979434695359d-2*u96
  u458=(u97+u348*(u476+u88))
  u481=u490*u348
  u459=u348*(u84+u481)+u75
  value=value+(c(14)*(u458*u89+u459))
  value=value+(c(15)*((u348*(u88+u476)+u97)*u64))
  value=value+(c(16)*(u458*u477+u459))
  u84=-1.6875d1*u58
  u58=u86*(2.0d0*(u8-1.6d1*u478)+1.67496888910571265d3*u449)
  u8=2.11571093830408608d-1*u96
  u96=x*y
  u449=(u58+u476)
  u86=u449*u89
  u458=u8*u348+u84
  value=value+(c(17)*(u96*(u86+u458)))
  u459=u481+u97
  value=value+(c(18)*(x*(u86+u459)*z))
  u86=u449*u477
  value=value+(c(19)*(u96*(u86+u459)))
  u490=x*z
  value=value+(c(20)*(u490*(u86+u458)))
  if ( lmax .eq. 3 ) return
  u68=A8_(p,pd,erfpd,exppd2)
  u65=u68*u351
  u8=a3*u488
  u459=-6.0d0*u8
  u488=u469*u44
  u84=2.8125d1*u488*(4.9d1*u65+u459)
  u44=a3*(-u484-u470)
  u458=-1.05785546915204304d0*u488*(1.17247822237399885d4*u65+4.0d0*(u4&
 &4-5.6d1*u468))
  u470=a3*(-u48-u61)
  u48=2.11571093830408608d-1*u488
  u86=u7*u471
  u52=u86*u351
  u49=u48*(2.0d0*(u470-1.12d2*u52)+1.28972604461139874d5*u65)
  u56=2.39520551142116908d5*u68
  u476=pd2**2
  u456=4.0d0*u476
  u75=(u496+1.1d1)
  u88=-3.2d1*u7
  u58=+u88*(1.3d1*u75+u456)
  u9=p**8
  u97=(u56+u58)*u9
  u494=u469*u97
  u489=-7.05236979434695359d-2*u494
  u475=u489*u348
  value=value+(c(21)*(x*(u348*(u458+u348*(u475+u49))+u84)))
  u84=5.625d0*u488*(3.5d1*u65+u459)
  u458=8.37484444552856323d3*u65
  u49=-6.34713281491225823d-1*u488*(u458+4.0d0*(u44-4.0d1*u468))
  u459=u48*(2.0d0*(u470-8.0d1*u52)+9.21232889008141955d4*u65)
  u73=(u348*(u49+u348*(u475+u459))+u84)
  value=value+(c(22)*(u73*y))
  value=value+(c(23)*(u73*z))
  u49=3.0d0*u44
  u459=-8.0d1*u468
  u73=-2.11571093830408608d-1*u488*(u458+2.0d0*(u49+u459))
  u458=1.67496888910571265d3*u68
  u441=(u458+u88)
  u83=u441*u351
  u77=-1.41047395886939072d-1*u488*(u49+5.0d0*u83)
  u49=1.84246577801628391d4*u68
  u449=-3.2d1*u86
  u481=(u49+u449)
  u86=u481*u351
  u460=a3*(-u484*(u496+9.0d0)-u61)
  u61=1.41047395886939072d-1*u488*(5.0d0*u86+3.0d0*u460)
  u80=u481*u9
  u484=u469*u80
  u78=7.05236979434695359d-2*u484
  u472=(u73+u348*(u475+u61))
  u482=u78*u348
  u92=u348*(u77+u482)+u84
  value=value+(c(24)*(x*(u472*u89+u92)))
  value=value+(c(25)*(x*(u348*(u61+u475)+u73)*u64))
  value=value+(c(26)*(x*(u472*u477+u92)))
  u84=u488*(7.0d0*u65-2.0d0*u8)
  u61=1.6875d1*u84
  u73=u488*(1.67496888910571265d3*u65+2.0d0*(u44-1.6d1*u468))
  u472=-2.11571093830408608d-1*u73
  u92=u488*(u44+u83)
  u83=-1.26942656298245165d0*u92
  u44=4.23142187660817215d-1*u488*(u86+u460)
  u86=2.11571093830408608d-1*u484
  u460=(u472+u348*(u475+u44))
  u79=u460*u89
  u483=u86*u348
  u461=u348*(u83+u483)+u61
  value=value+(c(27)*(y*(u79+u461)))
  u50=5.625d0*u84
  u84=-4.23142187660817215d-1*u92
  u51=u348*(u84+u482)+u50
  value=value+(c(28)*((u79+u51)*z))
  u482=u460*u477
  value=value+(c(29)*(y*(u482+u51)))
  value=value+(c(30)*(z*(u482+u461)))
  u50=-1.26942656298245165d0*u73
  u482=1.84246577801628391d4*u65
  u65=-1.6d1*u52
  u52=u48*(2.0d0*(u470+u65)+u482)
  u84=u441*u9
  u44=-2.11571093830408608d-1*u469
  u78=+u44*u84
  u470=4.23142187660817215d-1*u484
  u79=(u475+u52)
  u460=u50+u470*u348
  u461=u78*u348+u61
  value=value+(c(31)*(x*(u89*(u460+u79*u89)+u461)))
  u51=-6.34713281491225823d-1*u73
  u472=(u52+u475)
  u462=u483+u51
  value=value+(c(32)*(u96*(u472*u89+u462)*z))
  u483=1.86107654345079183d2*u68
  u92=-4.0d0*u7
  u95=-4.23142187660817215d-1*u488*(2.65868077635827404d1*u8+4.0d0*(u48&
 &3+u92)*u351)
  u83=a3**(-2)
  u488=4.23142187660817215d-1*u83*u493
  u493=u48*(2.0d0*(a3*u91+u65)+u482)
  u482=-4.23142187660817215d-1*u83
  u91=+u482*u99
  u99=-2.11571093830408608d-1*u484
  u475=2.17745955583742644d4*u68
  u65=(1.3d1+u496)
  u48=u7*u65
  u73=-3.2d1*u48
  u8=u474*(u475+u73)*u9
  u77=+u6*(4.0d0*u75+u476)
  u474=-1.12837916709551257d0*u469*(u49+u77)*u9
  u5=7.05236979434695359d-2*u494
  u494=-7.05236979434695359d-2*u484
  u484=u5*u348
  value=value+(c(33)*(x*((u488+u91*u89)*u477+u89*(u493+u348*(u484+u474)&
 &+(u484+u99)*u89)+u348*(u8+u494*u348)+u95)))
  u484=u96*z
  value=value+(c(34)*(u484*(u472*u477+u462)))
  value=value+(c(35)*(x*(u477*(u460+u79*u477)+u461)))
  if ( lmax .eq. 4 ) return
  u488=a3*(1.6d1*exppd2+1.86107654345079183d2*u479)
  u493=-2.7d1*u488
  u91=A9_(p,pd,erfpd,exppd2)
  u99=u91*u351
  u8=u469*u46
  u474=-1.67913566532070324d-2*u8*(8.20734755661799196d4*u99+2.0d0*(7.8&
 &4d2*u57+u493))
  u494=-a3*u479
  u61=3.54375d3*u8*(1.4d1*u99+u494)
  u489=-6.4d1*u70
  u5=(1.84246577801628391d4*u91+u489)
  u86=u5*u351
  u470=a3*(-u480-u55)
  u78=3.0d0*u470
  u52=-2.11571093830408608d0*u8*(u78+7.0d0*u86)
  u55=(2.39520551142116908d5*u91+u489*u65)
  u461=u55*u351
  u95=a3*(-u480*u75-u71)
  u79=3.0d0*u95
  u51=1.41047395886939072d-1*u8
  u46=u51*(1.4d1*u461+u79)
  u460=(u496+1.3d1)
  u472=(1.5d1*u460+u456)
  u467=p**9
  u463=u469*(3.59280826713175363d6*u91+u489*u472)*u467
  u462=-7.05236979434695359d-2*u463
  u473=u462*u348
  value=value+(c(36)*(u348*(u61+u348*(u348*(u46+u473)+u52))+u474))
  u474=-2.0d0*(-u494)
  u61=5.90625d2*u8*(2.1d1*u99+u474)
  u52=-1.05785546915204304d0*u8*(1.28972604461139874d5*u99+4.0d0*(u470-&
 &1.12d2*u478))
  u46=a3*(-u66-u71)
  u71=u65*u351
  u50=u70*u71
  u66=(u46-2.24d2*u50)
  u72=2.11571093830408608d-1*u8
  u62=u72*(2.0d0*u66+1.67664385799481836d6*u99)
  u93=x*(u348*(u52+u348*(u473+u62))+u61)
  value=value+(c(37)*(u93*y))
  value=value+(c(38)*(u93*z))
  u61=-3.35827133064140647d-3*u8*(5.86239111186999426d4*u99+2.0d0*(5.6d&
 &2*u57+u493))
  u493=u8*(1.5d1*u99+u474)
  u62=1.18125d2*u493
  u93=1.18125d2*u8*(4.5d1*u99-4.0d0*(-u494))
  u85=9.21232889008141955d4*u99
  u47=-6.34713281491225823d-1*u8*(u85+4.0d0*(u470+u76))
  u76=-2.11571093830408608d-1*u8
  u487=-1.6d2*u478
  u53=+u76*(u85+2.0d0*(u470+u487))
  u74=u72*(2.0d0*(u46-1.6d2*u50)+1.19760275571058454d6*u99)
  u81=u469*u55*u467
  u55=7.05236979434695359d-2*u81
  u67=(u62+u348*(u348*(u74+u473)+u47))
  u485=u55*u348
  u486=u348*(u93+u348*(u485+u53))+u61
  value=value+(c(39)*(u67*u89+u486))
  value=value+(c(40)*((u348*(u47+u348*(u473+u74))+u62)*u64))
  value=value+(c(41)*(u67*u477+u486))
  u93=3.54375d2*u493
  u493=+u76*(u85+2.0d0*(u78+u487))
  u85=u8*(u78+5.0d0*u86)
  u78=-4.23142187660817215d-1*u85
  u74=u51*(5.0d0*u461+u79)
  u53=2.11571093830408608d-1*u81
  u487=(u493+u348*(u473+u74))
  u61=u487*u89
  u486=u53*u348
  u67=u348*(u78+u486)+u93
  value=value+(c(42)*(u96*(u61+u67)))
  u79=-1.41047395886939072d-1*u85
  u492=u348*(u79+u485)+u62
  value=value+(c(43)*(x*(u61+u492)*z))
  u61=u487*u477
  value=value+(c(44)*(u96*(u61+u492)))
  value=value+(c(45)*(u490*(u61+u67)))
  u62=-1.00748139919242194d-2*u8*(1.17247822237399885d4*u99+2.0d0*(1.12&
 &d2*u57-9.0d0*u488))
  u93=9.0d0*u99
  u55=u8*(u93+u474)
  u61=2.3625d2*u55
  u474=2.0d0*(u470-3.2d1*u478)
  u47=1.84246577801628391d4*u99
  u74=u8*(u47+u474)
  u493=-2.11571093830408608d-1*u74
  u79=2.3625d2*u8*(u93+u494)
  u93=u8*(u470+u86)
  u86=-2.53885312596490329d0*u93
  u85=4.23142187660817215d-1*u8*(u461+u95)
  u95=u469*u5*u467
  u5=-2.11571093830408608d-1*u95
  u67=4.23142187660817215d-1*u81
  u492=(u348*(u85+u473)+u493)
  u487=u67*u348
  u78=u61+u348*(u487+u86)
  u488=u5*u348
  u57=u348*(u79+u488)+u62
  value=value+(c(46)*(u89*(u78+u492*u89)+u57))
  u495=1.18125d2*u55
  u87=-1.26942656298245165d0*u93
  u52=(u493+u348*(u473+u85))
  u69=u348*(u87+u486)+u495
  value=value+(c(47)*(y*(u52*u89+u69)*z))
  u90=1.34330853225656259d-2*u8*(1.4d1*(1.67496888910571265d3*u91-u54)*&
 &u351+9.0d0*a3*(u82-5.58322963035237549d2*u479))
  u54=u72*(u474+u47)
  u474=+u76*(3.51743466712199656d4*u99+2.0d0*(u470-6.4d1*u478))
  u93=4.0d0*pd2
  u76=u72*(8.0d0*(a3*(-u63*(6.0d0+pd2)-5.02490666731713794d3*u479)-8.0d&
 &0*u70*(2.7d1+u93)*u351)+4.97465760064396656d5*u99)
  u63=-4.23142187660817215d-1*u8*(u46+u461)
  u47=u51*(3.0d0*(u470-1.92d2*u478)+(1.65821920021465552d5*u91-6.4d1*ex&
 &ppd2*u476)*u351)
  u486=pd2**3
  u479=u486*u351
  u470=-7.05236979434695359d-2*u8*(5.02993157398445508d6*u99+2.0d0*(3.0&
 &d0*u66-1.28d2*exppd2*u479))
  u485=7.05236979434695359d-2*u463
  u463=-7.05236979434695359d-2*u81
  u478=u485*u348
  value=value+(c(48)*(u89*(u493+u348*(u348*(u470+u478)+u76)+(u348*(u63+&
 &u478)+u54)*u89)+u348*(u474+u348*(u463*u348+u47))+u90))
  value=value+(c(49)*(u64*(u52*u477+u69)))
  value=value+(c(50)*(u477*(u78+u492*u477)+u57))
  u90=5.90625d2*u55
  u54=-2.11571093830408608d0*u74
  u474=u72*(2.0d0*(u46-3.2d1*u50)+2.39520551142116908d5*u99)
  u52=-1.05785546915204304d0*u95
  u63=7.05236979434695359d-1*u81
  u47=(u473+u474)
  u95=u47*u89
  u463=u54+u63*u348
  u78=u52*u348+u90
  value=value+(c(51)*(u96*(u89*(u463+u95)+u78)))
  u55=-1.26942656298245165d0*u74
  u61=u55+u487
  u51=u488+u495
  value=value+(c(52)*(x*(u89*(u61+u95)+u51)*z))
  u95=-1.26942656298245165d0*u8*(1.86107654345079183d2*(-u494)+(8.37484&
 &444552856323d3*u91+u480)*u351)
  u488=1.26942656298245165d0*u83
  u86=u488*u94
  u85=(1.5d1+u496)
  u62=u85*u351
  u8=u72*(2.0d0*(a3*u457+u480*u62)+2.76369866702442587d5*u99)
  u99=+u482*u98
  u487=-2.11571093830408608d-1*u81
  u480=2.11571093830408608d-1*u469
  u81=u480*(2.76369866702442587d5*u91+u489*u85)*u467
  u98=(5.0d0*u460+u476)
  u457=-2.82094791773878144d-1*u469
  u470=+u457*(1.19760275571058454d6*u91+u489*u98)*u467
  u494=u8+u348*(u478+u470)
  u87=u348*(u81+u487*u348)+u95
  u461=(u478+u487)
  u489=u99*u89
  value=value+(c(53)*(u96*((u86+u489)*u477+u89*(u494+u461*u89)+u87)))
  value=value+(c(54)*(u490*(u477*(u494+u489+u461*u477)+u86*u89+u87)))
  u478=u47*u477
  value=value+(c(55)*(u96*(u477*(u61+u478)+u51)))
  value=value+(c(56)*(u490*(u477*(u463+u478)+u78)))
  if ( lmax .eq. 5 ) return
  u54=A10_(p,pd,erfpd,exppd2)
  u478=u54*u351
  u462=a3*u68
  u463=-2.0d0*u462
  u461=u469*u9
  u99=-4.134375d3*u461*(2.7d1*u478+u463)
  u95=-6.4d1*u7
  u47=(1.84246577801628391d4*u54+u95)
  u86=u47*u351
  u485=a3*(-u88-u458)
  u489=4.44299297043858076d1*u461*(2.0d0*u86+u485)
  u494=(2.39520551142116908d5*u54-6.4d1*u48)
  u78=u494*u351
  u458=a3*(-u449-u49)
  u81=-8.88598594087716152d0*u461*(u458+3.0d0*u78)
  u474=3.59280826713175363d6*u54
  u5=u7*u472
  u90=(u474-6.4d1*u5)
  u55=u90*u351
  u449=a3*(-u88*(u456+1.3d1*u471)-u56)
  u51=4.23142187660817215d-1*u461
  u470=u51*(6.0d0*u55+u449)
  u52=(u456+1.5d1*u65)
  u87=8.0d0*u486
  u61=p**10
  u50=u469*(6.10777405412398116d7*u54+u95*(1.7d1*u52+u87))*u61
  u79=-7.05236979434695359d-2*u50
  u472=u79*u348
  value=value+(c(57)*(x*(u348*(u489+u348*(u348*(u470+u472)+u81))+u99)))
  u99=-5.90625d2*u461*(2.1d1*u478+u463)
  u489=2.11571093830408608d0*u461
  u81=u489*(1.4d1*u86+9.0d0*u485)
  u470=3.0d0*u458
  u48=-u489*(u470+7.0d0*u78)
  u487=a3*(-u58-u56)
  u489=u7*u476
  u8=(u474-2.56d2*u489)*u351
  u474=1.41047395886939072d-1*u461
  u53=u7*u71
  u71=u474*(3.0d0*(u487-4.48d3*u53)+1.4d1*u8)
  u58=(u348*(u81+u348*(u348*(u71+u472)+u48))+u99)
  value=value+(c(58)*(u58*y))
  value=value+(c(59)*(u58*z))
  u71=3.0d0*u485
  u58=1.28972604461139874d5*u478
  u81=1.05785546915204304d0*u461
  u48=u81*(2.0d0*(u71-2.24d2*u468)+u58)
  u63=u81*(4.0d0*(u485-1.12d2*u468)+u58)
  u58=a3*(-u88*u75-u49)
  u74=1.67664385799481836d6*u478
  u65=-u81*(u74+4.0d0*(u58-1.12d2*u53))
  u81=-2.11571093830408608d-1*u461
  u67=+u81*(u74+2.0d0*(u58-2.24d2*u53))
  u74=u5*u351
  u473=2.11571093830408608d-1*u461
  u5=u473*(2.0d0*(u487-2.24d2*u74)+2.51496578699222754d7*u478)
  u75=u469*u90*u61
  u90=7.05236979434695359d-2*u75
  u69=(u48+u348*(u348*(u5+u472)+u65))
  u490=u90*u348
  u46=u348*(u63+u348*(u490+u67))+u99
  value=value+(c(60)*(x*(u69*u89+u46)))
  value=value+(c(61)*(x*(u348*(u65+u348*(u472+u5))+u48)*u64))
  value=value+(c(62)*(x*(u69*u477+u46)))
  u65=u461*(1.5d1*u478+u463)
  u67=-3.54375d2*u65
  u64=9.21232889008141955d4*u478
  u69=u461*(2.0d0*(u71-1.6d2*u468)+u64)
  u46=2.11571093830408608d-1*u69
  u76=u461*(4.0d0*(u485+u459)+u64)
  u64=1.90413984447367747d0*u76
  u72=1.19760275571058454d6*u478
  u5=-6.34713281491225823d-1*u461
  u495=+u5*(u72+4.0d0*(u58-8.0d1*u53))
  u48=-1.6d2*u53
  u70=u461*(u72+2.0d0*(u58+u48))
  u82=-6.34713281491225823d-1*u70
  u94=u473*(2.0d0*(u487-1.6d2*u74)+1.79640413356587681d7*u478)
  u459=2.11571093830408608d-1*u75
  u9=(u46+u348*(u348*(u94+u472)+u495))
  u492=u9*u89
  u467=u459*u348
  u493=u348*(u64+u348*(u467+u82))+u67
  value=value+(c(63)*(y*(u492+u493)))
  u56=-1.18125d2*u65
  u65=6.34713281491225823d-1*u76
  u456=-2.11571093830408608d-1*u70
  u70=u348*(u65+u348*(u490+u456))+u56
  value=value+(c(64)*((u492+u70)*z))
  u492=u9*u477
  value=value+(c(65)*(y*(u492+u70)))
  value=value+(c(66)*(z*(u492+u493)))
  u56=1.26942656298245165d0*u69
  u490=3.0d0*u58
  u90=+u81*(u72+2.0d0*(u490+u48))
  u82=u51*(5.0d0*u86+u71)
  u456=u461*(u470+5.0d0*u78)
  u495=-8.46284375321634431d-1*u456
  u71=5.0d0*u8
  u8=-1.6d3*u53
  u94=u474*(3.0d0*(u487+u8)+u71)
  u46=u469*u494*u61
  u64=-2.11571093830408608d-1*u46
  u65=4.23142187660817215d-1*u75
  u494=(u348*(u94+u472)+u90)
  u492=u65*u348
  u9=u56+u348*(u492+u495)
  u493=u64*u348
  u70=u348*(u82+u493)+u67
  value=value+(c(67)*(x*(u89*(u9+u494*u89)+u70)))
  u57=6.34713281491225823d-1*u69
  u69=-4.23142187660817215d-1*u456
  u456=(u90+u348*(u472+u94))
  u91=u348*(u69+u467)+u57
  value=value+(c(68)*(u96*(u456*u89+u91)*z))
  u467=a3*(-u92-u483)
  u68=u51*(8.0d0*(3.0d0*u467-2.0d1*u468)+4.18742222276428161d4*u478)
  u483=u473*(2.0d0*(u470+u48)+u72)
  u470=-7.05236979434695359d-2*u461
  u72=+u470*(2.48732880032198328d6*u478+2.0d0*(3.0d0*(a3*(-u73-u475)-1.&
 &44d3*u468)-6.4d2*u7*u59))
  u59=u489*u351
  u66=7.05236979434695359d-2*u461*(3.2d1*(3.0d0*(a3*(-u6*(u476+4.0d0*u4&
 &71)-u49)-1.1d2*u53)-8.0d1*u59)+3.95208909384492899d7*u478)
  u6=-1.41047395886939072d-1*u461*(u71+3.0d0*(u449+u8))
  u71=u474*(3.0d0*(u458-2.56d2*u53)+4.0d0*(7.18561653426350725d5*u54-3.&
 &2d1*u489)*u351)
  u8=+u470*(9.70058232125573479d7*u478+2.0d0*(3.0d0*(u487-2.88d2*u74)-2&
 &.56d2*u7*u479))
  u73=7.05236979434695359d-2*u50
  u471=-7.05236979434695359d-2*u75
  u474=u73*u348
  value=value+(c(69)*(x*(u89*(u90+u348*(u348*(u8+u474)+u66)+(u348*(u6+u&
 &474)+u483)*u89)+u348*(u72+u348*(u471*u348+u71))+u68)))
  value=value+(c(70)*(u484*(u456*u477+u91)))
  value=value+(c(71)*(x*(u477*(u9+u494*u477)+u70)))
  u68=u461*(9.0d0*u478+u463)
  u463=-5.90625d2*u68
  u72=u461*(2.0d0*(u485-3.2d1*u468)+1.84246577801628391d4*u478)
  u66=2.11571093830408608d0*u72
  u6=2.39520551142116908d5*u478
  u71=-3.2d1*u53
  u56=u461*(u6+2.0d0*(u58+u71))
  u57=-2.11571093830408608d-1*u56
  u94=u461*(u86+u485)
  u90=6.34713281491225823d0*u94
  u67=u461*(u458+u78)
  u50=-4.23142187660817215d0*u67
  u8=u51*(u55+u449)
  u78=-1.05785546915204304d0*u46
  u449=7.05236979434695359d-1*u75
  u485=(u348*(u8+u472)+u57)
  u69=u485*u89
  u494=u449*u348
  u86=u66+u348*(u494+u50)
  u495=u78*u348
  u82=u348*(u90+u495)+u463
  value=value+(c(72)*(y*(u89*(u86+u69)+u82)))
  u70=-1.18125d2*u68
  u68=1.26942656298245165d0*u72
  u91=1.26942656298245165d0*u94
  u94=-2.53885312596490329d0*u67
  u67=u68+u348*(u492+u94)
  u492=u348*(u91+u493)+u70
  value=value+(c(73)*((u89*(u67+u69)+u492)*z))
  u493=1.26942656298245165d0*u461
  u69=u493*(8.0d0*(u467-4.0d0*u468)+8.37484444552856323d3*u478)
  u467=+u81*(2.76369866702442587d5*u478+2.0d0*(a3*(-u88*u460-u475)+u88*&
 &u62))
  u468=u473*(2.0d0*(u458+u71)+u6)
  u458=4.60616444504070978d5*u478
  u475=u7*(2.5d1+u93)*u351
  u71=+u5*(u458+2.0d0*(u58-3.2d1*u475))
  u58=u7*(3.5d1*u460+8.0d0*u476)
  u6=u473*(3.2d1*(a3*(-u77-u49)-2.0d0*u58*u351)+8.38321928997409179d6*u&
 &478)
  u7=-4.23142187660817215d-1*u461*(u487+u55)
  u55=2.0d0*(1.19760275571058454d6*u54+u95*u98)*u351
  u9=u51*(u55+u490)
  u456=+u470*(8.98202066782938406d7*u478+2.0d0*(3.0d0*(u487-4.0d3*u53)-&
 &1.28d2*u489*(2.5d1+u496)*u351))
  u489=-2.11571093830408608d-1*u75
  u470=u467+u348*(u348*(u456+u474)+u6)
  u496=u489*u348
  u471=u348*(u71+u348*(u496+u9))+u69
  u479=(u348*(u7+u474)+u468)
  value=value+(c(74)*(y*(u89*(u470+u479*u89)+u471)))
  value=value+(c(75)*(z*(u477*(u470+u479*u477)+u471)))
  u467=u485*u477
  value=value+(c(76)*(y*(u477*(u67+u467)+u492)))
  value=value+(c(77)*(z*(u477*(u86+u467)+u82)))
  u70=9.52069922236838735d0*u72
  u66=-3.17356640745612912d0*u56
  u8=3.59280826713175363d6*u478
  u478=u473*(2.0d0*(u487-3.2d1*u74)+u8)
  u487=1.05785546915204304d0*u469*u47*u61
  u74=-3.17356640745612912d0*u46
  u47=1.05785546915204304d0*u75
  u82=(u478+u472)
  u467=u70+u74*u348
  u468=u47*u348+u66
  u469=u487*u348+u463
  value=value+(c(78)*(x*(u89*(u467+u89*(u82*u89+u468))+u469)))
  u71=3.17356640745612912d0*u72
  u72=-2.11571093830408608d0*u56
  u56=(u472+u478)
  u470=u72+u494
  u471=u495+u71
  value=value+(c(79)*(u96*(u89*(u470+u56*u89)+u471)*z))
  u96=u493*((8.37484444552856323d3*u54+u88)*u351+1.86107654345079183d2*&
 &u462)
  u462=-u488*u84
  u84=a3*u441
  u488=+u5*(u458+4.0d0*(u84-1.6d1*u475))
  u458=u83*u80
  u80=2.53885312596490329d0*u458
  u83=a3*u481
  u481=u51*(u55+u83)
  u51=+u482*u97
  u482=+u44*(2.76369866702442587d5*u54+u95*u85)*u61
  u44=u480*(8.38321928997409179d6*u54-6.4d1*u58)*u61
  u480=+u440*(8.98202066782938406d7*u54+u95*(2.5d1*u52+u87))*u61
  u87=2.11571093830408608d-1*u46
  u46=-4.23142187660817215d-1*u75
  u440=u488+u348*(u46*u348+u44)
  u441=u348*(u480+u474)+u481
  u58=u348*(u482+u87*u348)+u96
  u456=(u489+u474)
  u479=u51*u89
  value=value+(c(80)*(x*((u462+u89*(u479+u80))*u477+u89*(u440+u89*(u456&
 &*u89+u441))+u58)))
  u75=-u493*(3.0d0*u84+(9.21232889008141955d4*u54+u95*(5.0d0+pd2))*u351&
 &)
  u351=1.26942656298245165d0*u458
  u458=u473*(2.0d0*(3.0d0*(u83+u48)-1.28d2*u59)+u8)
  u473=+u457*(1.79640413356587681d7*u54+u95*(5.0d0*u52+2.0d0*u486))*u61
  value=value+(c(81)*(u484*((u351+u479)*u477+u89*(u458+u348*(u474+u473)&
 &+(u474+u489)*u89)+u348*(u459+u496)+u75)))
  value=value+(c(82)*(x*(u477*(u440+u80*u89+u477*(u456*u477+u479+u441))&
 &+u462*u89+u58)))
  value=value+(c(83)*(u484*(u477*(u470+u56*u477)+u471)))
  value=value+(c(84)*(x*(u477*(u467+u477*(u82*u477+u468))+u469)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_1=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_2(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_2
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u401
  real(kind=8) :: u402
  real(kind=8) :: u437
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u483
  real(kind=8) :: u486
  real(kind=8) :: u494
  real(kind=8) :: u499
  real(kind=8) :: u500
  real(kind=8) :: u508
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u519
  real(kind=8) :: u52
  real(kind=8) :: u520
  real(kind=8) :: u521
  real(kind=8) :: u522
  real(kind=8) :: u523
  real(kind=8) :: u524
  real(kind=8) :: u525
  real(kind=8) :: u526
  real(kind=8) :: u527
  real(kind=8) :: u528
  real(kind=8) :: u529
  real(kind=8) :: u53
  real(kind=8) :: u530
  real(kind=8) :: u531
  real(kind=8) :: u532
  real(kind=8) :: u533
  real(kind=8) :: u534
  real(kind=8) :: u535
  real(kind=8) :: u536
  real(kind=8) :: u537
  real(kind=8) :: u538
  real(kind=8) :: u539
  real(kind=8) :: u54
  real(kind=8) :: u540
  real(kind=8) :: u541
  real(kind=8) :: u542
  real(kind=8) :: u543
  real(kind=8) :: u544
  real(kind=8) :: u545
  real(kind=8) :: u546
  real(kind=8) :: u547
  real(kind=8) :: u548
  real(kind=8) :: u549
  real(kind=8) :: u55
  real(kind=8) :: u550
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_2=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u57=A4_(p,pd,erfpd,exppd2)
  u94=p**2
  u483=a3**(-3)
  u437=-2.0d0*a3
  u77=1.25d-1*u483*u94*(3.0d0*u57*u94+u437*A2_(p,pd,erfpd,exppd2))
  u85=2.65868077635827404d1*u57
  u93=-7.05236979434695359d-2*u483
  u80=p**4
  u67=exppd2*pd
  u87=-8.0d0*u67
  u9=+u93*(u85+u87)*u80
  u401=x**2
  value=value+(c(1)*((u9*u401+u77)*y))
  if ( lmax .eq. 0 ) return
  u77=A5_(p,pd,erfpd,exppd2)
  u9=u77*u94
  u477=A3_(p,pd,erfpd,exppd2)
  u541=+u437*u477
  u96=u483*p**3
  u402=3.75d-1*u96
  u514=u402*(1.5d1*u9+u541)
  u60=1.86107654345079183d2*u77
  u7=p**5
  u540=exppd2*pd2
  u69=-1.6d1*u540
  u476=(u60+u69)*u7
  u97=+u93*u476
  u522=u97*u401
  value=value+(c(2)*(x*(u522+u514)*y))
  u514=exppd2*u94
  u53=4.0d0*exppd2
  u494=-4.70157986289796906d-3*u96*(7.97604232907482212d1*u9+2.0d0*(1.2&
 &d1*u514-5.0d0*a3*(u53+5.31736155271654808d0*u477)))
  u477=u402*(5.0d0*u9+u541)
  u9=u77*u7
  u541=1.875d0*u483*u9
  u402=y**2
  value=value+(c(3)*((u477+u522)*u402+u541*u401+u494))
  u494=y*z
  value=value+(c(4)*((u522+u477)*u494))
  if ( lmax .eq. 1 ) return
  u541=A6_(p,pd,erfpd,exppd2)
  u477=u541*u94
  u97=+u437*u57
  u57=u483*u80
  u96=-3.75d-1*u57*(1.5d1*u477+u97)
  u80=a3*(-u87-u85)
  u85=1.86107654345079183d2*u541
  u70=-1.6d1*u67
  u548=(u85+u70)
  u71=1.41047395886939072d-1*u57*(3.0d0*u548*u94+u80)
  u76=1.67496888910571265d3*u541
  u546=2.0d0*pd2
  u6=+u70*(9.0d0+u546)
  u525=p**6
  u86=(u76+u6)*u525
  u64=+u93*u86
  u520=u64*u401
  value=value+(c(5)*((u401*(u71+u520)+u96)*y))
  u71=7.05236979434695359d-2*u57
  u437=u67*u94
  u61=u71*(2.0d0*(u80-2.4d1*u437)+5.58322963035237549d2*u477)
  u89=u548*u525
  u513=u483*u89
  u59=7.05236979434695359d-2*u513
  u526=u59*u401
  value=value+(c(6)*(x*((u61+u520)*u402+u526+u96)))
  value=value+(c(7)*(x*(u520+u61)*u494))
  u486=u57*(5.0d0*u477+u97)
  u97=-1.125d0*u486
  u57=u71*(2.0d0*(u80-8.0d0*u437)+1.86107654345079183d2*u477)
  u80=2.11571093830408608d-1*u513
  u71=(u57+u520)
  u477=u71*u402
  value=value+(c(8)*(y*(u477+u80*u401+u97)))
  u97=-3.75d-1*u486
  u486=u526+u97
  value=value+(c(9)*((u477+u486)*z))
  u477=z**2
  value=value+(c(10)*(y*(u71*u477+u486)))
  if ( lmax .eq. 2 ) return
  u64=A7_(p,pd,erfpd,exppd2)
  u59=u64*u94
  u71=a3*u77
  u486=-2.0d0*u71
  u513=u483*u7
  u7=-5.625d0*u513*(3.5d1*u59+u486)
  u80=1.67496888910571265d3*u64
  u75=-3.2d1*u540
  u512=(u80+u75)
  u74=u512*u94
  u500=a3*(-u69-u60)
  u60=1.41047395886939072d-1*u513
  u544=u60*(5.0d0*u74+u500)
  u538=1.84246577801628391d4*u64
  u61=(1.1d1+u546)
  u56=+u75*u61
  u97=(u538+u56)
  u515=p**7
  u511=u97*u515
  u529=u483*u511
  u55=-7.05236979434695359d-2*u529
  u517=u55*u401
  value=value+(c(11)*(x*(u401*(u544+u517)+u7)*y))
  u7=2.65868077635827404d1*u77
  u544=8.0d0*exppd2
  u57=-7.0d0*a3
  u77=+u57*(u544+u7)
  u499=2.01496279838484388d-3*u513*(2.0d0*(1.2d2*u514+u77)+2.7916148151&
 &7618774d3*u59)
  u82=2.1d1*u59
  u58=u513*(u82+u486)
  u95=-1.875d0*u58
  u549=-3.75d0*u513*(u82-u71)
  u82=u60*(3.0d0*u74+u500)
  u74=u512*u515
  u60=u483*u74
  u83=7.05236979434695359d-2*u60
  u527=u83*u401
  value=value+(c(12)*((u95+u401*(u517+u82))*u402+u401*(u549+u527)+u499)&
 &)
  value=value+(c(13)*((u401*(u82+u517)+u95)*u494))
  u499=-5.625d0*u58
  u549=7.05236979434695359d-2*u513
  u82=u540*u94
  u58=u549*(2.0d0*(u500-4.8d1*u82)+5.02490666731713794d3*u59)
  u534=2.11571093830408608d-1*u60
  u475=x*y
  u98=(u58+u517)
  u478=u98*u402
  u528=u534*u401
  value=value+(c(14)*(u475*(u478+u528+u499)))
  u499=u527+u95
  value=value+(c(15)*(x*(u478+u499)*z))
  value=value+(c(16)*(u475*(u98*u477+u499)))
  u98=6.04488839515453165d-3*u513*(2.0d0*(4.0d1*u514+u77)+9.30538271725&
 &395914d2*u59)
  u77=u513*(7.0d0*u59+u486)
  u486=-1.125d1*u77
  u499=1.67496888910571265d3*u59
  u58=-1.6d1*u82
  u59=u549*(2.0d0*(u500+u58)+u499)
  u92=u64*u515
  u500=-3.9375d1*u483*u92
  u547=4.23142187660817215d-1*u60
  value=value+(c(17)*(u402*(u486+u547*u401+(u517+u59)*u402)+u500*u401+u&
 &98))
  u98=-5.625d0*u77
  u486=(u59+u517)
  u500=u528+u98
  value=value+(c(18)*(y*(u486*u402+u500)*z))
  u547=5.58322963035237549d2*u64
  u77=-4.02992559676968777d-3*u513*(-u57*(u7+u544)+5.0d0*(u547-u544)*u9&
 &4)
  u478=a3**(-2)
  u513=3.75d0*u478*u9
  u9=u549*(2.0d0*(2.65868077635827404d1*u71+u58)+u499)
  u499=-1.41047395886939072d-1*u478
  u71=+u499*u476
  u476=-7.05236979434695359d-2*u60
  u60=5.02490666731713794d3*u64
  u58=-2.82094791773878144d-1*u483
  u7=+u69*(6.0d0+pd2)
  u549=+u58*(u60+u7)*u515
  u69=7.05236979434695359d-2*u529
  u529=u69*u401
  value=value+(c(19)*((u513+u71*u402)*u477+u402*(u9+u401*(u529+u549)+(u&
 &529+u476)*u402)+u401*(u83+u476*u401)+u77))
  value=value+(c(20)*(u494*(u486*u477+u500)))
  if ( lmax .eq. 3 ) return
  u59=A8_(p,pd,erfpd,exppd2)
  u513=u59*u94
  u9=a3*u541
  u71=-2.0d0*u9
  u549=u483*u525
  u55=5.625d0*u549*(3.5d1*u513+u71)
  u69=a3*(-u70-u85)
  u476=-2.11571093830408608d-1*u549
  u83=+u476*(2.51245333365856897d4*u513+4.0d0*(u69-1.2d2*u437))
  u534=a3*(-u6-u76)
  u85=7.05236979434695359d-2*u549
  u77=u67*u61
  u541=u77*u94
  u500=u85*(2.0d0*(u534-2.4d2*u541)+2.76369866702442587d5*u513)
  u98=2.39520551142116908d5*u59
  u57=pd2**2
  u517=4.0d0*u57
  u520=(u546+1.1d1)
  u96=-3.2d1*u67
  u529=+u96*(1.3d1*u520+u517)
  u486=(u98+u529)
  u527=p**8
  u525=u486*u527
  u6=u483*u525
  u99=-7.05236979434695359d-2*u6
  u516=u99*u401
  value=value+(c(21)*((u401*(u83+u401*(u516+u500))+u55)*y))
  u83=+u476*(8.37484444552856323d3*u513+2.0d0*(u69-8.0d1*u437))
  u500=1.67496888910571265d3*u59
  u476=(u500+u96)
  u510=u476*u94
  u79=-1.41047395886939072d-1*u549*(u69+5.0d0*u510)
  u526=1.84246577801628391d4*u59
  u528=-3.2d1*u77
  u95=(u526+u528)
  u77=u95*u94
  u518=a3*(-u70*(u546+9.0d0)-u76)
  u76=1.41047395886939072d-1*u549
  u70=u76*(5.0d0*u77+u518)
  u522=u95*u527
  u550=u483*u522
  u88=7.05236979434695359d-2*u550
  u530=u88*u401
  value=value+(c(22)*(x*((u83+u401*(u516+u70))*u402+u401*(u79+u530)+u55&
 &)))
  value=value+(c(23)*(x*(u401*(u70+u516)+u83)*u494))
  u79=u549*(2.1d1*u513+u71)
  u55=5.625d0*u79
  u70=u549*(5.02490666731713794d3*u513+2.0d0*(u69-4.8d1*u437))
  u83=-7.05236979434695359d-2*u70
  u84=u549*(u69+3.0d0*u510)
  u510=-4.23142187660817215d-1*u84
  u51=u76*(3.0d0*u77+u518)
  u77=2.11571093830408608d-1*u550
  u518=(u83+u401*(u516+u51))
  u76=u518*u402
  u531=u77*u401
  value=value+(c(24)*(y*(u76+u401*(u510+u531)+u55)))
  u510=1.875d0*u79
  u79=-1.41047395886939072d-1*u84
  u84=u401*(u79+u530)+u510
  value=value+(c(25)*((u76+u84)*z))
  value=value+(c(26)*(y*(u518*u477+u84)))
  u510=-4.23142187660817215d-1*u70
  u88=5.52739733404885173d4*u513
  u84=-4.8d1*u541
  u51=u85*(2.0d0*(u534+u84)+u88)
  u76=u476*u527
  u83=u483*u76
  u518=-2.11571093830408608d-1*u83
  u539=4.23142187660817215d-1*u550
  u532=u539*u401
  u533=u518*u401
  value=value+(c(27)*(x*(u402*(u510+u532+(u516+u51)*u402)+u533+u55)))
  u510=-2.11571093830408608d-1*u70
  u55=(u51+u516)
  u542=u531+u510
  value=value+(c(28)*(u475*(u55*u402+u542)*z))
  u531=1.86107654345079183d2*u59
  u530=-4.0d0*u67
  u66=4.0d0*(u531+u530)*u94
  u509=-4.23142187660817215d-1*u549
  u79=+u509*(8.86226925452758014d0*u9+u66)
  u65=u478*u89
  u89=1.41047395886939072d-1*u65
  u545=a3*u548
  u548=u85*(2.0d0*(u545+u84)+u88)
  u88=+u499*u86
  u86=-2.11571093830408608d-1*u550
  u84=2.17745955583742644d4*u59
  u68=(1.3d1+u546)
  u508=u67*u68
  u73=7.05236979434695359d-2*u483*(u84-3.2d1*u508)*u527
  u70=+u87*(4.0d0*u520+u57)
  u87=-1.12837916709551257d0*u483*(u526+u70)*u527
  u63=7.05236979434695359d-2*u6
  u6=-7.05236979434695359d-2*u550
  u523=u63*u401
  u52=u401*(u523+u87)
  u524=u88*u402
  value=value+(c(29)*(x*((u89+u524)*u477+u402*(u548+u52+(u523+u86)*u402&
 &)+u401*(u73+u6*u401)+u79)))
  u79=x*u494
  value=value+(c(30)*(u79*(u55*u477+u542)))
  u89=u549*(7.0d0*u513+u71)
  u548=2.8125d1*u89
  u73=u549*(1.67496888910571265d3*u513+2.0d0*(u69-1.6d1*u437))
  u51=-7.05236979434695359d-1*u73
  u69=u85*(2.0d0*(u534-1.6d1*u541)+1.84246577801628391d4*u513)
  u510=-1.05785546915204304d0*u83
  u549=7.05236979434695359d-1*u550
  u71=(u516+u69)
  u541=u71*u402
  value=value+(c(31)*(y*(u402*(u51+u549*u401+u541)+u510*u401+u548)))
  u548=5.625d0*u89
  u51=-4.23142187660817215d-1*u73
  u510=u51+u532
  u550=u533+u548
  value=value+(c(32)*((u402*(u510+u541)+u550)*z))
  u89=+u509*(2.65868077635827404d1*u9+u66)
  u66=4.23142187660817215d-1*u65
  u541=u68*u94
  u533=u67*u541
  u509=u85*(2.0d0*(u545-1.6d1*u533)+2.17745955583742644d4*u513)
  u549=u509+u52
  u65=u401*(u77+u86*u401)+u89
  u9=(u523+u6)
  value=value+(c(33)*(y*((u66+u524)*u477+u402*(u549+u9*u402)+u65)))
  value=value+(c(34)*(z*(u477*(u549+u524+u9*u477)+u66*u402+u65)))
  value=value+(c(35)*(y*(u477*(u510+u71*u477)+u550)))
  if ( lmax .eq. 4 ) return
  u548=A9_(p,pd,erfpd,exppd2)
  u89=u548*u94
  u63=a3*u64
  u87=-2.0d0*u63
  u88=u483*u515
  u86=1.96875d2*u88*(6.3d1*u89+u87)
  u516=a3*(-u75-u80)
  u77=-3.52618489717347679d-1*u88*(3.86917813383419621d5*u89+4.0d0*(u51&
 &6-3.36d2*u82))
  u73=a3*(-u56-u538)
  u518=5.02993157398445508d6*u89
  u66=7.05236979434695359d-2*u88
  u69=u540*u541
  u80=u66*(2.0d0*(u73-6.72d2*u69)+u518)
  u524=(u546+1.3d1)
  u541=(1.5d1*u524+u517)
  u509=p**9
  u549=-6.4d1*u540
  u65=u483*(3.59280826713175363d6*u548+u549*u541)*u509
  u56=-7.05236979434695359d-2*u65
  u515=u56*u401
  value=value+(c(36)*(x*(u401*(u77+u401*(u515+u80))+u86)*y))
  u86=a3*(1.6d1*exppd2+1.86107654345079183d2*u64)
  u77=-9.0d0*u86
  u80=-3.35827133064140647d-3*u88*(5.86239111186999426d4*u89+2.0d0*(5.6&
 &d2*u514+u77))
  u64=u88*(4.5d1*u89+u87)
  u9=3.9375d1*u64
  u71=3.9375d1*u88*(1.35d2*u89-4.0d0*u63)
  u545=2.76369866702442587d5*u89
  u513=-2.11571093830408608d-1*u88
  u52=+u513*(u545+4.0d0*(u516-2.4d2*u82))
  u532=-7.05236979434695359d-2*u88
  u550=+u532*(u545+2.0d0*(u516-4.8d2*u82))
  u85=u66*(2.0d0*(u73-4.8d2*u69)+3.59280826713175363d6*u89)
  u99=(2.39520551142116908d5*u548+u549*u68)
  u510=u483*u99*u509
  u542=7.05236979434695359d-2*u510
  u534=u542*u401
  value=value+(c(37)*((u9+u401*(u401*(u85+u515)+u52))*u402+u401*(u71+u4&
 &01*(u534+u550))+u80))
  value=value+(c(38)*((u401*(u52+u401*(u515+u85))+u9)*u494))
  u80=1.18125d2*u64
  u71=+u513*(9.21232889008141955d4*u89+2.0d0*(u516-1.6d2*u82))
  u550=(1.84246577801628391d4*u548+u549)
  u64=u550*u94
  u85=u88*(u516+5.0d0*u64)
  u83=-4.23142187660817215d-1*u85
  u55=u99*u94
  u99=a3*(-u75*u520-u538)
  u52=1.41047395886939072d-1*u88
  u538=u52*(5.0d0*u55+u99)
  u539=2.11571093830408608d-1*u510
  u6=(u71+u401*(u515+u538))
  u81=u6*u402
  u535=u539*u401
  value=value+(c(39)*(u475*(u81+u401*(u83+u535)+u80)))
  u80=-1.41047395886939072d-1*u85
  u83=u401*(u80+u534)+u9
  value=value+(c(40)*(x*(u81+u83)*z))
  value=value+(c(41)*(u475*(u6*u477+u83)))
  u9=1.17247822237399885d4*u89
  u542=1.12d2*u514
  u514=-1.00748139919242194d-2*u88*(u9+2.0d0*(u542-3.0d0*u86))
  u86=2.7d1*u89
  u538=u88*(u86+u87)
  u81=7.875d1*u538
  u6=2.0d0*(u516-9.6d1*u82)
  u83=5.52739733404885173d4*u89
  u71=u88*(u83+u6)
  u78=-7.05236979434695359d-2*u71
  u90=7.875d1*u88*(u86-u63)
  u86=u88*(u516+3.0d0*u64)
  u64=-8.46284375321634431d-1*u86
  u62=3.0d0*u55
  u55=u52*(u62+u99)
  u72=u483*u550*u509
  u550=-2.11571093830408608d-1*u72
  u54=4.23142187660817215d-1*u510
  u536=u54*u401
  u537=u550*u401
  value=value+(c(42)*(u402*(u81+u401*(u536+u64)+(u401*(u55+u515)+u78)*u&
 &402)+u401*(u90+u537)+u514))
  u514=3.9375d1*u538
  u81=-4.23142187660817215d-1*u86
  u90=(u78+u401*(u515+u55))
  u64=u401*(u81+u535)+u514
  value=value+(c(43)*(y*(u90*u402+u64)*z))
  u8=(1.67496888910571265d3*u548-u53)*u94
  u53=1.34330853225656259d-2*u88*(1.4d1*u8+3.0d0*a3*(u544-u547))
  u523=u66*(u6+u83)
  u6=+u532*(1.05523040013659897d5*u89+2.0d0*(u516-1.92d2*u82))
  u86=4.0d0*pd2
  u544=(2.7d1+u86)
  u535=u544*u94
  u83=u66*(8.0d0*(a3*(-u7-u60)-2.4d1*u540*u535)+1.49239728019318997d6*u&
 &89)
  u60=-1.41047395886939072d-1*u88
  u7=+u60*(u73+u62)
  u62=(1.65821920021465552d5*u548+u549*(9.0d0+pd2))*u94
  u547=u52*(u62+u516)
  u80=u540*(2.1d1*u524+u517)
  u543=+u532*(u518+2.0d0*(u99-3.2d1*u80*u94))
  u99=7.05236979434695359d-2*u65
  u65=-7.05236979434695359d-2*u510
  u518=u99*u401
  value=value+(c(44)*(u402*(u78+u401*(u401*(u543+u518)+u83)+(u401*(u7+u&
 &518)+u523)*u402)+u401*(u6+u401*(u65*u401+u547))+u53))
  value=value+(c(45)*(u494*(u90*u477+u64)))
  u53=1.96875d2*u538
  u523=-7.05236979434695359d-1*u71
  u81=u66*(2.0d0*(u73-9.6d1*u69)+7.18561653426350725d5*u89)
  u83=-1.05785546915204304d0*u72
  u7=7.05236979434695359d-1*u510
  u547=(u515+u81)
  u55=u547*u402
  u538=u7*u401
  u539=u83*u401
  value=value+(c(46)*(u475*(u402*(u523+u538+u55)+u539+u53)))
  u53=-4.23142187660817215d-1*u71
  u523=u53+u536
  u532=u537+u514
  value=value+(c(47)*(x*(u402*(u523+u55)+u532)*z))
  u55=(8.37484444552856323d3*u548+u75)*u94
  u75=-1.26942656298245165d0*u88
  u90=+u75*(6.2035884781693061d1*u63+u55)
  u78=u478*u74
  u74=4.23142187660817215d-1*u78
  u64=a3*u512
  u71=(1.5d1+u546)
  u537=u71*u94
  u546=u540*u537
  u534=u66*(2.0d0*(u64-9.6d1*u546)+8.2910960010732776d5*u89)
  u543=+u499*u511
  u512=-2.11571093830408608d-1*u510
  u536=2.11571093830408608d-1*u483
  u6=u536*(2.76369866702442587d5*u548+u549*u71)*u509
  u85=(5.0d0*u524+u57)
  u540=(1.19760275571058454d6*u548+u549*u85)
  u51=+u58*u540*u509
  u511=u534+u401*(u518+u51)
  u91=u401*(u6+u512*u401)+u90
  u519=(u518+u512)
  u521=u543*u402
  value=value+(c(48)*(u475*((u74+u521)*u477+u402*(u511+u519*u402)+u91))&
 &)
  value=value+(c(49)*(x*z*(u477*(u511+u521+u519*u477)+u74*u402+u91)))
  value=value+(c(50)*(u475*(u477*(u523+u547*u477)+u532)))
  u514=-1.67913566532070324d-2*u88*(u9+2.0d0*(u542+u77))
  u91=u88*(9.0d0*u89+u87)
  u54=5.90625d2*u91
  u6=-3.2d1*u82
  u74=u88*(1.84246577801628391d4*u89+2.0d0*(u516+u6))
  u511=-1.05785546915204304d0*u74
  u9=u66*(2.0d0*(u73-3.2d1*u69)+2.39520551142116908d5*u89)
  u66=1.771875d3*u483*u548*u509
  u547=-3.17356640745612912d0*u72
  u87=1.05785546915204304d0*u510
  value=value+(c(51)*(u402*(u54+u547*u401+u402*((u9+u515)*u402+u87*u401&
 &+u511))+u66*u401+u514))
  u514=1.96875d2*u91
  u54=-7.05236979434695359d-1*u74
  u511=(u515+u9)
  u66=u54+u538
  u547=u539+u514
  value=value+(c(52)*(y*(u402*(u66+u511*u402)+u547)*z))
  u87=6.71654266128281294d-3*u88*(2.8d1*u8-u77)
  u91=-7.875d1*u478*u92
  u542=1.86107654345079183d2*u63
  u77=+u513*(3.51743466712199656d4*u89+4.0d0*(u542+u6))
  u515=8.46284375321634431d-1*u78
  u78=u52*(u62+u64)
  u62=u536*(4.97465760064396656d5*u548+u549*u544)*u509
  u69=+u93*(5.02993157398445508d6*u548-6.4d1*u80)*u509
  u548=2.11571093830408608d-1*u72
  u72=-4.23142187660817215d-1*u510
  u63=u77+u401*(u72*u401+u62)
  u8=u401*(u69+u518)+u78
  u538=u401*(u550+u548*u401)+u87
  u74=(u65+u518)
  value=value+(c(53)*((u91+u402*(u521+u515))*u477+u402*(u63+u402*(u74*u&
 &402+u8))+u538))
  u513=+u75*(u542+u55)
  u75=2.11571093830408608d-1*u88*(2.0d0*(u64-3.2d1*u546)+u545)
  u539=+u60*(a3*u97+2.0d0*u540*u94)
  u540=u99*u402
  value=value+(c(54)*(u494*(u477*(u75+u402*(u540+u539)+(u540+u512)*u477&
 &)+u402*(u75+u512*u402)+u513)))
  value=value+(c(55)*(u477*(u63+u515*u402+u477*(u74*u477+u521+u8))+u91*&
 &u402+u538))
  value=value+(c(56)*(u494*(u477*(u66+u511*u477)+u547)))
  if ( lmax .eq. 5 ) return
  u54=A10_(p,pd,erfpd,exppd2)
  u74=u54*u94
  u73=a3*u59
  u89=-2.0d0*u73
  u539=u483*u527
  u99=-1.96875d2*u539*(6.3d1*u74+u89)
  u87=-6.4d1*u67
  u59=(1.84246577801628391d4*u54+u87)
  u65=u59*u94
  u527=a3*(-u96-u500)
  u60=2.11571093830408608d0*u539
  u62=u60*(1.4d1*u65+3.0d0*u527)
  u550=(2.39520551142116908d5*u54-6.4d1*u508)
  u83=u550*u94
  u521=a3*(-u528-u526)
  u548=-u60*(u521+7.0d0*u83)
  u60=u67*u541
  u8=(3.59280826713175363d6*u54-6.4d1*u60)
  u9=u8*u94
  u518=a3*(-u96*(u517+1.3d1*u61)-u98)
  u97=1.41047395886939072d-1*u539
  u538=u97*(1.4d1*u9+u518)
  u500=(u517+1.5d1*u68)
  u78=pd2**3
  u52=8.0d0*u78
  u77=p**10
  u514=u483*(6.10777405412398116d7*u54+u87*(1.7d1*u500+u52))*u77
  u517=-7.05236979434695359d-2*u514
  u513=u517*u401
  value=value+(c(57)*((u401*(u62+u401*(u401*(u538+u513)+u548))+u99)*y))
  u62=1.05785546915204304d0*u539*(2.0d0*(u527-2.24d2*u437)+1.2897260446&
 &1139874d5*u74)
  u548=3.52618489717347679d-1*u539*(4.0d0*(u527-3.36d2*u437)+3.86917813&
 &383419621d5*u74)
  u515=a3*(-u96*u520-u526)
  u520=5.02993157398445508d6*u74
  u538=-3.52618489717347679d-1*u539
  u72=+u538*(u520+4.0d0*(u515-3.36d2*u533))
  u528=-7.05236979434695359d-2*u539
  u510=+u528*(u520+2.0d0*(u515-6.72d2*u533))
  u520=a3*(-u529-u98)
  u529=u60*u94
  u61=7.05236979434695359d-2*u539
  u60=u61*(2.0d0*(u520-6.72d2*u529)+7.54489736097668261d7*u74)
  u98=u483*u8*u77
  u8=7.05236979434695359d-2*u98
  u541=u8*u401
  value=value+(c(58)*(x*((u62+u401*(u401*(u60+u513)+u72))*u402+u401*(u5&
 &48+u401*(u541+u510))+u99)))
  value=value+(c(59)*(x*(u401*(u72+u401*(u513+u60))+u62)*u494))
  u548=u539*(4.5d1*u74+u89)
  u510=-1.18125d2*u548
  u72=u539*(2.0d0*(u527-1.6d2*u437)+9.21232889008141955d4*u74)
  u60=2.11571093830408608d-1*u72
  u62=2.76369866702442587d5*u74
  u75=u539*(4.0d0*(u527-2.4d2*u437)+u62)
  u64=6.34713281491225823d-1*u75
  u80=3.59280826713175363d6*u74
  u99=-2.11571093830408608d-1*u539
  u69=+u99*(u80+4.0d0*(u515-2.4d2*u533))
  u508=u539*(u80+2.0d0*(u515-4.8d2*u533))
  u63=-2.11571093830408608d-1*u508
  u88=u61*(2.0d0*(u520-4.8d2*u529)+5.38921240069763044d7*u74)
  u540=2.11571093830408608d-1*u98
  u56=(u60+u401*(u401*(u88+u513)+u69))
  u55=u56*u402
  u542=u540*u401
  value=value+(c(60)*(y*(u55+u401*(u64+u401*(u542+u63))+u510)))
  u64=-3.9375d1*u548
  u63=2.11571093830408608d-1*u75
  u548=-7.05236979434695359d-2*u508
  u508=u401*(u63+u401*(u541+u548))+u64
  value=value+(c(61)*((u55+u508)*z))
  value=value+(c(62)*(y*(u56*u477+u508)))
  u64=1.26942656298245165d0*u72
  u75=1.19760275571058454d6*u74
  u69=-1.6d2*u533
  u548=+u99*(u75+2.0d0*(u515+u69))
  u63=4.23142187660817215d-1*u539
  u88=u63*(5.0d0*u65+u527)
  u55=u539*(u521+5.0d0*u83)
  u56=-8.46284375321634431d-1*u55
  u508=5.0d0*u9
  u8=u97*(u508+u518)
  u60=u483*u550*u77
  u550=-2.11571093830408608d-1*u60
  u509=4.23142187660817215d-1*u98
  u543=u509*u401
  u544=u550*u401
  value=value+(c(63)*(x*(u402*(u64+u401*(u543+u56)+(u401*(u8+u513)+u548&
 &)*u402)+u401*(u88+u544)+u510)))
  u64=6.34713281491225823d-1*u72
  u88=-4.23142187660817215d-1*u55
  u56=(u548+u401*(u513+u8))
  u510=u401*(u88+u542)+u64
  value=value+(c(64)*(u475*(u56*u402+u510)*z))
  u549=a3*(-u530-u531)
  u512=u63*(8.0d0*(u549-2.0d1*u437)+4.18742222276428161d4*u74)
  u530=2.11571093830408608d-1*u539
  u494=u530*(2.0d0*(u521+u69)+u75)
  u75=a3*(-u96*u524-u84)
  u531=u67*u535
  u69=+u528*(2.48732880032198328d6*u74+2.0d0*(u75-1.6d2*u531))
  u7=a3*(-u70-u526)
  u6=8.0d0*u57
  u84=u67*(3.3d1*u524+u6)
  u541=u61*(3.2d1*(u7-1.0d1*u84*u94)+3.95208909384492899d7*u74)
  u55=-1.41047395886939072d-1*u539
  u511=+u55*(u520+u508)
  u70=4.0d0*(7.18561653426350725d5*u54+u96*(6.0d0*u524+u57))*u94
  u508=u97*(u70+u515)
  u535=u67*(2.7d1*u500+u52)
  u91=+u528*(9.70058232125573479d7*u74+2.0d0*(u518-3.2d1*u535*u94))
  u57=7.05236979434695359d-2*u514
  u526=-7.05236979434695359d-2*u98
  u514=u57*u401
  value=value+(c(65)*(x*(u402*(u548+u401*(u401*(u91+u514)+u541)+(u401*(&
 &u511+u514)+u494)*u402)+u401*(u69+u401*(u526*u401+u508))+u512)))
  value=value+(c(66)*(u79*(u56*u477+u510)))
  u512=u539*(2.7d1*u74+u89)
  u494=-1.96875d2*u512
  u69=u539*(2.0d0*(u527-9.6d1*u437)+5.52739733404885173d4*u74)
  u541=7.05236979434695359d-1*u69
  u511=7.18561653426350725d5*u74
  u508=-9.6d1*u533
  u91=u539*(u511+2.0d0*(u515+u508))
  u548=-7.05236979434695359d-2*u91
  u88=u539*(3.0d0*u65+u527)
  u65=2.11571093830408608d0*u88
  u56=u539*(u521+3.0d0*u83)
  u83=-1.41047395886939072d0*u56
  u510=3.0d0*u9
  u9=u97*(u510+u518)
  u64=-1.05785546915204304d0*u60
  u8=+u64
  u542=7.05236979434695359d-1*u98
  u72=(u401*(u9+u513)+u548)
  u66=u72*u402
  u545=u542*u401
  u546=u8*u401
  value=value+(c(67)*(y*(u402*(u541+u401*(u545+u83)+u66)+u401*(u65+u546&
 &)+u494)))
  u541=-3.9375d1*u512
  u65=4.23142187660817215d-1*u69
  u83=4.23142187660817215d-1*u88
  u512=-8.46284375321634431d-1*u56
  u92=u65+u401*(u543+u512)
  u68=u401*(u83+u544)+u541
  value=value+(c(68)*((u402*(u92+u66)+u68)*z))
  u66=u63*(8.0d0*(u549-1.2d1*u437)+2.51245333365856897d4*u74)
  u544=u67*u537
  u549=+u528*(8.2910960010732776d5*u74+2.0d0*(u75-9.6d1*u544))
  u88=u61*(2.0d0*(u521+u508)+u511)
  u511=1.38184933351221293d6*u74
  u521=u67*(2.5d1+u86)*u94
  u508=+u99*(u511+2.0d0*(u515-9.6d1*u521))
  u75=u67*(3.5d1*u524+u6)
  u524=u75*u94
  u6=u61*(3.2d1*(u7-6.0d0*u524)+2.51496578699222754d7*u74)
  u7=+u55*(u520+u510)
  u510=(1.19760275571058454d6*u54+u87*u85)*u94
  u85=2.0d0*u510
  u55=u63*(u85+u515)
  u537=u67*(2.5d1*u500+u52)
  u52=-3.2d1*u537*u94
  u86=8.98202066782938406d7*u74
  u67=+u528*(u86+2.0d0*(u518+u52))
  u518=-2.11571093830408608d-1*u98
  u543=u549+u401*(u401*(u67+u514)+u6)
  u547=u518*u401
  u56=u401*(u508+u401*(u547+u55))+u66
  u519=(u401*(u7+u514)+u88)
  value=value+(c(69)*(y*(u402*(u543+u519*u402)+u56)))
  value=value+(c(70)*(z*(u477*(u543+u519*u477)+u56)))
  value=value+(c(71)*(y*(u477*(u92+u72*u477)+u68)))
  u67=3.17356640745612912d0*u69
  u72=-1.05785546915204304d0*u91
  u56=u61*(2.0d0*(u520-9.6d1*u529)+1.07784248013952609d7*u74)
  u83=u483*u59*u77
  u65=1.05785546915204304d0*u83
  u9=-3.17356640745612912d0*u60
  u59=1.05785546915204304d0*u98
  u548=u9*u401
  u549=u59*u401
  u550=u65*u401
  value=value+(c(72)*(x*(u402*(u67+u548+u402*((u56+u513)*u402+u549+u72)&
 &)+u550+u494)))
  u67=1.05785546915204304d0*u69
  u72=-7.05236979434695359d-1*u91
  u494=(u513+u56)
  u508=u72+u545
  u509=u546+u67
  value=value+(c(73)*(u475*(u402*(u508+u494*u402)+u509)*z))
  u545=(8.37484444552856323d3*u54+u96)*u94
  u543=1.26942656298245165d0*u539
  u91=u543*(u545+6.2035884781693061d1*u73)
  u96=u478*u76
  u512=-4.23142187660817215d-1*u96
  u69=a3*u476
  u476=+u99*(u511+4.0d0*(u69-4.8d1*u521))
  u546=u478*u522
  u511=8.46284375321634431d-1*u546
  u478=a3*u95
  u475=u97*(6.0d0*u510+u478)
  u95=+u499*u525
  u510=-2.11571093830408608d-1*u483*(2.76369866702442587d5*u54+u87*u71)&
 &*u77
  u525=u536*(8.38321928997409179d6*u54-6.4d1*u75)*u77
  u541=+u93*(8.98202066782938406d7*u54-6.4d1*u537)*u77
  u71=2.11571093830408608d-1*u60
  u536=-4.23142187660817215d-1*u98
  u499=u476+u401*(u536*u401+u525)
  u537=u401*(u541+u514)+u475
  u522=u401*(u510+u71*u401)+u91
  u55=(u518+u514)
  u519=u95*u402
  value=value+(c(74)*(x*((u512+u402*(u519+u511))*u477+u402*(u499+u402*(&
 &u55*u402+u537))+u522)))
  u92=-u543*(u69+(9.21232889008141955d4*u54+u87*(5.0d0+pd2))*u94)
  u94=4.23142187660817215d-1*u546
  u543=-3.2d1*u529
  u76=u530*(2.0d0*(u478+u543)+u80)
  u68=+u58*(1.79640413356587681d7*u54+u87*(5.0d0*u500+2.0d0*u78))*u77
  value=value+(c(75)*(u79*((u94+u519)*u477+u402*(u76+u401*(u514+u68)+(u&
 &514+u518)*u402)+u401*(u540+u547)+u92)))
  value=value+(c(76)*(x*(u477*(u499+u511*u402+u477*(u55*u477+u519+u537)&
 &)+u512*u402+u522)))
  value=value+(c(77)*(u79*(u477*(u508+u494*u477)+u509)))
  u92=u539*(9.0d0*u74+u89)
  u94=-1.378125d3*u92
  u76=u539*(2.0d0*(u527-3.2d1*u437)+1.84246577801628391d4*u74)
  u68=7.40498828406430127d0*u76
  u475=u539*(2.39520551142116908d5*u74+2.0d0*(u515-3.2d1*u533))
  u476=-1.48099765681286025d0*u475
  u515=u61*(2.0d0*(u520+u543)+u80)
  u510=7.40498828406430127d0*u83
  u511=-7.40498828406430127d0*u60
  u512=1.48099765681286025d0*u98
  u83=(u515+u513)
  u525=u83*u402
  value=value+(c(78)*(y*(u402*(u68+u511*u401+u402*(u525+u512*u401+u476)&
 &)+u510*u401+u94)))
  u513=-1.96875d2*u92
  u68=3.17356640745612912d0*u76
  u76=-1.05785546915204304d0*u475
  u510=u68+u548
  u511=u549+u76
  u512=u550+u513
  value=value+(c(79)*((u402*(u510+u402*(u525+u511))+u512)*z))
  u94=u539*(u545+1.86107654345079183d2*u73)
  u92=2.11571093830408608d0*u94
  u545=-2.11571093830408608d0*u96
  u96=+u538*(4.97465760064396656d5*u74+4.0d0*(u69-1.6d1*u531))
  u531=1.41047395886939072d0*u546
  u546=u97*(u70+u478)
  u70=3.52618489717347679d-1*u483*(7.90417818768985798d6*u54-6.4d1*u84)&
 &*u77
  u84=+u93*(9.70058232125573479d7*u54-6.4d1*u535)*u77
  u535=-u64
  u60=-7.05236979434695359d-1*u98
  u98=u96+u401*(u60*u401+u70)
  u475=u401*(u84+u514)+u546
  u476=u401*(u8+u535*u401)+u92
  u64=(u526+u514)
  value=value+(c(80)*(y*((u545+u402*(u519+u531))*u477+u402*(u98+u402*(u&
 &64*u402+u475))+u476)))
  u93=1.26942656298245165d0*u94
  u94=+u99*(u62+2.0d0*(u69-3.2d1*u544))
  u544=-6.34713281491225823d-1*u539*(4.60616444504070978d5*u74+4.0d0*(u&
 &69-1.6d1*u521))
  u521=u530*(4.0d0*(u478-1.6d1*u524)+8.38321928997409179d6*u74)
  u524=u63*(u85+u478)
  u478=+u528*(u86+2.0d0*(a3*u486+u52))
  u525=u57*u402
  u483=u402*(u478+u525)
  value=value+(c(81)*(z*(u477*(u94+u402*(u483+u521)+(u402*(u536+u525)+u&
 &71)*u477)+u402*(u544+u402*(u518*u402+u524))+u93)))
  value=value+(c(82)*(y*(u477*(u544+u402*(u536*u402+u521)+u477*((u518+u&
 &525)*u477+u483+u524))+u402*(u94+u71*u402)+u93)))
  value=value+(c(83)*(z*(u477*(u98+u531*u402+u477*(u64*u477+u519+u475))&
 &+u545*u402+u476)))
  value=value+(c(84)*(y*(u477*(u510+u477*(u83*u477+u511))+u512)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_2=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_3(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_3
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u401
  real(kind=8) :: u403
  real(kind=8) :: u479
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u49
  real(kind=8) :: u497
  real(kind=8) :: u498
  real(kind=8) :: u499
  real(kind=8) :: u500
  real(kind=8) :: u501
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u519
  real(kind=8) :: u52
  real(kind=8) :: u520
  real(kind=8) :: u521
  real(kind=8) :: u522
  real(kind=8) :: u523
  real(kind=8) :: u524
  real(kind=8) :: u525
  real(kind=8) :: u526
  real(kind=8) :: u527
  real(kind=8) :: u528
  real(kind=8) :: u529
  real(kind=8) :: u53
  real(kind=8) :: u530
  real(kind=8) :: u531
  real(kind=8) :: u532
  real(kind=8) :: u533
  real(kind=8) :: u534
  real(kind=8) :: u535
  real(kind=8) :: u536
  real(kind=8) :: u537
  real(kind=8) :: u538
  real(kind=8) :: u539
  real(kind=8) :: u54
  real(kind=8) :: u540
  real(kind=8) :: u541
  real(kind=8) :: u542
  real(kind=8) :: u543
  real(kind=8) :: u544
  real(kind=8) :: u545
  real(kind=8) :: u546
  real(kind=8) :: u547
  real(kind=8) :: u548
  real(kind=8) :: u549
  real(kind=8) :: u55
  real(kind=8) :: u550
  real(kind=8) :: u551
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_3=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u96=A4_(p,pd,erfpd,exppd2)
  u76=p**2
  u484=a3**(-3)
  u79=-2.0d0*a3
  u94=1.25d-1*u484*u76*(3.0d0*u96*u76+u79*A2_(p,pd,erfpd,exppd2))
  u497=2.65868077635827404d1*u96
  u498=-7.05236979434695359d-2*u484
  u55=p**4
  u91=exppd2*pd
  u77=-8.0d0*u91
  u60=+u498*(u497+u77)*u55
  u401=x**2
  value=value+(c(1)*((u60*u401+u94)*z))
  if ( lmax .eq. 0 ) return
  u94=A5_(p,pd,erfpd,exppd2)
  u60=u94*u76
  u485=A3_(p,pd,erfpd,exppd2)
  u7=+u79*u485
  u403=u484*p**3
  u8=3.75d-1*u403
  u97=u8*(1.5d1*u60+u7)
  u551=1.86107654345079183d2*u94
  u539=p**5
  u540=exppd2*pd2
  u545=-1.6d1*u540
  u51=(u551+u545)*u539
  u57=+u498*u51
  u523=u57*u401
  value=value+(c(2)*(x*(u523+u97)*z))
  u97=u8*(5.0d0*u60+u7)
  u7=y*z
  value=value+(c(3)*((u523+u97)*u7))
  u8=exppd2*u76
  u542=4.0d0*exppd2
  u54=-4.70157986289796906d-3*u403*(7.97604232907482212d1*u60+2.0d0*(1.&
 &2d1*u8-5.0d0*a3*(u542+5.31736155271654808d0*u485)))
  u60=u94*u539
  u485=1.875d0*u484*u60
  u403=z**2
  value=value+(c(4)*((u97+u523)*u403+u485*u401+u54))
  if ( lmax .eq. 1 ) return
  u54=A6_(p,pd,erfpd,exppd2)
  u485=u54*u76
  u97=+u79*u96
  u57=u484*u55
  u96=-3.75d-1*u57*(1.5d1*u485+u97)
  u55=a3*(-u77-u497)
  u497=1.86107654345079183d2*u54
  u79=-1.6d1*u91
  u80=(u497+u79)
  u499=1.41047395886939072d-1*u57*(3.0d0*u80*u76+u55)
  u73=1.67496888910571265d3*u54
  u523=2.0d0*pd2
  u6=+u79*(9.0d0+u523)
  u517=p**6
  u548=(u73+u6)*u517
  u547=+u498*u548
  u521=u547*u401
  value=value+(c(5)*((u401*(u499+u521)+u96)*z))
  u499=7.05236979434695359d-2*u57
  u526=u91*u76
  u61=u499*(2.0d0*(u55-2.4d1*u526)+5.58322963035237549d2*u485)
  value=value+(c(6)*(x*(u521+u61)*u7))
  u65=u80*u517
  u98=u484*u65
  u512=7.05236979434695359d-2*u98
  u527=u512*u401
  value=value+(c(7)*(x*((u61+u521)*u403+u527+u96)))
  u510=u57*(5.0d0*u485+u97)
  u97=-3.75d-1*u510
  u57=u499*(2.0d0*(u55-8.0d0*u526)+1.86107654345079183d2*u485)
  u61=y**2
  u485=(u57+u521)
  u499=u527+u97
  value=value+(c(8)*((u485*u61+u499)*z))
  u55=u485*u403
  value=value+(c(9)*(y*(u55+u499)))
  u512=-1.125d0*u510
  u510=2.11571093830408608d-1*u98
  value=value+(c(10)*(z*(u55+u510*u401+u512)))
  if ( lmax .eq. 2 ) return
  u512=A7_(p,pd,erfpd,exppd2)
  u510=u512*u76
  u547=a3*u94
  u98=-2.0d0*u547
  u499=u484*u539
  u539=-5.625d0*u499*(3.5d1*u510+u98)
  u55=1.67496888910571265d3*u512
  u550=-3.2d1*u540
  u544=(u55+u550)
  u85=u544*u76
  u485=a3*(-u545-u551)
  u551=1.41047395886939072d-1*u499
  u538=u551*(5.0d0*u85+u485)
  u513=1.84246577801628391d4*u512
  u97=(1.1d1+u523)
  u67=+u550*u97
  u66=(u513+u67)
  u516=p**7
  u514=u66*u516
  u530=u484*u514
  u63=-7.05236979434695359d-2*u530
  u518=u63*u401
  value=value+(c(11)*(x*(u401*(u538+u518)+u539)*z))
  u539=2.1d1*u510
  u538=u499*(u539+u98)
  u95=-1.875d0*u538
  u82=u551*(3.0d0*u85+u485)
  value=value+(c(12)*((u401*(u82+u518)+u95)*u7))
  u85=2.65868077635827404d1*u94
  u94=8.0d0*exppd2
  u551=-7.0d0*a3
  u532=+u551*(u94+u85)
  u543=2.01496279838484388d-3*u499*(2.0d0*(1.2d2*u8+u532)+2.79161481517&
 &618774d3*u510)
  u58=-3.75d0*u499*(u539-u547)
  u539=u544*u516
  u535=u484*u539
  u49=7.05236979434695359d-2*u535
  u528=u49*u401
  value=value+(c(13)*((u95+u401*(u518+u82))*u403+u401*(u58+u528)+u543))
  u543=7.05236979434695359d-2*u499
  u82=u540*u76
  u58=u543*(2.0d0*(u485-4.8d1*u82)+5.02490666731713794d3*u510)
  u93=(u58+u518)
  u500=u528+u95
  value=value+(c(14)*(x*(u93*u61+u500)*z))
  u96=x*y
  u479=u93*u403
  value=value+(c(15)*(u96*(u479+u500)))
  u93=-5.625d0*u538
  u538=2.11571093830408608d-1*u535
  u69=x*z
  u529=u538*u401
  value=value+(c(16)*(u69*(u479+u529+u93)))
  u93=u499*(7.0d0*u510+u98)
  u98=-5.625d0*u93
  u479=1.67496888910571265d3*u510
  u58=-1.6d1*u82
  u59=u543*(2.0d0*(u485+u58)+u479)
  u485=(u59+u518)
  u501=u529+u98
  value=value+(c(17)*(y*(u485*u61+u501)*z))
  u511=5.58322963035237549d2*u512
  u528=-4.02992559676968777d-3*u499*(-u551*(u85+u94)+5.0d0*(u511-u94)*u&
 &76)
  u95=a3**(-2)
  u85=3.75d0*u95*u60
  u60=u543*(2.0d0*(2.65868077635827404d1*u547+u58)+u479)
  u479=-1.41047395886939072d-1*u95
  u547=+u479*u51
  u500=-7.05236979434695359d-2*u535
  u543=5.02490666731713794d3*u512
  u58=-2.82094791773878144d-1*u484
  u551=+u545*(6.0d0+pd2)
  u545=+u58*(u543+u551)*u516
  u51=7.05236979434695359d-2*u530
  u530=u51*u401
  value=value+(c(18)*((u85+u547*u61)*u403+u61*(u60+u401*(u530+u545)+(u5&
 &30+u500)*u61)+u401*(u49+u500*u401)+u528))
  value=value+(c(19)*(u7*(u485*u403+u501)))
  u51=6.04488839515453165d-3*u499*(2.0d0*(4.0d1*u8+u532)+9.305382717253&
 &95914d2*u510)
  u85=-1.125d1*u93
  u60=u512*u516
  u530=-3.9375d1*u484*u60
  u547=4.23142187660817215d-1*u535
  value=value+(c(20)*(u403*(u85+u547*u401+(u518+u59)*u403)+u530*u401+u5&
 &1))
  if ( lmax .eq. 3 ) return
  u530=A8_(p,pd,erfpd,exppd2)
  u85=u530*u76
  u547=a3*u54
  u545=-2.0d0*u547
  u93=u484*u517
  u63=5.625d0*u93*(3.5d1*u85+u545)
  u51=a3*(-u79-u497)
  u500=-2.11571093830408608d-1*u93
  u49=+u500*(2.51245333365856897d4*u85+4.0d0*(u51-1.2d2*u526))
  u538=a3*(-u6-u73)
  u535=7.05236979434695359d-2*u93
  u532=u91*u97
  u510=u532*u76
  u98=u535*(2.0d0*(u538-2.4d2*u510)+2.76369866702442587d5*u85)
  u497=2.39520551142116908d5*u530
  u528=pd2**2
  u529=4.0d0*u528
  u499=(u523+1.1d1)
  u485=-3.2d1*u91
  u501=+u485*(1.3d1*u499+u529)
  u518=(u497+u501)
  u546=p**8
  u521=u518*u546
  u54=u484*u521
  u99=-7.05236979434695359d-2*u54
  u517=u99*u401
  value=value+(c(21)*((u401*(u49+u401*(u517+u98))+u63)*z))
  u49=+u500*(8.37484444552856323d3*u85+2.0d0*(u51-8.0d1*u526))
  u98=1.84246577801628391d4*u530
  u6=-3.2d1*u532
  u500=(u98+u6)
  u532=u500*u76
  u533=a3*(-u79*(u523+9.0d0)-u73)
  u73=1.41047395886939072d-1*u93
  u70=u73*(5.0d0*u532+u533)
  value=value+(c(22)*(x*(u401*(u70+u517)+u49)*u7))
  u59=1.67496888910571265d3*u530
  u527=(u59+u485)
  u79=u527*u76
  u81=-1.41047395886939072d-1*u93*(u51+5.0d0*u79)
  u57=u500*u546
  u519=u484*u57
  u549=7.05236979434695359d-2*u519
  u531=u549*u401
  value=value+(c(23)*(x*((u49+u401*(u517+u70))*u403+u401*(u81+u531)+u63&
 &)))
  u81=u93*(2.1d1*u85+u545)
  u63=1.875d0*u81
  u70=u93*(5.02490666731713794d3*u85+2.0d0*(u51-4.8d1*u526))
  u534=-7.05236979434695359d-2*u70
  u84=u93*(u51+3.0d0*u79)
  u79=-1.41047395886939072d-1*u84
  u74=u73*(3.0d0*u532+u533)
  u532=(u534+u401*(u517+u74))
  u533=u401*(u79+u531)+u63
  value=value+(c(24)*((u532*u61+u533)*z))
  u73=u532*u403
  value=value+(c(25)*(y*(u73+u533)))
  u63=5.625d0*u81
  u81=-4.23142187660817215d-1*u84
  u549=2.11571093830408608d-1*u519
  u532=u549*u401
  value=value+(c(26)*(z*(u73+u401*(u81+u532)+u63)))
  u81=-2.11571093830408608d-1*u70
  u74=5.52739733404885173d4*u85
  u531=-4.8d1*u510
  u73=u535*(2.0d0*(u538+u531)+u74)
  u533=(u73+u517)
  u534=u532+u81
  value=value+(c(27)*(u96*(u533*u61+u534)*z))
  u532=1.86107654345079183d2*u530
  u79=-4.0d0*u91
  u90=4.0d0*(u532+u79)*u76
  u68=-4.23142187660817215d-1*u93
  u49=+u68*(8.86226925452758014d0*u547+u90)
  u92=u95*u65
  u65=1.41047395886939072d-1*u92
  u52=a3*u80
  u80=u535*(2.0d0*(u52+u531)+u74)
  u74=+u479*u548
  u548=-2.11571093830408608d-1*u519
  u531=2.17745955583742644d4*u530
  u520=(1.3d1+u523)
  u88=u91*u520
  u515=7.05236979434695359d-2*u484*(u531-3.2d1*u88)*u546
  u84=+u77*(4.0d0*u499+u528)
  u77=-1.12837916709551257d0*u484*(u98+u84)*u546
  u86=7.05236979434695359d-2*u54
  u54=-7.05236979434695359d-2*u519
  u524=u86*u401
  u537=u401*(u524+u77)
  u525=u74*u61
  value=value+(c(28)*(x*((u65+u525)*u403+u61*(u80+u537+(u524+u548)*u61)&
 &+u401*(u515+u54*u401)+u49)))
  u49=x*u7
  value=value+(c(29)*(u49*(u533*u403+u534)))
  u65=-4.23142187660817215d-1*u70
  u70=u527*u546
  u515=u484*u70
  u80=-2.11571093830408608d-1*u515
  u81=4.23142187660817215d-1*u519
  u533=u81*u401
  u534=u80*u401
  value=value+(c(30)*(x*(u403*(u65+u533+(u517+u73)*u403)+u534+u63)))
  u65=u93*(7.0d0*u85+u545)
  u63=5.625d0*u65
  u73=u93*(1.67496888910571265d3*u85+2.0d0*(u51-1.6d1*u526))
  u51=-4.23142187660817215d-1*u73
  u545=u535*(2.0d0*(u538-1.6d1*u510)+1.84246577801628391d4*u85)
  u538=(u517+u545)
  u510=u51+u533
  u93=u534+u63
  value=value+(c(31)*((u61*(u510+u538*u61)+u93)*z))
  u89=+u68*(2.65868077635827404d1*u547+u90)
  u533=4.23142187660817215d-1*u92
  u68=u520*u76
  u534=u91*u68
  u547=u535*(2.0d0*(u52-1.6d1*u534)+2.17745955583742644d4*u85)
  u92=u547+u537
  u52=u401*(u549+u548*u401)+u89
  u85=(u524+u54)
  value=value+(c(32)*(y*((u533+u525)*u403+u61*(u92+u85*u61)+u52)))
  value=value+(c(33)*(z*(u403*(u92+u525+u85*u403)+u533*u61+u52)))
  u548=u538*u403
  value=value+(c(34)*(y*(u403*(u510+u548)+u93)))
  u63=2.8125d1*u65
  u65=-7.05236979434695359d-1*u73
  u77=-1.05785546915204304d0*u515
  u74=7.05236979434695359d-1*u519
  value=value+(c(35)*(z*(u403*(u65+u74*u401+u548)+u77*u401+u63)))
  if ( lmax .eq. 4 ) return
  u63=A9_(p,pd,erfpd,exppd2)
  u65=u63*u76
  u77=a3*u512
  u74=-2.0d0*u77
  u525=u484*u516
  u548=1.96875d2*u525*(6.3d1*u65+u74)
  u54=a3*(-u550-u55)
  u549=-3.52618489717347679d-1*u525*(3.86917813383419621d5*u65+4.0d0*(u&
 &54-3.36d2*u82))
  u51=a3*(-u67-u513)
  u519=5.02993157398445508d6*u65
  u533=7.05236979434695359d-2*u525
  u517=u540*u68
  u515=u533*(2.0d0*(u51-6.72d2*u517)+u519)
  u73=(u523+1.3d1)
  u55=(1.5d1*u73+u529)
  u547=p**9
  u68=-6.4d1*u540
  u92=u484*(3.59280826713175363d6*u63+u68*u55)*u547
  u67=-7.05236979434695359d-2*u92
  u516=u67*u401
  value=value+(c(36)*(x*(u401*(u549+u401*(u516+u515))+u548)*z))
  u548=u525*(4.5d1*u65+u74)
  u549=3.9375d1*u548
  u515=2.76369866702442587d5*u65
  u545=-2.11571093830408608d-1*u525
  u52=+u545*(u515+4.0d0*(u54-2.4d2*u82))
  u85=u533*(2.0d0*(u51-4.8d2*u517)+3.59280826713175363d6*u65)
  value=value+(c(37)*((u401*(u52+u401*(u516+u85))+u549)*u7))
  u537=a3*(1.6d1*exppd2+1.86107654345079183d2*u512)
  u512=-9.0d0*u537
  u86=-3.35827133064140647d-3*u525*(5.86239111186999426d4*u65+2.0d0*(5.&
 &6d2*u8+u512))
  u538=3.9375d1*u525*(1.35d2*u65-4.0d0*u77)
  u524=-7.05236979434695359d-2*u525
  u81=+u524*(u515+2.0d0*(u54-4.8d2*u82))
  u99=(2.39520551142116908d5*u63+u68*u520)
  u510=u484*u99*u547
  u93=7.05236979434695359d-2*u510
  u535=u93*u401
  value=value+(c(38)*((u549+u401*(u401*(u85+u516)+u52))*u403+u401*(u538&
 &+u401*(u535+u81))+u86))
  u86=+u545*(9.21232889008141955d4*u65+2.0d0*(u54-1.6d2*u82))
  u538=(1.84246577801628391d4*u63+u68)
  u81=u538*u76
  u85=u525*(u54+5.0d0*u81)
  u80=-1.41047395886939072d-1*u85
  u90=u99*u76
  u99=a3*(-u550*u499-u513)
  u513=1.41047395886939072d-1*u525
  u72=u513*(5.0d0*u90+u99)
  u536=(u86+u401*(u516+u72))
  u71=u401*(u80+u535)+u549
  value=value+(c(39)*(x*(u536*u61+u71)*z))
  u53=u536*u403
  value=value+(c(40)*(u96*(u53+u71)))
  u549=1.18125d2*u548
  u52=-4.23142187660817215d-1*u85
  u93=2.11571093830408608d-1*u510
  u536=u93*u401
  value=value+(c(41)*(u69*(u53+u401*(u52+u536)+u549)))
  u549=2.7d1*u65
  u52=u525*(u549+u74)
  u72=3.9375d1*u52
  u53=2.0d0*(u54-9.6d1*u82)
  u85=5.52739733404885173d4*u65
  u71=u525*(u85+u53)
  u535=-7.05236979434695359d-2*u71
  u86=u525*(u54+3.0d0*u81)
  u81=-4.23142187660817215d-1*u86
  u548=3.0d0*u90
  u90=u513*(u548+u99)
  u78=(u535+u401*(u516+u90))
  u83=u401*(u81+u536)+u72
  value=value+(c(42)*(y*(u78*u61+u83)*z))
  u75=(1.67496888910571265d3*u63-u542)*u76
  u542=1.34330853225656259d-2*u525*(1.4d1*u75+3.0d0*a3*(u94-u511))
  u511=u533*(u53+u85)
  u53=+u524*(1.05523040013659897d5*u65+2.0d0*(u54-1.92d2*u82))
  u85=4.0d0*pd2
  u94=(2.7d1+u85)
  u536=u94*u76
  u56=u533*(8.0d0*(a3*(-u551-u543)-2.4d1*u540*u536)+1.49239728019318997&
 &d6*u65)
  u543=-1.41047395886939072d-1*u525
  u551=+u543*(u51+u548)
  u548=(1.65821920021465552d5*u63+u68*(9.0d0+pd2))*u76
  u89=u513*(u548+u54)
  u509=u540*(2.1d1*u73+u529)
  u9=+u524*(u519+2.0d0*(u99-3.2d1*u509*u76))
  u99=7.05236979434695359d-2*u92
  u92=-7.05236979434695359d-2*u510
  u519=u99*u401
  value=value+(c(43)*(u61*(u535+u401*(u401*(u9+u519)+u56)+(u401*(u551+u&
 &519)+u511)*u61)+u401*(u53+u401*(u92*u401+u89))+u542))
  value=value+(c(44)*(u7*(u78*u403+u83)))
  u542=1.17247822237399885d4*u65
  u511=1.12d2*u8
  u53=-1.00748139919242194d-2*u525*(u542+2.0d0*(u511-3.0d0*u537))
  u56=7.875d1*u52
  u551=7.875d1*u525*(u549-u77)
  u89=-8.46284375321634431d-1*u86
  u9=u484*u538*u547
  u93=-2.11571093830408608d-1*u9
  u549=4.23142187660817215d-1*u510
  u537=u549*u401
  u538=u93*u401
  value=value+(c(45)*(u403*(u56+u401*(u537+u89)+(u401*(u90+u516)+u535)*&
 &u403)+u401*(u551+u538)+u53))
  u53=-4.23142187660817215d-1*u71
  u56=u533*(2.0d0*(u51-9.6d1*u517)+7.18561653426350725d5*u65)
  u551=(u516+u56)
  u89=u53+u537
  u524=u538+u72
  value=value+(c(46)*(x*(u61*(u89+u551*u61)+u524)*z))
  u8=(8.37484444552856323d3*u63+u550)*u76
  u550=-1.26942656298245165d0*u525
  u90=+u550*(6.2035884781693061d1*u77+u8)
  u78=u95*u539
  u539=4.23142187660817215d-1*u78
  u535=a3*u544
  u538=(1.5d1+u523)
  u523=u538*u76
  u544=u540*u523
  u540=u533*(2.0d0*(u535-9.6d1*u544)+8.2910960010732776d5*u65)
  u83=+u479*u514
  u514=-2.11571093830408608d-1*u510
  u537=2.11571093830408608d-1*u484
  u62=u537*(2.76369866702442587d5*u63+u68*u538)*u547
  u86=(5.0d0*u73+u528)
  u541=(1.19760275571058454d6*u63+u68*u86)
  u64=+u58*u541*u547
  u87=u540+u401*(u519+u64)
  u80=u401*(u62+u514*u401)+u90
  u81=(u519+u514)
  u522=u83*u61
  value=value+(c(47)*(u96*((u539+u522)*u403+u61*(u87+u81*u61)+u80)))
  value=value+(c(48)*(u69*(u403*(u87+u522+u81*u403)+u539*u61+u80)))
  u87=u551*u403
  value=value+(c(49)*(u96*(u403*(u89+u87)+u524)))
  u72=1.96875d2*u52
  u551=-7.05236979434695359d-1*u71
  u549=-1.05785546915204304d0*u9
  u62=7.05236979434695359d-1*u510
  u539=u62*u401
  u540=u549*u401
  value=value+(c(50)*(u69*(u403*(u551+u539+u87)+u540+u72)))
  u72=u525*(9.0d0*u65+u74)
  u71=1.96875d2*u72
  u56=-3.2d1*u82
  u74=u525*(1.84246577801628391d4*u65+2.0d0*(u54+u56))
  u54=-7.05236979434695359d-1*u74
  u69=u533*(2.0d0*(u51-3.2d1*u517)+2.39520551142116908d5*u65)
  u551=(u516+u69)
  u82=u54+u539
  u539=u540+u71
  value=value+(c(51)*(y*(u61*(u82+u551*u61)+u539)*z))
  u87=6.71654266128281294d-3*u525*(2.8d1*u75-u512)
  u75=-7.875d1*u95*u60
  u60=1.86107654345079183d2*u77
  u77=+u545*(3.51743466712199656d4*u65+4.0d0*(u60+u56))
  u65=8.46284375321634431d-1*u78
  u78=u513*(u548+u535)
  u548=u537*(4.97465760064396656d5*u63+u68*u94)*u547
  u513=+u498*(5.02993157398445508d6*u63-6.4d1*u509)*u547
  u509=2.11571093830408608d-1*u9
  u545=-4.23142187660817215d-1*u510
  u56=u77+u401*(u545*u401+u548)
  u94=u401*(u513+u519)+u78
  u68=u401*(u93+u509*u401)+u87
  u540=(u92+u519)
  value=value+(c(52)*((u75+u61*(u522+u65))*u403+u61*(u56+u61*(u540*u61+&
 &u94))+u68))
  u64=+u550*(u60+u8)
  u60=2.11571093830408608d-1*u525*(2.0d0*(u535-3.2d1*u544)+u515)
  u515=+u543*(a3*u66+2.0d0*u541*u76)
  u541=u99*u61
  value=value+(c(53)*(u7*(u403*(u60+u61*(u541+u515)+(u541+u514)*u403)+u&
 &61*(u60+u514*u61)+u64)))
  value=value+(c(54)*(u403*(u56+u65*u61+u403*(u540*u403+u522+u94))+u75*&
 &u61+u68))
  value=value+(c(55)*(u7*(u403*(u82+u551*u403)+u539)))
  u548=-1.67913566532070324d-2*u525*(u542+2.0d0*(u511+u512))
  u83=5.90625d2*u72
  u62=-1.05785546915204304d0*u74
  u78=1.771875d3*u484*u63*u547
  u74=-3.17356640745612912d0*u9
  u99=1.05785546915204304d0*u510
  value=value+(c(56)*(u403*(u83+u74*u401+u403*((u69+u516)*u403+u99*u401&
 &+u62))+u78*u401+u548))
  if ( lmax .eq. 5 ) return
  u74=A10_(p,pd,erfpd,exppd2)
  u516=u74*u76
  u78=a3*u530
  u71=-2.0d0*u78
  u535=u484*u546
  u99=-1.96875d2*u535*(6.3d1*u516+u71)
  u541=-6.4d1*u91
  u530=(1.84246577801628391d4*u74+u541)
  u83=u530*u76
  u540=a3*(-u485-u59)
  u60=2.11571093830408608d0*u535
  u62=u60*(1.4d1*u83+3.0d0*u540)
  u548=(2.39520551142116908d5*u74-6.4d1*u88)
  u510=u548*u76
  u93=a3*(-u6-u98)
  u59=-u60*(u93+7.0d0*u510)
  u60=u91*u55
  u509=(3.59280826713175363d6*u74-6.4d1*u60)
  u9=u509*u76
  u546=a3*(-u485*(u529+1.3d1*u97)-u497)
  u97=1.41047395886939072d-1*u535
  u542=u97*(1.4d1*u9+u546)
  u522=(u529+1.5d1*u520)
  u87=pd2**3
  u512=8.0d0*u87
  u54=p**10
  u515=u484*(6.10777405412398116d7*u74+u541*(1.7d1*u522+u512))*u54
  u529=-7.05236979434695359d-2*u515
  u514=u529*u401
  value=value+(c(57)*((u401*(u62+u401*(u401*(u542+u514)+u59))+u99)*z))
  u62=1.05785546915204304d0*u535*(2.0d0*(u540-2.24d2*u526)+1.2897260446&
 &1139874d5*u516)
  u519=a3*(-u485*u499-u98)
  u542=5.02993157398445508d6*u516
  u59=-3.52618489717347679d-1*u535
  u72=+u59*(u542+4.0d0*(u519-3.36d2*u534))
  u499=a3*(-u501-u497)
  u539=u60*u76
  u501=7.05236979434695359d-2*u535
  u60=u501*(2.0d0*(u499-6.72d2*u539)+7.54489736097668261d7*u516)
  value=value+(c(58)*(x*(u401*(u72+u401*(u514+u60))+u62)*u7))
  u64=3.52618489717347679d-1*u535*(4.0d0*(u540-3.36d2*u526)+3.869178133&
 &83419621d5*u516)
  u77=-7.05236979434695359d-2*u535
  u65=+u77*(u542+2.0d0*(u519-6.72d2*u534))
  u82=u484*u509*u54
  u509=7.05236979434695359d-2*u82
  u542=u509*u401
  value=value+(c(59)*(x*((u62+u401*(u401*(u60+u514)+u72))*u403+u401*(u6&
 &4+u401*(u542+u65))+u99)))
  u64=u535*(4.5d1*u516+u71)
  u65=-3.9375d1*u64
  u72=u535*(2.0d0*(u540-1.6d2*u526)+9.21232889008141955d4*u516)
  u60=2.11571093830408608d-1*u72
  u62=2.76369866702442587d5*u516
  u75=u535*(4.0d0*(u540-2.4d2*u526)+u62)
  u63=2.11571093830408608d-1*u75
  u525=3.59280826713175363d6*u516
  u99=-2.11571093830408608d-1*u535
  u69=+u99*(u525+4.0d0*(u519-2.4d2*u534))
  u55=u535*(u525+2.0d0*(u519-4.8d2*u534))
  u543=-7.05236979434695359d-2*u55
  u550=u501*(2.0d0*(u499-4.8d2*u539)+5.38921240069763044d7*u516)
  u511=(u60+u401*(u401*(u550+u514)+u69))
  u8=u401*(u63+u401*(u542+u543))+u65
  value=value+(c(60)*((u511*u61+u8)*z))
  u94=u511*u403
  value=value+(c(61)*(y*(u94+u8)))
  u65=-1.18125d2*u64
  u64=6.34713281491225823d-1*u75
  u509=-2.11571093830408608d-1*u55
  u75=2.11571093830408608d-1*u82
  u543=u75*u401
  value=value+(c(62)*(z*(u94+u401*(u64+u401*(u543+u509))+u65)))
  u64=6.34713281491225823d-1*u72
  u509=1.19760275571058454d6*u516
  u69=-1.6d2*u534
  u550=+u99*(u509+2.0d0*(u519+u69))
  u55=u535*(u93+5.0d0*u510)
  u94=-4.23142187660817215d-1*u55
  u511=5.0d0*u9
  u8=u97*(u511+u546)
  u88=(u550+u401*(u514+u8))
  u56=u401*(u94+u543)+u64
  value=value+(c(63)*(u96*(u88*u61+u56)*z))
  u547=a3*(-u79-u532)
  u79=4.23142187660817215d-1*u535
  u92=u79*(8.0d0*(u547-2.0d1*u526)+4.18742222276428161d4*u516)
  u532=2.11571093830408608d-1*u535
  u67=u532*(2.0d0*(u93+u69)+u509)
  u509=a3*(-u485*u73-u531)
  u543=u91*u536
  u69=+u77*(2.48732880032198328d6*u516+2.0d0*(u509-1.6d2*u543))
  u7=a3*(-u84-u98)
  u6=8.0d0*u528
  u531=u91*(3.3d1*u73+u6)
  u545=u501*(3.2d1*(u7-1.0d1*u531*u76)+3.95208909384492899d7*u516)
  u513=-1.41047395886939072d-1*u535
  u549=+u513*(u499+u511)
  u84=4.0d0*(7.18561653426350725d5*u74+u485*(6.0d0*u73+u528))*u76
  u511=u97*(u84+u519)
  u536=u91*(2.7d1*u522+u512)
  u544=+u77*(9.70058232125573479d7*u516+2.0d0*(u546-3.2d1*u536*u76))
  u528=7.05236979434695359d-2*u515
  u98=-7.05236979434695359d-2*u82
  u515=u528*u401
  value=value+(c(64)*(x*(u61*(u550+u401*(u401*(u544+u515)+u545)+(u401*(&
 &u549+u515)+u67)*u61)+u401*(u69+u401*(u98*u401+u511))+u92)))
  value=value+(c(65)*(u49*(u88*u403+u56)))
  u92=1.26942656298245165d0*u72
  u67=u79*(5.0d0*u83+u540)
  u69=-8.46284375321634431d-1*u55
  u55=u484*u548*u54
  u549=-2.11571093830408608d-1*u55
  u511=4.23142187660817215d-1*u82
  u544=u511*u401
  u545=u549*u401
  value=value+(c(66)*(x*(u403*(u92+u401*(u544+u69)+(u401*(u8+u514)+u550&
 &)*u403)+u401*(u67+u545)+u65)))
  u92=u535*(2.7d1*u516+u71)
  u67=-3.9375d1*u92
  u69=u535*(2.0d0*(u540-9.6d1*u526)+5.52739733404885173d4*u516)
  u65=4.23142187660817215d-1*u69
  u550=7.18561653426350725d5*u516
  u548=-9.6d1*u534
  u8=u535*(u550+2.0d0*(u519+u548))
  u64=-7.05236979434695359d-2*u8
  u88=u535*(3.0d0*u83+u540)
  u83=4.23142187660817215d-1*u88
  u56=u535*(u93+3.0d0*u510)
  u510=-8.46284375321634431d-1*u56
  u94=3.0d0*u9
  u9=u97*(u94+u546)
  u68=(u401*(u9+u514)+u64)
  u60=u65+u401*(u544+u510)
  u520=u401*(u83+u545)+u67
  value=value+(c(67)*((u61*(u60+u68*u61)+u520)*z))
  u66=u79*(8.0d0*(u547-1.2d1*u526)+2.51245333365856897d4*u516)
  u545=u91*u523
  u547=+u77*(8.2910960010732776d5*u516+2.0d0*(u509-9.6d1*u545))
  u509=u501*(2.0d0*(u93+u548)+u550)
  u93=1.38184933351221293d6*u516
  u523=u91*(2.5d1+u85)*u76
  u548=+u99*(u93+2.0d0*(u519-9.6d1*u523))
  u550=u91*(3.5d1*u73+u6)
  u85=u550*u76
  u6=u501*(3.2d1*(u7-6.0d0*u85)+2.51496578699222754d7*u516)
  u7=+u513*(u499+u94)
  u94=(1.19760275571058454d6*u74+u541*u86)*u76
  u86=2.0d0*u94
  u513=u79*(u86+u519)
  u72=u91*(2.5d1*u522+u512)
  u73=-3.2d1*u72*u76
  u544=8.98202066782938406d7*u516
  u512=+u77*(u544+2.0d0*(u546+u73))
  u63=-2.11571093830408608d-1*u82
  u91=u547+u401*(u401*(u512+u515)+u6)
  u546=u63*u401
  u497=u401*(u548+u401*(u546+u513))+u66
  u551=(u401*(u7+u515)+u509)
  value=value+(c(68)*(y*(u61*(u91+u551*u61)+u497)))
  value=value+(c(69)*(z*(u403*(u91+u551*u403)+u497)))
  u509=u68*u403
  value=value+(c(70)*(y*(u403*(u60+u509)+u520)))
  u65=-1.96875d2*u92
  u67=7.05236979434695359d-1*u69
  u513=2.11571093830408608d0*u88
  u92=-1.41047395886939072d0*u56
  u88=-1.05785546915204304d0*u55
  u56=+u88
  u549=7.05236979434695359d-1*u82
  u547=u549*u401
  u548=u56*u401
  value=value+(c(71)*(z*(u403*(u67+u401*(u547+u92)+u509)+u401*(u513+u54&
 &8)+u65)))
  u67=1.05785546915204304d0*u69
  u513=-7.05236979434695359d-1*u8
  u92=u501*(2.0d0*(u499-9.6d1*u539)+1.07784248013952609d7*u516)
  u83=(u514+u92)
  u509=u513+u547
  u510=u548+u67
  value=value+(c(72)*(u96*(u61*(u509+u83*u61)+u510)*z))
  u96=(8.37484444552856323d3*u74+u485)*u76
  u547=1.26942656298245165d0*u535
  u91=u547*(u96+6.2035884781693061d1*u78)
  u485=u95*u70
  u497=-4.23142187660817215d-1*u485
  u70=a3*u527
  u548=+u99*(u93+4.0d0*(u70-4.8d1*u523))
  u527=u95*u57
  u93=8.46284375321634431d-1*u527
  u57=a3*u500
  u95=u97*(6.0d0*u94+u57)
  u500=+u479*u521
  u94=-2.11571093830408608d-1*u484*(2.76369866702442587d5*u74+u541*u538&
 &)*u54
  u551=u537*(8.38321928997409179d6*u74-6.4d1*u550)*u54
  u550=+u498*(8.98202066782938406d7*u74-6.4d1*u72)*u54
  u538=2.11571093830408608d-1*u55
  u537=-4.23142187660817215d-1*u82
  u9=u548+u401*(u537*u401+u551)
  u479=u401*(u550+u515)+u95
  u521=u401*(u94+u538*u401)+u91
  u72=(u63+u515)
  u520=u500*u61
  value=value+(c(73)*(x*((u497+u61*(u520+u93))*u403+u61*(u9+u61*(u72*u6&
 &1+u479))+u521)))
  u68=-u547*(u70+(9.21232889008141955d4*u74+u541*(5.0d0+pd2))*u76)
  u76=4.23142187660817215d-1*u527
  u547=-3.2d1*u539
  u512=u532*(2.0d0*(u57+u547)+u525)
  u511=+u58*(1.79640413356587681d7*u74+u541*(5.0d0*u522+2.0d0*u87))*u54
  value=value+(c(74)*(u49*((u76+u520)*u403+u61*(u512+u401*(u515+u511)+(&
 &u515+u63)*u61)+u401*(u75+u546)+u68)))
  value=value+(c(75)*(x*(u403*(u9+u93*u61+u403*(u72*u403+u520+u479))+u4&
 &97*u61+u521)))
  value=value+(c(76)*(u49*(u403*(u509+u83*u403)+u510)))
  u68=3.17356640745612912d0*u69
  u76=-1.05785546915204304d0*u8
  u49=u484*u530*u54
  u69=1.05785546915204304d0*u49
  u8=-3.17356640745612912d0*u55
  u530=1.05785546915204304d0*u82
  u549=u8*u401
  u550=u530*u401
  u551=u69*u401
  value=value+(c(77)*(x*(u403*(u68+u549+u403*((u92+u514)*u403+u550+u76)&
 &)+u551+u65)))
  u65=u535*(9.0d0*u516+u71)
  u71=-1.96875d2*u65
  u76=u535*(2.0d0*(u540-3.2d1*u526)+1.84246577801628391d4*u516)
  u68=3.17356640745612912d0*u76
  u540=u535*(2.39520551142116908d5*u516+2.0d0*(u519-3.2d1*u534))
  u519=-1.05785546915204304d0*u540
  u534=u501*(2.0d0*(u499+u547)+u525)
  u497=(u534+u514)
  u511=u68+u549
  u512=u550+u519
  u513=u551+u71
  value=value+(c(78)*((u61*(u511+u61*(u497*u61+u512))+u513)*z))
  u94=u535*(u96+1.86107654345079183d2*u78)
  u92=2.11571093830408608d0*u94
  u78=-2.11571093830408608d0*u485
  u485=+u59*(4.97465760064396656d5*u516+4.0d0*(u70-1.6d1*u543))
  u543=1.41047395886939072d0*u527
  u527=u97*(u84+u57)
  u84=3.52618489717347679d-1*u484*(7.90417818768985798d6*u74-6.4d1*u531&
 &)*u54
  u531=+u498*(9.70058232125573479d7*u74-6.4d1*u536)*u54
  u536=-u88
  u88=-7.05236979434695359d-1*u82
  u54=u485+u401*(u88*u401+u84)
  u74=u401*(u531+u515)+u527
  u97=u401*(u56+u536*u401)+u92
  u498=(u98+u515)
  value=value+(c(79)*(y*((u78+u61*(u520+u543))*u403+u61*(u54+u61*(u498*&
 &u61+u74))+u97)))
  u93=1.26942656298245165d0*u94
  u94=+u99*(u62+2.0d0*(u70-3.2d1*u545))
  u545=-6.34713281491225823d-1*u535*(4.60616444504070978d5*u516+4.0d0*(&
 &u70-1.6d1*u523))
  u523=u532*(4.0d0*(u57-1.6d1*u85)+8.38321928997409179d6*u516)
  u516=u79*(u86+u57)
  u484=+u77*(u544+2.0d0*(a3*u518+u73))
  u526=u528*u61
  u518=u61*(u484+u526)
  value=value+(c(80)*(z*(u403*(u94+u61*(u518+u523)+(u61*(u537+u526)+u53&
 &8)*u403)+u61*(u545+u61*(u63*u61+u516))+u93)))
  value=value+(c(81)*(y*(u403*(u545+u61*(u537*u61+u523)+u403*((u63+u526&
 &)*u403+u518+u516))+u61*(u94+u538*u61)+u93)))
  value=value+(c(82)*(z*(u403*(u54+u543*u61+u403*(u498*u403+u520+u74))+&
 &u78*u61+u97)))
  u484=u497*u403
  value=value+(c(83)*(y*(u403*(u511+u403*(u484+u512))+u513)))
  u511=-1.378125d3*u65
  u65=7.40498828406430127d0*u76
  u76=-1.48099765681286025d0*u540
  u540=7.40498828406430127d0*u49
  u49=-7.40498828406430127d0*u55
  u55=1.48099765681286025d0*u82
  value=value+(c(84)*(z*(u403*(u65+u49*u401+u403*(u484+u55*u401+u76))+u&
 &540*u401+u511)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_3=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_4(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_4
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u411
  real(kind=8) :: u412
  real(kind=8) :: u414
  real(kind=8) :: u415
  real(kind=8) :: u432
  real(kind=8) :: u441
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u491
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u496
  real(kind=8) :: u497
  real(kind=8) :: u498
  real(kind=8) :: u499
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u500
  real(kind=8) :: u501
  real(kind=8) :: u502
  real(kind=8) :: u503
  real(kind=8) :: u504
  real(kind=8) :: u505
  real(kind=8) :: u506
  real(kind=8) :: u507
  real(kind=8) :: u508
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_4=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u454=A4_(p,pd,erfpd,exppd2)
  u414=p**2
  u415=a3**(-3)
  u447=-2.0d0*a3
  u61=1.25d-1*u415*u414*(3.0d0*u454*u414+u447*A2_(p,pd,erfpd,exppd2))
  u449=2.65868077635827404d1*u454
  u88=-7.05236979434695359d-2*u415
  u68=p**4
  u441=exppd2*pd
  u97=-8.0d0*u441
  u489=+u88*(u449+u97)*u68
  u412=y**2
  value=value+(c(1)*(x*(u489*u412+u61)))
  if ( lmax .eq. 0 ) return
  u61=A5_(p,pd,erfpd,exppd2)
  u489=u61*u414
  u91=A3_(p,pd,erfpd,exppd2)
  u460=u415*p**3
  u60=exppd2*u414
  u448=4.0d0*exppd2
  u67=-4.70157986289796906d-3*u460*(7.97604232907482212d1*u489+2.0d0*(1&
 &.2d1*u60-5.0d0*a3*(u448+5.31736155271654808d0*u91)))
  u74=p**5
  u477=u61*u74
  u442=1.875d0*u415*u477
  u470=+u447*u91
  u91=3.75d-1*u460
  u460=u91*(5.0d0*u489+u470)
  u53=1.86107654345079183d2*u61
  u443=exppd2*pd2
  u507=-1.6d1*u443
  u476=(u53+u507)*u74
  u92=+u88*u476
  u411=x**2
  value=value+(c(2)*((u442+u92*u411)*u412+u460*u411+u67))
  u67=u91*(1.5d1*u489+u470)
  u442=x*y
  u489=u92*u412
  value=value+(c(3)*(u442*(u489+u67)))
  value=value+(c(4)*(x*(u489+u460)*z))
  if ( lmax .eq. 1 ) return
  u67=A6_(p,pd,erfpd,exppd2)
  u460=u67*u414
  u92=+u447*u454
  u470=u415*u68
  u454=u470*(5.0d0*u460+u92)
  u91=-1.125d0*u454
  u68=1.86107654345079183d2*u67
  u70=-1.6d1*u441
  u501=(u68+u70)
  u65=p**6
  u473=u501*u65
  u56=u415*u473
  u445=2.11571093830408608d-1*u56
  u485=a3*(-u97-u449)
  u449=7.05236979434695359d-2*u470
  u489=u441*u414
  u52=u449*(2.0d0*(u485-8.0d0*u489)+1.86107654345079183d2*u460)
  u99=1.67496888910571265d3*u67
  u444=2.0d0*pd2
  u467=+u70*(9.0d0+u444)
  u58=(u99+u467)
  u83=u58*u65
  u6=+u88*u83
  u490=u6*u411
  u491=u52*u411
  value=value+(c(5)*(x*((u445+u490)*u412+u491+u91)))
  u91=-3.75d-1*u470*(1.5d1*u460+u92)
  u445=7.05236979434695359d-2*u56
  u56=u449*(2.0d0*(u485-2.4d1*u489)+5.58322963035237549d2*u460)
  u460=(u445+u490)*u412
  value=value+(c(6)*(y*(u460+u56*u411+u91)))
  u92=-3.75d-1*u454
  value=value+(c(7)*((u460+u491+u92)*z))
  u449=1.41047395886939072d-1*u470*(3.0d0*u501*u414+u485)
  u485=u6*u412
  value=value+(c(8)*(x*(u412*(u449+u485)+u91)))
  value=value+(c(9)*(u442*(u485+u56)*z))
  u91=z**2
  value=value+(c(10)*(x*((u52+u485)*u91+u445*u412+u92)))
  if ( lmax .eq. 2 ) return
  u460=2.65868077635827404d1*u61
  u445=8.0d0*exppd2
  u449=-7.0d0*a3
  u470=+u449*(u445+u460)
  u454=A7_(p,pd,erfpd,exppd2)
  u491=u454*u414
  u6=u415*u74
  u74=6.04488839515453165d-3*u6*(2.0d0*(4.0d1*u60+u470)+9.3053827172539&
 &5914d2*u491)
  u457=p**7
  u95=u454*u457
  u432=-3.9375d1*u415*u95
  u446=a3*u61
  u61=-2.0d0*u446
  u466=u6*(7.0d0*u491+u61)
  u93=-1.125d1*u466
  u452=1.67496888910571265d3*u454
  u475=-3.2d1*u443
  u73=(u452+u475)
  u75=u73*u457
  u482=u415*u75
  u69=4.23142187660817215d-1*u482
  u514=1.67496888910571265d3*u491
  u48=a3*(-u507-u53)
  u52=7.05236979434695359d-2*u6
  u485=u443*u414
  u92=-1.6d1*u485
  u53=u52*(2.0d0*(u48+u92)+u514)
  u50=1.84246577801628391d4*u454
  u488=(1.1d1+u444)
  u66=+u475*u488
  u513=(u50+u66)
  u96=u513*u457
  u494=u415*u96
  u502=-7.05236979434695359d-2*u494
  u481=u502*u411
  u492=u53*u411
  value=value+(c(11)*((u432+u411*(u481+u69))*u412+u411*(u93+u492)+u74))
  u74=2.1d1*u491
  u432=u6*(u74+u61)
  u93=-5.625d0*u432
  u69=2.11571093830408608d-1*u482
  u54=u52*(2.0d0*(u48-4.8d1*u485)+5.02490666731713794d3*u491)
  u461=(u69+u481)*u412
  u493=u54*u411
  value=value+(c(12)*(u442*(u461+u493+u93)))
  u93=-5.625d0*u466
  value=value+(c(13)*(x*(u461+u492+u93)*z))
  u466=2.01496279838484388d-3*u6*(2.0d0*(1.2d2*u60+u470)+2.791614815176&
 &18774d3*u491)
  u470=-3.75d0*u6*(u74-u446)
  u74=7.05236979434695359d-2*u482
  u90=-1.875d0*u432
  u432=u73*u414
  u461=1.41047395886939072d-1*u6
  u77=u461*(3.0d0*u432+u48)
  value=value+(c(14)*(u412*(u470+u77*u411+(u481+u74)*u412)+u90*u411+u46&
 &6))
  value=value+(c(15)*(y*((u74+u481)*u412+u493+u90)*z))
  u481=5.58322963035237549d2*u454
  u470=-4.02992559676968777d-3*u6*(-u449*(u460+u445)+5.0d0*(u481-u445)*&
 &u414)
  u460=a3**(-2)
  u466=3.75d0*u460*u477
  u477=-7.05236979434695359d-2*u482
  u482=u52*(2.0d0*(2.65868077635827404d1*u446+u92)+u514)
  u514=-1.41047395886939072d-1*u460
  u446=+u514*u476
  u449=5.02490666731713794d3*u454
  u52=-2.82094791773878144d-1*u415
  u92=+u507*(6.0d0+pd2)
  u447=+u52*(u449+u92)*u457
  u476=7.05236979434695359d-2*u494
  u494=u476*u411
  value=value+(c(16)*((u466+u446*u411)*u91+u412*(u74+u411*(u494+u447)+(&
 &u494+u477)*u412)+u411*(u482+u477*u411)+u470))
  u446=-5.625d0*u6*(3.5d1*u491+u61)
  u470=u461*(5.0d0*u432+u48)
  u482=u502*u412
  value=value+(c(17)*(u442*(u412*(u470+u482)+u446)))
  value=value+(c(18)*(x*(u412*(u77+u482)+u90)*z))
  value=value+(c(19)*(u442*((u54+u482)*u91+u74*u412+u90)))
  u446=x*z
  value=value+(c(20)*(u446*((u53+u482)*u91+u69*u412+u93)))
  if ( lmax .eq. 3 ) return
  u77=A8_(p,pd,erfpd,exppd2)
  u470=u77*u414
  u466=a3*u67
  u502=-2.0d0*u466
  u476=u415*u65
  u477=u476*(7.0d0*u470+u502)
  u74=2.8125d1*u477
  u90=1.67496888910571265d3*u77
  u432=-3.2d1*u441
  u482=(u90+u432)
  u491=p**8
  u447=u482*u491
  u48=u415*u447
  u61=-1.05785546915204304d0*u48
  u69=a3*(-u70-u68)
  u68=u476*(1.67496888910571265d3*u470+2.0d0*(u69-1.6d1*u489))
  u507=-7.05236979434695359d-1*u68
  u53=1.84246577801628391d4*u77
  u67=u441*u488
  u461=-3.2d1*u67
  u494=(u53+u461)
  u54=u494*u491
  u6=u415*u54
  u65=7.05236979434695359d-1*u6
  u509=a3*(-u467-u99)
  u467=1.84246577801628391d4*u470
  u5=u67*u414
  u67=-1.6d1*u5
  u87=7.05236979434695359d-2*u476
  u80=u87*(2.0d0*(u509+u67)+u467)
  u93=2.39520551142116908d5*u77
  u490=pd2**2
  u492=4.0d0*u490
  u7=(u444+1.1d1)
  u471=+u432*(1.3d1*u7+u492)
  u493=(u93+u471)
  u56=u493*u491
  u49=u415*u56
  u459=-7.05236979434695359d-2*u49
  u479=u459*u411
  u495=u80*u411
  value=value+(c(21)*(x*((u61+u411*(u479+u65))*u412+u411*(u507+u495)+u7&
 &4)))
  u74=u476*(2.1d1*u470+u502)
  u61=5.625d0*u74
  u507=-2.11571093830408608d-1*u48
  u65=u476*(5.02490666731713794d3*u470+2.0d0*(u69-4.8d1*u489))
  u48=-4.23142187660817215d-1*u65
  u453=4.23142187660817215d-1*u6
  u468=5.52739733404885173d4*u470
  u500=-4.8d1*u5
  u458=u87*(2.0d0*(u509+u500)+u468)
  u456=(u507+u411*(u479+u453))*u412
  u496=u458*u411
  value=value+(c(22)*(y*(u456+u411*(u48+u496)+u61)))
  u48=5.625d0*u477
  u477=-4.23142187660817215d-1*u68
  value=value+(c(23)*((u456+u411*(u477+u495)+u48)*z))
  u81=u482*u414
  u79=u476*(u69+3.0d0*u81)
  u45=-4.23142187660817215d-1*u79
  u511=2.11571093830408608d-1*u6
  u510=-7.05236979434695359d-2*u65
  u463=u494*u414
  u480=a3*(-u70*(u444+9.0d0)-u99)
  u99=1.41047395886939072d-1*u476
  u70=u99*(3.0d0*u463+u480)
  u497=u70*u411
  u498=u510*u411
  value=value+(c(24)*(x*(u412*(u45+u497+(u479+u511)*u412)+u498+u61)))
  u45=-2.11571093830408608d-1*u65
  value=value+(c(25)*(u442*((u511+u479)*u412+u496+u45)*z))
  u496=1.86107654345079183d2*u77
  u61=-4.0d0*u441
  u62=4.0d0*(u496+u61)*u414
  u51=-4.23142187660817215d-1*u476
  u84=+u51*(2.65868077635827404d1*u466+u62)
  u86=u460*u473
  u473=4.23142187660817215d-1*u86
  u469=-2.11571093830408608d-1*u6
  u98=a3*u501
  u456=(1.3d1+u444)
  u501=u456*u414
  u495=u441*u501
  u57=u87*(2.0d0*(u98-1.6d1*u495)+2.17745955583742644d4*u470)
  u78=+u514*u83
  u65=+u97*(4.0d0*u7+u490)
  u83=(u53+u65)
  u68=u83*u491
  u97=-1.12837916709551257d0*u415*u68
  u64=7.05236979434695359d-2*u49
  u49=-7.05236979434695359d-2*u6
  u483=u64*u411
  u462=u411*(u483+u97)
  u499=u78*u411
  value=value+(c(26)*(x*((u473+u499)*u91+u412*(u511+u462+(u483+u469)*u4&
 &12)+u411*(u57+u49*u411)+u84)))
  u473=5.625d0*u476*(3.5d1*u470+u502)
  u502=-1.41047395886939072d-1*u476
  u478=+u502*(u69+5.0d0*u81)
  u81=7.05236979434695359d-2*u6
  u6=-2.11571093830408608d-1*u476
  u46=+u6*(8.37484444552856323d3*u470+2.0d0*(u69-8.0d1*u489))
  u47=u99*(5.0d0*u463+u480)
  u463=(u479+u81)*u412
  value=value+(c(27)*(y*(u412*(u478+u47*u411+u463)+u46*u411+u473)))
  u478=1.875d0*u74
  u74=-1.41047395886939072d-1*u79
  value=value+(c(28)*((u412*(u74+u497+u463)+u498+u478)*z))
  u480=+u51*(8.86226925452758014d0*u466+u62)
  u498=1.41047395886939072d-1*u86
  u463=2.17745955583742644d4*u77
  u497=u441*u456
  u86=7.05236979434695359d-2*u415*(u463-3.2d1*u497)*u491
  u99=u87*(2.0d0*(u98+u500)+u468)
  u468=(u483+u49)
  u500=u469*u411
  value=value+(c(29)*(y*((u498+u499)*u91+u412*(u86+u462+u468*u412)+u411&
 &*(u99+u500)+u480)))
  u498=2.11571093830408608d-1*u476*(2.0d0*(u98+u67)+u467)
  u86=+u502*(a3*u58+8.0d0*u83*u414)
  value=value+(c(30)*(z*(u91*(u57+u411*(u483+u86)+u468*u91)+u411*(u498+&
 &u500)+u84)))
  u498=+u6*(2.51245333365856897d4*u470+4.0d0*(u69-1.2d2*u489))
  u86=u87*(2.0d0*(u509-2.4d2*u5)+2.76369866702442587d5*u470)
  u480=u459*u412
  value=value+(c(31)*(x*(u412*(u498+u412*(u480+u86))+u473)))
  value=value+(c(32)*(u442*(u412*(u47+u480)+u46)*z))
  value=value+(c(33)*(x*((u510+u412*(u480+u70))*u91+u412*(u74+u81*u412)&
 &+u478)))
  u498=u442*z
  value=value+(c(34)*(u498*((u458+u480)*u91+u511*u412+u45)))
  value=value+(c(35)*(x*(u91*(u477+u453*u412+(u480+u80)*u91)+u507*u412+&
 &u48)))
  if ( lmax .eq. 4 ) return
  u86=A9_(p,pd,erfpd,exppd2)
  u99=u86*u414
  u48=1.17247822237399885d4*u99
  u473=a3*(1.6d1*exppd2+1.86107654345079183d2*u454)
  u478=-9.0d0*u473
  u459=u415*u457
  u64=1.12d2*u60
  u97=-1.67913566532070324d-2*u459*(u48+2.0d0*(u64+u478))
  u469=p**9
  u49=1.771875d3*u415*u86*u469
  u78=a3*u454
  u511=-2.0d0*u78
  u453=u459*(9.0d0*u99+u511)
  u462=5.90625d2*u453
  u507=-6.4d1*u443
  u80=(1.84246577801628391d4*u86+u507)
  u458=u415*u80*u469
  u83=-3.17356640745612912d0*u458
  u509=1.84246577801628391d4*u99
  u58=a3*(-u475-u452)
  u467=-3.2d1*u485
  u69=u459*(u509+2.0d0*(u58+u467))
  u98=-1.05785546915204304d0*u69
  u470=(2.39520551142116908d5*u86+u507*u456)
  u452=u415*u470*u469
  u57=1.05785546915204304d0*u452
  u454=a3*(-u66-u50)
  u67=7.05236979434695359d-2*u459
  u87=u443*u501
  u51=u67*(2.0d0*(u454-3.2d1*u87)+2.39520551142116908d5*u99)
  u45=(u444+1.3d1)
  u6=(1.5d1*u45+u492)
  u70=u415*(3.59280826713175363d6*u86+u507*u6)*u469
  u5=-7.05236979434695359d-2*u70
  u476=u5*u411
  u501=u51*u411
  value=value+(c(36)*((u49+u411*(u411*(u57+u476)+u83))*u412+u411*(u462+&
 &u411*(u501+u98))+u97))
  u97=2.7d1*u99
  u49=u459*(u97+u511)
  u462=1.96875d2*u49
  u83=-1.05785546915204304d0*u458
  u98=2.0d0*(u58-9.6d1*u485)
  u57=5.52739733404885173d4*u99
  u66=u459*(u57+u98)
  u47=-7.05236979434695359d-1*u66
  u466=7.05236979434695359d-1*u452
  u510=u67*(2.0d0*(u454-9.6d1*u87)+7.18561653426350725d5*u99)
  u457=(u83+u411*(u476+u466))*u412
  u502=u510*u411
  value=value+(c(37)*(u442*(u457+u411*(u47+u502)+u462)))
  u462=1.96875d2*u453
  u47=-7.05236979434695359d-1*u69
  value=value+(c(38)*(x*(u457+u411*(u47+u501)+u462)*z))
  u453=-1.00748139919242194d-2*u459*(u48+2.0d0*(u64-3.0d0*u473))
  u48=7.875d1*u459*(u97-u78)
  u97=-2.11571093830408608d-1*u458
  u473=7.875d1*u49
  u64=u80*u414
  u80=u459*(u58+3.0d0*u64)
  u81=-8.46284375321634431d-1*u80
  u62=4.23142187660817215d-1*u452
  u477=-7.05236979434695359d-2*u66
  u464=u470*u414
  u470=3.0d0*u464
  u512=a3*(-u475*u7-u50)
  u50=1.41047395886939072d-1*u459
  u9=u50*(u470+u512)
  u503=u9*u411
  u504=u477*u411
  value=value+(c(39)*(u412*(u48+u411*(u503+u81)+(u411*(u62+u476)+u97)*u&
 &412)+u411*(u473+u504)+u453))
  u453=3.9375d1*u49
  u48=-4.23142187660817215d-1*u66
  value=value+(c(40)*(y*((u97+u411*(u476+u62))*u412+u411*(u48+u502)+u45&
 &3)*z))
  u502=(1.67496888910571265d3*u86-u448)*u414
  u81=6.71654266128281294d-3*u459*(2.8d1*u502-u478)
  u49=-7.875d1*u460*u95
  u95=2.11571093830408608d-1*u458
  u458=1.86107654345079183d2*u78
  u473=(u458+u467)
  u467=-2.11571093830408608d-1*u459
  u72=+u467*(3.51743466712199656d4*u99+4.0d0*u473)
  u455=u460*u75
  u75=8.46284375321634431d-1*u455
  u448=2.11571093830408608d-1*u415
  u450=4.0d0*pd2
  u468=(2.7d1+u450)
  u82=u448*(4.97465760064396656d5*u86+u507*u468)*u469
  u484=-4.23142187660817215d-1*u452
  u66=(1.65821920021465552d5*u86+u507*(9.0d0+pd2))*u414
  u89=a3*u73
  u73=u50*(u66+u89)
  u451=+u514*u96
  u96=u443*(2.1d1*u45+u492)
  u514=+u88*(5.02993157398445508d6*u86-6.4d1*u96)*u469
  u501=7.05236979434695359d-2*u70
  u70=-7.05236979434695359d-2*u452
  u474=u501*u411
  u486=u451*u411
  value=value+(c(41)*((u49+u411*(u486+u75))*u91+u412*(u97+u411*(u411*(u&
 &514+u474)+u82)+(u411*(u484+u474)+u95)*u412)+u411*(u72+u411*(u70*u411+&
 &u73))+u81))
  u49=u459*(4.5d1*u99+u511)
  u75=1.18125d2*u49
  u82=u459*(u58+5.0d0*u64)
  u514=-4.23142187660817215d-1*u82
  u64=2.11571093830408608d-1*u452
  u74=+u467*(9.21232889008141955d4*u99+2.0d0*(u58-1.6d2*u485))
  u487=u50*(5.0d0*u464+u512)
  u464=(u476+u64)*u412
  u505=u487*u411
  u506=u74*u411
  value=value+(c(42)*(u442*(u412*(u514+u505+u464)+u506+u75)))
  u75=-4.23142187660817215d-1*u80
  value=value+(c(43)*(x*(u412*(u75+u503+u464)+u504+u453)*z))
  u514=(8.37484444552856323d3*u86+u475)*u414
  u475=-1.26942656298245165d0*u459
  u85=+u475*(6.2035884781693061d1*u78+u514)
  u59=4.23142187660817215d-1*u455
  u503=(1.5d1+u444)
  u455=u448*(2.76369866702442587d5*u86+u507*u503)*u469
  u94=-2.11571093830408608d-1*u452
  u499=u503*u414
  u69=u443*u499
  u8=u67*(2.0d0*(u89-9.6d1*u69)+8.2910960010732776d5*u99)
  u444=(5.0d0*u45+u490)
  u472=(1.19760275571058454d6*u86+u507*u444)
  u86=+u52*u472*u469
  u469=(u474+u94)
  u507=u94*u411
  value=value+(c(44)*(u442*((u59+u486)*u91+u412*(u455+u411*(u474+u86)+u&
 &469*u412)+u411*(u8+u507)+u85)))
  u76=+u475*(u458+u514)
  u514=2.76369866702442587d5*u99
  u458=2.11571093830408608d-1*u459
  u475=u458*(2.0d0*(u89-3.2d1*u69)+u514)
  u69=a3*u513
  u513=-1.41047395886939072d-1*u459
  u508=+u513*(u69+2.0d0*u472*u414)
  value=value+(c(45)*(u446*(u91*(u475+u411*(u474+u508)+u469*u91)+u411*(&
 &u475+u507)+u76)))
  u76=-3.35827133064140647d-3*u459*(5.86239111186999426d4*u99+2.0d0*(5.&
 &6d2*u60+u478))
  u508=3.9375d1*u459*(1.35d2*u99-4.0d0*u78)
  u472=-7.05236979434695359d-2*u459
  u478=+u472*(u514+2.0d0*(u58-4.8d2*u485))
  u78=7.05236979434695359d-2*u452
  u452=3.9375d1*u49
  u49=+u467*(u514+4.0d0*(u58-2.4d2*u485))
  u514=u67*(2.0d0*(u454-4.8d2*u87)+3.59280826713175363d6*u99)
  value=value+(c(46)*(u412*(u508+u49*u411+u412*((u78+u476)*u412+u514*u4&
 &11+u478))+u452*u411+u76))
  u76=-1.41047395886939072d-1*u82
  value=value+(c(47)*(y*(u412*(u76+u505+(u476+u78)*u412)+u506+u452)*z))
  u508=1.34330853225656259d-2*u459*(1.4d1*u502+3.0d0*a3*(u445-u481))
  u478=+u472*(1.05523040013659897d5*u99+2.0d0*(u58-1.92d2*u485))
  u479=u50*(u66+u58)
  u506=u468*u414
  u445=u443*u506
  u50=u67*(8.0d0*(a3*(-u92-u449)-2.4d1*u445)+1.49239728019318997d6*u99)
  u475=5.02993157398445508d6*u99
  u507=-3.2d1*u96*u414
  u96=+u472*(u475+2.0d0*(u512+u507))
  u512=u67*(u98+u57)
  u443=+u513*(u454+u470)
  u470=(u70+u474)
  value=value+(c(48)*(u412*(u478+u411*(u443*u411+u50)+u412*(u470*u412+u&
 &411*(u96+u474)+u479))+u411*(u477+u512*u411)+u508))
  u508=u501*u412
  value=value+(c(49)*(y*z*(u91*(u8+u486+u412*(u508+u86)+(u508+u94)*u91)&
 &+u412*(u455+u94*u412)+u59*u411+u85)))
  u86=+u467*(u509+2.0d0*u473)
  u478=u458*(4.0d0*(u89-1.6d1*u445)+4.97465760064396656d5*u99)
  u443=+u472*(u475+2.0d0*(u69+u507))
  value=value+(c(50)*(u91*(u72+u411*(u484*u411+u478)+u91*(u470*u91+u411&
 &*(u443+u474)+u73))+u411*(u86+u95*u411)+u81))
  u443=1.96875d2*u459*(6.3d1*u99+u511)
  u474=-3.52618489717347679d-1*u459*(3.86917813383419621d5*u99+4.0d0*(u&
 &58-3.36d2*u485))
  u479=u67*(2.0d0*(u454-6.72d2*u87)+u475)
  u478=u5*u412
  value=value+(c(51)*(u442*(u412*(u474+u412*(u478+u479))+u443)))
  value=value+(c(52)*(x*(u412*(u49+u412*(u478+u514))+u452)*z))
  value=value+(c(53)*(u442*((u74+u412*(u478+u487))*u91+u412*(u76+u78*u4&
 &12)+u452)))
  value=value+(c(54)*(u446*((u477+u412*(u478+u9))*u91+u412*(u75+u64*u41&
 &2)+u453)))
  value=value+(c(55)*(u442*(u91*(u48+u62*u412+(u478+u510)*u91)+u97*u412&
 &+u453)))
  value=value+(c(56)*(u446*(u91*(u47+u466*u412+(u478+u51)*u91)+u83*u412&
 &+u462)))
  if ( lmax .eq. 5 ) return
  u443=A10_(p,pd,erfpd,exppd2)
  u479=u443*u414
  u81=a3*u77
  u474=-2.0d0*u81
  u507=u415*u491
  u446=u507*(9.0d0*u479+u474)
  u452=-1.378125d3*u446
  u462=-6.4d1*u441
  u58=(1.84246577801628391d4*u443+u462)
  u501=p**10
  u86=u415*u58*u501
  u94=7.40498828406430127d0*u86
  u49=a3*(-u432-u90)
  u70=u507*(2.0d0*(u49-3.2d1*u489)+1.84246577801628391d4*u479)
  u76=7.40498828406430127d0*u70
  u48=(2.39520551142116908d5*u443-6.4d1*u497)
  u62=u415*u48*u501
  u64=-7.40498828406430127d0*u62
  u47=a3*(-u432*u7-u53)
  u468=2.39520551142116908d5*u479
  u92=-3.2d1*u495
  u83=u507*(u468+2.0d0*(u47+u92))
  u95=-1.48099765681286025d0*u83
  u72=u441*u6
  u69=(3.59280826713175363d6*u443-6.4d1*u72)
  u445=u415*u69*u501
  u497=1.48099765681286025d0*u445
  u74=a3*(-u471-u93)
  u75=3.59280826713175363d6*u479
  u73=u72*u414
  u72=-3.2d1*u73
  u85=7.05236979434695359d-2*u507
  u481=u85*(2.0d0*(u74+u72)+u75)
  u500=(u492+1.5d1*u456)
  u480=pd2**3
  u464=8.0d0*u480
  u473=u415*(6.10777405412398116d7*u443+u462*(1.7d1*u500+u464))*u501
  u456=-7.05236979434695359d-2*u473
  u475=u456*u411
  u509=u481*u411
  value=value+(c(57)*(x*((u94+u411*(u411*(u497+u475)+u64))*u412+u411*(u&
 &76+u411*(u509+u95))+u452)))
  u452=u507*(2.7d1*u479+u474)
  u94=-1.96875d2*u452
  u497=1.05785546915204304d0*u86
  u64=u507*(2.0d0*(u49-9.6d1*u489)+5.52739733404885173d4*u479)
  u95=3.17356640745612912d0*u64
  u79=-3.17356640745612912d0*u62
  u76=7.18561653426350725d5*u479
  u486=-9.6d1*u495
  u86=u507*(u76+2.0d0*(u47+u486))
  u57=-1.05785546915204304d0*u86
  u491=1.05785546915204304d0*u445
  u90=u85*(2.0d0*(u74-9.6d1*u73)+1.07784248013952609d7*u479)
  u455=(u497+u411*(u411*(u491+u475)+u79))*u412
  u510=u90*u411
  value=value+(c(58)*(y*(u455+u411*(u95+u411*(u510+u57))+u94)))
  u95=-1.96875d2*u446
  u57=3.17356640745612912d0*u70
  u70=-1.05785546915204304d0*u83
  value=value+(c(59)*((u455+u411*(u57+u411*(u509+u70))+u95)*z))
  u446=u58*u414
  u83=u507*(3.0d0*u446+u49)
  u58=2.11571093830408608d0*u83
  u451=-1.05785546915204304d0*u62
  u455=+u451
  u89=7.05236979434695359d-1*u64
  u77=u48*u414
  u48=a3*(-u461-u53)
  u50=u507*(u48+3.0d0*u77)
  u99=-1.41047395886939072d0*u50
  u66=7.05236979434695359d-1*u445
  u461=-7.05236979434695359d-2*u86
  u485=u69*u414
  u69=3.0d0*u485
  u509=a3*(-u432*(u492+1.3d1*u488)-u93)
  u476=1.41047395886939072d-1*u507
  u5=u476*(u69+u509)
  u511=u5*u411
  u512=u461*u411
  value=value+(c(60)*(x*(u412*(u58+u411*(u511+u99)+(u411*(u66+u475)+u45&
 &5)*u412)+u411*(u89+u512)+u94)))
  u58=1.05785546915204304d0*u64
  u94=-7.05236979434695359d-1*u86
  value=value+(c(61)*(u442*((u455+u411*(u475+u66))*u412+u411*(u94+u510)&
 &+u58)*z))
  u99=(8.37484444552856323d3*u443+u432)*u414
  u89=u507*(u99+1.86107654345079183d2*u81)
  u86=2.11571093830408608d0*u89
  u457=u460*u447
  u93=-2.11571093830408608d0*u457
  u492=-u451
  u508=a3*u482
  u505=-3.52618489717347679d-1*u507
  u504=u441*u506
  u506=+u505*(4.97465760064396656d5*u479+4.0d0*(u508-1.6d1*u504))
  u46=u460*u54
  u96=1.41047395886939072d0*u46
  u453=8.0d0*u490
  u82=u441*(3.3d1*u45+u453)
  u449=3.52618489717347679d-1*u415*(7.90417818768985798d6*u443-6.4d1*u8&
 &2)*u501
  u482=-7.05236979434695359d-1*u445
  u469=4.0d0*(7.18561653426350725d5*u443+u432*(6.0d0*u45+u490))*u414
  u478=a3*u494
  u8=u476*(u469+u478)
  u447=u460*u56
  u54=-1.41047395886939072d-1*u447
  u470=u441*(2.7d1*u500+u464)
  u97=+u88*(9.70058232125573479d7*u443-6.4d1*u470)*u501
  u494=7.05236979434695359d-2*u473
  u84=-7.05236979434695359d-2*u445
  u473=u494*u411
  u484=u54*u411
  value=value+(c(62)*(x*((u93+u411*(u484+u96))*u91+u412*(u455+u411*(u41&
 &1*(u97+u473)+u449)+(u411*(u482+u473)+u492)*u412)+u411*(u506+u411*(u84&
 &*u411+u8))+u86)))
  u56=u507*(4.5d1*u479+u474)
  u96=-1.18125d2*u56
  u449=4.23142187660817215d-1*u507
  u97=u449*(5.0d0*u446+u49)
  u93=-2.11571093830408608d-1*u62
  u67=u507*(2.0d0*(u49-1.6d2*u489)+9.21232889008141955d4*u479)
  u78=1.26942656298245165d0*u67
  u51=u507*(u48+5.0d0*u77)
  u59=-8.46284375321634431d-1*u51
  u451=4.23142187660817215d-1*u445
  u467=1.19760275571058454d6*u479
  u472=-1.6d2*u495
  u454=-2.11571093830408608d-1*u507
  u490=+u454*(u467+2.0d0*(u47+u472))
  u510=5.0d0*u485
  u6=u476*(u510+u509)
  u458=(u411*(u451+u475)+u93)*u412
  u513=u6*u411
  u514=u490*u411
  value=value+(c(63)*(y*(u412*(u97+u411*(u513+u59)+u458)+u411*(u78+u514&
 &)+u96)))
  u97=-3.9375d1*u452
  u78=4.23142187660817215d-1*u83
  u59=4.23142187660817215d-1*u64
  u64=-8.46284375321634431d-1*u50
  value=value+(c(64)*((u412*(u78+u411*(u511+u64)+u458)+u411*(u59+u512)+&
 &u97)*z))
  u452=1.26942656298245165d0*u507
  u87=u452*(u99+6.2035884781693061d1*u81)
  u511=-4.23142187660817215d-1*u457
  u81=-2.11571093830408608d-1*u415*(2.76369866702442587d5*u443+u462*u50&
 &3)*u501
  u483=2.11571093830408608d-1*u62
  u62=1.38184933351221293d6*u479
  u457=u441*(2.5d1+u450)
  u99=u457*u414
  u512=+u454*(u62+4.0d0*(u508-4.8d1*u99))
  u450=8.46284375321634431d-1*u46
  u50=u441*(3.5d1*u45+u453)
  u502=u448*(8.38321928997409179d6*u443-6.4d1*u50)*u501
  u448=-4.23142187660817215d-1*u445
  u458=(1.19760275571058454d6*u443+u462*u444)
  u453=u458*u414
  u9=u476*(6.0d0*u453+u478)
  u98=u441*(2.5d1*u500+u464)
  u80=+u88*(8.98202066782938406d7*u443-6.4d1*u98)*u501
  u464=-2.11571093830408608d-1*u445
  u459=(u411*(u448+u473)+u483)
  u487=u464*u411
  value=value+(c(65)*(y*((u511+u411*(u484+u450))*u91+u412*(u81+u411*(u4&
 &11*(u80+u473)+u502)+u459*u412)+u411*(u512+u411*(u487+u9))+u87)))
  u88=1.26942656298245165d0*u89
  u60=2.76369866702442587d5*u479
  u83=u441*u499
  u466=+u454*(u60+2.0d0*(u508-3.2d1*u83))
  u477=-6.34713281491225823d-1*u507*(4.60616444504070978d5*u479+4.0d0*(&
 &u508-1.6d1*u99))
  u503=u50*u414
  u50=2.11571093830408608d-1*u507
  u7=u50*(4.0d0*(u478-1.6d1*u503)+8.38321928997409179d6*u479)
  u488=2.0d0*u453
  u453=u449*(u488+u478)
  u89=a3*u493
  u471=-3.2d1*u98*u414
  u98=8.98202066782938406d7*u479
  u444=-7.05236979434695359d-2*u507
  u63=+u444*(u98+2.0d0*(u89+u471))
  u465=u411*(u63+u473)
  value=value+(c(66)*(z*(u91*(u466+u411*(u465+u7)+u459*u91)+u411*(u477+&
 &u411*(u487+u453))+u88)))
  u71=u507*(4.0d0*(u49-2.4d2*u489)+u60)
  u60=6.34713281491225823d-1*u71
  u493=u507*(u75+2.0d0*(u47-4.8d2*u495))
  u518=-2.11571093830408608d-1*u493
  u459=2.11571093830408608d-1*u445
  u55=2.11571093830408608d-1*u67
  u499=+u454*(u75+4.0d0*(u47-2.4d2*u495))
  u441=u85*(2.0d0*(u74-4.8d2*u73)+5.38921240069763044d7*u479)
  u515=u499*u411
  u516=u441*u411
  u517=u55*u411
  value=value+(c(67)*(x*(u412*(u60+u515+u412*((u459+u475)*u412+u516+u51&
 &8))+u517+u96)))
  u60=6.34713281491225823d-1*u67
  u67=-4.23142187660817215d-1*u51
  value=value+(c(68)*(u442*(u412*(u67+u513+(u475+u459)*u412)+u514+u60)*&
 &z))
  u518=a3*(-u61-u496)
  u61=u449*(8.0d0*(u518-1.2d1*u489)+2.51245333365856897d4*u479)
  u496=+u454*(u62+2.0d0*(u47-9.6d1*u99))
  u62=u449*(u488+u47)
  u488=a3*(-u432*u45-u463)
  u432=+u444*(8.2910960010732776d5*u479+2.0d0*(u488-9.6d1*u83))
  u454=a3*(-u65-u53)
  u99=u85*(3.2d1*(u454-6.0d0*u503)+2.51496578699222754d7*u479)
  u65=+u444*(u98+2.0d0*(u509+u471))
  u53=u85*(2.0d0*(u48+u486)+u76)
  u486=-1.41047395886939072d-1*u507
  u98=+u486*(u74+u69)
  u471=(u464+u473)
  value=value+(c(69)*(x*(u412*(u496+u411*(u98*u411+u99)+u412*(u471*u412&
 &+u411*(u65+u473)+u62))+u411*(u432+u53*u411)+u61)))
  u98=-u452*(u508+(9.21232889008141955d4*u443+u462*(5.0d0+pd2))*u414)
  u452=4.23142187660817215d-1*u46
  u62=u50*(2.0d0*(u478+u72)+u75)
  u99=+u52*(1.79640413356587681d7*u443+u462*(5.0d0*u500+2.0d0*u480))*u5&
 &01
  value=value+(c(70)*(u498*((u452+u484)*u91+u412*(u459+u411*(u473+u99)+&
 &(u473+u464)*u412)+u411*(u62+u487)+u98)))
  value=value+(c(71)*(x*(u91*(u477+u411*(u448*u411+u7)+u91*(u471*u91+u4&
 &65+u453))+u411*(u466+u483*u411)+u88)))
  u98=-1.96875d2*u507*(6.3d1*u479+u474)
  u465=3.52618489717347679d-1*u507
  u99=u465*(4.0d0*(u49-3.36d2*u489)+3.86917813383419621d5*u479)
  u466=5.02993157398445508d6*u479
  u63=+u444*(u466+2.0d0*(u47-6.72d2*u495))
  u474=7.05236979434695359d-2*u445
  u453=1.05785546915204304d0*u507
  u62=u453*(2.0d0*(u49-2.24d2*u489)+1.28972604461139874d5*u479)
  u445=+u505*(u466+4.0d0*(u47-3.36d2*u495))
  u495=u85*(2.0d0*(u74-6.72d2*u73)+7.54489736097668261d7*u479)
  u466=(u474+u475)*u412
  value=value+(c(72)*(y*(u412*(u99+u445*u411+u412*(u466+u495*u411+u63))&
 &+u62*u411+u98)))
  u99=-3.9375d1*u56
  u63=2.11571093830408608d-1*u71
  u71=-7.05236979434695359d-2*u493
  value=value+(c(73)*((u412*(u63+u515+u412*(u466+u516+u71))+u517+u99)*z&
 &))
  u477=u449*(8.0d0*(u518-2.0d1*u489)+4.18742222276428161d4*u479)
  u518=+u444*(2.48732880032198328d6*u479+2.0d0*(u488-1.6d2*u504))
  u504=u476*(u469+u47)
  u469=u82*u414
  u82=u85*(3.2d1*(u454-1.0d1*u469)+3.95208909384492899d7*u479)
  u85=-3.2d1*u470*u414
  u414=9.70058232125573479d7*u479
  u454=+u444*(u414+2.0d0*(u509+u85))
  u488=u50*(2.0d0*(u48+u472)+u467)
  u467=+u486*(u74+u510)
  u472=(u84+u473)
  value=value+(c(74)*(y*(u412*(u518+u411*(u467*u411+u82)+u412*(u472*u41&
 &2+u411*(u454+u473)+u504))+u411*(u490+u488*u411)+u477)))
  u477=-6.34713281491225823d-1*u415*(4.60616444504070978d5*u443-6.4d1*u&
 &457)*u501
  u443=8.46284375321634431d-1*u415*u458*u501
  u415=-2.25675833419102515d0*u460*u68
  u460=1.41047395886939072d-1*u447
  u454=-4.23142187660817215d-1*u46
  u488=u494*u412
  u467=u412*(u80+u488)
  u518=u460*u411
  value=value+(c(75)*(z*(u91*(u432+u411*(u518+u415)+u412*(u467+u502)+(u&
 &412*(u448+u488)+u518+u53)*u91)+u412*(u477+u412*(u464*u412+u443))+u411&
 &*(u452+u454*u411)+u61)))
  value=value+(c(76)*(y*(u91*(u512+u450*u411+u412*(u448*u412+u502)+u91*&
 &((u464+u488)*u91+u467+u484+u9))+u412*(u81+u483*u412)+u511*u411+u87)))
  u454=-u453*(u468+2.0d0*(u508+u92))
  u453=u465*(4.0d0*(u478-1.6d1*u469)+7.90417818768985798d6*u479)
  u477=+u444*(u414+2.0d0*(u89+u85))
  value=value+(c(77)*(z*(u91*(u506+u411*(u482*u411+u453)+u91*(u472*u91+&
 &u411*(u477+u473)+u8))+u411*(u454+u492*u411)+u86)))
  u454=2.11571093830408608d0*u507
  u411=u454*(1.4d1*u446+3.0d0*u49)
  u446=-u454*(u48+7.0d0*u77)
  u454=u476*(1.4d1*u485+u509)
  u477=u456*u412
  value=value+(c(78)*(x*(u412*(u411+u412*(u412*(u454+u477)+u446))+u98))&
 &)
  value=value+(c(79)*(u442*(u412*(u445+u412*(u477+u495))+u62)*z))
  value=value+(c(80)*(x*((u55+u412*(u412*(u441+u477)+u499))*u91+u412*(u&
 &63+u412*(u474*u412+u71))+u99)))
  value=value+(c(81)*(u498*((u490+u412*(u477+u6))*u91+u412*(u67+u459*u4&
 &12)+u60)))
  value=value+(c(82)*(x*(u91*(u59+u412*(u451*u412+u64)+(u412*(u5+u477)+&
 &u461)*u91)+u412*(u78+u93*u412)+u97)))
  value=value+(c(83)*(u498*(u91*(u94+u66*u412+(u477+u90)*u91)+u455*u412&
 &+u58)))
  value=value+(c(84)*(x*(u91*(u57+u79*u412+u91*((u481+u477)*u91+u491*u4&
 &12+u70))+u497*u412+u95)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_4=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_5(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_5
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u128
  real(kind=8) :: u129
  real(kind=8) :: u146
  real(kind=8) :: u153
  real(kind=8) :: u228
  real(kind=8) :: u242
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_5=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u242=a3**(-3)
  u7=-7.05236979434695359d-2*u242
  u61=exppd2*pd
  u65=-8.0d0*u61
  u228=+u7*(2.65868077635827404d1*A4_(p,pd,erfpd,exppd2)+u65)*p**4
  u153=x*y
  u146=u153*z
  value=value+(c(1)*(u228*u146))
  if ( lmax .eq. 0 ) return
  u228=A5_(p,pd,erfpd,exppd2)
  u128=p**5
  u62=1.875d0*u242
  u81=u62*u228*u128
  u57=exppd2*pd2
  u89=-1.6d1*u57
  u71=+u7*(1.86107654345079183d2*u228+u89)*u128
  u228=x**2
  u84=y*z
  value=value+(c(2)*((u71*u228+u81)*u84))
  u128=y**2
  value=value+(c(3)*(x*(u71*u128+u81)*z))
  u129=z**2
  value=value+(c(4)*(u153*(u71*u129+u81)))
  if ( lmax .eq. 1 ) return
  u81=A6_(p,pd,erfpd,exppd2)
  u98=p**6
  u66=-1.6d1*u61
  u96=u242*(1.86107654345079183d2*u81+u66)*u98
  u86=2.11571093830408608d-1*u96
  u71=2.0d0*pd2
  u52=+u7*(1.67496888910571265d3*u81+u66*(9.0d0+u71))*u98
  u66=u52*u228
  value=value+(c(5)*(x*(u66+u86)*u84))
  u59=-u62*u81*u98
  u81=7.05236979434695359d-2*u96
  u98=(u81+u66)
  u62=u81*u228+u59
  value=value+(c(6)*((u98*u128+u62)*z))
  value=value+(c(7)*(y*(u98*u129+u62)))
  u62=u52*u128
  value=value+(c(8)*(u153*(u62+u86)*z))
  value=value+(c(9)*(x*((u81+u62)*u129+u81*u128+u59)))
  value=value+(c(10)*(u146*(u52*u129+u86)))
  if ( lmax .eq. 2 ) return
  u59=A7_(p,pd,erfpd,exppd2)
  u62=p**7
  u66=-3.9375d1*u242
  u98=+u66*u59*u62
  u52=-3.2d1*u57
  u92=u242*(1.67496888910571265d3*u59+u52)*u62
  u87=4.23142187660817215d-1*u92
  u54=(1.1d1+u71)
  u64=u242*(1.84246577801628391d4*u59+u52*u54)*u62
  u8=-7.05236979434695359d-2*u64
  u56=u8*u228
  value=value+(c(11)*((u228*(u87+u56)+u98)*u84))
  u82=2.11571093830408608d-1*u92
  u80=7.05236979434695359d-2*u92
  u93=(u82+u56)
  u72=u80*u228+u98
  value=value+(c(12)*(x*(u93*u128+u72)*z))
  value=value+(c(13)*(u153*(u93*u129+u72)))
  u93=(u80+u56)
  u72=u82*u228+u98
  value=value+(c(14)*(y*(u93*u128+u72)*z))
  u56=-2.01496279838484388d-2*u242*(5.58322963035237549d2*u59-8.0d0*exp&
 &pd2)*u62
  u78=-7.05236979434695359d-2*u92
  u92=-2.82094791773878144d-1*u242
  u5=+u92*(5.02490666731713794d3*u59+u89*(6.0d0+pd2))*u62
  u59=7.05236979434695359d-2*u64
  u89=u59*u228
  value=value+(c(15)*(u128*(u80+u228*(u89+u5)+(u89+u78)*u128)+u228*(u80&
 &+u78*u228)+u56))
  value=value+(c(16)*(u84*(u93*u129+u72)))
  u89=u8*u128
  value=value+(c(17)*(x*(u128*(u87+u89)+u98)*z))
  value=value+(c(18)*(u153*((u82+u89)*u129+u80*u128+u98)))
  u59=x*z
  value=value+(c(19)*(u59*((u80+u89)*u129+u82*u128+u98)))
  value=value+(c(20)*(u153*(u129*(u87+u8*u129)+u98)))
  if ( lmax .eq. 3 ) return
  u89=A8_(p,pd,erfpd,exppd2)
  u5=p**8
  u98=-3.2d1*u61
  u93=u242*(1.67496888910571265d3*u89+u98)*u5
  u72=-1.05785546915204304d0*u93
  u56=1.84246577801628391d4*u89
  u62=u242*(u56+u98*u54)*u5
  u54=7.05236979434695359d-1*u62
  u82=pd2**2
  u87=4.0d0*u82
  u8=(u71+1.1d1)
  u79=u242*(2.39520551142116908d5*u89+u98*(1.3d1*u8+u87))*u5
  u6=-7.05236979434695359d-2*u79
  u60=u6*u228
  value=value+(c(21)*(x*(u228*(u54+u60)+u72)*u84))
  u90=-u66*u89*u5
  u66=-2.11571093830408608d-1*u93
  u67=-4.23142187660817215d-1*u93
  u81=4.23142187660817215d-1*u62
  u96=7.05236979434695359d-2*u62
  u73=(u66+u228*(u60+u81))
  u69=u228*(u67+u96*u228)+u90
  value=value+(c(22)*((u73*u128+u69)*z))
  value=value+(c(23)*(y*(u73*u129+u69)))
  u73=-6.34713281491225823d-1*u93
  u69=2.11571093830408608d-1*u62
  u68=(u69+u60)
  u75=u69*u228+u73
  value=value+(c(24)*(u153*(u68*u128+u75)*z))
  u74=-1.69256875064326886d0*u242*(1.86107654345079183d2*u89-4.0d0*u61)&
 &*u5
  u97=-2.11571093830408608d-1*u62
  u80=(1.3d1+u71)
  u93=u61*u80
  u55=7.05236979434695359d-2*u242*(2.17745955583742644d4*u89-3.2d1*u93)&
 &*u5
  u89=-1.12837916709551257d0*u242*(u56+u65*(4.0d0*u8+u82))*u5
  u56=7.05236979434695359d-2*u79
  u5=-7.05236979434695359d-2*u62
  u8=u56*u228
  u65=u228*(u8+u89)
  value=value+(c(25)*(x*(u128*(u69+u65+(u8+u97)*u128)+u228*(u55+u5*u228&
 &)+u74)))
  value=value+(c(26)*(u146*(u68*u129+u75)))
  u68=(u60+u96)
  u75=u67+u81*u228
  u60=u66*u228+u90
  value=value+(c(27)*((u128*(u75+u68*u128)+u60)*z))
  u79=u55+u65
  u65=u228*(u69+u97*u228)+u74
  u91=(u8+u5)
  value=value+(c(28)*(y*(u128*(u79+u91*u128)+u65)))
  value=value+(c(29)*(z*(u129*(u79+u91*u129)+u65)))
  value=value+(c(30)*(y*(u129*(u75+u68*u129)+u60)))
  u79=u6*u128
  value=value+(c(31)*(u153*(u128*(u54+u79)+u72)*z))
  value=value+(c(32)*(x*((u66+u128*(u79+u81))*u129+u128*(u67+u96*u128)+&
 &u90)))
  value=value+(c(33)*(u146*((u69+u79)*u129+u69*u128+u73)))
  value=value+(c(34)*(x*(u129*(u67+u81*u128+(u79+u96)*u129)+u66*u128+u9&
 &0)))
  value=value+(c(35)*(u146*(u129*(u54+u6*u129)+u72)))
  if ( lmax .eq. 4 ) return
  u90=A9_(p,pd,erfpd,exppd2)
  u79=p**9
  u65=u242*u90*u79
  u89=1.771875d3*u65
  u55=-6.4d1*u57
  u91=u242*(1.84246577801628391d4*u90+u55)*u79
  u75=-3.17356640745612912d0*u91
  u60=u242*(2.39520551142116908d5*u90+u55*u80)*u79
  u56=1.05785546915204304d0*u60
  u54=(u71+1.3d1)
  u8=(1.5d1*u54+u87)
  u73=u242*(3.59280826713175363d6*u90+u55*u8)*u79
  u5=-7.05236979434695359d-2*u73
  u97=u5*u228
  value=value+(c(36)*((u228*(u75+u228*(u97+u56))+u89)*u84))
  u68=-1.05785546915204304d0*u91
  u69=-7.05236979434695359d-1*u91
  u81=7.05236979434695359d-1*u60
  u96=7.05236979434695359d-2*u60
  u94=(u68+u228*(u97+u81))
  u70=u228*(u69+u96*u228)+u89
  value=value+(c(37)*(x*(u94*u128+u70)*z))
  value=value+(c(38)*(u153*(u94*u129+u70)))
  u94=1.063125d3*u65
  u65=-2.11571093830408608d-1*u91
  u70=-1.26942656298245165d0*u91
  u50=4.23142187660817215d-1*u60
  u51=2.11571093830408608d-1*u60
  u74=(u65+u228*(u97+u50))
  u62=u228*(u70+u51*u228)+u94
  value=value+(c(39)*(y*(u74*u128+u62)*z))
  u95=1.88063194515918762d-1*u242*(1.67496888910571265d3*u90-4.0d0*expp&
 &d2)*u79
  u88=2.11571093830408608d-1*u91
  u91=-2.11571093830408608d-1*u242
  u76=+u91*(3.51743466712199656d4*u90-1.28d2*u57)*u79
  u86=2.11571093830408608d-1*u242
  u6=4.0d0*pd2
  u72=(2.7d1+u6)
  u57=u86*(4.97465760064396656d5*u90+u55*u72)*u79
  u78=-4.23142187660817215d-1*u60
  u63=1.41047395886939072d-1*u242*(1.65821920021465552d5*u90+u55*(9.0d0&
 &+pd2))*u79
  u9=+u7*(5.02993157398445508d6*u90+u55*(2.1d1*u54+u87))*u79
  u53=7.05236979434695359d-2*u73
  u73=-7.05236979434695359d-2*u60
  u85=u53*u228
  u67=u228*(u9+u85)
  value=value+(c(40)*(u128*(u65+u228*(u67+u57)+(u228*(u78+u85)+u88)*u12&
 &8)+u228*(u76+u228*(u73*u228+u63))+u95))
  value=value+(c(41)*(u84*(u74*u129+u62)))
  u74=(u97+u51)
  u62=u70+u50*u228
  u99=u65*u228+u94
  value=value+(c(42)*(x*(u128*(u62+u74*u128)+u99)*z))
  u66=-1.26942656298245165d0*u242
  u77=+u66*(8.37484444552856323d3*u90+u52)*u79
  u64=(1.5d1+u71)
  u52=u86*(2.76369866702442587d5*u90+u55*u64)*u79
  u58=-2.11571093830408608d-1*u60
  u60=(5.0d0*u54+u82)
  u83=+u92*(1.19760275571058454d6*u90+u55*u60)*u79
  u90=u52+u228*(u85+u83)
  u79=u228*(u52+u58*u228)+u77
  u55=(u85+u58)
  value=value+(c(43)*(u153*(u128*(u90+u55*u128)+u79)))
  value=value+(c(44)*(u59*(u129*(u90+u55*u129)+u79)))
  value=value+(c(45)*(u153*(u129*(u62+u74*u129)+u99)))
  u90=(u97+u96)
  u79=u69+u81*u228
  u74=u68*u228+u89
  value=value+(c(46)*(y*(u128*(u79+u90*u128)+u74)*z))
  u55=u76+u228*(u78*u228+u57)
  u62=u67+u63
  u71=u228*(u65+u88*u228)+u95
  u99=(u73+u85)
  value=value+(c(47)*(u128*(u55+u128*(u99*u128+u62))+u71))
  u97=u53*u128
  value=value+(c(48)*(u84*(u129*(u52+u128*(u97+u83)+(u97+u58)*u129)+u12&
 &8*(u52+u58*u128)+u77)))
  value=value+(c(49)*(u129*(u55+u129*(u99*u129+u62))+u71))
  value=value+(c(50)*(u84*(u129*(u79+u90*u129)+u74)))
  u55=u5*u128
  value=value+(c(51)*(x*(u128*(u75+u128*(u55+u56))+u89)*z))
  value=value+(c(52)*(u153*((u68+u128*(u55+u81))*u129+u128*(u69+u96*u12&
 &8)+u89)))
  value=value+(c(53)*(u59*((u65+u128*(u55+u50))*u129+u128*(u70+u51*u128&
 &)+u94)))
  value=value+(c(54)*(u153*(u129*(u70+u50*u128+(u55+u51)*u129)+u65*u128&
 &+u94)))
  value=value+(c(55)*(u59*(u129*(u69+u81*u128+(u55+u96)*u129)+u68*u128+&
 &u89)))
  value=value+(c(56)*(u153*(u129*(u75+u129*(u5*u129+u56))+u89)))
  if ( lmax .eq. 5 ) return
  u5=A10_(p,pd,erfpd,exppd2)
  u56=p**10
  u75=-6.4d1*u61
  u94=u242*(1.84246577801628391d4*u5+u75)*u56
  u89=7.40498828406430127d0*u94
  u61=u242*(2.39520551142116908d5*u5-6.4d1*u93)*u56
  u55=-7.40498828406430127d0*u61
  u76=u242*(3.59280826713175363d6*u5+u75*u8)*u56
  u50=1.48099765681286025d0*u76
  u93=(u87+1.5d1*u80)
  u63=pd2**3
  u87=8.0d0*u63
  u67=u242*(6.10777405412398116d7*u5+u75*(1.7d1*u93+u87))*u56
  u80=-7.05236979434695359d-2*u67
  u73=u80*u228
  value=value+(c(57)*(x*(u228*(u55+u228*(u73+u50))+u89)*u84))
  u84=u242*u5*u56
  u99=-1.771875d3*u84
  u83=1.05785546915204304d0*u94
  u79=3.17356640745612912d0*u94
  u52=-3.17356640745612912d0*u61
  u74=-1.05785546915204304d0*u61
  u9=+u74
  u59=1.05785546915204304d0*u76
  u81=7.05236979434695359d-2*u76
  u77=(u83+u228*(u228*(u59+u73)+u52))
  u68=u228*(u79+u228*(u81*u228+u9))+u99
  value=value+(c(58)*((u77*u128+u68)*z))
  value=value+(c(59)*(y*(u77*u129+u68)))
  u77=-2.11571093830408608d0*u61
  u68=7.05236979434695359d-1*u76
  u96=2.11571093830408608d-1*u76
  u71=(u9+u228*(u73+u68))
  u62=u228*(u77+u96*u228)+u79
  value=value+(c(60)*(u153*(u71*u128+u62)*z))
  u97=u242*(8.37484444552856323d3*u5+u98)*u56
  u90=2.11571093830408608d0*u97
  u58=-u74
  u74=-3.52618489717347679d-1*u242*(4.97465760064396656d5*u5+u75*u72)*u&
 &56
  u8=8.0d0*u82
  u57=3.52618489717347679d-1*u242*(7.90417818768985798d6*u5+u75*(3.3d1*&
 &u54+u8))*u56
  u72=-7.05236979434695359d-1*u76
  u88=5.64189583547756287d-1*u242*(7.18561653426350725d5*u5+u98*(6.0d0*&
 &u54+u82))*u56
  u69=+u7*(9.70058232125573479d7*u5+u75*(2.7d1*u93+u87))*u56
  u95=7.05236979434695359d-2*u67
  u67=-7.05236979434695359d-2*u76
  u78=u95*u228
  u98=u228*(u69+u78)
  value=value+(c(61)*(x*(u128*(u9+u228*(u98+u57)+(u228*(u72+u78)+u58)*u&
 &128)+u228*(u74+u228*(u67*u228+u88))+u90)))
  value=value+(c(62)*(u146*(u71*u129+u62)))
  u82=-1.063125d3*u84
  u84=1.26942656298245165d0*u94
  u71=-2.11571093830408608d-1*u61
  u62=-2.53885312596490329d0*u61
  u94=4.23142187660817215d-1*u76
  u51=(u228*(u94+u73)+u71)
  u70=u84+u228*(u94*u228+u62)
  u65=u228*(u84+u71*u228)+u82
  value=value+(c(63)*((u128*(u70+u51*u128)+u65)*z))
  u85=1.26942656298245165d0*u97
  u97=+u91*(2.76369866702442587d5*u5+u75*u64)*u56
  u53=2.11571093830408608d-1*u61
  u91=-6.34713281491225823d-1*u242*(4.60616444504070978d5*u5+u75*(2.5d1&
 &+u6))*u56
  u6=u86*(8.38321928997409179d6*u5+u75*(3.5d1*u54+u8))*u56
  u8=-4.23142187660817215d-1*u76
  u64=8.46284375321634431d-1*u242*(1.19760275571058454d6*u5+u75*u60)*u5&
 &6
  u60=+u7*(8.98202066782938406d7*u5+u75*(2.5d1*u93+u87))*u56
  u7=-2.11571093830408608d-1*u76
  u76=u228*(u60+u78)
  u86=u97+u228*(u76+u6)
  u242=u7*u228
  u54=u228*(u91+u228*(u242+u64))+u85
  u61=(u228*(u8+u78)+u53)
  value=value+(c(64)*(y*(u128*(u86+u61*u128)+u54)))
  value=value+(c(65)*(z*(u129*(u86+u61*u129)+u54)))
  value=value+(c(66)*(y*(u129*(u70+u51*u129)+u65)))
  u86=(u73+u96)
  u54=u77+u68*u228
  u61=u9*u228+u79
  value=value+(c(67)*(u153*(u128*(u54+u86*u128)+u61)*z))
  u51=u91+u228*(u8*u228+u6)
  u65=u76+u64
  u70=u228*(u97+u53*u228)+u85
  u76=(u7+u78)
  value=value+(c(68)*(x*(u128*(u51+u128*(u76*u128+u65))+u70)))
  u87=+u66*(9.21232889008141955d4*u5+u75*(5.0d0+pd2))*u56
  u66=+u92*(1.79640413356587681d7*u5+u75*(5.0d0*u93+2.0d0*u63))*u56
  value=value+(c(69)*(u153*(u128*(u96+u228*(u78+u66)+(u78+u7)*u128)+u22&
 &8*(u96+u242)+u87)*z))
  value=value+(c(70)*(x*(u129*(u51+u129*(u76*u129+u65))+u70)))
  value=value+(c(71)*(u146*(u129*(u54+u86*u129)+u61)))
  u61=(u81+u73)
  u65=u79+u52*u228
  u242=u59*u228+u9
  u51=u83*u228+u99
  value=value+(c(72)*((u128*(u65+u128*(u61*u128+u242))+u51)*z))
  u73=u74+u228*(u72*u228+u57)
  u54=u98+u88
  u98=u228*(u9+u58*u228)+u90
  u86=(u67+u78)
  value=value+(c(73)*(y*(u128*(u73+u128*(u86*u128+u54))+u98)))
  u70=u95*u128
  u78=u128*(u60+u70)
  value=value+(c(74)*(z*(u129*(u97+u128*(u78+u6)+(u128*(u8+u70)+u53)*u1&
 &29)+u128*(u91+u128*(u7*u128+u64))+u85)))
  value=value+(c(75)*(y*(u129*(u91+u128*(u8*u128+u6)+u129*((u7+u70)*u12&
 &9+u78+u64))+u128*(u97+u53*u128)+u85)))
  value=value+(c(76)*(z*(u129*(u73+u129*(u86*u129+u54))+u98)))
  value=value+(c(77)*(y*(u129*(u65+u129*(u61*u129+u242))+u51)))
  u228=u80*u128
  value=value+(c(78)*(u153*(u128*(u55+u128*(u228+u50))+u89)*z))
  value=value+(c(79)*(x*((u83+u128*(u128*(u59+u228)+u52))*u129+u128*(u7&
 &9+u128*(u81*u128+u9))+u99)))
  value=value+(c(80)*(u146*((u9+u128*(u228+u68))*u129+u128*(u77+u96*u12&
 &8)+u79)))
  value=value+(c(81)*(x*(u129*(u84+u128*(u94*u128+u62)+(u128*(u94+u228)&
 &+u71)*u129)+u128*(u84+u71*u128)+u82)))
  value=value+(c(82)*(u146*(u129*(u77+u68*u128+(u228+u96)*u129)+u9*u128&
 &+u79)))
  value=value+(c(83)*(x*(u129*(u79+u52*u128+u129*((u81+u228)*u129+u59*u&
 &128+u9))+u83*u128+u99)))
  value=value+(c(84)*(u146*(u129*(u55+u129*(u80*u129+u50))+u89)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_5=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_6(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_6
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u406
  real(kind=8) :: u407
  real(kind=8) :: u419
  real(kind=8) :: u427
  real(kind=8) :: u443
  real(kind=8) :: u445
  real(kind=8) :: u452
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u491
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u496
  real(kind=8) :: u497
  real(kind=8) :: u498
  real(kind=8) :: u499
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u500
  real(kind=8) :: u501
  real(kind=8) :: u502
  real(kind=8) :: u503
  real(kind=8) :: u504
  real(kind=8) :: u505
  real(kind=8) :: u506
  real(kind=8) :: u507
  real(kind=8) :: u508
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u519
  real(kind=8) :: u52
  real(kind=8) :: u520
  real(kind=8) :: u521
  real(kind=8) :: u522
  real(kind=8) :: u523
  real(kind=8) :: u524
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_6=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u77=A4_(p,pd,erfpd,exppd2)
  u522=p**2
  u79=a3**(-3)
  u443=-2.0d0*a3
  u485=1.25d-1*u79*u522*(3.0d0*u77*u522+u443*A2_(p,pd,erfpd,exppd2))
  u82=2.65868077635827404d1*u77
  u467=-7.05236979434695359d-2*u79
  u419=p**4
  u7=exppd2*pd
  u474=-8.0d0*u7
  u518=+u467*(u82+u474)*u419
  u407=z**2
  value=value+(c(1)*(x*(u518*u407+u485)))
  if ( lmax .eq. 0 ) return
  u485=A5_(p,pd,erfpd,exppd2)
  u518=u485*u522
  u456=A3_(p,pd,erfpd,exppd2)
  u56=u79*p**3
  u68=exppd2*u522
  u506=4.0d0*exppd2
  u521=-4.70157986289796906d-3*u56*(7.97604232907482212d1*u518+2.0d0*(1&
 &.2d1*u68-5.0d0*a3*(u506+5.31736155271654808d0*u456)))
  u510=p**5
  u486=1.875d0*u79*u485*u510
  u64=+u443*u456
  u456=3.75d-1*u56
  u56=u456*(5.0d0*u518+u64)
  u465=1.86107654345079183d2*u485
  u519=exppd2*pd2
  u93=-1.6d1*u519
  u493=(u465+u93)
  u9=+u467*u493*u510
  u406=x**2
  value=value+(c(2)*((u486+u9*u406)*u407+u56*u406+u521))
  u521=x*y
  u486=u9*u407
  value=value+(c(3)*(u521*(u486+u56)))
  u56=u456*(1.5d1*u518+u64)
  u518=x*z
  value=value+(c(4)*(u518*(u486+u56)))
  if ( lmax .eq. 1 ) return
  u56=A6_(p,pd,erfpd,exppd2)
  u9=u56*u522
  u64=+u443*u77
  u77=u79*u419
  u456=u77*(5.0d0*u9+u64)
  u427=-1.125d0*u456
  u76=1.86107654345079183d2*u56
  u511=-1.6d1*u7
  u49=(u76+u511)
  u473=p**6
  u459=u49*u473
  u523=u79*u459
  u489=2.11571093830408608d-1*u523
  u87=a3*(-u474-u82)
  u82=7.05236979434695359d-2*u77
  u419=u7*u522
  u60=u82*(2.0d0*(u87-8.0d0*u419)+1.86107654345079183d2*u9)
  u95=1.67496888910571265d3*u56
  u481=2.0d0*pd2
  u48=+u511*(9.0d0+u481)
  u54=(u95+u48)
  u72=u54*u473
  u445=+u467*u72
  u487=u445*u406
  u488=u60*u406
  value=value+(c(5)*(x*((u489+u487)*u407+u488+u427)))
  u427=-3.75d-1*u456
  u489=7.05236979434695359d-2*u523
  u456=(u489+u487)*u407
  value=value+(c(6)*(y*(u456+u488+u427)))
  u523=-3.75d-1*u77*(1.5d1*u9+u64)
  u64=u82*(2.0d0*(u87-2.4d1*u419)+5.58322963035237549d2*u9)
  value=value+(c(7)*(z*(u456+u64*u406+u523)))
  u456=y**2
  value=value+(c(8)*(x*((u489+u445*u456)*u407+u60*u456+u427)))
  u427=u521*z
  u489=u445*u407
  value=value+(c(9)*(u427*(u489+u64)))
  u82=1.41047395886939072d-1*u77*(3.0d0*u49*u522+u87)
  value=value+(c(10)*(x*(u407*(u82+u489)+u523)))
  if ( lmax .eq. 2 ) return
  u82=2.65868077635827404d1*u485
  u523=8.0d0*exppd2
  u445=-7.0d0*a3
  u87=+u445*(u523+u82)
  u77=A7_(p,pd,erfpd,exppd2)
  u9=u77*u522
  u486=u79*u510
  u510=6.04488839515453165d-3*u486*(2.0d0*(4.0d1*u68+u87)+9.30538271725&
 &395914d2*u9)
  u488=p**7
  u90=-3.9375d1*u79*u77*u488
  u60=a3*u485
  u485=-2.0d0*u60
  u466=u486*(7.0d0*u9+u485)
  u457=-1.125d1*u466
  u97=1.67496888910571265d3*u77
  u85=-3.2d1*u519
  u59=(u97+u85)
  u512=u59*u488
  u452=u79*u512
  u52=4.23142187660817215d-1*u452
  u494=1.67496888910571265d3*u9
  u500=a3*(-u93-u465)
  u465=7.05236979434695359d-2*u486
  u443=u519*u522
  u524=-1.6d1*u443
  u61=u465*(2.0d0*(u500+u524)+u494)
  u46=1.84246577801628391d4*u77
  u520=(1.1d1+u481)
  u69=+u85*u520
  u67=(u46+u69)
  u86=u67*u488
  u492=u79*u86
  u478=-7.05236979434695359d-2*u492
  u479=u478*u406
  u490=u61*u406
  value=value+(c(11)*((u90+u406*(u479+u52))*u407+u406*(u457+u490)+u510)&
 &)
  u510=-5.625d0*u466
  u90=2.11571093830408608d-1*u452
  u457=(u90+u479)*u407
  value=value+(c(12)*(u521*(u457+u490+u510)))
  u52=2.1d1*u9
  u466=u486*(u52+u485)
  u483=-5.625d0*u466
  u62=u465*(2.0d0*(u500-4.8d1*u443)+5.02490666731713794d3*u9)
  u491=u62*u406
  value=value+(c(13)*(u518*(u457+u491+u483)))
  u457=5.58322963035237549d2*u77
  u483=-4.02992559676968777d-3*u486*(-u445*(u82+u523)+5.0d0*(u457-u523)&
 &*u522)
  u82=u465*(2.0d0*(2.65868077635827404d1*u60+u524)+u494)
  u494=-7.05236979434695359d-2*u452
  u445=(5.02490666731713794d3*u77+u93*(6.0d0+pd2))
  u465=-1.41047395886939072d-1*u486*(a3*u493+2.0d0*u445*u522)
  u493=7.05236979434695359d-2*u492
  u492=u493*u406
  value=value+(c(14)*(u456*(u82+u406*(u492+u465)+(u492+u494)*u456)+u406&
 &*(u82+u494*u406)+u483))
  u483=-1.875d0*u466
  u465=7.05236979434695359d-2*u452
  u466=y*z
  value=value+(c(15)*(u466*((u465+u479)*u407+u491+u483)))
  u493=2.01496279838484388d-3*u486*(2.0d0*(1.2d2*u68+u87)+2.79161481517&
 &618774d3*u9)
  u494=-3.75d0*u486*(u52-u60)
  u452=u59*u522
  u60=1.41047395886939072d-1*u486
  u87=u60*(3.0d0*u452+u500)
  value=value+(c(16)*(u407*(u494+u87*u406+(u479+u465)*u407)+u483*u406+u&
 &493))
  u493=u478*u456
  value=value+(c(17)*(u521*((u90+u493)*u407+u61*u456+u510)))
  value=value+(c(18)*(u518*((u465+u493)*u407+u62*u456+u483)))
  u494=u478*u407
  value=value+(c(19)*(u521*(u407*(u87+u494)+u483)))
  u62=-5.625d0*u486*(3.5d1*u9+u485)
  u510=u60*(5.0d0*u452+u500)
  value=value+(c(20)*(u518*(u407*(u510+u494)+u62)))
  if ( lmax .eq. 3 ) return
  u62=A8_(p,pd,erfpd,exppd2)
  u510=u62*u522
  u478=a3*u56
  u90=-2.0d0*u478
  u465=u79*u473
  u452=u465*(7.0d0*u510+u90)
  u500=2.8125d1*u452
  u493=1.67496888910571265d3*u62
  u485=-3.2d1*u7
  u494=(u493+u485)
  u60=p**8
  u486=u494*u60
  u9=u79*u486
  u483=-1.05785546915204304d0*u9
  u56=a3*(-u511-u76)
  u76=u465*(1.67496888910571265d3*u510+2.0d0*(u56-1.6d1*u419))
  u52=-7.05236979434695359d-1*u76
  u491=1.84246577801628391d4*u62
  u75=u7*u520
  u490=-3.2d1*u75
  u61=(u491+u490)
  u87=u61*u60
  u524=u79*u87
  u473=7.05236979434695359d-1*u524
  u55=a3*(-u48-u95)
  u48=1.84246577801628391d4*u510
  u5=u75*u522
  u75=-1.6d1*u5
  u508=7.05236979434695359d-2*u465
  u509=u508*(2.0d0*(u55+u75)+u48)
  u492=2.39520551142116908d5*u62
  u487=pd2**2
  u489=4.0d0*u487
  u471=(u481+1.1d1)
  u479=+u485*(1.3d1*u471+u489)
  u82=(u492+u479)
  u64=u82*u60
  u513=u79*u64
  u91=-7.05236979434695359d-2*u513
  u477=u91*u406
  u495=u509*u406
  value=value+(c(21)*(x*((u483+u406*(u477+u473))*u407+u406*(u52+u495)+u&
 &500)))
  u500=5.625d0*u452
  u483=-2.11571093830408608d-1*u9
  u52=-4.23142187660817215d-1*u76
  u473=4.23142187660817215d-1*u524
  u452=(u483+u406*(u477+u473))*u407
  value=value+(c(22)*(y*(u452+u406*(u52+u495)+u500)))
  u9=u465*(2.1d1*u510+u90)
  u499=5.625d0*u9
  u73=u465*(5.02490666731713794d3*u510+2.0d0*(u56-4.8d1*u419))
  u63=-4.23142187660817215d-1*u73
  u482=5.52739733404885173d4*u510
  u99=-4.8d1*u5
  u463=u508*(2.0d0*(u55+u99)+u482)
  u496=u463*u406
  value=value+(c(23)*(z*(u452+u406*(u63+u496)+u499)))
  u452=1.86107654345079183d2*u62
  u63=-4.0d0*u7
  u84=4.0d0*(u452+u63)*u522
  u74=-4.23142187660817215d-1*u465
  u94=+u74*(2.65868077635827404d1*u478+u84)
  u462=a3*u49
  u49=2.11571093830408608d-1*u465*(2.0d0*(u462+u75)+u48)
  u48=-2.11571093830408608d-1*u524
  u75=(1.3d1+u481)
  u6=u75*u522
  u76=u7*u6
  u475=u508*(2.0d0*(u462-1.6d1*u76)+2.17745955583742644d4*u510)
  u495=+u474*(4.0d0*u471+u487)
  u474=(u491+u495)
  u501=-1.41047395886939072d-1*u465
  u71=+u501*(a3*u54+8.0d0*u474*u522)
  u54=7.05236979434695359d-2*u513
  u513=-7.05236979434695359d-2*u524
  u480=u54*u406
  u458=u406*(u480+u71)
  value=value+(c(24)*(x*(u456*(u49+u458+(u480+u48)*u456)+u406*(u475+u51&
 &3*u406)+u94)))
  u53=-2.11571093830408608d-1*u73
  u484=2.11571093830408608d-1*u524
  value=value+(c(25)*(u427*((u484+u477)*u407+u496+u53)))
  u517=u494*u522
  u89=u465*(u56+3.0d0*u517)
  u468=-4.23142187660817215d-1*u89
  u50=-7.05236979434695359d-2*u73
  u96=u61*u522
  u472=a3*(-u511*(u481+9.0d0)-u95)
  u95=1.41047395886939072d-1*u465
  u511=u95*(3.0d0*u96+u472)
  u497=u511*u406
  u498=u50*u406
  value=value+(c(26)*(x*(u407*(u468+u497+(u477+u484)*u407)+u498+u499)))
  u468=(u480+u513)
  u499=u48*u406
  value=value+(c(27)*(y*(u456*(u475+u458+u468*u456)+u406*(u49+u499)+u94&
 &)))
  u71=+u74*(8.86226925452758014d0*u478+u84)
  u94=2.17745955583742644d4*u62
  u496=u7*u75
  u84=7.05236979434695359d-2*u79*(u94-3.2d1*u496)*u60
  u73=a3**(-2)
  u49=1.41047395886939072d-1*u73*u459
  u459=u508*(2.0d0*(u462+u99)+u482)
  u458=u474*u60
  u474=-1.12837916709551257d0*u79*u458
  u482=-1.41047395886939072d-1*u73*u72
  value=value+(c(28)*(z*(u407*(u84+u406*(u480+u474)+u468*u407)+(u49+u48&
 &2*u406)*u456+u406*(u459+u499)+u71)))
  u71=1.875d0*u9
  u84=-1.41047395886939072d-1*u89
  u513=7.05236979434695359d-2*u524
  u459=(u477+u513)*u407
  value=value+(c(29)*(y*(u407*(u84+u497+u459)+u498+u71)))
  u474=5.625d0*u465*(3.5d1*u510+u90)
  u482=+u501*(u56+5.0d0*u517)
  u49=-2.11571093830408608d-1*u465
  u54=+u49*(8.37484444552856323d3*u510+2.0d0*(u56-8.0d1*u419))
  u48=u95*(5.0d0*u96+u472)
  value=value+(c(30)*(z*(u407*(u482+u48*u406+u459)+u54*u406+u474)))
  u482=u91*u456
  value=value+(c(31)*(x*((u483+u456*(u482+u473))*u407+u456*(u52+u509*u4&
 &56)+u500)))
  value=value+(c(32)*(u427*((u484+u482)*u407+u463*u456+u53)))
  value=value+(c(33)*(x*(u407*(u84+u511*u456+(u482+u513)*u407)+u50*u456&
 &+u71)))
  u500=u91*u407
  value=value+(c(34)*(u427*(u407*(u48+u500)+u54)))
  u71=+u49*(2.51245333365856897d4*u510+4.0d0*(u56-1.2d2*u419))
  u513=u508*(2.0d0*(u55-2.4d2*u5)+2.76369866702442587d5*u510)
  value=value+(c(35)*(x*(u407*(u71+u407*(u500+u513))+u474)))
  if ( lmax .eq. 4 ) return
  u71=A9_(p,pd,erfpd,exppd2)
  u513=u71*u522
  u474=1.17247822237399885d4*u513
  u91=a3*(1.6d1*exppd2+1.86107654345079183d2*u77)
  u473=-9.0d0*u91
  u484=u79*u488
  u49=1.12d2*u68
  u524=-1.67913566532070324d-2*u484*(u474+2.0d0*(u49+u473))
  u483=p**9
  u72=1.771875d3*u79*u71*u483
  u96=a3*u77
  u517=-2.0d0*u96
  u509=u484*(9.0d0*u513+u517)
  u55=5.90625d2*u509
  u472=-6.4d1*u519
  u463=(1.84246577801628391d4*u71+u472)
  u56=u79*u463*u483
  u462=-3.17356640745612912d0*u56
  u510=1.84246577801628391d4*u513
  u53=a3*(-u85-u97)
  u97=-3.2d1*u443
  u77=u484*(u510+2.0d0*(u53+u97))
  u99=-1.05785546915204304d0*u77
  u508=(2.39520551142116908d5*u71+u472*u75)
  u498=u79*u508*u483
  u95=1.05785546915204304d0*u498
  u9=a3*(-u69-u46)
  u5=7.05236979434695359d-2*u484
  u48=u519*u6
  u6=u5*(2.0d0*(u9-3.2d1*u48)+2.39520551142116908d5*u513)
  u500=(u481+1.3d1)
  u69=(1.5d1*u500+u489)
  u84=u79*(3.59280826713175363d6*u71+u472*u69)*u483
  u459=-7.05236979434695359d-2*u84
  u475=u459*u406
  u501=u6*u406
  value=value+(c(36)*((u72+u406*(u406*(u95+u475)+u462))*u407+u406*(u55+&
 &u406*(u501+u99))+u524))
  u524=1.96875d2*u509
  u72=-1.05785546915204304d0*u56
  u55=-7.05236979434695359d-1*u77
  u462=7.05236979434695359d-1*u498
  u99=(u72+u406*(u475+u462))*u407
  value=value+(c(37)*(u521*(u99+u406*(u55+u501)+u524)))
  u95=2.7d1*u513
  u509=u484*(u95+u517)
  u478=1.96875d2*u509
  u511=2.0d0*(u53-9.6d1*u443)
  u465=5.52739733404885173d4*u513
  u74=u484*(u465+u511)
  u90=-7.05236979434695359d-1*u74
  u514=u5*(2.0d0*(u9-9.6d1*u48)+7.18561653426350725d5*u513)
  u502=u514*u406
  value=value+(c(38)*(u518*(u99+u406*(u90+u502)+u478)))
  u478=(1.67496888910571265d3*u71-u506)*u522
  u90=6.71654266128281294d-3*u484*(2.8d1*u478-u473)
  u506=1.86107654345079183d2*u96
  u99=(u506+u97)
  u97=-2.11571093830408608d-1*u484
  u80=+u97*(u510+2.0d0*u99)
  u510=2.11571093830408608d-1*u56
  u81=+u97*(3.51743466712199656d4*u513+4.0d0*u99)
  u99=a3*u59
  u89=2.11571093830408608d-1*u484
  u482=4.0d0*pd2
  u59=(2.7d1+u482)
  u77=u59*u522
  u464=u89*(4.0d0*(u99+u93*u77)+4.97465760064396656d5*u513)
  u93=-4.23142187660817215d-1*u498
  u57=(1.65821920021465552d5*u71+u472*(9.0d0+pd2))
  u58=1.41047395886939072d-1*u484
  u83=u58*(u57*u522+u99)
  u469=a3*u67
  u67=5.02993157398445508d6*u513
  u65=u519*(2.1d1*u500+u489)
  u515=-7.05236979434695359d-2*u484
  u8=+u515*(u67+2.0d0*(u469-3.2d1*u65*u522))
  u501=7.05236979434695359d-2*u84
  u84=-7.05236979434695359d-2*u498
  u476=u501*u406
  u460=u406*(u8+u476)
  value=value+(c(39)*(u456*(u80+u406*(u460+u464)+(u406*(u93+u476)+u510)&
 &*u456)+u406*(u81+u406*(u84*u406+u83))+u90))
  u516=3.9375d1*u509
  u497=-2.11571093830408608d-1*u56
  u56=-4.23142187660817215d-1*u74
  u66=4.23142187660817215d-1*u498
  value=value+(c(40)*(u466*((u497+u406*(u475+u66))*u407+u406*(u56+u502)&
 &+u516)))
  u78=-1.00748139919242194d-2*u484*(u474+2.0d0*(u49-3.0d0*u91))
  u474=7.875d1*u484*(u95-u96)
  u95=7.875d1*u509
  u509=u463*u522
  u91=u484*(u53+3.0d0*u509)
  u463=-8.46284375321634431d-1*u91
  u49=-7.05236979434695359d-2*u74
  u507=u508*u522
  u508=a3*(-u85*u471-u46)
  u46=u58*(3.0d0*u507+u508)
  u503=u46*u406
  u504=u49*u406
  value=value+(c(41)*(u407*(u474+u406*(u503+u463)+(u406*(u66+u475)+u497&
 &)*u407)+u406*(u95+u504)+u78))
  u78=(8.37484444552856323d3*u71+u85)*u522
  u474=-1.26942656298245165d0*u484
  u95=+u474*(u506+u78)
  u463=2.76369866702442587d5*u513
  u502=(1.5d1+u481)
  u50=u502*u522
  u506=u519*u50
  u85=u89*(2.0d0*(u99-3.2d1*u506)+u463)
  u89=-2.11571093830408608d-1*u498
  u54=(5.0d0*u500+u487)
  u481=(1.19760275571058454d6*u71+u472*u54)
  u74=-1.41047395886939072d-1*u484*(u469+2.0d0*u481*u522)
  u469=(u476+u89)
  u505=u89*u406
  value=value+(c(42)*(u521*(u456*(u85+u406*(u476+u74)+u469*u456)+u406*(&
 &u85+u505)+u95)))
  u95=+u474*(6.2035884781693061d1*u96+u78)
  u74=2.11571093830408608d-1*u79
  u78=u74*(2.76369866702442587d5*u71+u472*u502)*u483
  u474=u73*u512
  u512=4.23142187660817215d-1*u474
  u98=u5*(2.0d0*(u99-9.6d1*u506)+8.2910960010732776d5*u513)
  u99=-2.82094791773878144d-1*u79*u481*u483
  u481=u73*u86
  u86=-1.41047395886939072d-1*u481
  u506=u86*u406
  value=value+(c(43)*(u518*(u407*(u78+u406*(u476+u99)+u469*u407)+(u512+&
 &u506)*u456+u406*(u98+u505)+u95)))
  u85=-4.23142187660817215d-1*u91
  u70=2.11571093830408608d-1*u498
  u461=(u475+u70)*u407
  value=value+(c(44)*(u521*(u407*(u85+u503+u461)+u504+u516)))
  u88=u484*(4.5d1*u513+u517)
  u470=1.18125d2*u88
  u92=u484*(u53+5.0d0*u509)
  u509=-4.23142187660817215d-1*u92
  u51=+u97*(9.21232889008141955d4*u513+2.0d0*(u53-1.6d2*u443))
  u47=u58*(5.0d0*u507+u508)
  u507=u47*u406
  u508=u51*u406
  value=value+(c(45)*(u518*(u407*(u509+u507+u461)+u508+u470)))
  u470=(u84+u476)
  u509=u93*u406
  value=value+(c(46)*(u456*(u81+u406*(u509+u464)+u456*(u470*u456+u460+u&
 &83))+u406*(u80+u510*u406)+u90))
  u510=u501*u456
  value=value+(c(47)*(u466*(u407*(u78+u456*(u510+u99)+(u510+u89)*u407)+&
 &u456*(u98+u506+u89*u456)+u512*u406+u95)))
  u99=1.34330853225656259d-2*u484*(1.4d1*u478+3.0d0*a3*(u523-u457))
  u8=-2.11571093830408608d-1*u79
  u86=+u8*(3.51743466712199656d4*u71-1.28d2*u519)*u483
  u78=1.41047395886939072d-1*u79*u57*u483
  u512=1.41047395886939072d-1*u474
  u461=-1.41047395886939072d-1*u474
  u474=u74*(4.97465760064396656d5*u71+u472*u59)*u483
  u57=+u467*(5.02993157398445508d6*u71-6.4d1*u65)*u483
  u510=-5.64189583547756287d-1*u73*u445*u488
  u65=1.41047395886939072d-1*u481
  u481=u5*(u511+u465)
  u511=u65*u406
  value=value+(c(48)*(u407*(u86+u406*(u509+u474)+u407*(u470*u407+u406*(&
 &u57+u476)+u78))+u456*(u512+u406*(u511+u510)+(u511+u461)*u456)+u406*(u&
 &49+u481*u406)+u99))
  u510=3.9375d1*u88
  u86=-1.41047395886939072d-1*u92
  u93=7.05236979434695359d-2*u498
  value=value+(c(49)*(u466*(u407*(u86+u507+(u475+u93)*u407)+u508+u510))&
 &)
  u481=-3.35827133064140647d-3*u484*(5.86239111186999426d4*u513+2.0d0*(&
 &5.6d2*u68+u473))
  u512=3.9375d1*u484*(1.35d2*u513-4.0d0*u96)
  u466=+u515*(u463+2.0d0*(u53-4.8d2*u443))
  u57=+u97*(u463+4.0d0*(u53-2.4d2*u443))
  u88=u5*(2.0d0*(u9-4.8d2*u48)+3.59280826713175363d6*u513)
  value=value+(c(50)*(u407*(u512+u57*u406+u407*((u93+u475)*u407+u88*u40&
 &6+u466))+u510*u406+u481))
  u481=u459*u456
  value=value+(c(51)*(u521*((u72+u456*(u481+u462))*u407+u456*(u55+u6*u4&
 &56)+u524)))
  value=value+(c(52)*(u518*((u497+u456*(u481+u66))*u407+u456*(u56+u514*&
 &u456)+u516)))
  value=value+(c(53)*(u521*(u407*(u85+u46*u456+(u481+u70)*u407)+u49*u45&
 &6+u516)))
  value=value+(c(54)*(u518*(u407*(u86+u47*u456+(u481+u93)*u407)+u51*u45&
 &6+u510)))
  u512=u459*u407
  value=value+(c(55)*(u521*(u407*(u57+u407*(u512+u88))+u510)))
  u466=1.96875d2*u484*(6.3d1*u513+u517)
  u481=-3.52618489717347679d-1*u484*(3.86917813383419621d5*u513+4.0d0*(&
 &u53-3.36d2*u443))
  u56=u5*(2.0d0*(u9-6.72d2*u48)+u67)
  value=value+(c(56)*(u518*(u407*(u481+u407*(u512+u56))+u466)))
  if ( lmax .eq. 5 ) return
  u466=A10_(p,pd,erfpd,exppd2)
  u481=u466*u522
  u518=a3*u62
  u56=-2.0d0*u518
  u510=u79*u60
  u88=u510*(9.0d0*u481+u56)
  u469=-1.378125d3*u88
  u501=-6.4d1*u7
  u93=(1.84246577801628391d4*u466+u501)
  u461=p**10
  u475=u79*u93*u461
  u60=7.40498828406430127d0*u475
  u85=a3*(-u485-u493)
  u78=u510*(2.0d0*(u85-3.2d1*u419)+1.84246577801628391d4*u481)
  u65=7.40498828406430127d0*u78
  u47=(2.39520551142116908d5*u466-6.4d1*u496)
  u496=u79*u47*u461
  u72=-7.40498828406430127d0*u496
  u498=a3*(-u485*u471-u491)
  u497=2.39520551142116908d5*u481
  u84=-3.2d1*u76
  u517=u510*(u497+2.0d0*(u498+u84))
  u493=-1.48099765681286025d0*u517
  u55=u7*u69
  u6=(3.59280826713175363d6*u466-6.4d1*u55)
  u48=u79*u6*u461
  u67=1.48099765681286025d0*u48
  u91=a3*(-u479-u492)
  u503=3.59280826713175363d6*u481
  u90=u55*u522
  u55=-3.2d1*u90
  u511=7.05236979434695359d-2*u510
  u479=u511*(2.0d0*(u91+u55)+u503)
  u472=(u489+1.5d1*u75)
  u504=pd2**3
  u71=8.0d0*u504
  u473=u79*(6.10777405412398116d7*u466+u501*(1.7d1*u472+u71))*u461
  u508=-7.05236979434695359d-2*u473
  u474=u508*u406
  u513=u479*u406
  value=value+(c(57)*(x*((u60+u406*(u406*(u67+u474)+u72))*u407+u406*(u6&
 &5+u406*(u513+u493))+u469)))
  u469=-1.96875d2*u88
  u493=1.05785546915204304d0*u475
  u65=3.17356640745612912d0*u78
  u78=-3.17356640745612912d0*u496
  u60=-1.05785546915204304d0*u517
  u475=1.05785546915204304d0*u48
  u96=(u493+u406*(u406*(u475+u474)+u78))*u407
  value=value+(c(58)*(y*(u96+u406*(u65+u406*(u513+u60))+u469)))
  u88=u510*(2.7d1*u481+u56)
  u67=-1.96875d2*u88
  u72=u510*(2.0d0*(u85-9.6d1*u419)+5.52739733404885173d4*u481)
  u517=3.17356640745612912d0*u72
  u95=7.18561653426350725d5*u481
  u476=-9.6d1*u76
  u49=u510*(u95+2.0d0*(u498+u476))
  u99=-1.05785546915204304d0*u49
  u46=u511*(2.0d0*(u91-9.6d1*u90)+1.07784248013952609d7*u481)
  u514=u46*u406
  value=value+(c(59)*(z*(u96+u406*(u517+u406*(u514+u99))+u67)))
  u517=(8.37484444552856323d3*u466+u485)*u522
  u99=u510*(u517+1.86107654345079183d2*u518)
  u96=2.11571093830408608d0*u99
  u57=a3*u494
  u459=-1.05785546915204304d0*u510
  u507=+u459*(u497+2.0d0*(u57+u84))
  u497=1.05785546915204304d0*u496
  u84=-3.52618489717347679d-1*u510
  u506=u7*u77
  u92=+u84*(4.97465760064396656d5*u481+4.0d0*(u57-1.6d1*u506))
  u512=a3*u61
  u465=8.0d0*u487
  u460=u7*(3.3d1*u500+u465)*u522
  u457=3.52618489717347679d-1*u510
  u9=u457*(4.0d0*(u512-1.6d1*u460)+7.90417818768985798d6*u481)
  u51=-7.05236979434695359d-1*u48
  u494=4.0d0*(7.18561653426350725d5*u466+u485*(6.0d0*u500+u487))*u522
  u445=1.41047395886939072d-1*u510
  u487=u445*(u494+u512)
  u5=a3*u82
  u62=+u485*(2.7d1*u472+u71)*u522
  u443=9.70058232125573479d7*u481
  u488=-7.05236979434695359d-2*u510
  u82=+u488*(u443+2.0d0*(u5+u62))
  u61=7.05236979434695359d-2*u473
  u53=-7.05236979434695359d-2*u48
  u473=u61*u406
  u462=u406*(u82+u473)
  value=value+(c(60)*(x*(u456*(u507+u406*(u462+u9)+(u406*(u51+u473)+u49&
 &7)*u456)+u406*(u92+u406*(u53*u406+u487))+u96)))
  u66=1.05785546915204304d0*u72
  u89=-u497
  u513=-7.05236979434695359d-1*u49
  u470=7.05236979434695359d-1*u48
  value=value+(c(61)*(u427*((u89+u406*(u474+u470))*u407+u406*(u513+u514&
 &)+u66)))
  u514=u93*u522
  u93=u510*(3.0d0*u514+u85)
  u97=2.11571093830408608d0*u93
  u70=7.05236979434695359d-1*u72
  u86=u47*u522
  u47=a3*(-u490-u491)
  u58=u510*(u47+3.0d0*u86)
  u69=-1.41047395886939072d0*u58
  u490=-7.05236979434695359d-2*u49
  u49=u6*u522
  u509=a3*(-u485*(u489+1.3d1*u520)-u492)
  u6=u445*(3.0d0*u49+u509)
  u515=u6*u406
  u516=u490*u406
  value=value+(c(62)*(x*(u407*(u97+u406*(u515+u69)+(u406*(u470+u474)+u8&
 &9)*u407)+u406*(u70+u516)+u67)))
  u97=1.26942656298245165d0*u99
  u99=2.76369866702442587d5*u481
  u492=-2.11571093830408608d-1*u510
  u489=u7*u50
  u70=+u492*(u99+2.0d0*(u57-3.2d1*u489))
  u77=2.11571093830408608d-1*u496
  u69=u7*(2.5d1+u482)
  u67=u69*u522
  u477=-6.34713281491225823d-1*u510*(4.60616444504070978d5*u481+4.0d0*(&
 &u57-1.6d1*u67))
  u478=u7*(3.5d1*u500+u465)
  u52=2.11571093830408608d-1*u510
  u465=u52*(4.0d0*(u512-1.6d1*u478*u522)+8.38321928997409179d6*u481)
  u83=-4.23142187660817215d-1*u48
  u524=(1.19760275571058454d6*u466+u501*u54)
  u484=u524*u522
  u50=4.23142187660817215d-1*u510
  u68=u50*(2.0d0*u484+u512)
  u464=u7*(2.5d1*u472+u71)
  u71=+u488*(8.98202066782938406d7*u481+2.0d0*(u5-3.2d1*u464*u522))
  u80=-2.11571093830408608d-1*u48
  u468=(u406*(u83+u473)+u77)
  u463=u406*(u71+u473)
  u483=u80*u406
  value=value+(c(63)*(y*(u456*(u70+u406*(u463+u465)+u468*u456)+u406*(u4&
 &77+u406*(u483+u68))+u97)))
  u523=1.26942656298245165d0*u510
  u98=u523*(u517+6.2035884781693061d1*u518)
  u482=+u8*(2.76369866702442587d5*u466+u501*u502)*u461
  u81=-4.23142187660817215d-1*u73*u486
  u54=+u492*(1.38184933351221293d6*u481+4.0d0*(u57-4.8d1*u67))
  u505=u74*(8.38321928997409179d6*u466-6.4d1*u478)*u461
  u478=u73*u87
  u74=8.46284375321634431d-1*u478
  u87=u445*(6.0d0*u484+u512)
  u486=+u467*(8.98202066782938406d7*u466-6.4d1*u464)*u461
  u484=u73*u64
  u64=-1.41047395886939072d-1*u484
  u464=u406*(u486+u473)
  u517=u64*u406
  value=value+(c(64)*(z*(u407*(u482+u406*(u464+u505)+u468*u407)+(u81+u4&
 &06*(u517+u74))*u456+u406*(u54+u406*(u483+u87))+u98)))
  u499=-3.9375d1*u88
  u88=4.23142187660817215d-1*u93
  u93=-2.11571093830408608d-1*u496
  u67=4.23142187660817215d-1*u72
  u468=-8.46284375321634431d-1*u58
  u58=4.23142187660817215d-1*u48
  u480=(u406*(u58+u474)+u93)*u407
  value=value+(c(65)*(y*(u407*(u88+u406*(u515+u468)+u480)+u406*(u67+u51&
 &6)+u499)))
  u516=u510*(4.5d1*u481+u56)
  u515=-1.18125d2*u516
  u471=u50*(5.0d0*u514+u85)
  u75=u510*(2.0d0*(u85-1.6d2*u419)+9.21232889008141955d4*u481)
  u520=1.26942656298245165d0*u75
  u59=u510*(u47+5.0d0*u86)
  u467=-8.46284375321634431d-1*u59
  u8=1.19760275571058454d6*u481
  u502=-1.6d2*u76
  u496=+u492*(u8+2.0d0*(u498+u502))
  u72=5.0d0*u49
  u7=u445*(u72+u509)
  u518=u7*u406
  u519=u496*u406
  value=value+(c(66)*(z*(u407*(u471+u406*(u518+u467)+u480)+u406*(u520+u&
 &519)+u515)))
  u471=(u80+u473)
  u520=u83*u406
  value=value+(c(67)*(x*(u456*(u477+u406*(u520+u465)+u456*(u471*u456+u4&
 &63+u68))+u406*(u70+u77*u406)+u97)))
  u467=-u523*(u57+(9.21232889008141955d4*u466+u501*(5.0d0+pd2))*u522)
  u71=u52*(2.0d0*(u512+u55)+u503)
  u512=-1.41047395886939072d-1*u510
  u68=+u512*(u5+2.0d0*(1.79640413356587681d7*u466+u501*(5.0d0*u472+2.0d&
 &0*u504))*u522)
  value=value+(c(68)*(u521*(u456*(u71+u406*(u473+u68)+(u473+u80)*u456)+&
 &u406*(u71+u483)+u467)*z))
  u483=a3*(-u63-u452)
  u68=u50*(8.0d0*(u483-1.2d1*u419)+2.51245333365856897d4*u481)
  u71=-6.34713281491225823d-1*u79*(4.60616444504070978d5*u466-6.4d1*u69&
 &)*u461
  u5=8.46284375321634431d-1*u79*u524*u461
  u524=4.23142187660817215d-1*u478
  u467=-4.23142187660817215d-1*u478
  u461=a3*(-u485*u500-u94)
  u478=+u488*(8.2910960010732776d5*u481+2.0d0*(u461-9.6d1*u489))
  u70=-2.25675833419102515d0*u73*u458
  u73=1.41047395886939072d-1*u484
  u458=u511*(2.0d0*(u47+u476)+u95)
  u484=u73*u406
  u465=u406*(u484+u70)
  value=value+(c(69)*(x*(u407*(u71+u406*(u520+u505)+u407*(u471*u407+u46&
 &4+u5))+u456*(u524+u465+(u484+u467)*u456)+u406*(u478+u458*u406)+u68)))
  u69=6.34713281491225823d-1*u75
  u464=-4.23142187660817215d-1*u59
  u59=2.11571093830408608d-1*u48
  value=value+(c(70)*(u427*(u407*(u464+u518+(u474+u59)*u407)+u519+u69))&
 &)
  u79=u510*(4.0d0*(u85-2.4d2*u419)+u99)
  u472=6.34713281491225823d-1*u79
  u99=u510*(u503+2.0d0*(u498-4.8d2*u76))
  u485=-2.11571093830408608d-1*u99
  u63=2.11571093830408608d-1*u75
  u75=+u492*(u503+4.0d0*(u498-2.4d2*u76))
  u492=u511*(2.0d0*(u91-4.8d2*u90)+5.38921240069763044d7*u481)
  u521=u75*u406
  u522=u492*u406
  u523=u63*u406
  value=value+(c(71)*(x*(u407*(u472+u521+u407*((u59+u474)*u407+u522+u48&
 &5))+u523+u515)))
  u472=(u53+u473)
  value=value+(c(72)*(y*(u456*(u92+u406*(u51*u406+u9)+u456*(u472*u456+u&
 &462+u487))+u406*(u507+u497*u406)+u96)))
  u485=u61*u456
  u466=u456*(u486+u485)
  value=value+(c(73)*(z*(u407*(u482+u456*(u466+u505)+(u456*(u83+u485)+u&
 &77)*u407)+u456*(u54+u74*u406+u456*(u80*u456+u517+u87))+u81*u406+u98))&
 &)
  value=value+(c(74)*(y*(u407*(u71+u456*(u83*u456+u505)+u407*((u80+u485&
 &)*u407+u466+u5))+u456*(u478+u465+(u484+u458)*u456)+u406*(u524+u467*u4&
 &06)+u68)))
  u458=u50*(8.0d0*(u483-2.0d1*u419)+4.18742222276428161d4*u481)
  u70=+u488*(2.48732880032198328d6*u481+2.0d0*(u461-1.6d2*u506))
  u5=u445*(u494+u498)
  u71=u511*(3.2d1*(a3*(-u495-u491)-1.0d1*u460)+3.95208909384492899d7*u4&
 &81)
  u467=+u488*(u443+2.0d0*(u509+u62))
  u524=u52*(2.0d0*(u47+u502)+u8)
  u478=+u512*(u91+u72)
  value=value+(c(75)*(z*(u407*(u70+u406*(u478*u406+u71)+u407*(u472*u407&
 &+u406*(u467+u473)+u5))+u406*(u496+u524*u406)+u458)))
  u458=-3.9375d1*u516
  u70=2.11571093830408608d-1*u79
  u79=-7.05236979434695359d-2*u99
  u99=7.05236979434695359d-2*u48
  u467=(u99+u474)*u407
  value=value+(c(76)*(y*(u407*(u70+u521+u407*(u467+u522+u79))+u523+u458&
 &)))
  u521=-1.96875d2*u510*(6.3d1*u481+u56)
  u478=u457*(4.0d0*(u85-3.36d2*u419)+3.86917813383419621d5*u481)
  u5=5.02993157398445508d6*u481
  u524=+u488*(u5+2.0d0*(u498-6.72d2*u76))
  u71=-u459*(2.0d0*(u85-2.24d2*u419)+1.28972604461139874d5*u481)
  u419=+u84*(u5+4.0d0*(u498-3.36d2*u76))
  u5=u511*(2.0d0*(u91-6.72d2*u90)+7.54489736097668261d7*u481)
  value=value+(c(77)*(z*(u407*(u478+u419*u406+u407*(u467+u5*u406+u524))&
 &+u71*u406+u521)))
  u478=u508*u456
  value=value+(c(78)*(x*((u493+u456*(u456*(u475+u478)+u78))*u407+u456*(&
 &u65+u456*(u479*u456+u60))+u469)))
  value=value+(c(79)*(u427*((u89+u456*(u478+u470))*u407+u456*(u513+u46*&
 &u456)+u66)))
  value=value+(c(80)*(x*(u407*(u88+u456*(u6*u456+u468)+(u456*(u58+u478)&
 &+u93)*u407)+u456*(u67+u490*u456)+u499)))
  value=value+(c(81)*(u427*(u407*(u464+u7*u456+(u478+u59)*u407)+u496*u4&
 &56+u69)))
  value=value+(c(82)*(x*(u407*(u70+u75*u456+u407*((u99+u478)*u407+u492*&
 &u456+u79))+u63*u456+u458)))
  u524=u508*u407
  value=value+(c(83)*(u427*(u407*(u419+u407*(u524+u5))+u71)))
  u427=2.11571093830408608d0*u510
  u419=u427*(1.4d1*u514+3.0d0*u85)
  u514=-u427*(u47+7.0d0*u86)
  u427=u445*(1.4d1*u49+u509)
  value=value+(c(84)*(x*(u407*(u419+u407*(u407*(u427+u524)+u514))+u521)&
 &))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_6=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_7(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_7
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u349
  real(kind=8) :: u379
  real(kind=8) :: u380
  real(kind=8) :: u389
  real(kind=8) :: u39
  real(kind=8) :: u390
  real(kind=8) :: u391
  real(kind=8) :: u392
  real(kind=8) :: u393
  real(kind=8) :: u394
  real(kind=8) :: u395
  real(kind=8) :: u396
  real(kind=8) :: u397
  real(kind=8) :: u398
  real(kind=8) :: u399
  real(kind=8) :: u4
  real(kind=8) :: u40
  real(kind=8) :: u400
  real(kind=8) :: u401
  real(kind=8) :: u402
  real(kind=8) :: u403
  real(kind=8) :: u404
  real(kind=8) :: u405
  real(kind=8) :: u406
  real(kind=8) :: u407
  real(kind=8) :: u408
  real(kind=8) :: u409
  real(kind=8) :: u41
  real(kind=8) :: u410
  real(kind=8) :: u411
  real(kind=8) :: u412
  real(kind=8) :: u413
  real(kind=8) :: u414
  real(kind=8) :: u415
  real(kind=8) :: u416
  real(kind=8) :: u417
  real(kind=8) :: u418
  real(kind=8) :: u419
  real(kind=8) :: u42
  real(kind=8) :: u420
  real(kind=8) :: u421
  real(kind=8) :: u422
  real(kind=8) :: u423
  real(kind=8) :: u424
  real(kind=8) :: u426
  real(kind=8) :: u427
  real(kind=8) :: u428
  real(kind=8) :: u429
  real(kind=8) :: u43
  real(kind=8) :: u430
  real(kind=8) :: u431
  real(kind=8) :: u432
  real(kind=8) :: u433
  real(kind=8) :: u434
  real(kind=8) :: u435
  real(kind=8) :: u436
  real(kind=8) :: u437
  real(kind=8) :: u438
  real(kind=8) :: u439
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u441
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u46
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_7=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u68=A4_(p,pd,erfpd,exppd2)
  u408=p**2
  u398=a3**(-3)
  u44=3.75d-1*u398*u408*(3.0d0*u68*u408-2.0d0*a3*A2_(p,pd,erfpd,exppd2)&
 &)
  u54=2.65868077635827404d1*u68
  u419=-7.05236979434695359d-2*u398
  u8=p**4
  u379=exppd2*pd
  u454=-8.0d0*u379
  u97=+u419*(u54+u454)*u8
  u349=y**2
  value=value+(c(1)*(y*(u97*u349+u44)))
  if ( lmax .eq. 0 ) return
  u44=A5_(p,pd,erfpd,exppd2)
  u97=u44*u408
  u69=5.0d0*u97
  u64=A3_(p,pd,erfpd,exppd2)
  u93=a3*u64
  u393=u398*p**3
  u414=1.125d0*u393*(u69-2.0d0*u93)
  u89=1.86107654345079183d2*u44
  u62=p**5
  u396=exppd2*pd2
  u439=-1.6d1*u396
  u59=+u419*(u89+u439)*u62
  u456=x*y
  u421=u59*u349
  u407=(u421+u414)
  value=value+(c(2)*(u456*u407))
  u77=exppd2*u408
  u65=4.0d0*exppd2
  u435=-1.41047395886939072d-2*u393*(7.97604232907482212d1*u97+2.0d0*(1&
 &.2d1*u77-5.0d0*a3*(u65+5.31736155271654808d0*u64)))
  u97=2.25d0*u393*(u69-u93)
  value=value+(c(3)*(u349*(u97+u421)+u435))
  value=value+(c(4)*(y*u407*z))
  if ( lmax .eq. 1 ) return
  u435=A6_(p,pd,erfpd,exppd2)
  u97=u435*u408
  u414=a3*u68
  u59=u398*u8
  u69=-1.125d0*u59
  u93=+u69*(5.0d0*u97-2.0d0*u414)
  u68=1.86107654345079183d2*u435
  u64=-1.6d1*u379
  u393=(u68+u64)
  u8=p**6
  u91=u393*u8
  u94=7.05236979434695359d-2*u398
  u79=u94*u91
  u405=a3*(-u454-u54)
  u421=u379*u408
  u54=2.11571093830408608d-1*u59*(2.0d0*(u405-8.0d0*u421)+1.86107654345&
 &079183d2*u97)
  u39=1.67496888910571265d3*u435
  u380=2.0d0*pd2
  u404=+u64*(9.0d0+u380)
  u395=(u39+u404)*u8
  u392=+u419*u395
  u407=x**2
  value=value+(c(5)*(y*((u79+u392*u407)*u349+u54*u407+u93)))
  u437=u393*u408
  u84=4.23142187660817215d-1*u59*(u437+u405)
  u415=u392*u349
  u399=(u349*(u84+u415)+u93)
  value=value+(c(6)*(x*u399))
  value=value+(c(7)*(u456*(u415+u54)*z))
  u60=+u69*(2.5d1*u97-6.0d0*u414)
  u414=1.41047395886939072d-1*u59*(5.0d0*u437+3.0d0*u405)
  value=value+(c(8)*(y*(u349*(u414+u415)+u60)))
  value=value+(c(9)*(u399*z))
  u399=z**2
  value=value+(c(10)*(y*((u54+u415)*u399+u79*u349+u93)))
  if ( lmax .eq. 2 ) return
  u415=A7_(p,pd,erfpd,exppd2)
  u392=u415*u408
  u79=7.0d0*u392
  u437=a3*u44
  u84=u398*u62
  u414=u84*(u79-2.0d0*u437)
  u97=-1.6875d1*u414
  u69=1.67496888910571265d3*u415
  u59=-3.2d1*u396
  u60=(u69+u59)
  u62=p**7
  u405=u60*u62
  u92=u398*u405
  u443=2.11571093830408608d-1*u92
  u93=a3*(-u439-u89)
  u89=2.11571093830408608d-1*u84
  u54=pd2*u408
  u455=exppd2*u54
  u53=u89*(2.0d0*(u93-1.6d1*u455)+1.67496888910571265d3*u392)
  u40=1.84246577801628391d4*u415
  u453=(1.1d1+u380)
  u406=+u59*u453
  u438=(u40+u406)*u62
  u85=+u419*u438
  u418=u85*u407
  u422=u53*u407
  value=value+(c(11)*(u456*((u443+u418)*u349+u422+u97)))
  u7=8.0d0*exppd2
  u427=a3*(u7+2.65868077635827404d1*u44)
  u44=6.04488839515453165d-3*u84
  u70=u44*(2.0d0*(4.0d1*u77-7.0d0*u427)+9.30538271725395914d2*u392)
  u429=-1.125d1*u84*(u79-u437)
  u79=7.05236979434695359d-2*u92
  u92=-5.625d0*u414
  u414=u60*u408
  u83=4.23142187660817215d-1*u84*(u414+u93)
  value=value+(c(12)*(u349*(u429+u83*u407+(u418+u79)*u349)+u92*u407+u70&
 &))
  value=value+(c(13)*(y*((u79+u418)*u349+u422+u92)*z))
  u74=3.5d1*u392
  u98=-5.625d0*u84*(u74-6.0d0*u437)
  u75=1.41047395886939072d-1*u84*(5.0d0*u414+3.0d0*u93)
  u414=u85*u349
  u400=(u349*(u75+u414)+u98)
  value=value+(c(14)*(u456*u400))
  value=value+(c(15)*(x*(u349*(u83+u414)+u92)*z))
  u401=(u53+u414)*u399
  u423=u79*u349
  value=value+(c(16)*(u456*(u401+u423+u92)))
  u420=u44*(2.0d0*(2.0d2*u77-2.1d1*u427)+4.65269135862697957d3*u392)
  u44=-1.6875d1*u84*(u74-4.0d0*u437)
  u74=-8.0d1*u455
  u437=u89*(2.0d0*(u93+u74)+8.37484444552856323d3*u392)
  value=value+(c(17)*(u349*(u44+u349*(u414+u437))+u420))
  value=value+(c(18)*(y*u400*z))
  value=value+(c(19)*((u92+u349*(u414+u83))*u399+u349*(u429+u423)+u70))
  u420=y*z
  value=value+(c(20)*(u420*(u401+u443*u349+u97)))
  if ( lmax .eq. 3 ) return
  u423=A8_(p,pd,erfpd,exppd2)
  u437=u423*u408
  u429=a3*u435
  u85=u398*u8
  u79=u85*(7.0d0*u437-2.0d0*u429)
  u443=1.6875d1*u79
  u414=1.67496888910571265d3*u423
  u392=-3.2d1*u379
  u401=(u414+u392)
  u93=p**8
  u84=u401*u93
  u98=-2.11571093830408608d-1*u398
  u435=+u98*u84
  u89=a3*(-u64-u68)
  u68=u85*(1.67496888910571265d3*u437+2.0d0*(u89-1.6d1*u421))
  u44=-1.26942656298245165d0*u68
  u53=1.84246577801628391d4*u423
  u417=u379*u453
  u400=-3.2d1*u417
  u70=(u53+u400)
  u97=u70*u93
  u427=u398*u97
  u8=4.23142187660817215d-1*u427
  u412=a3*(-u404-u39)
  u404=1.84246577801628391d4*u437
  u452=u417*u408
  u417=-1.6d1*u452
  u47=2.11571093830408608d-1*u85
  u88=u47*(2.0d0*(u412+u417)+u404)
  u92=2.39520551142116908d5*u423
  u422=pd2**2
  u75=4.0d0*u422
  u389=(u380+1.1d1)
  u83=+u392*(1.3d1*u389+u75)
  u418=(u92+u83)*u93
  u428=u398*u418
  u445=-7.05236979434695359d-2*u428
  u416=u445*u407
  u424=u88*u407
  value=value+(c(21)*(y*((u435+u407*(u416+u8))*u349+u407*(u44+u424)+u44&
 &3)))
  u86=u401*u408
  u87=u85*(u89+u86)
  u78=-1.26942656298245165d0*u87
  u48=2.11571093830408608d-1*u427
  u397=-2.11571093830408608d-1*u68
  u402=u70*u408
  u409=a3*(-u64*(u380+9.0d0)-u39)
  u39=4.23142187660817215d-1*u85*(u402+u409)
  u64=u39*u407
  u426=u397*u407
  value=value+(c(22)*(x*(u349*(u78+u64+(u416+u48)*u349)+u426+u443)))
  u45=-6.34713281491225823d-1*u68
  value=value+(c(23)*(u456*((u48+u416)*u349+u424+u45)*z))
  u410=-6.0d0*u429
  u442=5.625d0*u85*(3.5d1*u437+u410)
  u391=3.0d0*u89
  u72=-1.41047395886939072d-1*u85*(u391+5.0d0*u86)
  u86=7.05236979434695359d-2*u427
  u441=8.37484444552856323d3*u437
  u424=-8.0d1*u421
  u61=-2.11571093830408608d-1*u85*(u441+2.0d0*(u391+u424))
  u391=1.41047395886939072d-1*u85*(5.0d0*u402+3.0d0*u409)
  u402=(u416+u86)*u349
  value=value+(c(24)*(y*(u349*(u72+u391*u407+u402)+u61*u407+u442)))
  u409=5.625d0*u79
  u79=-4.23142187660817215d-1*u87
  value=value+(c(25)*((u349*(u79+u64+u402)+u426+u409)*z))
  u96=1.86107654345079183d2*u423
  u64=-4.0d0*u379
  u394=-4.23142187660817215d-1*u85*(2.65868077635827404d1*u429+4.0d0*(u&
 &96+u64)*u408)
  u68=a3**(-2)
  u429=4.23142187660817215d-1*u68*u91
  u402=2.17745955583742644d4*u423
  u4=(1.3d1+u380)
  u91=u379*u4
  u87=-3.2d1*u91
  u46=u94*(u402+u87)*u93
  u94=-7.05236979434695359d-2*u427
  u411=u47*(2.0d0*(a3*u393+u417)+u404)
  u404=-4.23142187660817215d-1*u68
  u393=+u404*u395
  u416=+u454*(4.0d0*u389+u422)
  u426=(u53+u416)*u93
  u395=-1.12837916709551257d0*u398*u426
  u417=7.05236979434695359d-2*u428
  u428=-2.11571093830408608d-1*u427
  u427=u417*u407
  value=value+(c(26)*(y*((u429+u393*u407)*u399+u349*(u46+u407*(u427+u39&
 &5)+(u427+u94)*u349)+u407*(u411+u428*u407)+u394)))
  u46=-6.34713281491225823d-1*u85*(u441+4.0d0*(u89-4.0d1*u421))
  u94=u47*(2.0d0*(u412-8.0d1*u452)+9.21232889008141955d4*u437)
  u411=u445*u349
  u393=(u349*(u46+u349*(u411+u94))+u442)
  value=value+(c(27)*(x*u393))
  value=value+(c(28)*(u456*(u349*(u391+u411)+u61)*z))
  u395=(u397+u349*(u411+u39))*u399
  u428=u86*u349
  value=value+(c(29)*(x*(u395+u349*(u79+u428)+u409)))
  u79=u456*z
  u429=u48*u349
  value=value+(c(30)*(u79*((u88+u411)*u399+u429+u45)))
  u409=2.8125d1*u85*(4.9d1*u437+u410)
  u410=-1.05785546915204304d0*u85*(1.17247822237399885d4*u437+4.0d0*(u8&
 &9-5.6d1*u421))
  u441=u47*(2.0d0*(u412-1.12d2*u452)+1.28972604461139874d5*u437)
  value=value+(c(31)*(y*(u349*(u410+u349*(u411+u441))+u409)))
  value=value+(c(32)*(u393*z))
  value=value+(c(33)*(y*((u61+u349*(u411+u391))*u399+u349*(u72+u428)+u4&
 &42)))
  value=value+(c(34)*(z*(u395+u349*(u78+u429)+u443)))
  value=value+(c(35)*(y*(u399*(u44+u8*u349+(u411+u88)*u399)+u435*u349+u&
 &443)))
  if ( lmax .eq. 4 ) return
  u409=A9_(p,pd,erfpd,exppd2)
  u429=u409*u408
  u441=9.0d0*u429
  u443=a3*u415
  u442=-2.0d0*u443
  u445=u398*u62
  u48=u445*(u441+u442)
  u86=5.90625d2*u48
  u8=-6.4d1*u396
  u88=(1.84246577801628391d4*u409+u8)
  u435=p**9
  u94=u398*u88*u435
  u412=-1.05785546915204304d0*u94
  u89=a3*(-u59-u69)
  u437=2.0d0*(u89-3.2d1*u455)
  u410=1.84246577801628391d4*u429
  u69=u445*(u410+u437)
  u47=-2.11571093830408608d0*u69
  u391=(2.39520551142116908d5*u409+u8*u4)
  u39=u398*u391*u435
  u427=7.05236979434695359d-1*u39
  u61=a3*(-u406-u40)
  u406=2.11571093830408608d-1*u445
  u62=u4*u408
  u394=u396*u62
  u397=u406*(2.0d0*(u61-3.2d1*u394)+2.39520551142116908d5*u429)
  u411=(u380+1.3d1)
  u452=(1.5d1*u411+u75)
  u417=u398*(3.59280826713175363d6*u409+u8*u452)*u435
  u85=-7.05236979434695359d-2*u417
  u413=u85*u407
  u430=u397*u407
  value=value+(c(36)*(u456*((u412+u407*(u413+u427))*u349+u407*(u47+u430&
 &)+u86)))
  u57=a3*(1.6d1*exppd2+1.86107654345079183d2*u415)
  u56=-1.00748139919242194d-2*u445*(1.17247822237399885d4*u429+2.0d0*(1&
 &.12d2*u77-9.0d0*u57))
  u51=2.3625d2*u445*(u441-u443)
  u441=-2.11571093830408608d-1*u94
  u94=2.3625d2*u48
  u43=u88*u408
  u88=u445*(u89+u43)
  u80=-2.53885312596490329d0*u88
  u67=4.23142187660817215d-1*u39
  u66=-2.11571093830408608d-1*u69
  u451=u391*u408
  u391=a3*(-u59*u389-u40)
  u40=4.23142187660817215d-1*u445*(u451+u391)
  u431=u40*u407
  u432=u66*u407
  value=value+(c(37)*(u349*(u51+u407*(u431+u80)+(u407*(u67+u413)+u441)*&
 &u349)+u407*(u94+u432)+u56))
  u76=1.18125d2*u48
  u48=-1.26942656298245165d0*u69
  value=value+(c(38)*(y*((u441+u407*(u413+u67))*u349+u407*(u48+u430)+u7&
 &6)*z))
  u42=u445*(1.5d1*u429+u442)
  u430=3.54375d2*u42
  u446=3.0d0*u89
  u81=u445*(u446+5.0d0*u43)
  u73=-4.23142187660817215d-1*u81
  u58=2.11571093830408608d-1*u39
  u95=9.21232889008141955d4*u429
  u50=-2.11571093830408608d-1*u445
  u450=-1.6d2*u455
  u99=+u50*(u95+2.0d0*(u446+u450))
  u63=3.0d0*u391
  u391=1.41047395886939072d-1*u445
  u6=u391*(5.0d0*u451+u63)
  u403=(u413+u58)*u349
  u433=u6*u407
  u434=u99*u407
  value=value+(c(39)*(u456*(u349*(u73+u433+u403)+u434+u430)))
  u82=-1.26942656298245165d0*u88
  value=value+(c(40)*(x*(u349*(u82+u431+u403)+u432+u76)*z))
  u90=-1.26942656298245165d0*u445*(1.86107654345079183d2*u443+(8.374844&
 &44552856323d3*u409+u59)*u408)
  u393=1.26942656298245165d0*u68
  u5=u393*u405
  u431=2.11571093830408608d-1*u398
  u88=(1.5d1+u380)
  u405=u431*(2.76369866702442587d5*u409+u8*u88)*u435
  u440=-2.11571093830408608d-1*u39
  u403=u88*u408
  u55=u406*(2.0d0*(a3*u60+u59*u403)+2.76369866702442587d5*u429)
  u60=+u404*u438
  u69=(5.0d0*u411+u422)
  u432=-2.82094791773878144d-1*u398
  u404=+u432*(1.19760275571058454d6*u409+u8*u69)*u435
  u438=7.05236979434695359d-2*u417
  u417=u438*u407
  u435=u60*u407
  value=value+(c(41)*(u456*((u5+u435)*u399+u349*(u405+u407*(u417+u404)+&
 &(u417+u440)*u349)+u407*(u55+u440*u407)+u90)))
  u59=-2.7d1*u57
  u57=-3.35827133064140647d-3*u445*(5.86239111186999426d4*u429+2.0d0*(5&
 &.6d2*u77+u59))
  u8=1.18125d2*u445*(4.5d1*u429-4.0d0*u443)
  u49=+u50*(u95+2.0d0*(u89+u450))
  u450=7.05236979434695359d-2*u39
  u444=1.18125d2*u42
  u42=-6.34713281491225823d-1*u445*(u95+4.0d0*(u89+u74))
  u95=u406*(2.0d0*(u61-1.6d2*u394)+1.19760275571058454d6*u429)
  value=value+(c(42)*(u349*(u8+u42*u407+u349*((u450+u413)*u349+u95*u407&
 &+u49))+u444*u407+u57))
  u74=-1.41047395886939072d-1*u81
  value=value+(c(43)*(y*(u349*(u74+u433+(u413+u450)*u349)+u434+u444)*z)&
 &)
  u436=1.34330853225656259d-2*u445*(1.4d1*(1.67496888910571265d3*u409-u&
 &65)*u408+9.0d0*a3*(u7-5.58322963035237549d2*u415))
  u413=+u50*(3.51743466712199656d4*u429+2.0d0*(u89-6.4d1*u455))
  u50=u391*(3.0d0*(u89-1.92d2*u455)+(1.65821920021465552d5*u409-6.4d1*e&
 &xppd2*u422)*u408)
  u72=-7.05236979434695359d-2*u39
  u65=4.0d0*pd2
  u409=u406*(8.0d0*(a3*(-u439*(6.0d0+pd2)-5.02490666731713794d3*u415)-8&
 &.0d0*u396*(2.7d1+u65)*u408)+4.97465760064396656d5*u429)
  u439=(u61-2.24d2*u394)
  u433=pd2**3
  u39=u433*u408
  u394=-7.05236979434695359d-2*u445*(5.02993157398445508d6*u429+2.0d0*(&
 &3.0d0*u439-1.28d2*exppd2*u39))
  u396=u406*(u437+u410)
  u437=-4.23142187660817215d-1*u445*(u61+u451)
  value=value+(c(44)*(u349*(u413+u407*(u437*u407+u409)+u349*((u72+u417)&
 &*u349+u407*(u394+u417)+u50))+u407*(u66+u396*u407)+u436))
  u436=u438*u349
  value=value+(c(45)*(u420*(u399*(u55+u435+u349*(u436+u404)+(u436+u440)&
 &*u399)+u349*(u405+u440*u349)+u5*u407+u90)))
  u413=5.90625d2*u445*(2.1d1*u429+u442)
  u50=-1.05785546915204304d0*u445*(1.28972604461139874d5*u429+4.0d0*(u8&
 &9-1.12d2*u455))
  u410=u406*(2.0d0*u439+1.67664385799481836d6*u429)
  u409=u85*u349
  u394=(u349*(u50+u349*(u409+u410))+u413)
  value=value+(c(46)*(u456*u394))
  value=value+(c(47)*(x*(u349*(u42+u349*(u409+u95))+u444)*z))
  u396=(u99+u349*(u409+u6))*u399
  u437=u450*u349
  value=value+(c(48)*(u456*(u396+u349*(u74+u437)+u444)))
  u438=u58*u349
  value=value+(c(49)*(x*z*((u66+u349*(u409+u40))*u399+u349*(u82+u438)+u&
 &76)))
  u404=(u409+u397)*u399
  u439=u67*u349
  u440=u441*u349
  value=value+(c(50)*(u456*(u399*(u48+u439+u404)+u440+u76)))
  u60=-1.67913566532070324d-2*u445*(8.20734755661799196d4*u429+2.0d0*(7&
 &.84d2*u77+u59))
  u436=3.54375d3*u445*(1.4d1*u429-u443)
  u405=-2.11571093830408608d0*u445*(u446+7.0d0*u43)
  u89=u391*(1.4d1*u451+u63)
  value=value+(c(51)*(u349*(u436+u349*(u349*(u89+u409)+u405))+u60))
  value=value+(c(52)*(y*u394*z))
  value=value+(c(53)*((u444+u349*(u349*(u95+u409)+u42))*u399+u349*(u8+u&
 &349*(u437+u49))+u57))
  value=value+(c(54)*(u420*(u396+u349*(u73+u438)+u430)))
  value=value+(c(55)*(u399*(u94+u349*(u439+u80)+(u349*(u40+u409)+u66)*u&
 &399)+u349*(u51+u440)+u56))
  value=value+(c(56)*(u420*(u399*(u47+u427*u349+u404)+u412*u349+u86)))
  if ( lmax .eq. 5 ) return
  u394=A10_(p,pd,erfpd,exppd2)
  u438=u394*u408
  u405=a3*u423
  u42=-2.0d0*u405
  u436=u398*u93
  u86=u436*(9.0d0*u438+u42)
  u94=-5.90625d2*u86
  u430=-6.4d1*u379
  u89=(1.84246577801628391d4*u394+u430)
  u413=p**10
  u93=1.05785546915204304d0*u398*u89*u413
  u396=a3*(-u392-u414)
  u67=u436*(2.0d0*(u396-3.2d1*u421)+1.84246577801628391d4*u438)
  u58=9.52069922236838735d0*u67
  u409=(2.39520551142116908d5*u394-6.4d1*u91)
  u427=u398*u409*u413
  u72=-3.17356640745612912d0*u427
  u40=a3*(-u392*u389-u53)
  u80=2.39520551142116908d5*u438
  u435=u379*u62
  u90=-3.2d1*u435
  u95=u436*(u80+2.0d0*(u40+u90))
  u429=-3.17356640745612912d0*u95
  u451=3.59280826713175363d6*u394
  u415=u379*u452
  u50=(u451-6.4d1*u415)
  u81=u398*u50*u413
  u434=1.05785546915204304d0*u81
  u414=a3*(-u83-u92)
  u417=3.59280826713175363d6*u438
  u49=u415*u408
  u415=2.11571093830408608d-1*u436
  u44=u415*(2.0d0*(u414-3.2d1*u49)+u417)
  u74=(u75+1.5d1*u4)
  u446=8.0d0*u433
  u410=u398*(6.10777405412398116d7*u394+u430*(1.7d1*u74+u446))*u413
  u395=-7.05236979434695359d-2*u410
  u412=u395*u407
  u441=u44*u407
  value=value+(c(57)*(y*((u93+u407*(u407*(u434+u412)+u72))*u349+u407*(u&
 &58+u407*(u441+u429))+u94)))
  u47=u89*u408
  u89=u436*(u47+u396)
  u85=6.34713281491225823d0*u89
  u73=-1.05785546915204304d0*u427
  u59=2.11571093830408608d0*u67
  u78=u409*u408
  u409=a3*(-u400-u53)
  u60=u436*(u409+u78)
  u428=-4.23142187660817215d0*u60
  u400=7.05236979434695359d-1*u81
  u8=-2.11571093830408608d-1*u95
  u439=u50*u408
  u50=a3*(-u392*(u75+1.3d1*u453)-u92)
  u48=4.23142187660817215d-1*u436
  u5=u48*(u439+u50)
  u442=u5*u407
  u443=u8*u407
  value=value+(c(58)*(x*(u349*(u85+u407*(u442+u428)+(u407*(u400+u412)+u&
 &73)*u349)+u407*(u59+u443)+u94)))
  u61=3.17356640745612912d0*u67
  u92=-2.11571093830408608d0*u95
  value=value+(c(59)*(u456*((u73+u407*(u412+u400))*u349+u407*(u92+u441)&
 &+u61)*z))
  u441=u436*(1.5d1*u438+u42)
  u95=-3.54375d2*u441
  u440=3.0d0*u396
  u76=u48*(5.0d0*u47+u440)
  u75=-2.11571093830408608d-1*u427
  u63=9.21232889008141955d4*u438
  u55=u436*(2.0d0*(u440-1.6d2*u421)+u63)
  u51=1.26942656298245165d0*u55
  u404=3.0d0*u409
  u77=u436*(u404+5.0d0*u78)
  u437=-8.46284375321634431d-1*u77
  u82=4.23142187660817215d-1*u81
  u406=3.0d0*u40
  u56=1.19760275571058454d6*u438
  u450=-1.6d2*u435
  u43=-2.11571093830408608d-1*u436
  u6=+u43*(u56+2.0d0*(u406+u450))
  u391=u379*u422
  u423=(u451-2.56d2*u391)*u408
  u83=5.0d0*u423
  u451=-1.6d3*u435
  u452=1.41047395886939072d-1*u436
  u57=u452*(3.0d0*(u414+u451)+u83)
  u397=(u407*(u82+u412)+u75)*u349
  u444=u57*u407
  u445=u6*u407
  value=value+(c(60)*(y*(u349*(u76+u407*(u444+u437)+u397)+u407*(u51+u44&
 &5)+u95)))
  u99=-1.18125d2*u86
  u86=1.26942656298245165d0*u89
  u62=1.26942656298245165d0*u67
  u455=-2.53885312596490329d0*u60
  value=value+(c(61)*((u349*(u86+u407*(u442+u455)+u397)+u407*(u62+u443)&
 &+u99)*z))
  u45=1.26942656298245165d0*u436
  u91=u45*((8.37484444552856323d3*u394+u392)*u408+1.86107654345079183d2&
 &*u405)
  u442=-u393*u84
  u84=+u98*(2.76369866702442587d5*u394+u430*u88)*u413
  u98=2.11571093830408608d-1*u427
  u427=4.60616444504070978d5*u438
  u405=a3*u401
  u389=-6.34713281491225823d-1*u436
  u89=u379*(2.5d1+u65)
  u66=u89*u408
  u397=+u389*(u427+4.0d0*(u405-1.6d1*u66))
  u401=u68*u97
  u46=2.53885312596490329d0*u401
  u4=u379*(3.5d1*u411+8.0d0*u422)
  u97=u431*(8.38321928997409179d6*u394-6.4d1*u4)*u413
  u431=-4.23142187660817215d-1*u81
  u88=(1.19760275571058454d6*u394+u430*u69)
  u420=2.0d0*u88*u408
  u65=a3*u70
  u7=u48*(u420+u65)
  u69=u68*u418
  u70=-4.23142187660817215d-1*u69
  u418=+u419*(8.98202066782938406d7*u394+u430*(2.5d1*u74+u446))*u413
  u60=7.05236979434695359d-2*u410
  u67=-2.11571093830408608d-1*u81
  u410=u60*u407
  u419=u70*u407
  u446=u67*u407
  value=value+(c(62)*(y*((u442+u407*(u419+u46))*u399+u349*(u84+u407*(u4&
 &07*(u418+u410)+u97)+(u407*(u431+u410)+u98)*u349)+u407*(u397+u407*(u44&
 &6+u7))+u91)))
  u71=u436*(4.0d0*(u396+u424)+u63)
  u63=1.90413984447367747d0*u71
  u390=u436*(u56+2.0d0*(u40+u450))
  u393=-6.34713281491225823d-1*u390
  u424=2.11571093830408608d-1*u81
  u41=2.11571093830408608d-1*u55
  u9=+u389*(u56+4.0d0*(u40-8.0d1*u435))
  u443=u415*(2.0d0*(u414-1.6d2*u49)+1.79640413356587681d7*u438)
  u447=u9*u407
  u448=u443*u407
  u449=u41*u407
  value=value+(c(63)*(x*(u349*(u63+u447+u349*((u424+u412)*u349+u448+u39&
 &3))+u449+u95)))
  u52=6.34713281491225823d-1*u55
  u55=-4.23142187660817215d-1*u77
  value=value+(c(64)*(u456*(u349*(u55+u444+(u412+u424)*u349)+u445+u52)*&
 &z))
  u77=a3*(-u64-u96)
  u64=u45*(8.0d0*(u77-4.0d0*u421)+8.37484444552856323d3*u438)
  u96=+u389*(u427+2.0d0*(u40-3.2d1*u66))
  u66=u48*(u420+u406)
  u427=+u43*(2.76369866702442587d5*u438+2.0d0*(a3*(-u392*u411-u402)+u39&
 &2*u403))
  u420=u415*(3.2d1*(a3*(-u416-u53)-2.0d0*u4*u408)+8.38321928997409179d6&
 &*u438)
  u406=-7.05236979434695359d-2*u436
  u4=+u406*(8.98202066782938406d7*u438+2.0d0*(3.0d0*(u414-4.0d3*u435)-1&
 &.28d2*u391*(2.5d1+u380)*u408))
  u380=u415*(2.0d0*(u409+u90)+u80)
  u389=-4.23142187660817215d-1*u436*(u414+u439)
  value=value+(c(65)*(x*(u349*(u96+u407*(u389*u407+u420)+u349*((u67+u41&
 &0)*u349+u407*(u4+u410)+u66))+u407*(u427+u380*u407)+u64)))
  u96=-u45*(3.0d0*u405+(9.21232889008141955d4*u394+u430*(5.0d0+pd2))*u4&
 &08)
  u45=1.26942656298245165d0*u401
  u420=u391*u408
  u4=u415*(2.0d0*(3.0d0*(u65+u450)-1.28d2*u420)+u417)
  u389=+u432*(1.79640413356587681d7*u394+u430*(5.0d0*u74+2.0d0*u433))*u&
 &413
  value=value+(c(66)*(u79*((u45+u419)*u399+u349*(u424+u407*(u410+u389)+&
 &(u410+u67)*u349)+u407*(u4+u446)+u96)))
  u96=-5.90625d2*u436*(2.1d1*u438+u42)
  u4=1.28972604461139874d5*u438
  u389=1.05785546915204304d0*u436
  u65=u389*(4.0d0*(u396-1.12d2*u421)+u4)
  u405=1.67664385799481836d6*u438
  u446=+u43*(u405+2.0d0*(u40-2.24d2*u435))
  u430=7.05236979434695359d-2*u81
  u43=u389*(2.0d0*(u440-2.24d2*u421)+u4)
  u440=-u389*(u405+4.0d0*(u40-1.12d2*u435))
  u4=u415*(2.0d0*(u414-2.24d2*u49)+2.51496578699222754d7*u438)
  u405=(u430+u412)*u349
  value=value+(c(67)*(y*(u349*(u65+u440*u407+u349*(u405+u4*u407+u446))+&
 &u43*u407+u96)))
  u412=-1.18125d2*u441
  u66=6.34713281491225823d-1*u71
  u71=-2.11571093830408608d-1*u390
  value=value+(c(68)*((u349*(u66+u447+u349*(u405+u448+u71))+u449+u412)*&
 &z))
  u390=u48*(8.0d0*(3.0d0*u77-2.0d1*u421)+4.18742222276428161d4*u438)
  u77=+u406*(2.48732880032198328d6*u438+2.0d0*(3.0d0*(a3*(-u87-u402)-1.&
 &44d3*u421)-6.4d2*u379*u54))
  u392=u452*(3.0d0*(u409-2.56d2*u435)+4.0d0*(7.18561653426350725d5*u394&
 &-3.2d1*u391)*u408)
  u391=-7.05236979434695359d-2*u81
  u408=7.05236979434695359d-2*u436*(3.2d1*(3.0d0*(a3*(-u454*(u422+4.0d0&
 &*u453)-u53)-1.1d2*u435)-8.0d1*u420)+3.95208909384492899d7*u438)
  u420=+u406*(9.70058232125573479d7*u438+2.0d0*(3.0d0*(u414-2.88d2*u49)&
 &-2.56d2*u379*u39))
  u406=u415*(2.0d0*(u404+u450)+u56)
  u450=-1.41047395886939072d-1*u436*(u83+3.0d0*(u50+u451))
  value=value+(c(69)*(y*(u349*(u77+u407*(u450*u407+u408)+u349*((u391+u4&
 &10)*u349+u407*(u420+u410)+u392))+u407*(u6+u406*u407)+u390)))
  u390=-6.34713281491225823d-1*u398*(4.60616444504070978d5*u394-6.4d1*u&
 &89)*u413
  u77=8.46284375321634431d-1*u398*u88*u413
  u392=-6.77027500257307545d0*u68*u426
  u391=4.23142187660817215d-1*u69
  u408=-u45
  u420=u60*u349
  u406=u349*(u418+u420)
  u450=u391*u407
  value=value+(c(70)*(z*(u399*(u427+u407*(u450+u392)+u349*(u406+u97)+(u&
 &349*(u431+u420)+u450+u380)*u399)+u349*(u390+u349*(u67*u349+u77))+u407&
 &*(u45+u408*u407)+u64)))
  value=value+(c(71)*(y*(u399*(u397+u46*u407+u349*(u431*u349+u97)+u399*&
 &((u67+u420)*u399+u406+u419+u7))+u349*(u84+u98*u349)+u442*u407+u91)))
  u390=2.11571093830408608d0*u436
  u77=u390*(1.4d1*u47+9.0d0*u396)
  u397=-u390*(u404+7.0d0*u78)
  u390=u452*(3.0d0*(u414-4.48d3*u435)+1.4d1*u423)
  u408=u395*u349
  u391=(u349*(u77+u349*(u349*(u390+u408)+u397))+u96)
  value=value+(c(72)*(x*u391))
  value=value+(c(73)*(u456*(u349*(u440+u349*(u408+u4))+u43)*z))
  u392=(u41+u349*(u349*(u443+u408)+u9))*u399
  u451=u430*u349
  value=value+(c(74)*(x*(u392+u349*(u66+u349*(u451+u71))+u412)))
  u452=u424*u349
  value=value+(c(75)*(u79*((u6+u349*(u408+u57))*u399+u349*(u55+u452)+u5&
 &2)))
  u398=(u349*(u5+u408)+u8)*u399
  u453=u82*u349
  u454=u75*u349
  value=value+(c(76)*(x*(u399*(u62+u349*(u453+u455)+u398)+u349*(u86+u45&
 &4)+u99)))
  u455=u400*u349
  u456=u73*u349
  value=value+(c(77)*(u79*(u399*(u92+u455+(u408+u44)*u399)+u456+u61)))
  u61=-4.134375d3*u436*(2.7d1*u438+u42)
  u42=4.44299297043858076d1*u436*(2.0d0*u47+u396)
  u396=-8.88598594087716152d0*u436*(u409+3.0d0*u78)
  u409=u48*(6.0d0*u439+u50)
  value=value+(c(78)*(y*(u349*(u42+u349*(u349*(u409+u408)+u396))+u61)))
  value=value+(c(79)*(u391*z))
  value=value+(c(80)*(y*((u43+u349*(u349*(u4+u408)+u440))*u399+u349*(u6&
 &5+u349*(u451+u446))+u96)))
  value=value+(c(81)*(z*(u392+u349*(u63+u349*(u452+u393))+u95)))
  value=value+(c(82)*(y*(u399*(u51+u349*(u453+u437)+(u349*(u57+u408)+u6&
 &)*u399)+u349*(u76+u454)+u95)))
  value=value+(c(83)*(z*(u399*(u59+u349*(u455+u428)+u398)+u349*(u85+u45&
 &6)+u94)))
  value=value+(c(84)*(y*(u399*(u58+u72*u349+u399*((u44+u408)*u399+u434*&
 &u349+u429))+u93*u349+u94)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_7=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_8(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_8
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u411
  real(kind=8) :: u413
  real(kind=8) :: u414
  real(kind=8) :: u415
  real(kind=8) :: u424
  real(kind=8) :: u432
  real(kind=8) :: u438
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u491
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u496
  real(kind=8) :: u497
  real(kind=8) :: u498
  real(kind=8) :: u499
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u500
  real(kind=8) :: u501
  real(kind=8) :: u502
  real(kind=8) :: u503
  real(kind=8) :: u504
  real(kind=8) :: u505
  real(kind=8) :: u506
  real(kind=8) :: u507
  real(kind=8) :: u508
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_8=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u5=A4_(p,pd,erfpd,exppd2)
  u414=p**2
  u415=a3**(-3)
  u448=-2.0d0*a3
  u458=1.25d-1*u415*u414*(3.0d0*u5*u414+u448*A2_(p,pd,erfpd,exppd2))
  u442=2.65868077635827404d1*u5
  u454=-7.05236979434695359d-2*u415
  u424=p**4
  u96=exppd2*pd
  u438=-8.0d0*u96
  u446=+u454*(u442+u438)*u424
  u411=y**2
  value=value+(c(1)*((u446*u411+u458)*z))
  if ( lmax .eq. 0 ) return
  u458=A5_(p,pd,erfpd,exppd2)
  u446=u458*u414
  u78=A3_(p,pd,erfpd,exppd2)
  u449=+u448*u78
  u413=u415*p**3
  u452=3.75d-1*u413
  u93=u452*(5.0d0*u446+u449)
  u479=1.86107654345079183d2*u458
  u510=p**5
  u443=exppd2*pd2
  u462=-1.6d1*u443
  u480=(u479+u462)*u510
  u87=+u454*u480
  u485=u87*u411
  value=value+(c(2)*(x*(u485+u93)*z))
  u71=u452*(1.5d1*u446+u449)
  value=value+(c(3)*(y*(u485+u71)*z))
  u71=exppd2*u414
  u449=4.0d0*exppd2
  u452=-4.70157986289796906d-3*u413*(7.97604232907482212d1*u446+2.0d0*(&
 &1.2d1*u71-5.0d0*a3*(u449+5.31736155271654808d0*u78)))
  u446=u458*u510
  u78=1.875d0*u415*u446
  u413=z**2
  value=value+(c(4)*((u93+u485)*u413+u78*u411+u452))
  if ( lmax .eq. 1 ) return
  u452=A6_(p,pd,erfpd,exppd2)
  u78=u452*u414
  u93=+u448*u5
  u87=u415*u424
  u5=u87*(5.0d0*u78+u93)
  u91=-3.75d-1*u5
  u68=1.86107654345079183d2*u452
  u483=-1.6d1*u96
  u468=(u68+u483)
  u51=p**6
  u62=u468*u51
  u60=u415*u62
  u76=7.05236979434695359d-2*u60
  u8=a3*(-u438-u442)
  u442=7.05236979434695359d-2*u87
  u424=u96*u414
  u52=u442*(2.0d0*(u8-8.0d0*u424)+1.86107654345079183d2*u78)
  u55=1.67496888910571265d3*u452
  u444=2.0d0*pd2
  u47=+u483*(9.0d0+u444)
  u512=(u55+u47)
  u499=u512*u51
  u89=+u454*u499
  u448=x**2
  value=value+(c(5)*(((u76+u89*u448)*u411+u52*u448+u91)*z))
  u56=u442*(2.0d0*(u8-2.4d1*u424)+5.58322963035237549d2*u78)
  u442=x*y
  u481=u89*u411
  value=value+(c(6)*(u442*(u481+u56)*z))
  u461=(u52+u481)*u413
  u490=u76*u411
  value=value+(c(7)*(x*(u461+u490+u91)))
  u92=-3.75d-1*u87*(1.5d1*u78+u93)
  u78=1.41047395886939072d-1*u87*(3.0d0*u468*u414+u8)
  value=value+(c(8)*((u411*(u78+u481)+u92)*z))
  value=value+(c(9)*(y*((u56+u481)*u413+u490+u92)))
  u78=-1.125d0*u5
  u92=2.11571093830408608d-1*u60
  value=value+(c(10)*(z*(u461+u92*u411+u78)))
  if ( lmax .eq. 2 ) return
  u78=A7_(p,pd,erfpd,exppd2)
  u92=u78*u414
  u89=a3*u458
  u76=-2.0d0*u89
  u60=u415*u510
  u8=u60*(7.0d0*u92+u76)
  u93=-5.625d0*u8
  u87=1.67496888910571265d3*u78
  u5=-3.2d1*u443
  u510=(u87+u5)
  u472=p**7
  u81=u510*u472
  u466=u415*u81
  u514=2.11571093830408608d-1*u466
  u88=1.67496888910571265d3*u92
  u471=a3*(-u462-u479)
  u479=7.05236979434695359d-2*u60
  u485=u443*u414
  u52=-1.6d1*u485
  u53=u479*(2.0d0*(u471+u52)+u88)
  u456=1.84246577801628391d4*u78
  u473=(1.1d1+u444)
  u70=+u5*u473
  u488=(u456+u70)
  u49=u488*u472
  u492=u415*u49
  u513=-7.05236979434695359d-2*u492
  u491=u513*u448
  value=value+(c(11)*(x*((u514+u491)*u411+u53*u448+u93)*z))
  u99=2.1d1*u92
  u59=u60*(u99+u76)
  u90=-1.875d0*u59
  u97=7.05236979434695359d-2*u466
  u54=u479*(2.0d0*(u471-4.8d1*u485)+5.02490666731713794d3*u92)
  value=value+(c(12)*(y*((u97+u491)*u411+u54*u448+u90)*z))
  u453=2.65868077635827404d1*u458
  u458=5.58322963035237549d2*u78
  u445=8.0d0*exppd2
  u450=7.0d0*a3
  u447=-4.02992559676968777d-3*u60*(u450*(u453+u445)+5.0d0*(u458-u445)*&
 &u414)
  u56=a3**(-2)
  u491=3.75d0*u56*u446
  u446=-7.05236979434695359d-2*u466
  u77=u479*(2.0d0*(2.65868077635827404d1*u89+u52)+u88)
  u88=-1.41047395886939072d-1*u56
  u479=+u88*u480
  u480=5.02490666731713794d3*u78
  u52=-2.82094791773878144d-1*u415
  u481=+u462*(6.0d0+pd2)
  u462=+u52*(u480+u481)*u472
  u493=7.05236979434695359d-2*u492
  u492=u493*u448
  value=value+(c(13)*((u491+u479*u448)*u413+u411*(u97+u448*(u492+u462)+&
 &(u492+u446)*u411)+u448*(u77+u446*u448)+u447))
  u447=u510*u414
  u491=1.41047395886939072d-1*u60
  u77=u491*(3.0d0*u447+u471)
  u479=u513*u411
  value=value+(c(14)*(x*(u411*(u77+u479)+u90)*z))
  u462=(u54+u479)*u413
  u493=u97*u411
  value=value+(c(15)*(u442*(u462+u493+u90)))
  u446=x*z
  u494=u514*u411
  value=value+(c(16)*(u446*((u53+u479)*u413+u494+u93)))
  u432=-5.625d0*u60*(3.5d1*u92+u76)
  u76=u491*(5.0d0*u447+u471)
  value=value+(c(17)*(y*(u411*(u76+u479)+u432)*z))
  u432=-u450*(u445+u453)
  u453=2.01496279838484388d-3*u60*(2.0d0*(1.2d2*u71+u432)+2.79161481517&
 &618774d3*u92)
  u447=-3.75d0*u60*(u99-u89)
  value=value+(c(18)*((u90+u411*(u479+u77))*u413+u411*(u447+u493)+u453)&
 &)
  u493=-5.625d0*u59
  u447=y*z
  value=value+(c(19)*(u447*(u462+u494+u493)))
  u493=6.04488839515453165d-3*u60*(2.0d0*(4.0d1*u71+u432)+9.30538271725&
 &395914d2*u92)
  u59=-1.125d1*u8
  u8=u78*u472
  u97=-3.9375d1*u415*u8
  u514=4.23142187660817215d-1*u466
  value=value+(c(20)*(u413*(u59+u514*u411+(u479+u53)*u413)+u97*u411+u49&
 &3))
  if ( lmax .eq. 3 ) return
  u493=A8_(p,pd,erfpd,exppd2)
  u59=u493*u414
  u97=a3*u452
  u514=-2.0d0*u97
  u513=u415*u51
  u466=u513*(7.0d0*u59+u514)
  u99=5.625d0*u466
  u494=1.67496888910571265d3*u493
  u432=-3.2d1*u96
  u479=(u494+u432)
  u92=p**8
  u51=u479*u92
  u89=u415*u51
  u453=-2.11571093830408608d-1*u89
  u471=a3*(-u483-u68)
  u68=u513*(1.67496888910571265d3*u59+2.0d0*(u471-1.6d1*u424))
  u76=-4.23142187660817215d-1*u68
  u53=1.84246577801628391d4*u493
  u452=u96*u473
  u491=-3.2d1*u452
  u77=(u53+u491)
  u462=u77*u92
  u60=u415*u462
  u505=4.23142187660817215d-1*u60
  u69=a3*(-u47-u55)
  u47=1.84246577801628391d4*u59
  u58=u452*u414
  u452=-1.6d1*u58
  u511=7.05236979434695359d-2*u513
  u57=u511*(2.0d0*(u69+u452)+u47)
  u492=2.39520551142116908d5*u493
  u91=pd2**2
  u461=4.0d0*u91
  u467=(u444+1.1d1)
  u90=+u432*(1.3d1*u467+u461)
  u63=(u492+u90)
  u490=u63*u92
  u498=u415*u490
  u94=-7.05236979434695359d-2*u498
  u486=u94*u448
  value=value+(c(21)*(((u453+u448*(u486+u505))*u411+u448*(u76+u57*u448)&
 &+u99)*z))
  u65=u513*(5.02490666731713794d3*u59+2.0d0*(u471-4.8d1*u424))
  u45=-2.11571093830408608d-1*u65
  u459=2.11571093830408608d-1*u60
  u469=5.52739733404885173d4*u59
  u496=-4.8d1*u58
  u64=u511*(2.0d0*(u69+u496)+u469)
  value=value+(c(22)*(u442*((u459+u486)*u411+u64*u448+u45)*z))
  u54=1.86107654345079183d2*u493
  u61=-4.0d0*u96
  u66=4.0d0*(u54+u61)*u414
  u95=-4.23142187660817215d-1*u513
  u84=+u95*(2.65868077635827404d1*u97+u66)
  u476=u56*u62
  u62=4.23142187660817215d-1*u476
  u497=-2.11571093830408608d-1*u60
  u86=a3*u468
  u468=(1.3d1+u444)
  u507=u468*u414
  u93=u96*u507
  u515=u511*(2.0d0*(u86-1.6d1*u93)+2.17745955583742644d4*u59)
  u464=+u88*u499
  u450=+u438*(4.0d0*u467+u91)
  u499=(u53+u450)
  u438=u499*u92
  u457=-1.12837916709551257d0*u415*u438
  u478=7.05236979434695359d-2*u498
  u498=-7.05236979434695359d-2*u60
  u482=u478*u448
  u463=u448*(u482+u457)
  u495=u464*u448
  value=value+(c(23)*(x*((u62+u495)*u413+u411*(u459+u463+(u482+u497)*u4&
 &11)+u448*(u515+u498*u448)+u84)))
  u62=u513*(2.1d1*u59+u514)
  u80=1.875d0*u62
  u518=u479*u414
  u79=u513*(u471+3.0d0*u518)
  u74=-1.41047395886939072d-1*u79
  u67=7.05236979434695359d-2*u60
  u48=-7.05236979434695359d-2*u65
  u500=u77*u414
  u50=a3*(-u483*(u444+9.0d0)-u55)
  u55=1.41047395886939072d-1*u513
  u483=u55*(3.0d0*u500+u50)
  value=value+(c(24)*((u411*(u74+u483*u448+(u486+u67)*u411)+u48*u448+u8&
 &0)*z))
  u46=+u95*(8.86226925452758014d0*u97+u66)
  u97=1.41047395886939072d-1*u476
  u486=2.17745955583742644d4*u493
  u6=u96*u468
  u476=7.05236979434695359d-2*u415*(u486-3.2d1*u6)*u92
  u66=u511*(2.0d0*(u86+u496)+u469)
  u469=(u482+u498)
  u496=u497*u448
  value=value+(c(25)*(y*((u97+u495)*u413+u411*(u476+u463+u469*u411)+u44&
 &8*(u66+u496)+u46)))
  u457=2.11571093830408608d-1*u513*(2.0d0*(u86+u452)+u47)
  u47=-1.41047395886939072d-1*u513
  u46=+u47*(a3*u512+8.0d0*u499*u414)
  value=value+(c(26)*(z*(u413*(u515+u448*(u482+u46)+u469*u413)+u448*(u4&
 &57+u496)+u84)))
  u512=-2.11571093830408608d-1*u513
  u46=+u512*(8.37484444552856323d3*u59+2.0d0*(u471-8.0d1*u424))
  u86=u55*(5.0d0*u500+u50)
  u478=u94*u411
  value=value+(c(27)*(u442*(u411*(u86+u478)+u46)*z))
  u457=(u48+u411*(u478+u483))*u413
  u497=u67*u411
  value=value+(c(28)*(x*(u457+u411*(u74+u497)+u80)))
  u496=u442*z
  u498=u459*u411
  value=value+(c(29)*(u496*((u64+u478)*u413+u498+u45)))
  u464=(u478+u57)*u413
  u499=u505*u411
  u500=u453*u411
  value=value+(c(30)*(x*(u413*(u76+u499+u464)+u500+u99)))
  u99=5.625d0*u513*(3.5d1*u59+u514)
  u50=+u512*(2.51245333365856897d4*u59+4.0d0*(u471-1.2d2*u424))
  u512=u511*(2.0d0*(u69-2.4d2*u58)+2.76369866702442587d5*u59)
  value=value+(c(31)*((u411*(u50+u411*(u478+u512))+u99)*z))
  u50=+u47*(u471+5.0d0*u518)
  value=value+(c(32)*(y*((u46+u411*(u478+u86))*u413+u411*(u50+u497)+u99&
 &)))
  u99=5.625d0*u62
  u50=-4.23142187660817215d-1*u79
  value=value+(c(33)*(z*(u457+u411*(u50+u498)+u99)))
  u50=-4.23142187660817215d-1*u65
  value=value+(c(34)*(y*(u413*(u50+u499+(u478+u64)*u413)+u500+u99)))
  u50=2.8125d1*u466
  u99=-7.05236979434695359d-1*u68
  u512=-1.05785546915204304d0*u89
  u466=7.05236979434695359d-1*u60
  value=value+(c(35)*(z*(u413*(u99+u466*u411+u464)+u512*u411+u50)))
  if ( lmax .eq. 4 ) return
  u50=A9_(p,pd,erfpd,exppd2)
  u99=u50*u414
  u512=a3*u78
  u466=-2.0d0*u512
  u62=u415*u472
  u94=u62*(9.0d0*u99+u466)
  u459=1.96875d2*u94
  u505=-6.4d1*u443
  u67=(1.84246577801628391d4*u50+u505)
  u60=p**9
  u453=u415*u67*u60
  u57=-1.05785546915204304d0*u453
  u64=1.84246577801628391d4*u99
  u89=a3*(-u5-u87)
  u518=-3.2d1*u485
  u69=u62*(u64+2.0d0*(u89+u518))
  u47=-7.05236979434695359d-1*u69
  u471=(2.39520551142116908d5*u50+u505*u468)
  u86=u415*u471*u60
  u59=7.05236979434695359d-1*u86
  u514=a3*(-u70-u456)
  u87=7.05236979434695359d-2*u62
  u515=u443*u507
  u452=u87*(2.0d0*(u514-3.2d1*u515)+2.39520551142116908d5*u99)
  u65=(u444+1.3d1)
  u55=(1.5d1*u65+u461)
  u68=u415*(3.59280826713175363d6*u50+u505*u55)*u60
  u74=-7.05236979434695359d-2*u68
  u483=u74*u448
  value=value+(c(36)*(x*((u57+u448*(u483+u59))*u411+u448*(u47+u452*u448&
 &)+u459)*z))
  u58=2.7d1*u99
  u513=u62*(u58+u466)
  u507=3.9375d1*u513
  u70=-2.11571093830408608d-1*u453
  u476=2.0d0*(u89-9.6d1*u485)
  u97=5.52739733404885173d4*u99
  u66=u62*(u97+u476)
  u48=-4.23142187660817215d-1*u66
  u464=4.23142187660817215d-1*u86
  u472=u87*(2.0d0*(u514-9.6d1*u515)+7.18561653426350725d5*u99)
  value=value+(c(37)*(y*((u70+u448*(u483+u464))*u411+u448*(u48+u472*u44&
 &8)+u507)*z))
  u511=(1.67496888910571265d3*u50-u449)*u414
  u95=a3*(1.6d1*exppd2+1.86107654345079183d2*u78)
  u78=9.0d0*u95
  u80=6.71654266128281294d-3*u62*(2.8d1*u511+u78)
  u76=-7.875d1*u56*u8
  u8=2.11571093830408608d-1*u453
  u460=1.86107654345079183d2*u512
  u98=(u460+u518)
  u518=-2.11571093830408608d-1*u62
  u72=+u518*(3.51743466712199656d4*u99+4.0d0*u98)
  u478=u56*u81
  u81=8.46284375321634431d-1*u478
  u449=2.11571093830408608d-1*u415
  u451=4.0d0*pd2
  u504=(2.7d1+u451)
  u75=u449*(4.97465760064396656d5*u50+u505*u504)*u60
  u509=-4.23142187660817215d-1*u86
  u455=(1.65821920021465552d5*u50+u505*(9.0d0+pd2))*u414
  u475=a3*u510
  u510=1.41047395886939072d-1*u62
  u73=u510*(u455+u475)
  u508=+u88*u49
  u49=u443*(2.1d1*u65+u461)
  u88=+u454*(5.02993157398445508d6*u50-6.4d1*u49)*u60
  u465=7.05236979434695359d-2*u68
  u68=-7.05236979434695359d-2*u86
  u477=u465*u448
  u487=u508*u448
  value=value+(c(38)*((u76+u448*(u487+u81))*u413+u411*(u70+u448*(u448*(&
 &u88+u477)+u75)+(u448*(u509+u477)+u8)*u411)+u448*(u72+u448*(u68*u448+u&
 &73))+u80))
  u76=u67*u414
  u81=u62*(u89+3.0d0*u76)
  u75=-4.23142187660817215d-1*u81
  u88=2.11571093830408608d-1*u86
  u67=-7.05236979434695359d-2*u66
  u502=u471*u414
  u471=3.0d0*u502
  u83=a3*(-u5*u467-u456)
  u456=u510*(u471+u83)
  value=value+(c(39)*(x*(u411*(u75+u456*u448+(u483+u88)*u411)+u67*u448+&
 &u507)*z))
  u474=(8.37484444552856323d3*u50+u5)*u414
  u5=-1.26942656298245165d0*u62
  u85=+u5*(6.2035884781693061d1*u512+u474)
  u517=4.23142187660817215d-1*u478
  u478=(1.5d1+u444)
  u500=u449*(2.76369866702442587d5*u50+u505*u478)*u60
  u506=-2.11571093830408608d-1*u86
  u469=u478*u414
  u9=u443*u469
  u516=u87*(2.0d0*(u475-9.6d1*u9)+8.2910960010732776d5*u99)
  u444=(5.0d0*u65+u91)
  u82=(1.19760275571058454d6*u50+u505*u444)
  u505=+u52*u82*u60
  u470=(u477+u506)
  u501=u506*u448
  value=value+(c(40)*(u442*((u517+u487)*u413+u411*(u500+u448*(u477+u505&
 &)+u470*u411)+u448*(u516+u501)+u85)))
  u484=+u5*(u460+u474)
  u474=2.76369866702442587d5*u99
  u460=2.11571093830408608d-1*u62
  u5=u460*(2.0d0*(u475-3.2d1*u9)+u474)
  u9=a3*u488
  u488=-1.41047395886939072d-1*u62
  u489=+u488*(u9+2.0d0*u82*u414)
  value=value+(c(41)*(u446*(u413*(u5+u448*(u477+u489)+u470*u413)+u448*(&
 &u5+u501)+u484)))
  u484=u62*(4.5d1*u99+u466)
  u489=3.9375d1*u484
  u82=u62*(u89+5.0d0*u76)
  u76=-1.41047395886939072d-1*u82
  u5=7.05236979434695359d-2*u86
  u457=+u518*(9.21232889008141955d4*u99+2.0d0*(u89-1.6d2*u485))
  u7=u510*(5.0d0*u502+u83)
  value=value+(c(42)*(y*(u411*(u76+u7*u448+(u483+u5)*u411)+u457*u448+u4&
 &89)*z))
  u502=1.34330853225656259d-2*u62*(1.4d1*u511+3.0d0*a3*(u445-u458))
  u511=-7.05236979434695359d-2*u62
  u458=+u511*(1.05523040013659897d5*u99+2.0d0*(u89-1.92d2*u485))
  u503=u510*(u455+u89)
  u455=u504*u414
  u510=u443*u455
  u504=u87*(8.0d0*(a3*(-u481-u480)-2.4d1*u510)+1.49239728019318997d6*u9&
 &9)
  u480=5.02993157398445508d6*u99
  u483=-3.2d1*u49*u414
  u49=+u511*(u480+2.0d0*(u83+u483))
  u83=u87*(u476+u97)
  u476=+u488*(u514+u471)
  u471=(u68+u477)
  value=value+(c(43)*(u411*(u458+u448*(u476*u448+u504)+u411*(u471*u411+&
 &u448*(u49+u477)+u503))+u448*(u67+u83*u448)+u502))
  u502=u465*u411
  value=value+(c(44)*(u447*(u413*(u516+u487+u411*(u502+u505)+(u502+u506&
 &)*u413)+u411*(u500+u506*u411)+u517*u448+u85)))
  u49=+u518*(u64+2.0d0*u98)
  u458=u460*(4.0d0*(u475-1.6d1*u510)+4.97465760064396656d5*u99)
  u476=+u511*(u480+2.0d0*(u9+u483))
  value=value+(c(45)*(u413*(u72+u448*(u509*u448+u458)+u413*(u471*u413+u&
 &448*(u476+u477)+u73))+u448*(u49+u8*u448)+u80))
  u49=+u518*(u474+4.0d0*(u89-2.4d2*u485))
  u477=u87*(2.0d0*(u514-4.8d2*u515)+3.59280826713175363d6*u99)
  u476=u74*u411
  value=value+(c(46)*(x*(u411*(u49+u411*(u476+u477))+u489)*z))
  u458=(u457+u411*(u476+u7))*u413
  u503=u5*u411
  value=value+(c(47)*(u442*(u458+u411*(u76+u503)+u489)))
  u504=u88*u411
  value=value+(c(48)*(u446*((u67+u411*(u476+u456))*u413+u411*(u75+u504)&
 &+u507)))
  u465=(u476+u472)*u413
  u505=u464*u411
  u506=u70*u411
  value=value+(c(49)*(u442*(u413*(u48+u505+u465)+u506+u507)))
  u507=u59*u411
  u508=u57*u411
  value=value+(c(50)*(u446*(u413*(u47+u507+(u476+u452)*u413)+u508+u459)&
 &))
  u85=1.96875d2*u62*(6.3d1*u99+u466)
  u517=-3.52618489717347679d-1*u62*(3.86917813383419621d5*u99+4.0d0*(u8&
 &9-3.36d2*u485))
  u487=u87*(2.0d0*(u514-6.72d2*u515)+u480)
  value=value+(c(51)*(y*(u411*(u517+u411*(u476+u487))+u85)*z))
  u85=-3.35827133064140647d-3*u62*(5.86239111186999426d4*u99+2.0d0*(5.6&
 &d2*u71-u78))
  u517=3.9375d1*u62*(1.35d2*u99-4.0d0*u512)
  u487=+u511*(u474+2.0d0*(u89-4.8d2*u485))
  value=value+(c(52)*((u489+u411*(u411*(u477+u476)+u49))*u413+u411*(u51&
 &7+u411*(u503+u487))+u85))
  u517=1.18125d2*u484
  u85=-4.23142187660817215d-1*u82
  value=value+(c(53)*(u447*(u458+u411*(u85+u504)+u517)))
  u82=1.17247822237399885d4*u99
  u85=1.12d2*u71
  u517=-1.00748139919242194d-2*u62*(u82+2.0d0*(u85-3.0d0*u95))
  u503=7.875d1*u513
  u487=7.875d1*u62*(u58-u512)
  u458=-8.46284375321634431d-1*u81
  value=value+(c(54)*(u413*(u503+u411*(u505+u458)+(u411*(u456+u476)+u67&
 &)*u413)+u411*(u487+u506)+u517))
  u487=1.96875d2*u513
  u458=-7.05236979434695359d-1*u66
  value=value+(c(55)*(u447*(u413*(u458+u507+u465)+u508+u487)))
  u487=-1.67913566532070324d-2*u62*(u82+2.0d0*(u85-u78))
  u458=5.90625d2*u94
  u517=-1.05785546915204304d0*u69
  u503=1.771875d3*u415*u50*u60
  u85=-3.17356640745612912d0*u453
  u94=1.05785546915204304d0*u86
  value=value+(c(56)*(u413*(u458+u85*u411+u413*((u452+u476)*u413+u94*u4&
 &11+u517))+u503*u411+u487))
  if ( lmax .eq. 5 ) return
  u487=A10_(p,pd,erfpd,exppd2)
  u458=u487*u414
  u517=a3*u493
  u503=-2.0d0*u517
  u85=u415*u92
  u92=u85*(9.0d0*u458+u503)
  u94=-1.96875d2*u92
  u74=-6.4d1*u96
  u59=(1.84246577801628391d4*u487+u74)
  u464=p**10
  u465=u415*u59*u464
  u69=1.05785546915204304d0*u465
  u483=a3*(-u432-u494)
  u70=u85*(2.0d0*(u483-3.2d1*u424)+1.84246577801628391d4*u458)
  u57=3.17356640745612912d0*u70
  u502=(2.39520551142116908d5*u487-6.4d1*u6)
  u481=u415*u502*u464
  u445=-3.17356640745612912d0*u481
  u508=a3*(-u432*u467-u53)
  u82=2.39520551142116908d5*u458
  u48=-3.2d1*u93
  u81=u85*(u82+2.0d0*(u508+u48))
  u457=-1.05785546915204304d0*u81
  u477=u96*u55
  u472=(3.59280826713175363d6*u487-6.4d1*u477)
  u482=u415*u472*u464
  u73=1.05785546915204304d0*u482
  u68=a3*(-u90-u492)
  u506=3.59280826713175363d6*u458
  u75=u477*u414
  u477=-3.2d1*u75
  u76=7.05236979434695359d-2*u85
  u47=u76*(2.0d0*(u68+u477)+u506)
  u72=(u461+1.5d1*u468)
  u500=pd2**3
  u98=8.0d0*u500
  u474=u415*(6.10777405412398116d7*u487+u74*(1.7d1*u72+u98))*u464
  u498=-7.05236979434695359d-2*u474
  u480=u498*u448
  value=value+(c(57)*(((u69+u448*(u448*(u73+u480)+u445))*u411+u448*(u57&
 &+u448*(u47*u448+u457))+u94)*z))
  u64=u85*(2.0d0*(u483-9.6d1*u424)+5.52739733404885173d4*u458)
  u58=1.05785546915204304d0*u64
  u452=-1.05785546915204304d0*u481
  u493=+u452
  u97=7.18561653426350725d5*u458
  u509=-9.6d1*u93
  u45=u85*(u97+2.0d0*(u508+u509))
  u494=-7.05236979434695359d-1*u45
  u90=7.05236979434695359d-1*u482
  u485=u76*(2.0d0*(u68-9.6d1*u75)+1.07784248013952609d7*u458)
  value=value+(c(58)*(u442*((u493+u448*(u480+u90))*u411+u448*(u494+u485&
 &*u448)+u58)*z))
  u514=(8.37484444552856323d3*u487+u432)*u414
  u89=u85*(u514+1.86107654345079183d2*u517)
  u86=2.11571093830408608d0*u89
  u475=u56*u51
  u78=-2.11571093830408608d0*u475
  u476=-u452
  u504=a3*u479
  u80=-3.52618489717347679d-1*u85
  u99=u96*u455
  u46=+u80*(4.97465760064396656d5*u458+4.0d0*(u504-1.6d1*u99))
  u446=u56*u462
  u95=1.41047395886939072d0*u446
  u511=8.0d0*u91
  u489=u96*(3.3d1*u65+u511)
  u507=3.52618489717347679d-1*u415*(7.90417818768985798d6*u487-6.4d1*u4&
 &89)*u464
  u463=-7.05236979434695359d-1*u482
  u452=4.0d0*(7.18561653426350725d5*u487+u432*(6.0d0*u65+u91))*u414
  u66=a3*u77
  u471=1.41047395886939072d-1*u85
  u8=u471*(u452+u66)
  u479=u56*u490
  u91=-1.41047395886939072d-1*u479
  u512=u96*(2.7d1*u72+u98)
  u83=+u454*(9.70058232125573479d7*u487-6.4d1*u512)*u464
  u490=7.05236979434695359d-2*u474
  u462=-7.05236979434695359d-2*u482
  u474=u490*u448
  u484=u91*u448
  value=value+(c(59)*(x*((u78+u448*(u484+u95))*u413+u411*(u493+u448*(u4&
 &48*(u83+u474)+u507)+(u448*(u463+u474)+u476)*u411)+u448*(u46+u448*(u46&
 &2*u448+u8))+u86)))
  u77=u85*(2.7d1*u458+u503)
  u95=-3.9375d1*u77
  u507=u59*u414
  u83=u85*(3.0d0*u507+u483)
  u78=4.23142187660817215d-1*u83
  u499=-2.11571093830408608d-1*u481
  u59=4.23142187660817215d-1*u64
  u447=u502*u414
  u502=a3*(-u491-u53)
  u50=u85*(u502+3.0d0*u447)
  u516=-8.46284375321634431d-1*u50
  u505=4.23142187660817215d-1*u482
  u491=-7.05236979434695359d-2*u45
  u49=u472*u414
  u472=3.0d0*u49
  u443=a3*(-u432*(u461+1.3d1*u473)-u492)
  u5=u471*(u472+u443)
  value=value+(c(60)*((u411*(u78+u448*(u5*u448+u516)+(u448*(u505+u480)+&
 &u499)*u411)+u448*(u59+u491*u448)+u95)*z))
  u453=1.26942656298245165d0*u85
  u87=u453*(u514+6.2035884781693061d1*u517)
  u461=-4.23142187660817215d-1*u475
  u514=-2.11571093830408608d-1*u415*(2.76369866702442587d5*u487+u74*u47&
 &8)*u464
  u497=2.11571093830408608d-1*u481
  u475=1.38184933351221293d6*u458
  u517=-2.11571093830408608d-1*u85
  u478=u96*(2.5d1+u451)
  u71=u478*u414
  u79=+u517*(u475+4.0d0*(u504-4.8d1*u71))
  u451=8.46284375321634431d-1*u446
  u518=u96*(3.5d1*u65+u511)
  u501=u449*(8.38321928997409179d6*u487-6.4d1*u518)*u464
  u449=-4.23142187660817215d-1*u482
  u492=(1.19760275571058454d6*u487+u74*u444)
  u511=u492*u414
  u9=u471*(6.0d0*u511+u66)
  u55=u96*(2.5d1*u72+u98)
  u470=+u454*(8.98202066782938406d7*u487-6.4d1*u55)*u464
  u98=-2.11571093830408608d-1*u482
  u460=(u448*(u449+u474)+u497)
  u488=u98*u448
  value=value+(c(61)*(y*((u461+u448*(u484+u451))*u413+u411*(u514+u448*(&
 &u448*(u470+u474)+u501)+u460*u411)+u448*(u79+u448*(u488+u9))+u87)))
  u88=1.26942656298245165d0*u89
  u515=2.76369866702442587d5*u458
  u510=u96*u469
  u456=+u517*(u515+2.0d0*(u504-3.2d1*u510))
  u513=-6.34713281491225823d-1*u85*(4.60616444504070978d5*u458+4.0d0*(u&
 &504-1.6d1*u71))
  u62=u518*u414
  u518=2.11571093830408608d-1*u85
  u7=u518*(4.0d0*(u66-1.6d1*u62)+8.38321928997409179d6*u458)
  u455=2.0d0*u511
  u89=4.23142187660817215d-1*u85
  u511=u89*(u455+u66)
  u469=a3*u63
  u459=-3.2d1*u55*u414
  u55=8.98202066782938406d7*u458
  u495=-7.05236979434695359d-2*u85
  u454=+u495*(u55+2.0d0*(u469+u459))
  u466=u448*(u454+u474)
  value=value+(c(62)*(z*(u413*(u456+u448*(u466+u7)+u460*u413)+u448*(u51&
 &3+u448*(u488+u511))+u88)))
  u67=u85*(2.0d0*(u483-1.6d2*u424)+9.21232889008141955d4*u458)
  u60=6.34713281491225823d-1*u67
  u51=u85*(u502+5.0d0*u447)
  u444=-4.23142187660817215d-1*u51
  u84=2.11571093830408608d-1*u482
  u467=1.19760275571058454d6*u458
  u468=-1.6d2*u93
  u460=+u517*(u467+2.0d0*(u508+u468))
  u473=5.0d0*u49
  u6=u471*(u473+u443)
  value=value+(c(63)*(u442*(u411*(u444+u6*u448+(u480+u84)*u411)+u460*u4&
 &48+u60)*z))
  u63=a3*(-u61-u54)
  u61=u89*(8.0d0*(u63-1.2d1*u424)+2.51245333365856897d4*u458)
  u96=+u517*(u475+2.0d0*(u508-9.6d1*u71))
  u475=u89*(u455+u508)
  u455=a3*(-u432*u65-u486)
  u432=+u495*(8.2910960010732776d5*u458+2.0d0*(u455-9.6d1*u510))
  u510=a3*(-u450-u53)
  u71=u76*(3.2d1*(u510-6.0d0*u62)+2.51496578699222754d7*u458)
  u62=+u495*(u55+2.0d0*(u443+u459))
  u459=u76*(2.0d0*(u502+u509)+u97)
  u509=-1.41047395886939072d-1*u85
  u55=+u509*(u68+u472)
  u472=(u98+u474)
  value=value+(c(64)*(x*(u411*(u96+u448*(u55*u448+u71)+u411*(u472*u411+&
 &u448*(u62+u474)+u475))+u448*(u432+u459*u448)+u61)))
  u62=-u453*(u504+(9.21232889008141955d4*u487+u74*(5.0d0+pd2))*u414)
  u475=4.23142187660817215d-1*u446
  u96=u518*(2.0d0*(u66+u477)+u506)
  u71=+u52*(1.79640413356587681d7*u487+u74*(5.0d0*u72+2.0d0*u500))*u464
  value=value+(c(65)*(u496*((u475+u484)*u413+u411*(u84+u448*(u474+u71)+&
 &(u474+u98)*u411)+u448*(u96+u488)+u62)))
  value=value+(c(66)*(x*(u413*(u513+u448*(u449*u448+u7)+u413*(u472*u413&
 &+u466+u511))+u448*(u456+u497*u448)+u88)))
  u7=u85*(4.5d1*u458+u503)
  u96=-3.9375d1*u7
  u71=u85*(4.0d0*(u483-2.4d2*u424)+u515)
  u62=2.11571093830408608d-1*u71
  u472=u85*(u506+2.0d0*(u508-4.8d2*u93))
  u511=-7.05236979434695359d-2*u472
  u88=7.05236979434695359d-2*u482
  u55=2.11571093830408608d-1*u67
  u466=+u517*(u506+4.0d0*(u508-2.4d2*u93))
  u506=u76*(2.0d0*(u68-4.8d2*u75)+5.38921240069763044d7*u458)
  value=value+(c(67)*((u411*(u62+u466*u448+u411*((u88+u480)*u411+u506*u&
 &448+u511))+u55*u448+u96)*z))
  u454=u89*(8.0d0*(u63-2.0d1*u424)+4.18742222276428161d4*u458)
  u63=+u495*(2.48732880032198328d6*u458+2.0d0*(u455-1.6d2*u99))
  u517=u471*(u452+u508)
  u515=u489*u414
  u456=u76*(3.2d1*(u510-1.0d1*u515)+3.95208909384492899d7*u458)
  u510=-3.2d1*u512*u414
  u512=9.70058232125573479d7*u458
  u513=+u495*(u512+2.0d0*(u443+u510))
  u489=u518*(2.0d0*(u502+u468)+u467)
  u467=+u509*(u68+u473)
  u473=(u462+u474)
  value=value+(c(68)*(y*(u411*(u63+u448*(u467*u448+u456)+u411*(u473*u41&
 &1+u448*(u513+u474)+u517))+u448*(u460+u489*u448)+u454)))
  u454=-6.34713281491225823d-1*u415*(4.60616444504070978d5*u487-6.4d1*u&
 &478)*u464
  u63=8.46284375321634431d-1*u415*u492*u464
  u468=-2.25675833419102515d0*u56*u438
  u456=1.41047395886939072d-1*u479
  u513=-4.23142187660817215d-1*u446
  u489=u490*u411
  u467=u411*(u470+u489)
  u509=u456*u448
  value=value+(c(69)*(z*(u413*(u432+u448*(u509+u468)+u411*(u467+u501)+(&
 &u411*(u449+u489)+u509+u459)*u413)+u411*(u454+u411*(u98*u411+u63))+u44&
 &8*(u475+u513*u448)+u61)))
  value=value+(c(70)*(y*(u413*(u79+u451*u448+u411*(u449*u411+u501)+u413&
 &*((u98+u489)*u413+u467+u484+u9))+u411*(u514+u497*u411)+u461*u448+u87)&
 &))
  u454=-1.05785546915204304d0*u85
  u63=+u454*(u82+2.0d0*(u504+u48))
  u48=3.52618489717347679d-1*u85
  u475=u48*(4.0d0*(u66-1.6d1*u515)+7.90417818768985798d6*u458)
  u456=+u495*(u512+2.0d0*(u469+u510))
  value=value+(c(71)*(z*(u413*(u46+u448*(u463*u448+u475)+u413*(u473*u41&
 &3+u448*(u456+u474)+u8))+u448*(u63+u476*u448)+u86)))
  u63=-u454*(2.0d0*(u483-2.24d2*u424)+1.28972604461139874d5*u458)
  u448=5.02993157398445508d6*u458
  u454=+u80*(u448+4.0d0*(u508-3.36d2*u93))
  u80=u76*(2.0d0*(u68-6.72d2*u75)+7.54489736097668261d7*u458)
  u475=u498*u411
  value=value+(c(72)*(u442*(u411*(u454+u411*(u475+u80))+u63)*z))
  u456=(u55+u411*(u411*(u506+u475)+u466))*u413
  u510=u88*u411
  value=value+(c(73)*(x*(u456+u411*(u62+u411*(u510+u511))+u96)))
  u511=u84*u411
  value=value+(c(74)*(u496*((u460+u411*(u475+u6))*u413+u411*(u444+u511)&
 &+u60)))
  u459=(u411*(u5+u475)+u491)*u413
  u512=u505*u411
  u513=u499*u411
  value=value+(c(75)*(x*(u413*(u59+u411*(u512+u516)+u459)+u411*(u78+u51&
 &3)+u95)))
  u514=u90*u411
  u515=u493*u411
  value=value+(c(76)*(u496*(u413*(u494+u514+(u475+u485)*u413)+u515+u58)&
 &))
  u468=(u47+u475)*u413
  u516=u445*u411
  u517=u73*u411
  u518=u69*u411
  value=value+(c(77)*(x*(u413*(u57+u516+u413*(u468+u517+u457))+u518+u94&
 &)))
  u97=-1.96875d2*u85*(6.3d1*u458+u503)
  u455=2.11571093830408608d0*u85
  u99=u455*(1.4d1*u507+3.0d0*u483)
  u503=-u455*(u502+7.0d0*u447)
  u98=u471*(1.4d1*u49+u443)
  value=value+(c(78)*((u411*(u99+u411*(u411*(u98+u475)+u503))+u97)*z))
  u98=u48*(4.0d0*(u483-3.36d2*u424)+3.86917813383419621d5*u458)
  u99=+u495*(u448+2.0d0*(u508-6.72d2*u93))
  value=value+(c(79)*(y*((u63+u411*(u411*(u80+u475)+u454))*u413+u411*(u&
 &98+u411*(u510+u99))+u97)))
  u98=-1.18125d2*u7
  u99=6.34713281491225823d-1*u71
  u71=-2.11571093830408608d-1*u472
  value=value+(c(80)*(z*(u456+u411*(u99+u411*(u511+u71))+u98)))
  u99=1.26942656298245165d0*u67
  u67=u89*(5.0d0*u507+u483)
  u483=-8.46284375321634431d-1*u51
  value=value+(c(81)*(y*(u413*(u99+u411*(u512+u483)+(u411*(u6+u475)+u46&
 &0)*u413)+u411*(u67+u513)+u98)))
  u99=-1.96875d2*u77
  u77=7.05236979434695359d-1*u64
  u460=2.11571093830408608d0*u83
  u83=-1.41047395886939072d0*u50
  value=value+(c(82)*(z*(u413*(u77+u411*(u514+u83)+u459)+u411*(u460+u51&
 &5)+u99)))
  u459=3.17356640745612912d0*u64
  u64=-1.05785546915204304d0*u45
  value=value+(c(83)*(y*(u413*(u459+u516+u413*((u485+u475)*u413+u517+u6&
 &4))+u518+u99)))
  u445=-1.378125d3*u92
  u92=7.40498828406430127d0*u70
  u70=-1.48099765681286025d0*u81
  u81=7.40498828406430127d0*u465
  u465=-7.40498828406430127d0*u481
  u481=1.48099765681286025d0*u482
  value=value+(c(84)*(z*(u413*(u92+u465*u411+u413*(u468+u481*u411+u70))&
 &+u81*u411+u445)))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_8=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_9(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_9
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u406
  real(kind=8) :: u408
  real(kind=8) :: u419
  real(kind=8) :: u427
  real(kind=8) :: u437
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u445
  real(kind=8) :: u450
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u466
  real(kind=8) :: u467
  real(kind=8) :: u468
  real(kind=8) :: u469
  real(kind=8) :: u47
  real(kind=8) :: u470
  real(kind=8) :: u471
  real(kind=8) :: u472
  real(kind=8) :: u473
  real(kind=8) :: u474
  real(kind=8) :: u475
  real(kind=8) :: u476
  real(kind=8) :: u477
  real(kind=8) :: u478
  real(kind=8) :: u479
  real(kind=8) :: u48
  real(kind=8) :: u480
  real(kind=8) :: u481
  real(kind=8) :: u482
  real(kind=8) :: u483
  real(kind=8) :: u484
  real(kind=8) :: u485
  real(kind=8) :: u486
  real(kind=8) :: u487
  real(kind=8) :: u488
  real(kind=8) :: u489
  real(kind=8) :: u49
  real(kind=8) :: u490
  real(kind=8) :: u491
  real(kind=8) :: u492
  real(kind=8) :: u493
  real(kind=8) :: u494
  real(kind=8) :: u495
  real(kind=8) :: u496
  real(kind=8) :: u497
  real(kind=8) :: u498
  real(kind=8) :: u499
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u500
  real(kind=8) :: u501
  real(kind=8) :: u502
  real(kind=8) :: u503
  real(kind=8) :: u504
  real(kind=8) :: u505
  real(kind=8) :: u506
  real(kind=8) :: u507
  real(kind=8) :: u508
  real(kind=8) :: u509
  real(kind=8) :: u51
  real(kind=8) :: u510
  real(kind=8) :: u511
  real(kind=8) :: u512
  real(kind=8) :: u513
  real(kind=8) :: u514
  real(kind=8) :: u515
  real(kind=8) :: u516
  real(kind=8) :: u517
  real(kind=8) :: u518
  real(kind=8) :: u519
  real(kind=8) :: u52
  real(kind=8) :: u520
  real(kind=8) :: u521
  real(kind=8) :: u522
  real(kind=8) :: u523
  real(kind=8) :: u524
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_9=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u64=A4_(p,pd,erfpd,exppd2)
  u450=p**2
  u474=a3**(-3)
  u443=-2.0d0*a3
  u476=1.25d-1*u474*u450*(3.0d0*u64*u450+u443*A2_(p,pd,erfpd,exppd2))
  u427=2.65868077635827404d1*u64
  u79=-7.05236979434695359d-2*u474
  u419=p**4
  u513=exppd2*pd
  u84=-8.0d0*u513
  u470=+u79*(u427+u84)*u419
  u408=z**2
  value=value+(c(1)*(y*(u470*u408+u476)))
  if ( lmax .eq. 0 ) return
  u476=A5_(p,pd,erfpd,exppd2)
  u470=u476*u450
  u88=A3_(p,pd,erfpd,exppd2)
  u96=+u443*u88
  u406=u474*p**3
  u69=3.75d-1*u406
  u442=u69*(5.0d0*u470+u96)
  u479=1.86107654345079183d2*u476
  u67=exppd2*pd2
  u461=-1.6d1*u67
  u72=(u479+u461)
  u86=p**5
  u81=+u79*u72*u86
  u437=x*y
  u486=u81*u408
  value=value+(c(2)*(u437*(u486+u442)))
  u467=exppd2*u450
  u9=4.0d0*exppd2
  u500=-4.70157986289796906d-3*u406*(7.97604232907482212d1*u470+2.0d0*(&
 &1.2d1*u467-5.0d0*a3*(u9+5.31736155271654808d0*u88)))
  u88=1.875d0*u474*u476*u86
  u406=y**2
  value=value+(c(3)*((u88+u81*u406)*u408+u442*u406+u500))
  u500=u69*(1.5d1*u470+u96)
  u88=y*z
  value=value+(c(4)*(u88*(u486+u500)))
  if ( lmax .eq. 1 ) return
  u500=A6_(p,pd,erfpd,exppd2)
  u442=u500*u450
  u81=+u443*u64
  u470=u474*u419
  u96=u470*(5.0d0*u442+u81)
  u64=-3.75d-1*u96
  u69=1.86107654345079183d2*u500
  u498=-1.6d1*u513
  u464=(u69+u498)
  u486=p**6
  u89=u464*u486
  u517=u474*u89
  u504=7.05236979434695359d-2*u517
  u58=a3*(-u84-u427)
  u427=7.05236979434695359d-2*u470
  u419=u513*u450
  u60=u427*(2.0d0*(u58-8.0d0*u419)+1.86107654345079183d2*u442)
  u477=1.67496888910571265d3*u500
  u502=2.0d0*pd2
  u478=+u498*(9.0d0+u502)
  u50=(u477+u478)
  u59=u50*u486
  u518=+u79*u59
  u443=x**2
  value=value+(c(5)*(y*((u504+u518*u443)*u408+u60*u443+u64)))
  u487=u518*u406
  u456=(u504+u487)*u408
  u488=u60*u406
  value=value+(c(6)*(x*(u456+u488+u64)))
  u64=u427*(2.0d0*(u58-2.4d1*u419)+5.58322963035237549d2*u442)
  u427=u437*z
  u489=u518*u408
  value=value+(c(7)*(u427*(u489+u64)))
  u76=-1.125d0*u96
  u96=2.11571093830408608d-1*u517
  value=value+(c(8)*(y*((u96+u487)*u408+u488+u76)))
  u76=-3.75d-1*u470*(1.5d1*u442+u81)
  value=value+(c(9)*(z*(u456+u64*u406+u76)))
  u96=1.41047395886939072d-1*u470*(3.0d0*u464*u450+u58)
  value=value+(c(10)*(y*(u408*(u96+u489)+u76)))
  if ( lmax .eq. 2 ) return
  u96=A7_(p,pd,erfpd,exppd2)
  u76=u96*u450
  u489=a3*u476
  u504=-2.0d0*u489
  u517=u474*u86
  u58=u517*(7.0d0*u76+u504)
  u442=-5.625d0*u58
  u81=1.67496888910571265d3*u96
  u470=-3.2d1*u67
  u518=(u81+u470)
  u60=p**7
  u86=u518*u60
  u52=u474*u86
  u507=2.11571093830408608d-1*u52
  u472=1.67496888910571265d3*u76
  u519=a3*(-u461-u479)
  u479=7.05236979434695359d-2*u517
  u71=u67*u450
  u509=-1.6d1*u71
  u61=u479*(2.0d0*(u519+u509)+u472)
  u503=1.84246577801628391d4*u96
  u471=(1.1d1+u502)
  u465=+u470*u471
  u524=(u503+u465)
  u5=u524*u60
  u491=u474*u5
  u497=-7.05236979434695359d-2*u491
  u490=u497*u443
  value=value+(c(11)*(u437*((u507+u490)*u408+u61*u443+u442)))
  u99=2.65868077635827404d1*u476
  u476=5.58322963035237549d2*u96
  u514=8.0d0*exppd2
  u445=7.0d0*a3
  u521=-4.02992559676968777d-3*u517*(u445*(u99+u514)+5.0d0*(u476-u514)*&
 &u450)
  u82=u479*(2.0d0*(2.65868077635827404d1*u489+u509)+u472)
  u472=-7.05236979434695359d-2*u52
  u509=(5.02490666731713794d3*u96+u461*(6.0d0+pd2))
  u481=-1.41047395886939072d-1*u517*(a3*u72+2.0d0*u509*u450)
  u72=7.05236979434695359d-2*u491
  u491=u72*u443
  value=value+(c(12)*(u406*(u82+u443*(u491+u481)+(u491+u472)*u406)+u443&
 &*(u82+u472*u443)+u521))
  u521=2.1d1*u76
  u481=u517*(u521+u504)
  u72=-1.875d0*u481
  u472=7.05236979434695359d-2*u52
  u62=u479*(2.0d0*(u519-4.8d1*u71)+5.02490666731713794d3*u76)
  value=value+(c(13)*(u88*((u472+u490)*u408+u62*u443+u72)))
  u479=u497*u406
  u457=(u507+u479)*u408
  u492=u61*u406
  value=value+(c(14)*(u437*(u457+u492+u442)))
  u442=x*z
  u493=u62*u406
  value=value+(c(15)*(u442*((u472+u479)*u408+u493+u72)))
  u488=u518*u450
  u483=1.41047395886939072d-1*u517
  u87=u483*(3.0d0*u488+u519)
  u494=u497*u408
  value=value+(c(16)*(u437*(u408*(u87+u494)+u72)))
  u77=-u445*(u514+u99)
  u99=6.04488839515453165d-3*u517*(2.0d0*(4.0d1*u467+u77)+9.30538271725&
 &395914d2*u76)
  u445=-3.9375d1*u474*u96*u60
  u55=-1.125d1*u58
  u58=4.23142187660817215d-1*u52
  value=value+(c(17)*((u445+u406*(u479+u58))*u408+u406*(u55+u492)+u99))
  u55=-5.625d0*u481
  value=value+(c(18)*(u88*(u457+u493+u55)))
  u493=2.01496279838484388d-3*u517*(2.0d0*(1.2d2*u467+u77)+2.7916148151&
 &7618774d3*u76)
  u55=-3.75d0*u517*(u521-u489)
  value=value+(c(19)*(u408*(u55+u87*u406+(u479+u472)*u408)+u72*u406+u49&
 &3))
  u493=-5.625d0*u517*(3.5d1*u76+u504)
  u55=u483*(5.0d0*u488+u519)
  value=value+(c(20)*(u88*(u408*(u55+u494)+u493)))
  if ( lmax .eq. 3 ) return
  u493=A8_(p,pd,erfpd,exppd2)
  u55=u493*u450
  u58=a3*u500
  u99=-2.0d0*u58
  u72=u474*u486
  u481=u72*(7.0d0*u55+u99)
  u497=5.625d0*u481
  u87=1.67496888910571265d3*u493
  u472=-3.2d1*u513
  u494=(u87+u472)
  u488=p**8
  u517=u494*u488
  u521=u474*u517
  u519=-2.11571093830408608d-1*u521
  u77=a3*(-u498-u69)
  u76=u72*(1.67496888910571265d3*u55+2.0d0*(u77-1.6d1*u419))
  u52=-4.23142187660817215d-1*u76
  u445=1.84246577801628391d4*u493
  u483=u513*u471
  u489=-3.2d1*u483
  u62=(u445+u489)
  u479=u62*u488
  u69=u474*u479
  u507=4.23142187660817215d-1*u69
  u520=a3*(-u478-u477)
  u500=1.84246577801628391d4*u55
  u80=u483*u450
  u483=-1.6d1*u80
  u478=7.05236979434695359d-2*u72
  u504=u478*(2.0d0*(u520+u483)+u500)
  u491=2.39520551142116908d5*u493
  u486=pd2**2
  u456=4.0d0*u486
  u463=(u502+1.1d1)
  u492=+u472*(1.3d1*u463+u456)
  u82=(u491+u492)
  u64=u82*u488
  u68=u474*u64
  u516=-7.05236979434695359d-2*u68
  u482=u516*u443
  value=value+(c(21)*(y*((u519+u443*(u482+u507))*u408+u443*(u52+u504*u4&
 &43)+u497)))
  u457=1.86107654345079183d2*u493
  u466=-4.0d0*u513
  u462=4.0d0*(u457+u466)*u450
  u487=-4.23142187660817215d-1*u72
  u94=+u487*(2.65868077635827404d1*u58+u462)
  u90=a3*u464
  u464=2.11571093830408608d-1*u72*(2.0d0*(u90+u483)+u500)
  u500=-2.11571093830408608d-1*u69
  u483=(1.3d1+u502)
  u508=u483*u450
  u490=u513*u508
  u496=u478*(2.0d0*(u90-1.6d1*u490)+2.17745955583742644d4*u55)
  u61=+u84*(4.0d0*u463+u486)
  u84=(u445+u61)
  u63=-1.41047395886939072d-1*u72
  u70=+u63*(a3*u50+8.0d0*u84*u450)
  u50=7.05236979434695359d-2*u68
  u68=-7.05236979434695359d-2*u69
  u480=u50*u443
  u458=u443*(u480+u70)
  value=value+(c(22)*(x*(u406*(u464+u458+(u480+u500)*u406)+u443*(u496+u&
 &68*u443)+u94)))
  u73=u72*(5.02490666731713794d3*u55+2.0d0*(u77-4.8d1*u419))
  u53=-2.11571093830408608d-1*u73
  u98=2.11571093830408608d-1*u69
  u91=5.52739733404885173d4*u55
  u523=-4.8d1*u80
  u485=u478*(2.0d0*(u520+u523)+u91)
  value=value+(c(23)*(u427*((u98+u482)*u408+u485*u443+u53)))
  u468=(u480+u68)
  u495=u500*u443
  value=value+(c(24)*(y*(u406*(u496+u458+u468*u406)+u443*(u464+u495)+u9&
 &4)))
  u70=+u487*(8.86226925452758014d0*u58+u462)
  u94=2.17745955583742644d4*u493
  u464=u513*u483
  u462=7.05236979434695359d-2*u474*(u94-3.2d1*u464)*u488
  u487=a3**(-2)
  u58=1.41047395886939072d-1*u487*u89
  u89=u478*(2.0d0*(u90+u523)+u91)
  u458=u84*u488
  u84=-1.12837916709551257d0*u474*u458
  u91=-1.41047395886939072d-1*u487*u59
  value=value+(c(25)*(z*(u408*(u462+u443*(u480+u84)+u468*u408)+(u58+u91&
 &*u443)*u406+u443*(u89+u495)+u70)))
  u70=u72*(2.1d1*u55+u99)
  u462=1.875d0*u70
  u58=u494*u450
  u89=u72*(u77+3.0d0*u58)
  u84=-1.41047395886939072d-1*u89
  u91=7.05236979434695359d-2*u69
  u50=-7.05236979434695359d-2*u73
  u500=u62*u450
  u68=a3*(-u498*(u502+9.0d0)-u477)
  u59=1.41047395886939072d-1*u72
  u90=u59*(3.0d0*u500+u68)
  value=value+(c(26)*(y*(u408*(u84+u90*u443+(u482+u91)*u408)+u50*u443+u&
 &462)))
  u477=u516*u406
  u523=(u519+u406*(u477+u507))*u408
  u496=u504*u406
  value=value+(c(27)*(x*(u523+u406*(u52+u496)+u497)))
  u497=u485*u406
  value=value+(c(28)*(u427*((u98+u477)*u408+u497+u53)))
  u53=(u477+u91)*u408
  u498=u90*u406
  u499=u50*u406
  value=value+(c(29)*(x*(u408*(u84+u498+u53)+u499+u462)))
  u462=-2.11571093830408608d-1*u72
  u54=+u462*(8.37484444552856323d3*u55+2.0d0*(u77-8.0d1*u419))
  u48=u59*(5.0d0*u500+u68)
  u500=u516*u408
  value=value+(c(30)*(u427*(u408*(u48+u500)+u54)))
  u68=2.8125d1*u481
  u481=-1.05785546915204304d0*u521
  u521=-7.05236979434695359d-1*u76
  u59=7.05236979434695359d-1*u69
  value=value+(c(31)*(y*((u481+u406*(u477+u59))*u408+u406*(u521+u496)+u&
 &68)))
  u521=5.625d0*u70
  u59=-4.23142187660817215d-1*u73
  value=value+(c(32)*(z*(u523+u406*(u59+u497)+u521)))
  u59=-4.23142187660817215d-1*u89
  value=value+(c(33)*(y*(u408*(u59+u498+(u477+u98)*u408)+u499+u521)))
  u59=5.625d0*u72*(3.5d1*u55+u99)
  u521=+u63*(u77+5.0d0*u58)
  value=value+(c(34)*(z*(u408*(u521+u48*u406+u53)+u54*u406+u59)))
  u521=+u462*(2.51245333365856897d4*u55+4.0d0*(u77-1.2d2*u419))
  u84=u478*(2.0d0*(u520-2.4d2*u80)+2.76369866702442587d5*u55)
  value=value+(c(35)*(y*(u408*(u521+u408*(u500+u84))+u59)))
  if ( lmax .eq. 4 ) return
  u521=A9_(p,pd,erfpd,exppd2)
  u84=u521*u450
  u54=a3*u96
  u59=-2.0d0*u54
  u70=u474*u60
  u516=u70*(9.0d0*u84+u59)
  u507=1.96875d2*u516
  u98=-6.4d1*u67
  u91=(1.84246577801628391d4*u521+u98)
  u69=p**9
  u519=u474*u91*u69
  u497=-1.05785546915204304d0*u519
  u504=1.84246577801628391d4*u84
  u76=a3*(-u470-u81)
  u485=-3.2d1*u71
  u77=u70*(u504+2.0d0*(u76+u485))
  u55=-7.05236979434695359d-1*u77
  u99=(2.39520551142116908d5*u521+u98*u483)
  u495=u474*u99*u69
  u478=7.05236979434695359d-1*u495
  u63=a3*(-u465-u503)
  u462=7.05236979434695359d-2*u70
  u53=u67*u508
  u72=u462*(2.0d0*(u63-3.2d1*u53)+2.39520551142116908d5*u84)
  u500=(u502+1.3d1)
  u465=(1.5d1*u500+u456)
  u508=u474*(3.59280826713175363d6*u521+u98*u465)*u69
  u68=-7.05236979434695359d-2*u508
  u481=u68*u443
  value=value+(c(36)*(u437*((u497+u443*(u481+u478))*u408+u443*(u55+u72*&
 &u443)+u507)))
  u58=(1.67496888910571265d3*u521-u9)*u450
  u9=a3*(1.6d1*exppd2+1.86107654345079183d2*u96)
  u96=9.0d0*u9
  u90=6.71654266128281294d-3*u70*(2.8d1*u58+u96)
  u520=1.86107654345079183d2*u54
  u523=(u520+u485)
  u485=-2.11571093830408608d-1*u70
  u80=+u485*(u504+2.0d0*u523)
  u504=2.11571093830408608d-1*u519
  u81=+u485*(3.51743466712199656d4*u84+4.0d0*u523)
  u523=a3*u518
  u518=2.11571093830408608d-1*u70
  u50=4.0d0*pd2
  u477=(2.7d1+u50)
  u75=u477*u450
  u515=u518*(4.0d0*(u523+u461*u75)+4.97465760064396656d5*u84)
  u461=-4.23142187660817215d-1*u495
  u47=(1.65821920021465552d5*u521+u98*(9.0d0+pd2))
  u66=1.41047395886939072d-1*u70
  u83=u66*(u47*u450+u523)
  u469=a3*u524
  u524=5.02993157398445508d6*u84
  u522=u67*(2.1d1*u500+u456)
  u97=-7.05236979434695359d-2*u70
  u8=+u97*(u524+2.0d0*(u469-3.2d1*u522*u450))
  u506=7.05236979434695359d-2*u508
  u508=-7.05236979434695359d-2*u495
  u475=u506*u443
  u480=u443*(u8+u475)
  value=value+(c(37)*(u406*(u80+u443*(u480+u515)+(u443*(u461+u475)+u504&
 &)*u406)+u443*(u81+u443*(u508*u443+u83))+u90))
  u7=2.7d1*u84
  u93=u70*(u7+u59)
  u510=3.9375d1*u93
  u484=-2.11571093830408608d-1*u519
  u505=2.0d0*(u76-9.6d1*u71)
  u512=5.52739733404885173d4*u84
  u74=u70*(u512+u505)
  u56=-4.23142187660817215d-1*u74
  u78=4.23142187660817215d-1*u495
  u473=u462*(2.0d0*(u63-9.6d1*u53)+7.18561653426350725d5*u84)
  value=value+(c(38)*(u88*((u484+u443*(u481+u78))*u408+u443*(u56+u473*u&
 &443)+u510)))
  u92=(8.37484444552856323d3*u521+u470)*u450
  u51=-1.26942656298245165d0*u70
  u95=+u51*(u520+u92)
  u520=2.76369866702442587d5*u84
  u482=(1.5d1+u502)
  u48=u482*u450
  u502=u67*u48
  u57=u518*(2.0d0*(u523-3.2d1*u502)+u520)
  u518=-2.11571093830408608d-1*u495
  u498=(5.0d0*u500+u486)
  u496=(1.19760275571058454d6*u521+u98*u498)
  u499=-1.41047395886939072d-1*u70*(u469+2.0d0*u496*u450)
  u469=(u475+u518)
  u501=u518*u443
  value=value+(c(39)*(u437*(u406*(u57+u443*(u475+u499)+u469*u406)+u443*&
 &(u57+u501)+u95)))
  u95=+u51*(6.2035884781693061d1*u54+u92)
  u499=2.11571093830408608d-1*u474
  u92=u499*(2.76369866702442587d5*u521+u98*u482)*u69
  u51=u487*u86
  u86=4.23142187660817215d-1*u51
  u52=u462*(2.0d0*(u523-9.6d1*u502)+8.2910960010732776d5*u84)
  u523=-2.82094791773878144d-1*u474*u496*u69
  u496=u487*u5
  u5=-1.41047395886939072d-1*u496
  u502=u5*u443
  value=value+(c(40)*(u442*(u408*(u92+u443*(u475+u523)+u469*u408)+(u86+&
 &u502)*u406+u443*(u52+u501)+u95)))
  u57=u91*u450
  u91=u70*(u76+3.0d0*u57)
  u85=-4.23142187660817215d-1*u91
  u65=2.11571093830408608d-1*u495
  u49=-7.05236979434695359d-2*u74
  u511=u99*u450
  u99=a3*(-u470*u463-u503)
  u469=u66*(3.0d0*u511+u99)
  value=value+(c(41)*(u437*(u408*(u85+u469*u443+(u481+u65)*u408)+u49*u4&
 &43+u510)))
  u470=(u508+u475)
  u503=u461*u443
  value=value+(c(42)*(u406*(u81+u443*(u503+u515)+u406*(u470*u406+u480+u&
 &83))+u443*(u80+u504*u443)+u90))
  u504=u506*u406
  value=value+(c(43)*(u88*(u408*(u92+u406*(u504+u523)+(u504+u518)*u408)&
 &+u406*(u52+u502+u518*u406)+u86*u443+u95)))
  u95=1.34330853225656259d-2*u70*(1.4d1*u58+3.0d0*a3*(u514-u476))
  u514=-2.11571093830408608d-1*u474
  u90=+u514*(3.51743466712199656d4*u521-1.28d2*u67)*u69
  u92=1.41047395886939072d-1*u474*u47*u69
  u86=1.41047395886939072d-1*u51
  u58=-1.41047395886939072d-1*u51
  u51=u499*(4.97465760064396656d5*u521+u98*u477)*u69
  u47=+u79*(5.02993157398445508d6*u521-6.4d1*u522)*u69
  u476=-5.64189583547756287d-1*u487*u509*u60
  u509=1.41047395886939072d-1*u496
  u502=u462*(u505+u512)
  u505=u509*u443
  value=value+(c(44)*(u408*(u90+u443*(u503+u51)+u408*(u470*u408+u443*(u&
 &47+u475)+u92))+u406*(u86+u443*(u505+u476)+(u505+u58)*u406)+u443*(u49+&
 &u502*u443)+u95))
  u95=u70*(4.5d1*u84+u59)
  u90=3.9375d1*u95
  u92=u70*(u76+5.0d0*u57)
  u86=-1.41047395886939072d-1*u92
  u58=7.05236979434695359d-2*u495
  u51=+u485*(9.21232889008141955d4*u84+2.0d0*(u76-1.6d2*u71))
  u47=u66*(5.0d0*u511+u99)
  value=value+(c(45)*(u88*(u408*(u86+u47*u443+(u481+u58)*u408)+u51*u443&
 &+u90)))
  u476=u68*u406
  u502=(u497+u406*(u476+u478))*u408
  u506=u72*u406
  value=value+(c(46)*(u437*(u502+u406*(u55+u506)+u507)))
  u507=u473*u406
  value=value+(c(47)*(u442*((u484+u406*(u476+u78))*u408+u406*(u56+u507)&
 &+u510)))
  u461=(u476+u65)*u408
  u508=u469*u406
  u509=u49*u406
  value=value+(c(48)*(u437*(u408*(u85+u508+u461)+u509+u510)))
  u510=u47*u406
  u511=u51*u406
  value=value+(c(49)*(u442*(u408*(u86+u510+(u476+u58)*u408)+u511+u90)))
  u57=+u485*(u520+4.0d0*(u76-2.4d2*u71))
  u99=u462*(2.0d0*(u63-4.8d2*u53)+3.59280826713175363d6*u84)
  u512=u68*u408
  value=value+(c(50)*(u437*(u408*(u57+u408*(u512+u99))+u90)))
  u522=1.17247822237399885d4*u84
  u475=1.12d2*u467
  u470=-1.67913566532070324d-2*u70*(u522+2.0d0*(u475-u96))
  u66=1.771875d3*u474*u521*u69
  u85=5.90625d2*u516
  u516=-3.17356640745612912d0*u519
  u519=-1.05785546915204304d0*u77
  u442=1.05785546915204304d0*u495
  value=value+(c(51)*((u66+u406*(u406*(u442+u476)+u516))*u408+u406*(u85&
 &+u406*(u506+u519))+u470))
  u519=1.96875d2*u93
  u470=-7.05236979434695359d-1*u74
  value=value+(c(52)*(u88*(u502+u406*(u470+u507)+u519)))
  u507=-1.00748139919242194d-2*u70*(u522+2.0d0*(u475-3.0d0*u9))
  u470=7.875d1*u70*(u7-u54)
  u519=7.875d1*u93
  u93=-8.46284375321634431d-1*u91
  value=value+(c(53)*(u408*(u470+u406*(u508+u93)+(u406*(u78+u476)+u484)&
 &*u408)+u406*(u519+u509)+u507))
  u508=1.18125d2*u95
  u519=-4.23142187660817215d-1*u92
  value=value+(c(54)*(u88*(u408*(u519+u510+u461)+u511+u508)))
  u508=-3.35827133064140647d-3*u70*(5.86239111186999426d4*u84+2.0d0*(5.&
 &6d2*u467-u96))
  u510=3.9375d1*u70*(1.35d2*u84-4.0d0*u54)
  u511=+u97*(u520+2.0d0*(u76-4.8d2*u71))
  value=value+(c(55)*(u408*(u510+u57*u406+u408*((u58+u476)*u408+u99*u40&
 &6+u511))+u90*u406+u508))
  u508=1.96875d2*u70*(6.3d1*u84+u59)
  u511=-3.52618489717347679d-1*u70*(3.86917813383419621d5*u84+4.0d0*(u7&
 &6-3.36d2*u71))
  u519=u462*(2.0d0*(u63-6.72d2*u53)+u524)
  value=value+(c(56)*(u88*(u408*(u511+u408*(u512+u519))+u508)))
  if ( lmax .eq. 5 ) return
  u508=A10_(p,pd,erfpd,exppd2)
  u511=u508*u450
  u519=a3*u493
  u510=-2.0d0*u519
  u470=u474*u488
  u493=u470*(9.0d0*u511+u510)
  u488=-1.96875d2*u493
  u90=-6.4d1*u513
  u93=(1.84246577801628391d4*u508+u90)
  u95=p**10
  u507=u474*u93*u95
  u502=1.05785546915204304d0*u507
  u476=a3*(-u472-u87)
  u78=u470*(2.0d0*(u476-3.2d1*u419)+1.84246577801628391d4*u511)
  u65=3.17356640745612912d0*u78
  u58=(2.39520551142116908d5*u508-6.4d1*u464)
  u54=u474*u58*u95
  u469=-3.17356640745612912d0*u54
  u57=a3*(-u472*u463-u445)
  u497=2.39520551142116908d5*u511
  u85=-3.2d1*u490
  u92=u470*(u497+2.0d0*(u57+u85))
  u87=-1.05785546915204304d0*u92
  u520=u513*u465
  u505=(3.59280826713175363d6*u508-6.4d1*u520)
  u495=u474*u505*u95
  u442=1.05785546915204304d0*u495
  u512=a3*(-u492-u491)
  u475=3.59280826713175363d6*u511
  u480=u520*u450
  u520=-3.2d1*u480
  u74=7.05236979434695359d-2*u470
  u492=u74*(2.0d0*(u512+u520)+u475)
  u524=(u456+1.5d1*u483)
  u7=pd2**3
  u522=8.0d0*u7
  u473=u474*(6.10777405412398116d7*u508+u90*(1.7d1*u524+u522))*u95
  u8=-7.05236979434695359d-2*u473
  u478=u8*u443
  value=value+(c(57)*(y*((u502+u443*(u443*(u442+u478)+u469))*u408+u443*&
 &(u65+u443*(u492*u443+u87))+u488)))
  u76=(8.37484444552856323d3*u508+u472)*u450
  u99=u470*(u76+1.86107654345079183d2*u519)
  u96=2.11571093830408608d0*u99
  u516=a3*u494
  u84=-1.05785546915204304d0*u470
  u509=+u84*(u497+2.0d0*(u516+u85))
  u497=1.05785546915204304d0*u54
  u85=-3.52618489717347679d-1*u470
  u481=u513*u75
  u485=+u85*(4.97465760064396656d5*u511+4.0d0*(u516-1.6d1*u481))
  u68=a3*u62
  u515=8.0d0*u486
  u49=u513*(3.3d1*u500+u515)*u450
  u56=3.52618489717347679d-1*u470
  u9=u56*(4.0d0*(u68-1.6d1*u49)+7.90417818768985798d6*u511)
  u51=-7.05236979434695359d-1*u495
  u494=4.0d0*(7.18561653426350725d5*u508+u472*(6.0d0*u500+u486))*u450
  u506=1.41047395886939072d-1*u470
  u486=u506*(u494+u68)
  u477=a3*u82
  u55=+u472*(2.7d1*u524+u522)*u450
  u86=9.70058232125573479d7*u511
  u77=-7.05236979434695359d-2*u470
  u82=+u77*(u86+2.0d0*(u477+u55))
  u62=7.05236979434695359d-2*u473
  u503=-7.05236979434695359d-2*u495
  u473=u62*u443
  u462=u443*(u82+u473)
  value=value+(c(58)*(x*(u406*(u509+u443*(u462+u9)+(u443*(u51+u473)+u49&
 &7)*u406)+u443*(u485+u443*(u503*u443+u486))+u96)))
  u72=u470*(2.0d0*(u476-9.6d1*u419)+5.52739733404885173d4*u511)
  u66=1.05785546915204304d0*u72
  u91=-u497
  u484=7.18561653426350725d5*u511
  u465=-9.6d1*u490
  u47=u470*(u484+2.0d0*(u57+u465))
  u60=-7.05236979434695359d-1*u47
  u53=7.05236979434695359d-1*u495
  u461=u74*(2.0d0*(u512-9.6d1*u480)+1.07784248013952609d7*u511)
  value=value+(c(59)*(u427*((u91+u443*(u478+u53))*u408+u443*(u60+u461*u&
 &443)+u66)))
  u97=1.26942656298245165d0*u99
  u99=2.76369866702442587d5*u511
  u496=-2.11571093830408608d-1*u470
  u59=u513*u48
  u52=+u496*(u99+2.0d0*(u516-3.2d1*u59))
  u48=2.11571093830408608d-1*u54
  u521=u513*(2.5d1+u50)
  u70=u521*u450
  u75=-6.34713281491225823d-1*u470*(4.60616444504070978d5*u511+4.0d0*(u&
 &516-1.6d1*u70))
  u467=u513*(3.5d1*u500+u515)
  u89=2.11571093830408608d-1*u470
  u515=u89*(4.0d0*(u68-1.6d1*u467*u450)+8.38321928997409179d6*u511)
  u81=-4.23142187660817215d-1*u495
  u518=(1.19760275571058454d6*u508+u90*u498)
  u63=u518*u450
  u498=4.23142187660817215d-1*u470
  u69=u498*(2.0d0*u63+u68)
  u523=u513*(2.5d1*u524+u522)
  u522=+u77*(8.98202066782938406d7*u511+2.0d0*(u477-3.2d1*u523*u450))
  u71=-2.11571093830408608d-1*u495
  u88=(u443*(u81+u473)+u48)
  u463=u443*(u522+u473)
  u483=u71*u443
  value=value+(c(60)*(y*(u406*(u52+u443*(u463+u515)+u88*u406)+u443*(u75&
 &+u443*(u483+u69))+u97)))
  u73=1.26942656298245165d0*u470
  u98=u73*(u76+6.2035884781693061d1*u519)
  u76=+u514*(2.76369866702442587d5*u508+u90*u482)*u95
  u519=-4.23142187660817215d-1*u487*u517
  u80=+u496*(1.38184933351221293d6*u511+4.0d0*(u516-4.8d1*u70))
  u70=u499*(8.38321928997409179d6*u508-6.4d1*u467)*u95
  u467=u487*u479
  u517=8.46284375321634431d-1*u467
  u5=u506*(6.0d0*u63+u68)
  u63=+u79*(8.98202066782938406d7*u508-6.4d1*u523)*u95
  u523=u487*u64
  u79=-1.41047395886939072d-1*u523
  u464=u443*(u63+u473)
  u513=u79*u443
  value=value+(c(61)*(z*(u408*(u76+u443*(u464+u70)+u88*u408)+(u519+u443&
 &*(u513+u517))*u406+u443*(u80+u443*(u483+u5))+u98)))
  u64=u470*(2.7d1*u511+u510)
  u482=-3.9375d1*u64
  u468=u93*u450
  u93=u470*(3.0d0*u468+u476)
  u88=4.23142187660817215d-1*u93
  u504=-2.11571093830408608d-1*u54
  u67=4.23142187660817215d-1*u72
  u479=u58*u450
  u50=a3*(-u489-u445)
  u58=u470*(u50+3.0d0*u479)
  u83=-8.46284375321634431d-1*u58
  u489=4.23142187660817215d-1*u495
  u499=-7.05236979434695359d-2*u47
  u501=u505*u450
  u505=a3*(-u472*(u456+1.3d1*u471)-u491)
  u456=u506*(3.0d0*u501+u505)
  value=value+(c(62)*(y*(u408*(u88+u443*(u456*u443+u83)+(u443*(u489+u47&
 &8)+u504)*u408)+u443*(u67+u499*u443)+u482)))
  u471=(u71+u473)
  u514=u81*u443
  value=value+(c(63)*(x*(u406*(u75+u443*(u514+u515)+u406*(u471*u406+u46&
 &3+u69))+u443*(u52+u48*u443)+u97)))
  u522=-u73*(u516+(9.21232889008141955d4*u508+u90*(5.0d0+pd2))*u450)
  u515=u89*(2.0d0*(u68+u520)+u475)
  u73=-1.41047395886939072d-1*u470
  u68=+u73*(u477+2.0d0*(1.79640413356587681d7*u508+u90*(5.0d0*u524+2.0d&
 &0*u7))*u450)
  value=value+(c(64)*(u437*(u406*(u515+u443*(u473+u68)+(u473+u71)*u406)&
 &+u443*(u515+u483)+u522)*z))
  u522=a3*(-u466-u457)
  u68=u498*(8.0d0*(u522-1.2d1*u419)+2.51245333365856897d4*u511)
  u515=-6.34713281491225823d-1*u474*(4.60616444504070978d5*u508-6.4d1*u&
 &521)*u95
  u508=8.46284375321634431d-1*u474*u518*u95
  u518=4.23142187660817215d-1*u467
  u516=-4.23142187660817215d-1*u467
  u467=a3*(-u472*u500-u94)
  u520=+u77*(8.2910960010732776d5*u511+2.0d0*(u467-9.6d1*u59))
  u500=-2.25675833419102515d0*u487*u458
  u524=1.41047395886939072d-1*u523
  u523=u74*(2.0d0*(u50+u465)+u484)
  u484=u524*u443
  u465=u443*(u484+u500)
  value=value+(c(65)*(x*(u408*(u515+u443*(u514+u70)+u408*(u471*u408+u46&
 &4+u508))+u406*(u518+u465+(u484+u516)*u406)+u443*(u520+u523*u443)+u68)&
 &))
  u75=u470*(2.0d0*(u476-1.6d2*u419)+9.21232889008141955d4*u511)
  u69=6.34713281491225823d-1*u75
  u59=u470*(u50+5.0d0*u479)
  u514=-4.23142187660817215d-1*u59
  u464=2.11571093830408608d-1*u495
  u521=1.19760275571058454d6*u511
  u450=-1.6d2*u490
  u471=+u496*(u521+2.0d0*(u57+u450))
  u474=5.0d0*u501
  u7=u506*(u474+u505)
  value=value+(c(66)*(u427*(u408*(u514+u7*u443+(u478+u464)*u408)+u471*u&
 &443+u69)))
  u472=(u503+u473)
  value=value+(c(67)*(y*(u406*(u485+u443*(u51*u443+u9)+u406*(u472*u406+&
 &u462+u486))+u443*(u509+u497*u443)+u96)))
  u485=u62*u406
  u466=u406*(u63+u485)
  value=value+(c(68)*(z*(u408*(u76+u406*(u466+u70)+(u406*(u81+u485)+u48&
 &)*u408)+u406*(u80+u517*u443+u406*(u71*u406+u513+u5))+u519*u443+u98)))
  value=value+(c(69)*(y*(u408*(u515+u406*(u81*u406+u70)+u408*((u71+u485&
 &)*u408+u466+u508))+u406*(u520+u465+(u484+u523)*u406)+u443*(u518+u516*&
 &u443)+u68)))
  u63=u498*(8.0d0*(u522-2.0d1*u419)+4.18742222276428161d4*u511)
  u71=+u77*(2.48732880032198328d6*u511+2.0d0*(u467-1.6d2*u481))
  u79=u506*(u494+u57)
  u70=u74*(3.2d1*(a3*(-u61-u445)-1.0d1*u49)+3.95208909384492899d7*u511)
  u516=+u77*(u86+2.0d0*(u505+u55))
  u5=u89*(2.0d0*(u50+u450)+u521)
  u515=+u73*(u512+u474)
  value=value+(c(70)*(z*(u408*(u71+u443*(u515*u443+u70)+u408*(u472*u408&
 &+u443*(u516+u473)+u79))+u443*(u471+u5*u443)+u63)))
  u473=u470*(4.5d1*u511+u510)
  u71=-3.9375d1*u473
  u79=u470*(4.0d0*(u476-2.4d2*u419)+u99)
  u70=2.11571093830408608d-1*u79
  u472=u470*(u475+2.0d0*(u57-4.8d2*u490))
  u5=-7.05236979434695359d-2*u472
  u99=7.05236979434695359d-2*u495
  u63=2.11571093830408608d-1*u75
  u503=+u496*(u475+4.0d0*(u57-2.4d2*u490))
  u475=u74*(2.0d0*(u512-4.8d2*u480)+5.38921240069763044d7*u511)
  value=value+(c(71)*(y*(u408*(u70+u503*u443+u408*((u99+u478)*u408+u475&
 &*u443+u5))+u63*u443+u71)))
  u474=u8*u406
  u443=(u502+u406*(u406*(u442+u474)+u469))*u408
  u515=u492*u406
  value=value+(c(72)*(x*(u443+u406*(u65+u406*(u515+u87))+u488)))
  u516=u461*u406
  value=value+(c(73)*(u427*((u91+u406*(u474+u53))*u408+u406*(u60+u516)+&
 &u66)))
  u60=(u406*(u489+u474)+u504)*u408
  u517=u456*u406
  u518=u499*u406
  value=value+(c(74)*(x*(u408*(u88+u406*(u517+u83)+u60)+u406*(u67+u518)&
 &+u482)))
  u519=u7*u406
  u520=u471*u406
  value=value+(c(75)*(u427*(u408*(u514+u519+(u474+u464)*u408)+u520+u69)&
 &))
  u467=(u99+u474)*u408
  u521=u503*u406
  u522=u475*u406
  u523=u63*u406
  value=value+(c(76)*(x*(u408*(u70+u521+u408*(u467+u522+u5))+u523+u71))&
 &)
  u71=-u84*(2.0d0*(u476-2.24d2*u419)+1.28972604461139874d5*u511)
  u70=5.02993157398445508d6*u511
  u84=+u85*(u70+4.0d0*(u57-3.36d2*u490))
  u5=u74*(2.0d0*(u512-6.72d2*u480)+7.54489736097668261d7*u511)
  u524=u8*u408
  value=value+(c(77)*(u427*(u408*(u84+u408*(u524+u5))+u71)))
  u427=-1.378125d3*u493
  u493=7.40498828406430127d0*u507
  u450=7.40498828406430127d0*u78
  u78=-7.40498828406430127d0*u54
  u54=-1.48099765681286025d0*u92
  u92=1.48099765681286025d0*u495
  value=value+(c(78)*(y*((u493+u406*(u406*(u92+u474)+u78))*u408+u406*(u&
 &450+u406*(u515+u54))+u427)))
  u427=-1.96875d2*u64
  u64=3.17356640745612912d0*u72
  u450=-1.05785546915204304d0*u47
  value=value+(c(79)*(z*(u443+u406*(u64+u406*(u516+u450))+u427)))
  u442=2.11571093830408608d0*u93
  u450=7.05236979434695359d-1*u72
  u72=-1.41047395886939072d0*u58
  value=value+(c(80)*(y*(u408*(u442+u406*(u517+u72)+(u406*(u53+u474)+u9&
 &1)*u408)+u406*(u450+u518)+u427)))
  u427=-1.18125d2*u473
  u450=u498*(5.0d0*u468+u476)
  u498=1.26942656298245165d0*u75
  u75=-8.46284375321634431d-1*u59
  value=value+(c(81)*(z*(u408*(u450+u406*(u519+u75)+u60)+u406*(u498+u52&
 &0)+u427)))
  u471=6.34713281491225823d-1*u79
  u450=-2.11571093830408608d-1*u472
  value=value+(c(82)*(y*(u408*(u471+u521+u408*((u464+u474)*u408+u522+u4&
 &50))+u523+u427)))
  u427=-1.96875d2*u470*(6.3d1*u511+u510)
  u450=u56*(4.0d0*(u476-3.36d2*u419)+3.86917813383419621d5*u511)
  u419=+u77*(u70+2.0d0*(u57-6.72d2*u490))
  value=value+(c(83)*(z*(u408*(u450+u84*u406+u408*(u467+u5*u406+u419))+&
 &u71*u406+u427)))
  u450=2.11571093830408608d0*u470
  u406=u450*(1.4d1*u468+3.0d0*u476)
  u468=-u450*(u50+7.0d0*u479)
  u450=u506*(1.4d1*u501+u505)
  value=value+(c(84)*(y*(u408*(u406+u408*(u408*(u450+u524)+u468))+u427)&
 &))
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_9=.false.
end function

  
  

!> Compute YY X Y coulomb integral for the right hand shell 
!!
recursive function D_X_R_opt_3_10(a12,a3,r3,c,lmax,value)
  
  use mod_A_functions
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< coeffcient of the hermit decomposition of the product of orbital 1 and 2
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition~%
  real(kind=8), intent(out) :: value    !< result value
  
  ! return value
  
  logical :: D_X_R_opt_3_10
  ! local variables
  real(kind=8) :: d,p,pd,pd2,erfpd,exppd2,x,y,z
  real(kind=8) :: u349
  real(kind=8) :: u351
  real(kind=8) :: u358
  real(kind=8) :: u361
  real(kind=8) :: u365
  real(kind=8) :: u369
  real(kind=8) :: u374
  real(kind=8) :: u375
  real(kind=8) :: u378
  real(kind=8) :: u405
  real(kind=8) :: u406
  real(kind=8) :: u407
  real(kind=8) :: u416
  real(kind=8) :: u417
  real(kind=8) :: u418
  real(kind=8) :: u419
  real(kind=8) :: u42
  real(kind=8) :: u422
  real(kind=8) :: u423
  real(kind=8) :: u424
  real(kind=8) :: u425
  real(kind=8) :: u426
  real(kind=8) :: u427
  real(kind=8) :: u428
  real(kind=8) :: u429
  real(kind=8) :: u43
  real(kind=8) :: u430
  real(kind=8) :: u431
  real(kind=8) :: u432
  real(kind=8) :: u433
  real(kind=8) :: u434
  real(kind=8) :: u435
  real(kind=8) :: u436
  real(kind=8) :: u438
  real(kind=8) :: u439
  real(kind=8) :: u44
  real(kind=8) :: u440
  real(kind=8) :: u442
  real(kind=8) :: u443
  real(kind=8) :: u444
  real(kind=8) :: u445
  real(kind=8) :: u446
  real(kind=8) :: u447
  real(kind=8) :: u448
  real(kind=8) :: u449
  real(kind=8) :: u45
  real(kind=8) :: u450
  real(kind=8) :: u451
  real(kind=8) :: u452
  real(kind=8) :: u453
  real(kind=8) :: u454
  real(kind=8) :: u455
  real(kind=8) :: u456
  real(kind=8) :: u457
  real(kind=8) :: u458
  real(kind=8) :: u459
  real(kind=8) :: u46
  real(kind=8) :: u460
  real(kind=8) :: u461
  real(kind=8) :: u462
  real(kind=8) :: u463
  real(kind=8) :: u464
  real(kind=8) :: u465
  real(kind=8) :: u47
  real(kind=8) :: u48
  real(kind=8) :: u49
  real(kind=8) :: u5
  real(kind=8) :: u50
  real(kind=8) :: u51
  real(kind=8) :: u52
  real(kind=8) :: u53
  real(kind=8) :: u54
  real(kind=8) :: u55
  real(kind=8) :: u56
  real(kind=8) :: u57
  real(kind=8) :: u58
  real(kind=8) :: u59
  real(kind=8) :: u6
  real(kind=8) :: u60
  real(kind=8) :: u61
  real(kind=8) :: u62
  real(kind=8) :: u63
  real(kind=8) :: u64
  real(kind=8) :: u65
  real(kind=8) :: u66
  real(kind=8) :: u67
  real(kind=8) :: u68
  real(kind=8) :: u69
  real(kind=8) :: u7
  real(kind=8) :: u70
  real(kind=8) :: u71
  real(kind=8) :: u72
  real(kind=8) :: u73
  real(kind=8) :: u74
  real(kind=8) :: u75
  real(kind=8) :: u76
  real(kind=8) :: u77
  real(kind=8) :: u78
  real(kind=8) :: u79
  real(kind=8) :: u8
  real(kind=8) :: u80
  real(kind=8) :: u81
  real(kind=8) :: u82
  real(kind=8) :: u83
  real(kind=8) :: u84
  real(kind=8) :: u85
  real(kind=8) :: u86
  real(kind=8) :: u87
  real(kind=8) :: u88
  real(kind=8) :: u89
  real(kind=8) :: u9
  real(kind=8) :: u90
  real(kind=8) :: u91
  real(kind=8) :: u92
  real(kind=8) :: u93
  real(kind=8) :: u94
  real(kind=8) :: u95
  real(kind=8) :: u96
  real(kind=8) :: u97
  real(kind=8) :: u98
  real(kind=8) :: u99

  
  ! init computation flag
  D_X_R_opt_3_10=.true.
  
  ! compute local quantities
  p=sqrt((a12*a3)/(a12+a3))
  d=sqrt(sum(r3**2))
  
  ! renormalize xyz
  x=0.0d0
  y=0.0d0
  z=0.0d0
  if (d>0.0d0) then
    x=r3(1)/d
    y=r3(2)/d
    z=r3(3)/d
  end if
  
  ! compute local quantities
  pd=p*d
  pd2=pd*pd
  erfpd =erf(pd)
  exppd2=exp(-pd2)
  
  ! computation section
  value=0.0d0
  u94=A4_(p,pd,erfpd,exppd2)
  u78=p**2
  u405=a3**(-3)
  u45=3.75d-1*u405*u78*(3.0d0*u94*u78-2.0d0*a3*A2_(p,pd,erfpd,exppd2))
  u55=2.65868077635827404d1*u94
  u406=-7.05236979434695359d-2*u405
  u361=p**4
  u378=exppd2*pd
  u374=-8.0d0*u378
  u423=+u406*(u55+u374)*u361
  u349=z**2
  value=value+(c(1)*(z*(u423*u349+u45)))
  if ( lmax .eq. 0 ) return
  u45=A5_(p,pd,erfpd,exppd2)
  u423=u45*u78
  u444=5.0d0*u423
  u69=A3_(p,pd,erfpd,exppd2)
  u443=a3*u69
  u375=u405*p**3
  u43=1.125d0*u375*(u444-2.0d0*u443)
  u445=1.86107654345079183d2*u45
  u438=p**5
  u50=exppd2*pd2
  u460=-1.6d1*u50
  u49=+u406*(u445+u460)*u438
  u465=x*z
  u425=u49*u349
  u407=(u425+u43)
  value=value+(c(2)*(u465*u407))
  u462=y*z
  value=value+(c(3)*(u462*u407))
  u407=exppd2*u78
  u43=4.0d0*exppd2
  u86=-1.41047395886939072d-2*u375*(7.97604232907482212d1*u423+2.0d0*(1&
 &.2d1*u407-5.0d0*a3*(u43+5.31736155271654808d0*u69)))
  u423=2.25d0*u375*(u444-u443)
  value=value+(c(4)*(u349*(u423+u425)+u86))
  if ( lmax .eq. 1 ) return
  u86=A6_(p,pd,erfpd,exppd2)
  u423=u86*u78
  u49=a3*u94
  u444=u405*u361
  u443=-1.125d0*u444
  u94=+u443*(5.0d0*u423-2.0d0*u49)
  u69=1.86107654345079183d2*u86
  u375=-1.6d1*u378
  u434=(u69+u375)
  u464=p**6
  u59=u434*u464
  u51=7.05236979434695359d-2*u405
  u98=u51*u59
  u431=a3*(-u374-u55)
  u361=u378*u78
  u55=2.11571093830408608d-1*u444*(2.0d0*(u431-8.0d0*u361)+1.8610765434&
 &5079183d2*u423)
  u455=1.67496888910571265d3*u86
  u97=2.0d0*pd2
  u42=+u375*(9.0d0+u97)
  u73=(u455+u42)*u464
  u96=+u406*u73
  u425=x**2
  value=value+(c(5)*(z*((u98+u96*u425)*u349+u55*u425+u94)))
  u369=x*u462
  u416=u96*u349
  value=value+(c(6)*(u369*(u416+u55)))
  u66=u434*u78
  u85=4.23142187660817215d-1*u444*(u66+u431)
  u53=(u349*(u85+u416)+u94)
  value=value+(c(7)*(x*u53))
  u351=y**2
  value=value+(c(8)*(z*((u98+u96*u351)*u349+u55*u351+u94)))
  value=value+(c(9)*(y*u53))
  u98=+u443*(2.5d1*u423-6.0d0*u49)
  u423=1.41047395886939072d-1*u444*(5.0d0*u66+3.0d0*u431)
  value=value+(c(10)*(z*(u349*(u423+u416)+u98)))
  if ( lmax .eq. 2 ) return
  u416=A7_(p,pd,erfpd,exppd2)
  u423=u416*u78
  u96=7.0d0*u423
  u66=a3*u45
  u431=u405*u438
  u49=u431*(u96-2.0d0*u66)
  u98=-1.6875d1*u49
  u443=1.67496888910571265d3*u416
  u444=-3.2d1*u50
  u438=(u443+u444)
  u53=p**7
  u58=u438*u53
  u461=u405*u58
  u450=2.11571093830408608d-1*u461
  u72=a3*(-u460-u445)
  u445=2.11571093830408608d-1*u431
  u85=pd2*u78
  u77=exppd2*u85
  u54=u445*(2.0d0*(u72-1.6d1*u77)+1.67496888910571265d3*u423)
  u436=1.84246577801628391d4*u416
  u365=(1.1d1+u97)
  u61=+u444*u365
  u62=(u436+u61)*u53
  u48=+u406*u62
  u417=u48*u425
  u426=u54*u425
  value=value+(c(11)*(u465*((u450+u417)*u349+u426+u98)))
  u93=-5.625d0*u49
  u49=7.05236979434695359d-2*u461
  value=value+(c(12)*(u462*((u49+u417)*u349+u426+u93)))
  u461=8.0d0*exppd2
  u452=a3*(u461+2.65868077635827404d1*u45)
  u45=6.04488839515453165d-3*u431
  u71=u45*(2.0d0*(4.0d1*u407-7.0d0*u452)+9.30538271725395914d2*u423)
  u426=-1.125d1*u431*(u96-u66)
  u96=u438*u78
  u84=4.23142187660817215d-1*u431*(u96+u72)
  value=value+(c(13)*(u349*(u426+u84*u425+(u417+u49)*u349)+u93*u425+u71&
 &))
  u418=u48*u351
  u427=u54*u351
  value=value+(c(14)*(u465*((u49+u418)*u349+u427+u93)))
  u67=x*y
  u419=u48*u349
  value=value+(c(15)*(u67*(u349*(u84+u419)+u93)))
  u433=3.5d1*u423
  u99=-5.625d0*u431*(u433-6.0d0*u66)
  u76=1.41047395886939072d-1*u431*(5.0d0*u96+3.0d0*u72)
  u96=(u349*(u76+u419)+u99)
  value=value+(c(16)*(u465*u96))
  value=value+(c(17)*(u462*((u450+u418)*u349+u427+u98)))
  value=value+(c(18)*(u349*(u426+u84*u351+(u418+u49)*u349)+u93*u351+u71&
 &))
  value=value+(c(19)*(u462*u96))
  u76=u45*(2.0d0*(2.0d2*u407-2.1d1*u452)+4.65269135862697957d3*u423)
  u49=-1.6875d1*u431*(u433-4.0d0*u66)
  u427=-8.0d1*u77
  u433=u445*(2.0d0*(u72+u427)+8.37484444552856323d3*u423)
  value=value+(c(20)*(u349*(u49+u349*(u419+u433))+u76))
  if ( lmax .eq. 3 ) return
  u76=A8_(p,pd,erfpd,exppd2)
  u49=u76*u78
  u433=a3*u86
  u48=u405*u464
  u72=u48*(7.0d0*u49-2.0d0*u433)
  u423=1.6875d1*u72
  u456=1.67496888910571265d3*u76
  u66=-3.2d1*u378
  u419=(u456+u66)
  u452=p**8
  u96=u419*u452
  u426=-2.11571093830408608d-1*u405
  u86=+u426*u96
  u445=a3*(-u375-u69)
  u69=u48*(1.67496888910571265d3*u49+2.0d0*(u445-1.6d1*u361))
  u45=-1.26942656298245165d0*u69
  u71=1.84246577801628391d4*u76
  u431=u378*u365
  u98=-3.2d1*u431
  u99=(u71+u98)
  u84=u99*u452
  u450=u405*u84
  u464=4.23142187660817215d-1*u450
  u89=a3*(-u42-u455)
  u42=1.84246577801628391d4*u49
  u442=u431*u78
  u431=-1.6d1*u442
  u457=2.11571093830408608d-1*u48
  u60=u457*(2.0d0*(u89+u431)+u42)
  u93=2.39520551142116908d5*u76
  u358=pd2**2
  u417=4.0d0*u358
  u56=(u97+1.1d1)
  u418=+u66*(1.3d1*u56+u417)
  u54=(u93+u418)
  u94=u54*u452
  u5=u405*u94
  u424=-7.05236979434695359d-2*u5
  u64=u424*u425
  u428=u60*u425
  value=value+(c(21)*(z*((u86+u425*(u64+u464))*u349+u425*(u45+u428)+u42&
 &3)))
  u46=-6.34713281491225823d-1*u69
  u459=2.11571093830408608d-1*u450
  value=value+(c(22)*(u369*((u459+u64)*u349+u428+u46)))
  u70=u419*u78
  u88=u48*(u445+u70)
  u79=-1.26942656298245165d0*u88
  u447=-2.11571093830408608d-1*u69
  u9=u99*u78
  u432=a3*(-u375*(u97+9.0d0)-u455)
  u455=4.23142187660817215d-1*u48*(u9+u432)
  u429=u455*u425
  u430=u447*u425
  value=value+(c(23)*(x*(u349*(u79+u429+(u64+u459)*u349)+u430+u423)))
  u69=1.86107654345079183d2*u76
  u458=-4.0d0*u378
  u453=-4.23142187660817215d-1*u48*(2.65868077635827404d1*u433+4.0d0*(u&
 &69+u458)*u78)
  u375=2.17745955583742644d4*u76
  u52=(1.3d1+u97)
  u454=u378*u52
  u428=-3.2d1*u454
  u80=u51*(u375+u428)*u452
  u51=-7.05236979434695359d-2*u450
  u55=a3**(-2)
  u47=4.23142187660817215d-1*u55*u59
  u59=u457*(2.0d0*(a3*u434+u431)+u42)
  u42=(u71+u374*(4.0d0*u56+u358))*u452
  u63=-1.12837916709551257d0*u405*u42
  u434=7.05236979434695359d-2*u5
  u5=-4.23142187660817215d-1*u55*u73
  u73=-2.11571093830408608d-1*u450
  u431=u434*u425
  value=value+(c(24)*(z*(u349*(u80+u425*(u431+u63)+(u431+u51)*u349)+(u4&
 &7+u5*u425)*u351+u425*(u59+u73*u425)+u453)))
  u47=5.625d0*u72
  u80=-4.23142187660817215d-1*u88
  u51=7.05236979434695359d-2*u450
  u434=(u64+u51)*u349
  value=value+(c(25)*(y*(u349*(u80+u429+u434)+u430+u47)))
  u59=-6.0d0*u433
  u63=5.625d0*u48*(3.5d1*u49+u59)
  u5=3.0d0*u445
  u73=-1.41047395886939072d-1*u48*(u5+5.0d0*u70)
  u72=8.37484444552856323d3*u49
  u429=-8.0d1*u361
  u450=-2.11571093830408608d-1*u48*(u72+2.0d0*(u5+u429))
  u70=1.41047395886939072d-1*u48*(5.0d0*u9+3.0d0*u432)
  value=value+(c(26)*(z*(u349*(u73+u70*u425+u434)+u450*u425+u63)))
  u9=u424*u351
  u432=u60*u351
  value=value+(c(27)*(u369*((u459+u9)*u349+u432+u46)))
  u5=(u9+u51)*u349
  u433=u455*u351
  u434=u447*u351
  value=value+(c(28)*(x*(u349*(u80+u433+u5)+u434+u47)))
  u46=u424*u349
  value=value+(c(29)*(u369*(u349*(u70+u46)+u450)))
  u47=-6.34713281491225823d-1*u48*(u72+4.0d0*(u445-4.0d1*u361))
  u72=u457*(2.0d0*(u89-8.0d1*u442)+9.21232889008141955d4*u49)
  u64=(u349*(u47+u349*(u46+u72))+u63)
  value=value+(c(30)*(x*u64))
  value=value+(c(31)*(z*((u86+u351*(u9+u464))*u349+u351*(u45+u432)+u423&
 &)))
  value=value+(c(32)*(y*(u349*(u79+u433+(u9+u459)*u349)+u434+u423)))
  value=value+(c(33)*(z*(u349*(u73+u70*u351+u5)+u450*u351+u63)))
  value=value+(c(34)*(y*u64))
  u423=2.8125d1*u48*(4.9d1*u49+u59)
  u434=-1.05785546915204304d0*u48*(1.17247822237399885d4*u49+4.0d0*(u44&
 &5-5.6d1*u361))
  u459=u457*(2.0d0*(u89-1.12d2*u442)+1.28972604461139874d5*u49)
  value=value+(c(35)*(z*(u349*(u434+u349*(u46+u459))+u423)))
  if ( lmax .eq. 4 ) return
  u423=A9_(p,pd,erfpd,exppd2)
  u434=u423*u78
  u459=9.0d0*u434
  u424=a3*u416
  u51=-2.0d0*u424
  u464=u405*u53
  u60=u464*(u459+u51)
  u86=5.90625d2*u60
  u72=-6.4d1*u50
  u89=(1.84246577801628391d4*u423+u72)
  u445=p**9
  u49=u405*u89*u445
  u59=-1.05785546915204304d0*u49
  u457=a3*(-u444-u443)
  u443=2.0d0*(u457-3.2d1*u77)
  u442=1.84246577801628391d4*u434
  u70=u464*(u442+u443)
  u48=-2.11571093830408608d0*u70
  u450=(2.39520551142116908d5*u423+u72*u52)
  u447=u405*u450*u445
  u64=7.05236979434695359d-1*u447
  u5=a3*(-u61-u436)
  u61=2.11571093830408608d-1*u464
  u46=u52*u78
  u455=u50*u46
  u63=u61*(2.0d0*(u5-3.2d1*u455)+2.39520551142116908d5*u434)
  u88=(u97+1.3d1)
  u9=(1.5d1*u88+u417)
  u80=u405*(3.59280826713175363d6*u423+u72*u9)*u445
  u453=-7.05236979434695359d-2*u80
  u45=u453*u425
  u435=u63*u425
  value=value+(c(36)*(u465*((u59+u425*(u45+u64))*u349+u425*(u48+u435)+u&
 &86)))
  u446=1.18125d2*u60
  u68=-2.11571093830408608d-1*u49
  u49=-1.26942656298245165d0*u70
  u90=4.23142187660817215d-1*u447
  value=value+(c(37)*(u462*((u68+u425*(u45+u90))*u349+u425*(u49+u435)+u&
 &446)))
  u87=a3*(1.6d1*exppd2+1.86107654345079183d2*u416)
  u57=-1.00748139919242194d-2*u464*(1.17247822237399885d4*u434+2.0d0*(1&
 &.12d2*u407-9.0d0*u87))
  u95=2.3625d2*u464*(u459-u424)
  u459=2.3625d2*u60
  u60=u89*u78
  u89=u464*(u457+u60)
  u81=-2.53885312596490329d0*u89
  u7=-2.11571093830408608d-1*u70
  u6=u450*u78
  u450=a3*(-u444*u56-u436)
  u79=4.23142187660817215d-1*u464*(u6+u450)
  u436=u79*u425
  u65=u7*u425
  value=value+(c(38)*(u349*(u95+u425*(u436+u81)+(u425*(u90+u45)+u68)*u3&
 &49)+u425*(u459+u65)+u57))
  u91=-1.26942656298245165d0*u464*(1.86107654345079183d2*u424+(8.374844&
 &44552856323d3*u423+u444)*u78)
  u70=2.11571093830408608d-1*u405
  u435=(1.5d1+u97)
  u97=u70*(2.76369866702442587d5*u423+u72*u435)*u445
  u75=-2.11571093830408608d-1*u447
  u432=u55*u58
  u58=1.26942656298245165d0*u432
  u47=u435*u78
  u44=u61*(2.0d0*(a3*u438+u444*u47)+2.76369866702442587d5*u434)
  u73=(5.0d0*u88+u358)
  u433=-2.82094791773878144d-1*u405*(1.19760275571058454d6*u423+u72*u73&
 &)*u445
  u444=7.05236979434695359d-2*u80
  u80=u55*u62
  u62=-4.23142187660817215d-1*u80
  u430=u444*u425
  u438=u62*u425
  value=value+(c(39)*(u465*(u349*(u97+u425*(u430+u433)+(u430+u75)*u349)&
 &+(u58+u438)*u351+u425*(u44+u75*u425)+u91)))
  u82=-1.26942656298245165d0*u89
  u451=2.11571093830408608d-1*u447
  u89=(u45+u451)*u349
  value=value+(c(40)*(u67*(u349*(u82+u436+u89)+u65+u446)))
  u436=u464*(1.5d1*u434+u51)
  u65=3.54375d2*u436
  u448=3.0d0*u457
  u83=u464*(u448+5.0d0*u60)
  u74=-4.23142187660817215d-1*u83
  u431=9.21232889008141955d4*u434
  u449=-2.11571093830408608d-1*u464
  u8=-1.6d2*u77
  u463=+u449*(u431+2.0d0*(u448+u8))
  u92=3.0d0*u450
  u450=1.41047395886939072d-1*u464
  u422=u450*(5.0d0*u6+u92)
  u439=u422*u425
  u440=u463*u425
  value=value+(c(41)*(u465*(u349*(u74+u439+u89)+u440+u65)))
  u89=u444*u351
  value=value+(c(42)*(u462*(u349*(u97+u351*(u89+u433)+(u89+u75)*u349)+u&
 &351*(u44+u438+u75*u351)+u58*u425+u91)))
  u89=1.34330853225656259d-2*u464*(1.4d1*(1.67496888910571265d3*u423-u4&
 &3)*u78+9.0d0*a3*(u461-5.58322963035237549d2*u416))
  u75=+u426*(3.51743466712199656d4*u423-1.28d2*u50)*u445
  u62=1.41047395886939072d-1*u405*(1.65821920021465552d5*u423+u72*(9.0d&
 &0+pd2))*u445
  u97=-7.05236979434695359d-2*u447
  u58=4.23142187660817215d-1*u432
  u44=-4.23142187660817215d-1*u432
  u461=4.0d0*pd2
  u50=u70*(4.97465760064396656d5*u423+u72*(2.7d1+u461))*u445
  u43=+u406*(5.02993157398445508d6*u423+u72*(2.1d1*u88+u417))*u445
  u433=-1.69256875064326886d0*u55*(5.02490666731713794d3*u416+u460*(6.0&
 &d0+pd2))*u53
  u445=4.23142187660817215d-1*u80
  u80=u61*(u443+u442)
  u443=-4.23142187660817215d-1*u447
  u442=u445*u425
  value=value+(c(43)*(u349*(u75+u425*(u443*u425+u50)+u349*((u97+u430)*u&
 &349+u425*(u43+u430)+u62))+u351*(u58+u425*(u442+u433)+(u442+u44)*u351)&
 &+u425*(u7+u80*u425)+u89))
  u80=1.18125d2*u436
  u75=-1.41047395886939072d-1*u83
  u62=7.05236979434695359d-2*u447
  value=value+(c(44)*(u462*(u349*(u75+u439+(u45+u62)*u349)+u440+u80)))
  u97=-2.7d1*u87
  u58=-3.35827133064140647d-3*u464*(5.86239111186999426d4*u434+2.0d0*(5&
 &.6d2*u407+u97))
  u44=1.18125d2*u464*(4.5d1*u434-4.0d0*u424)
  u50=+u449*(u431+2.0d0*(u457+u8))
  u43=-6.34713281491225823d-1*u464*(u431+4.0d0*(u457+u427))
  u449=u61*(2.0d0*(u5-1.6d2*u455)+1.19760275571058454d6*u434)
  value=value+(c(45)*(u349*(u44+u43*u425+u349*((u62+u45)*u349+u449*u425&
 &+u50))+u80*u425+u58))
  u436=u453*u351
  u443=u63*u351
  value=value+(c(46)*(u465*((u68+u351*(u436+u90))*u349+u351*(u49+u443)+&
 &u446)))
  u442=(u436+u451)*u349
  u444=u79*u351
  u445=u7*u351
  value=value+(c(47)*(u67*(u349*(u82+u444+u442)+u445+u446)))
  u446=u422*u351
  u447=u463*u351
  value=value+(c(48)*(u465*(u349*(u75+u446+(u436+u62)*u349)+u447+u80)))
  u89=u453*u349
  value=value+(c(49)*(u67*(u349*(u43+u349*(u89+u449))+u80)))
  u87=5.90625d2*u464*(2.1d1*u434+u51)
  u51=-1.05785546915204304d0*u464*(1.28972604461139874d5*u434+4.0d0*(u4&
 &57-1.12d2*u77))
  u440=u61*(2.0d0*(u5-2.24d2*u455)+1.67664385799481836d6*u434)
  u83=(u349*(u51+u349*(u89+u440))+u87)
  value=value+(c(50)*(u465*u83))
  value=value+(c(51)*(u462*((u59+u351*(u436+u64))*u349+u351*(u48+u443)+&
 &u86)))
  value=value+(c(52)*(u349*(u95+u351*(u444+u81)+(u351*(u90+u436)+u68)*u&
 &349)+u351*(u459+u445)+u57))
  value=value+(c(53)*(u462*(u349*(u74+u446+u442)+u447+u65)))
  value=value+(c(54)*(u349*(u44+u43*u351+u349*((u62+u436)*u349+u449*u35&
 &1+u50))+u80*u351+u58))
  value=value+(c(55)*(u462*u83))
  u58=-1.67913566532070324d-2*u464*(8.20734755661799196d4*u434+2.0d0*(7&
 &.84d2*u407+u97))
  u83=3.54375d3*u464*(1.4d1*u434-u424)
  u459=-2.11571093830408608d0*u464*(u448+7.0d0*u60)
  u45=u450*(1.4d1*u6+u92)
  value=value+(c(56)*(u349*(u83+u349*(u349*(u45+u89)+u459))+u58))
  if ( lmax .eq. 5 ) return
  u58=A10_(p,pd,erfpd,exppd2)
  u83=u58*u78
  u459=a3*u76
  u45=-2.0d0*u459
  u444=u405*u452
  u87=u444*(9.0d0*u83+u45)
  u95=-5.90625d2*u87
  u440=-6.4d1*u378
  u90=(1.84246577801628391d4*u58+u440)
  u442=p**10
  u76=1.05785546915204304d0*u405*u90*u442
  u407=a3*(-u66-u456)
  u68=u444*(2.0d0*(u407-3.2d1*u361)+1.84246577801628391d4*u83)
  u59=9.52069922236838735d0*u68
  u62=(2.39520551142116908d5*u58-6.4d1*u454)
  u63=u405*u62*u442
  u436=-3.17356640745612912d0*u63
  u74=a3*(-u66*u56-u71)
  u456=2.39520551142116908d5*u83
  u434=u378*u46
  u81=-3.2d1*u434
  u6=u444*(u456+2.0d0*(u74+u81))
  u57=-3.17356640745612912d0*u6
  u431=3.59280826713175363d6*u58
  u89=u378*u9
  u446=(u431-6.4d1*u89)
  u427=u405*u446*u442
  u447=1.05785546915204304d0*u427
  u49=a3*(-u418-u93)
  u64=3.59280826713175363d6*u83
  u50=u89*u78
  u89=2.11571093830408608d-1*u444
  u80=u89*(2.0d0*(u49-3.2d1*u50)+u64)
  u432=(u417+1.5d1*u52)
  u79=pd2**3
  u424=8.0d0*u79
  u97=u405*(6.10777405412398116d7*u58+u440*(1.7d1*u432+u424))*u442
  u439=-7.05236979434695359d-2*u97
  u46=u439*u425
  u448=u80*u425
  value=value+(c(57)*(z*((u76+u425*(u425*(u447+u46)+u436))*u349+u425*(u&
 &59+u425*(u448+u57))+u95)))
  u60=3.17356640745612912d0*u68
  u443=-1.05785546915204304d0*u63
  u430=-2.11571093830408608d0*u6
  u418=7.05236979434695359d-1*u427
  value=value+(c(58)*(u369*((u443+u425*(u46+u418))*u349+u425*(u430+u448&
 &)+u60)))
  u448=u90*u78
  u90=u444*(u448+u407)
  u86=6.34713281491225823d0*u90
  u61=2.11571093830408608d0*u68
  u51=u62*u78
  u445=a3*(-u98-u71)
  u62=u444*(u445+u51)
  u48=-4.23142187660817215d0*u62
  u9=-2.11571093830408608d-1*u6
  u43=u446*u78
  u98=a3*(-u66*(u417+1.3d1*u365)-u93)
  u446=4.23142187660817215d-1*u444
  u6=u446*(u43+u98)
  u449=u6*u425
  u450=u9*u425
  value=value+(c(59)*(x*(u349*(u86+u425*(u449+u48)+(u425*(u418+u46)+u44&
 &3)*u349)+u425*(u61+u450)+u95)))
  u422=1.26942656298245165d0*u444
  u92=u422*((8.37484444552856323d3*u58+u66)*u78+1.86107654345079183d2*u&
 &459)
  u93=+u426*(2.76369866702442587d5*u58+u440*u435)*u442
  u426=2.11571093830408608d-1*u63
  u435=-1.26942656298245165d0*u55*u96
  u459=a3*u419
  u455=-6.34713281491225823d-1*u444
  u44=u378*(2.5d1+u461)
  u419=+u455*(4.60616444504070978d5*u83+4.0d0*(u459-1.6d1*u44*u78))
  u416=u70*(8.38321928997409179d6*u58+u440*(3.5d1*u88+8.0d0*u358))*u442
  u70=-4.23142187660817215d-1*u427
  u464=u55*u84
  u84=2.53885312596490329d0*u464
  u457=(1.19760275571058454d6*u58+u440*u73)
  u463=a3*u99
  u8=u446*(2.0d0*u457*u78+u463)
  u99=+u406*(8.98202066782938406d7*u58+u440*(2.5d1*u432+u424))*u442
  u406=7.05236979434695359d-2*u97
  u97=u55*u94
  u432=-4.23142187660817215d-1*u97
  u424=-2.11571093830408608d-1*u427
  u433=u406*u425
  u53=u425*(u99+u433)
  u451=u432*u425
  u452=u424*u425
  value=value+(c(60)*(z*(u349*(u93+u425*(u53+u416)+(u425*(u70+u433)+u42&
 &6)*u349)+(u435+u425*(u451+u84))*u351+u425*(u419+u425*(u452+u8))+u92))&
 &)
  u94=-1.18125d2*u87
  u87=1.26942656298245165d0*u90
  u90=-2.11571093830408608d-1*u63
  u63=1.26942656298245165d0*u68
  u75=-2.53885312596490329d0*u62
  u62=4.23142187660817215d-1*u427
  u423=(u425*(u62+u46)+u90)*u349
  value=value+(c(61)*(y*(u349*(u87+u425*(u449+u75)+u423)+u425*(u63+u450&
 &)+u94)))
  u449=u444*(1.5d1*u83+u45)
  u96=-3.54375d2*u449
  u73=3.0d0*u407
  u77=u446*(5.0d0*u448+u73)
  u65=9.21232889008141955d4*u83
  u56=u444*(2.0d0*(u73-1.6d2*u361)+u65)
  u52=1.26942656298245165d0*u56
  u68=3.0d0*u445
  u72=u444*(u68+5.0d0*u51)
  u82=-8.46284375321634431d-1*u72
  u438=1.19760275571058454d6*u83
  u460=-1.6d2*u434
  u462=-2.11571093830408608d-1*u444
  u7=+u462*(u438+2.0d0*(3.0d0*u74+u460))
  u465=u378*u358
  u450=(u431-2.56d2*u465)*u78
  u431=5.0d0*u450
  u461=-1.6d3*u434
  u91=1.41047395886939072d-1*u444
  u417=u91*(3.0d0*(u49+u461)+u431)
  u453=u417*u425
  u454=u7*u425
  value=value+(c(62)*(z*(u349*(u77+u425*(u453+u82)+u423)+u425*(u52+u454&
 &)+u96)))
  u423=-u422*(3.0d0*u459+(9.21232889008141955d4*u58+u440*(5.0d0+pd2))*u&
 &78)
  u459=u465*u78
  u5=u89*(2.0d0*(3.0d0*(u463+u460)-1.28d2*u459)+u64)
  u463=-1.41047395886939072d-1*u444
  u64=+u463*(2.0d0*(1.79640413356587681d7*u58-1.28d2*u465*(1.0d1+pd2))*&
 &u78+3.0d0*(a3*u54-3.2d3*u434))
  value=value+(c(63)*(u67*(u351*(u5+u425*(u433+u64)+(u433+u424)*u351)+u&
 &425*(u5+u452)+u423)*z))
  u452=a3*(-u458-u69)
  u64=u422*(8.0d0*(u452-4.0d0*u361)+8.37484444552856323d3*u83)
  u458=-6.34713281491225823d-1*u405*(4.60616444504070978d5*u58-6.4d1*u4&
 &4)*u442
  u44=8.46284375321634431d-1*u405*u457*u442
  u442=1.26942656298245165d0*u464
  u405=-u442
  u464=+u462*(2.76369866702442587d5*u83+2.0d0*(a3*(-u66*u88-u375)+u66*u&
 &47))
  u66=-6.77027500257307545d0*u55*u42
  u67=4.23142187660817215d-1*u97
  u97=u89*(2.0d0*(u445+u81)+u456)
  u422=u67*u425
  u88=u425*(u422+u66)
  value=value+(c(64)*(x*(u349*(u458+u425*(u70*u425+u416)+u349*((u424+u4&
 &33)*u349+u53+u44))+u351*(u442+u88+(u422+u405)*u351)+u425*(u464+u97*u4&
 &25)+u64)))
  u53=6.34713281491225823d-1*u56
  u55=-4.23142187660817215d-1*u72
  u81=2.11571093830408608d-1*u427
  value=value+(c(65)*(u369*(u349*(u55+u453+(u46+u81)*u349)+u454+u53)))
  u72=u444*(4.0d0*(u407+u429)+u65)
  u65=1.90413984447367747d0*u72
  u454=u444*(u438+2.0d0*(u74+u460))
  u429=-6.34713281491225823d-1*u454
  u42=2.11571093830408608d-1*u56
  u56=+u455*(u438+4.0d0*(u74-8.0d1*u434))
  u453=u89*(2.0d0*(u49-1.6d2*u50)+1.79640413356587681d7*u83)
  u455=u56*u425
  u456=u453*u425
  u457=u42*u425
  value=value+(c(66)*(x*(u349*(u65+u455+u349*((u81+u46)*u349+u456+u429)&
 &)+u457+u96)))
  u423=u406*u351
  u47=u351*(u99+u423)
  value=value+(c(67)*(z*(u349*(u93+u351*(u47+u416)+(u351*(u70+u423)+u42&
 &6)*u349)+u351*(u419+u84*u425+u351*(u424*u351+u451+u8))+u435*u425+u92)&
 &))
  value=value+(c(68)*(y*(u349*(u458+u351*(u70*u351+u416)+u349*((u424+u4&
 &23)*u349+u47+u44))+u351*(u464+u88+(u422+u97)*u351)+u425*(u442+u405*u4&
 &25)+u64)))
  u67=u446*(8.0d0*(3.0d0*u452-2.0d1*u361)+4.18742222276428161d4*u83)
  u464=-7.05236979434695359d-2*u444
  u66=+u464*(2.48732880032198328d6*u83+2.0d0*(3.0d0*(a3*(-u428-u375)-1.&
 &44d3*u361)-6.4d2*u378*u85))
  u44=u91*(3.0d0*(u445-2.56d2*u434)+4.0d0*(7.18561653426350725d5*u58-3.&
 &2d1*u465)*u78)
  u458=-7.05236979434695359d-2*u427
  u405=7.05236979434695359d-2*u444*(3.2d1*(3.0d0*(a3*(-u374*(u358+4.0d0&
 &*u365)-u71)-1.1d2*u434)-8.0d1*u459)+3.95208909384492899d7*u83)
  u97=+u464*(9.70058232125573479d7*u83+2.0d0*(3.0d0*(u49-2.88d2*u50)-2.&
 &56d2*u378*u79*u78))
  u464=u89*(2.0d0*(u68+u460)+u438)
  u459=+u463*(u431+3.0d0*(u98+u461))
  value=value+(c(69)*(z*(u349*(u66+u425*(u459*u425+u405)+u349*((u458+u4&
 &33)*u349+u425*(u97+u433)+u44))+u425*(u7+u464*u425)+u67)))
  u433=-1.18125d2*u449
  u66=6.34713281491225823d-1*u72
  u72=-2.11571093830408608d-1*u454
  u449=7.05236979434695359d-2*u427
  u405=(u449+u46)*u349
  value=value+(c(70)*(y*(u349*(u66+u455+u349*(u405+u456+u72))+u457+u433&
 &)))
  u97=-5.90625d2*u444*(2.1d1*u83+u45)
  u459=1.28972604461139874d5*u83
  u458=1.05785546915204304d0*u444
  u67=u458*(4.0d0*(u407-1.12d2*u361)+u459)
  u460=1.67664385799481836d6*u83
  u455=+u462*(u460+2.0d0*(u74-2.24d2*u434))
  u44=u458*(2.0d0*(u73-2.24d2*u361)+u459)
  u361=-u458*(u460+4.0d0*(u74-1.12d2*u434))
  u74=u89*(2.0d0*(u49-2.24d2*u50)+2.51496578699222754d7*u83)
  value=value+(c(71)*(z*(u349*(u67+u361*u425+u349*(u405+u74*u425+u455))&
 &+u44*u425+u97)))
  u405=u439*u351
  u458=u80*u351
  value=value+(c(72)*(u369*((u443+u351*(u405+u418))*u349+u351*(u430+u45&
 &8)+u60)))
  u430=(u351*(u62+u405)+u90)*u349
  u459=u6*u351
  u460=u9*u351
  value=value+(c(73)*(x*(u349*(u87+u351*(u459+u75)+u430)+u351*(u63+u460&
 &)+u94)))
  u461=u417*u351
  u462=u7*u351
  value=value+(c(74)*(u369*(u349*(u55+u461+(u405+u81)*u349)+u462+u53)))
  u406=(u449+u405)*u349
  u463=u56*u351
  u464=u453*u351
  u465=u42*u351
  value=value+(c(75)*(x*(u349*(u66+u463+u349*(u406+u464+u72))+u465+u433&
 &)))
  u424=u439*u349
  value=value+(c(76)*(u369*(u349*(u361+u349*(u424+u74))+u44)))
  u433=2.11571093830408608d0*u444
  u78=u433*(1.4d1*u448+9.0d0*u407)
  u369=-u433*(u68+7.0d0*u51)
  u433=u91*(3.0d0*(u49-4.48d3*u434)+1.4d1*u450)
  u434=(u349*(u78+u349*(u349*(u433+u424)+u369))+u97)
  value=value+(c(77)*(x*u434))
  value=value+(c(78)*(z*((u76+u351*(u351*(u447+u405)+u436))*u349+u351*(&
 &u59+u351*(u458+u57))+u95)))
  value=value+(c(79)*(y*(u349*(u86+u351*(u459+u48)+(u351*(u418+u405)+u4&
 &43)*u349)+u351*(u61+u460)+u95)))
  value=value+(c(80)*(z*(u349*(u77+u351*(u461+u82)+u430)+u351*(u52+u462&
 &)+u96)))
  value=value+(c(81)*(y*(u349*(u65+u463+u349*((u81+u405)*u349+u464+u429&
 &))+u465+u96)))
  value=value+(c(82)*(z*(u349*(u67+u361*u351+u349*(u406+u74*u351+u455))&
 &+u44*u351+u97)))
  value=value+(c(83)*(y*u434))
  u369=-4.134375d3*u444*(2.7d1*u83+u45)
  u45=4.44299297043858076d1*u444*(2.0d0*u448+u407)
  u407=-8.88598594087716152d0*u444*(u445+3.0d0*u51)
  u444=u446*(6.0d0*u43+u98)
  value=value+(c(84)*(z*(u349*(u45+u349*(u349*(u444+u424)+u407))+u369))&
 &)
  if ( lmax .eq. 6 ) return
  ! if we get here, something went wrong...
  D_X_R_opt_3_10=.false.
end function

  
  
!> Compute D X R coulomb integral 
!!
recursive function D_X_R_opt_3(a12,a3,r3,ny3,nz3,c,lmax,value)
  
  implicit none
  
  ! input arguments
  real(kind=8), intent(in)  :: a12      !< combined exponent = a1*a2/(a1+a2) of the two first solid harmonics 
  real(kind=8), intent(in)  :: a3       !< exponent of the third solid harmonics 
  integer     , intent(in)  :: ny3      !< y exponent of the cubic harmonic
  integer     , intent(in)  :: nz3      !< z exponent of the cubic harmonic
  real(kind=8), intent(in)  :: r3(3)    !< third solid harmonic center, taken with combined center (a1*R1+a2*R2)/(a1+a2) as origin
  real(kind=8), intent(in)  :: c(*)     !< hermit coefficients of the two fisrt obrital produt
  integer     , intent(in)  :: lmax     !< l of maximum non 0 coeff in hermit decomposition
  real(kind=8), intent(out) :: value    !< result 
  logical                   :: D_X_R_opt_3 !< true if the routine knows how to calculate the requested value
  
  ! init return value
  D_X_R_opt_3 = .true.
  ! select case on m component
  select case ((ny3+nz3)*(ny3+nz3+1)/2+nz3+1)
    case (1)
      D_X_R_opt_3 = D_X_R_opt_3_1(a12,a3,r3,c,lmax,value)
    case (2)
      D_X_R_opt_3 = D_X_R_opt_3_2(a12,a3,r3,c,lmax,value)
    case (3)
      D_X_R_opt_3 = D_X_R_opt_3_3(a12,a3,r3,c,lmax,value)
    case (4)
      D_X_R_opt_3 = D_X_R_opt_3_4(a12,a3,r3,c,lmax,value)
    case (5)
      D_X_R_opt_3 = D_X_R_opt_3_5(a12,a3,r3,c,lmax,value)
    case (6)
      D_X_R_opt_3 = D_X_R_opt_3_6(a12,a3,r3,c,lmax,value)
    case (7)
      D_X_R_opt_3 = D_X_R_opt_3_7(a12,a3,r3,c,lmax,value)
    case (8)
      D_X_R_opt_3 = D_X_R_opt_3_8(a12,a3,r3,c,lmax,value)
    case (9)
      D_X_R_opt_3 = D_X_R_opt_3_9(a12,a3,r3,c,lmax,value)
    case (10)
      D_X_R_opt_3 = D_X_R_opt_3_10(a12,a3,r3,c,lmax,value)
    case default
      D_X_R_opt_3 = .false.
  end select
end function
  
end module
